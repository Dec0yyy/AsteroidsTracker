parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"gBK8":[function(require,module,exports) {
var define;
var e,t;function n(e){var t="function"==typeof Map?new Map:void 0;return(n=function(e){if(null===e||!i(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return r(e,arguments,w(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),M(n,e)})(e)}function r(e,t,n){return(r=E()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&M(i,n.prototype),i}).apply(null,arguments)}function i(e){return-1!==Function.toString.call(e).indexOf("[native code]")}function a(e,t,n,r,i,a,o){try{var s=e[a](o),l=s.value}catch(u){return void n(u)}s.done?t(l):Promise.resolve(l).then(r,i)}function o(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var o=e.apply(t,n);function s(e){a(o,r,i,s,l,"next",e)}function l(e){a(o,r,i,s,l,"throw",e)}s(void 0)})}}function s(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=v(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function l(e,t){return h(e)||c(e,t)||v(e,t)||u()}function u(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a,o,s=[],l=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=a.call(n)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){u=!0,i=e}finally{try{if(!l&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function h(e){if(Array.isArray(e))return e}function p(){return(p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=d(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}}).apply(this,arguments)}function d(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=w(e)););return e}function f(e){return y(e)||g(e)||v(e)||m()}function m(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function v(e,t){if(e){if("string"==typeof e)return _(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_(e,t):void 0}}function g(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function y(e){if(Array.isArray(e))return _(e)}function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function x(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&M(e,t)}function M(e,t){return(M=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function S(e){var t=E();return function(){var n,r=w(e);if(t){var i=w(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b(this,n)}}function b(e,t){if(t&&("object"===C(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return T(e)}function T(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function E(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function A(e,t,n){return(t=I(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function R(){"use strict";R=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function c(e,t,n,r){var a=t&&t.prototype instanceof g?t:g,o=Object.create(a.prototype),s=new P(r||[]);return i(o,"_invoke",{value:w(e,n,s)}),o}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=c;var p="suspendedStart",d="suspendedYield",f="executing",m="completed",v={};function g(){}function y(){}function _(){}var x={};u(x,o,function(){return this});var M=Object.getPrototypeOf,S=M&&M(M(I([])));S&&S!==n&&r.call(S,o)&&(x=S);var b=_.prototype=g.prototype=Object.create(x);function T(e){["next","throw","return"].forEach(function(t){u(e,t,function(e){return this._invoke(t,e)})})}function E(e,t){function n(i,a,o,s){var l=h(e[i],e,a);if("throw"!==l.type){var u=l.arg,c=u.value;return c&&"object"==C(c)&&r.call(c,"__await")?t.resolve(c.__await).then(function(e){n("next",e,o,s)},function(e){n("throw",e,o,s)}):t.resolve(c).then(function(e){u.value=e,o(u)},function(e){return n("throw",e,o,s)})}s(l.arg)}var a;i(this,"_invoke",{value:function(e,r){function i(){return new t(function(t,i){n(e,r,t,i)})}return a=a?a.then(i,i):i()}})}function w(t,n,r){var i=p;return function(a,o){if(i===f)throw new Error("Generator is already running");if(i===m){if("throw"===a)throw o;return{value:e,done:!0}}for(r.method=a,r.arg=o;;){var s=r.delegate;if(s){var l=A(s,r);if(l){if(l===v)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===p)throw i=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=f;var u=h(t,n,r);if("normal"===u.type){if(i=r.done?m:d,u.arg===v)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(i=m,r.method="throw",r.arg=u.arg)}}}function A(t,n){var r=n.method,i=t.iterator[r];if(i===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,A(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var a=h(i,t.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,v;var o=a.arg;return o?o.done?(n[t.resultName]=o.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,v):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function k(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function I(t){if(t||""===t){var n=t[o];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw new TypeError(C(t)+" is not iterable")}return y.prototype=_,i(b,"constructor",{value:_,configurable:!0}),i(_,"constructor",{value:y,configurable:!0}),y.displayName=u(_,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,u(e,l,"GeneratorFunction")),e.prototype=Object.create(b),e},t.awrap=function(e){return{__await:e}},T(E.prototype),u(E.prototype,s,function(){return this}),t.AsyncIterator=E,t.async=function(e,n,r,i,a){void 0===a&&(a=Promise);var o=new E(c(e,n,r,i),a);return t.isGeneratorFunction(n)?o:o.next().then(function(e){return e.done?e.value:o.next()})},T(b),u(b,l,"Generator"),u(b,o,function(){return this}),u(b,"toString",function(){return"[object Generator]"}),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=I,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(L),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return s.type="throw",s.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],s=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var l=r.call(o,"catchLoc"),u=r.call(o,"finallyLoc");if(l&&u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),L(n),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;L(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:I(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),v}},t}function C(e){return(C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function k(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function L(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,I(r.key),r)}}function P(e,t,n){return t&&L(e.prototype,t),n&&L(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function I(e){var t=U(e,"string");return"symbol"===C(t)?t:String(t)}function U(e,t){if("object"!==C(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==C(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.EllipseCurve=exports.EdgesGeometry=exports.DynamicReadUsage=exports.DynamicDrawUsage=exports.DynamicCopyUsage=exports.DstColorFactor=exports.DstAlphaFactor=exports.DoubleSide=exports.DodecahedronGeometry=exports.DisplayP3ColorSpace=exports.DiscreteInterpolant=exports.DirectionalLightHelper=exports.DirectionalLight=exports.DepthTexture=exports.DepthStencilFormat=exports.DepthFormat=exports.DefaultLoadingManager=exports.DecrementWrapStencilOp=exports.DecrementStencilOp=exports.DataUtils=exports.DataTextureLoader=exports.DataTexture=exports.DataArrayTexture=exports.Data3DTexture=exports.Cylindrical=exports.CylinderGeometry=exports.CustomToneMapping=exports.CustomBlending=exports.CurvePath=exports.Curve=exports.CullFaceNone=exports.CullFaceFrontBack=exports.CullFaceFront=exports.CullFaceBack=exports.CubicInterpolant=exports.CubicBezierCurve3=exports.CubicBezierCurve=exports.CubeUVReflectionMapping=exports.CubeTextureLoader=exports.CubeTexture=exports.CubeRefractionMapping=exports.CubeReflectionMapping=exports.CubeCamera=exports.ConeGeometry=exports.CompressedTextureLoader=exports.CompressedTexture=exports.CompressedCubeTexture=exports.CompressedArrayTexture=exports.ColorManagement=exports.ColorKeyframeTrack=exports.Color=exports.Clock=exports.ClampToEdgeWrapping=exports.CircleGeometry=exports.CineonToneMapping=exports.CatmullRomCurve3=exports.CapsuleGeometry=exports.CanvasTexture=exports.CameraHelper=exports.Camera=exports.Cache=exports.ByteType=exports.BufferGeometryLoader=exports.BufferGeometry=exports.BufferAttribute=exports.BoxHelper=exports.BoxGeometry=exports.Box3Helper=exports.Box3=exports.Box2=exports.BooleanKeyframeTrack=exports.Bone=exports.BasicShadowMap=exports.BasicDepthPacking=exports.BackSide=exports.AxesHelper=exports.AudioLoader=exports.AudioListener=exports.AudioContext=exports.AudioAnalyser=exports.Audio=exports.ArrowHelper=exports.ArrayCamera=exports.ArcCurve=exports.AnimationUtils=exports.AnimationObjectGroup=exports.AnimationMixer=exports.AnimationLoader=exports.AnimationClip=exports.AnimationAction=exports.AmbientLight=exports.AlwaysStencilFunc=exports.AlwaysDepth=exports.AlwaysCompare=exports.AlphaFormat=exports.AdditiveBlending=exports.AdditiveAnimationBlendMode=exports.AddOperation=exports.AddEquation=exports.ACESFilmicToneMapping=void 0,exports.MaxEquation=exports.Matrix4=exports.Matrix3=exports.MathUtils=exports.MaterialLoader=exports.Material=exports.MOUSE=exports.LuminanceFormat=exports.LuminanceAlphaFormat=exports.LoopRepeat=exports.LoopPingPong=exports.LoopOnce=exports.LoadingManager=exports.LoaderUtils=exports.Loader=exports.LinearTransfer=exports.LinearToneMapping=exports.LinearSRGBColorSpace=exports.LinearMipmapNearestFilter=exports.LinearMipmapLinearFilter=exports.LinearMipMapNearestFilter=exports.LinearMipMapLinearFilter=exports.LinearInterpolant=exports.LinearFilter=exports.LinearEncoding=exports.LinearDisplayP3ColorSpace=exports.LineSegments=exports.LineLoop=exports.LineDashedMaterial=exports.LineCurve3=exports.LineCurve=exports.LineBasicMaterial=exports.Line3=exports.Line=exports.LightProbe=exports.Light=exports.LessStencilFunc=exports.LessEqualStencilFunc=exports.LessEqualDepth=exports.LessEqualCompare=exports.LessDepth=exports.LessCompare=exports.Layers=exports.LatheGeometry=exports.LOD=exports.KeyframeTrack=exports.KeepStencilOp=exports.InvertStencilOp=exports.InterpolateSmooth=exports.InterpolateLinear=exports.InterpolateDiscrete=exports.Interpolant=exports.InterleavedBufferAttribute=exports.InterleavedBuffer=exports.IntType=exports.Int8BufferAttribute=exports.Int32BufferAttribute=exports.Int16BufferAttribute=exports.InstancedMesh=exports.InstancedInterleavedBuffer=exports.InstancedBufferGeometry=exports.InstancedBufferAttribute=exports.IncrementWrapStencilOp=exports.IncrementStencilOp=exports.ImageUtils=exports.ImageLoader=exports.ImageBitmapLoader=exports.IcosahedronGeometry=exports.HemisphereLightHelper=exports.HemisphereLight=exports.HalfFloatType=exports.Group=exports.GridHelper=exports.GreaterStencilFunc=exports.GreaterEqualStencilFunc=exports.GreaterEqualDepth=exports.GreaterEqualCompare=exports.GreaterDepth=exports.GreaterCompare=exports.GLSL3=exports.GLSL1=exports.GLBufferAttribute=exports.Frustum=exports.FrontSide=exports.FramebufferTexture=exports.FogExp2=exports.Fog=exports.FloatType=exports.Float64BufferAttribute=exports.Float32BufferAttribute=exports.Float16BufferAttribute=exports.FileLoader=exports.ExtrudeGeometry=exports.EventDispatcher=exports.Euler=exports.EquirectangularRefractionMapping=exports.EquirectangularReflectionMapping=exports.EqualStencilFunc=exports.EqualDepth=exports.EqualCompare=void 0,exports.RGB_S3TC_DXT1_Format=exports.RGB_PVRTC_4BPPV1_Format=exports.RGB_PVRTC_2BPPV1_Format=exports.RGB_ETC2_Format=exports.RGB_ETC1_Format=exports.RGB_BPTC_UNSIGNED_Format=exports.RGB_BPTC_SIGNED_Format=exports.RGBA_S3TC_DXT5_Format=exports.RGBA_S3TC_DXT3_Format=exports.RGBA_S3TC_DXT1_Format=exports.RGBA_PVRTC_4BPPV1_Format=exports.RGBA_PVRTC_2BPPV1_Format=exports.RGBA_ETC2_EAC_Format=exports.RGBA_BPTC_Format=exports.RGBA_ASTC_8x8_Format=exports.RGBA_ASTC_8x6_Format=exports.RGBA_ASTC_8x5_Format=exports.RGBA_ASTC_6x6_Format=exports.RGBA_ASTC_6x5_Format=exports.RGBA_ASTC_5x5_Format=exports.RGBA_ASTC_5x4_Format=exports.RGBA_ASTC_4x4_Format=exports.RGBA_ASTC_12x12_Format=exports.RGBA_ASTC_12x10_Format=exports.RGBA_ASTC_10x8_Format=exports.RGBA_ASTC_10x6_Format=exports.RGBA_ASTC_10x5_Format=exports.RGBA_ASTC_10x10_Format=exports.RGBAIntegerFormat=exports.RGBAFormat=exports.RGBADepthPacking=exports.REVISION=exports.RED_RGTC1_Format=exports.RED_GREEN_RGTC2_Format=exports.QuaternionLinearInterpolant=exports.QuaternionKeyframeTrack=exports.Quaternion=exports.QuadraticBezierCurve3=exports.QuadraticBezierCurve=exports.PropertyMixer=exports.PropertyBinding=exports.PositionalAudio=exports.PolyhedronGeometry=exports.PolarGridHelper=exports.PointsMaterial=exports.Points=exports.PointLightHelper=exports.PointLight=exports.PlaneHelper=exports.PlaneGeometry=exports.Plane=exports.PerspectiveCamera=exports.Path=exports.PMREMGenerator=exports.PCFSoftShadowMap=exports.PCFShadowMap=exports.P3Primaries=exports.OrthographicCamera=exports.OneMinusSrcColorFactor=exports.OneMinusSrcAlphaFactor=exports.OneMinusDstColorFactor=exports.OneMinusDstAlphaFactor=exports.OneFactor=exports.OctahedronGeometry=exports.ObjectSpaceNormalMap=exports.ObjectLoader=exports.Object3D=exports.NumberKeyframeTrack=exports.NotEqualStencilFunc=exports.NotEqualDepth=exports.NotEqualCompare=exports.NormalBlending=exports.NormalAnimationBlendMode=exports.NoToneMapping=exports.NoColorSpace=exports.NoBlending=exports.NeverStencilFunc=exports.NeverDepth=exports.NeverCompare=exports.NearestMipmapNearestFilter=exports.NearestMipmapLinearFilter=exports.NearestMipMapNearestFilter=exports.NearestMipMapLinearFilter=exports.NearestFilter=exports.MultiplyOperation=exports.MultiplyBlending=exports.MixOperation=exports.MirroredRepeatWrapping=exports.MinEquation=exports.MeshToonMaterial=exports.MeshStandardMaterial=exports.MeshPhysicalMaterial=exports.MeshPhongMaterial=exports.MeshNormalMaterial=exports.MeshMatcapMaterial=exports.MeshLambertMaterial=exports.MeshDistanceMaterial=exports.MeshDepthMaterial=exports.MeshBasicMaterial=exports.Mesh=void 0,exports.WebGLRenderer=exports.WebGLRenderTarget=exports.WebGLMultipleRenderTargets=exports.WebGLCubeRenderTarget=exports.WebGLCoordinateSystem=exports.WebGLArrayRenderTarget=exports.WebGL3DRenderTarget=exports.WebGL1Renderer=exports.VideoTexture=exports.VectorKeyframeTrack=exports.Vector4=exports.Vector3=exports.Vector2=exports.VSMShadowMap=exports.UnsignedShortType=exports.UnsignedShort5551Type=exports.UnsignedShort4444Type=exports.UnsignedIntType=exports.UnsignedInt248Type=exports.UnsignedByteType=exports.UniformsUtils=exports.UniformsLib=exports.UniformsGroup=exports.Uniform=exports.Uint8ClampedBufferAttribute=exports.Uint8BufferAttribute=exports.Uint32BufferAttribute=exports.Uint16BufferAttribute=exports.UVMapping=exports.TwoPassDoubleSide=exports.TubeGeometry=exports.TrianglesDrawMode=exports.TriangleStripDrawMode=exports.TriangleFanDrawMode=exports.Triangle=exports.TorusKnotGeometry=exports.TorusGeometry=exports.TextureLoader=exports.Texture=exports.TetrahedronGeometry=exports.TangentSpaceNormalMap=exports.TOUCH=exports.SubtractiveBlending=exports.SubtractEquation=exports.StringKeyframeTrack=exports.StreamReadUsage=exports.StreamDrawUsage=exports.StreamCopyUsage=exports.StereoCamera=exports.StaticReadUsage=exports.StaticDrawUsage=exports.StaticCopyUsage=exports.SrcColorFactor=exports.SrcAlphaSaturateFactor=exports.SrcAlphaFactor=exports.SpriteMaterial=exports.Sprite=exports.SpotLightHelper=exports.SpotLight=exports.SplineCurve=exports.SphericalHarmonics3=exports.Spherical=exports.SphereGeometry=exports.Sphere=exports.Source=exports.SkinnedMesh=exports.SkeletonHelper=exports.Skeleton=exports.ShortType=exports.ShapeUtils=exports.ShapePath=exports.ShapeGeometry=exports.Shape=exports.ShadowMaterial=exports.ShaderMaterial=exports.ShaderLib=exports.ShaderChunk=exports.Scene=exports.SRGBTransfer=exports.SRGBColorSpace=exports.SIGNED_RED_RGTC1_Format=exports.SIGNED_RED_GREEN_RGTC2_Format=exports.RingGeometry=exports.ReverseSubtractEquation=exports.ReplaceStencilOp=exports.RepeatWrapping=exports.RenderTarget=exports.ReinhardToneMapping=exports.RedIntegerFormat=exports.RedFormat=exports.RectAreaLight=exports.Rec709Primaries=exports.Raycaster=exports.Ray=exports.RawShaderMaterial=exports.RGIntegerFormat=exports.RGFormat=void 0,exports.WebGLUtils=Ep,exports.WireframeGeometry=exports.WebGPUCoordinateSystem=void 0,exports._SRGBAFormat=exports.ZeroStencilOp=exports.ZeroSlopeEnding=exports.ZeroFactor=exports.ZeroCurvatureEnding=exports.WrapAroundEnding=void 0,exports.createCanvasElement=Zr,exports.sRGBEncoding=void 0;var D=exports.REVISION="157",N=exports.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},O=exports.TOUCH={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},F=exports.CullFaceNone=0,B=exports.CullFaceBack=1,z=exports.CullFaceFront=2,G=exports.CullFaceFrontBack=3,H=exports.BasicShadowMap=0,V=exports.PCFShadowMap=1,W=exports.PCFSoftShadowMap=2,X=exports.VSMShadowMap=3,j=exports.FrontSide=0,q=exports.BackSide=1,Y=exports.DoubleSide=2,Z=exports.TwoPassDoubleSide=2,J=exports.NoBlending=0,K=exports.NormalBlending=1,Q=exports.AdditiveBlending=2,$=exports.SubtractiveBlending=3,ee=exports.MultiplyBlending=4,te=exports.CustomBlending=5,ne=exports.AddEquation=100,re=exports.SubtractEquation=101,ie=exports.ReverseSubtractEquation=102,ae=exports.MinEquation=103,oe=exports.MaxEquation=104,se=exports.ZeroFactor=200,le=exports.OneFactor=201,ue=exports.SrcColorFactor=202,ce=exports.OneMinusSrcColorFactor=203,he=exports.SrcAlphaFactor=204,pe=exports.OneMinusSrcAlphaFactor=205,de=exports.DstAlphaFactor=206,fe=exports.OneMinusDstAlphaFactor=207,me=exports.DstColorFactor=208,ve=exports.OneMinusDstColorFactor=209,ge=exports.SrcAlphaSaturateFactor=210,ye=exports.NeverDepth=0,_e=exports.AlwaysDepth=1,xe=exports.LessDepth=2,Me=exports.LessEqualDepth=3,Se=exports.EqualDepth=4,be=exports.GreaterEqualDepth=5,Te=exports.GreaterDepth=6,Ee=exports.NotEqualDepth=7,we=exports.MultiplyOperation=0,Ae=exports.MixOperation=1,Re=exports.AddOperation=2,Ce=exports.NoToneMapping=0,ke=exports.LinearToneMapping=1,Le=exports.ReinhardToneMapping=2,Pe=exports.CineonToneMapping=3,Ie=exports.ACESFilmicToneMapping=4,Ue=exports.CustomToneMapping=5,De=exports.UVMapping=300,Ne=exports.CubeReflectionMapping=301,Oe=exports.CubeRefractionMapping=302,Fe=exports.EquirectangularReflectionMapping=303,Be=exports.EquirectangularRefractionMapping=304,ze=exports.CubeUVReflectionMapping=306,Ge=exports.RepeatWrapping=1e3,He=exports.ClampToEdgeWrapping=1001,Ve=exports.MirroredRepeatWrapping=1002,We=exports.NearestFilter=1003,Xe=exports.NearestMipmapNearestFilter=1004,je=exports.NearestMipMapNearestFilter=1004,qe=exports.NearestMipmapLinearFilter=1005,Ye=exports.NearestMipMapLinearFilter=1005,Ze=exports.LinearFilter=1006,Je=exports.LinearMipmapNearestFilter=1007,Ke=exports.LinearMipMapNearestFilter=1007,Qe=exports.LinearMipmapLinearFilter=1008,$e=exports.LinearMipMapLinearFilter=1008,et=exports.UnsignedByteType=1009,tt=exports.ByteType=1010,nt=exports.ShortType=1011,rt=exports.UnsignedShortType=1012,it=exports.IntType=1013,at=exports.UnsignedIntType=1014,ot=exports.FloatType=1015,st=exports.HalfFloatType=1016,lt=exports.UnsignedShort4444Type=1017,ut=exports.UnsignedShort5551Type=1018,ct=exports.UnsignedInt248Type=1020,ht=exports.AlphaFormat=1021,pt=exports.RGBAFormat=1023,dt=exports.LuminanceFormat=1024,ft=exports.LuminanceAlphaFormat=1025,mt=exports.DepthFormat=1026,vt=exports.DepthStencilFormat=1027,gt=exports.RedFormat=1028,yt=exports.RedIntegerFormat=1029,_t=exports.RGFormat=1030,xt=exports.RGIntegerFormat=1031,Mt=exports.RGBAIntegerFormat=1033,St=exports.RGB_S3TC_DXT1_Format=33776,bt=exports.RGBA_S3TC_DXT1_Format=33777,Tt=exports.RGBA_S3TC_DXT3_Format=33778,Et=exports.RGBA_S3TC_DXT5_Format=33779,wt=exports.RGB_PVRTC_4BPPV1_Format=35840,At=exports.RGB_PVRTC_2BPPV1_Format=35841,Rt=exports.RGBA_PVRTC_4BPPV1_Format=35842,Ct=exports.RGBA_PVRTC_2BPPV1_Format=35843,kt=exports.RGB_ETC1_Format=36196,Lt=exports.RGB_ETC2_Format=37492,Pt=exports.RGBA_ETC2_EAC_Format=37496,It=exports.RGBA_ASTC_4x4_Format=37808,Ut=exports.RGBA_ASTC_5x4_Format=37809,Dt=exports.RGBA_ASTC_5x5_Format=37810,Nt=exports.RGBA_ASTC_6x5_Format=37811,Ot=exports.RGBA_ASTC_6x6_Format=37812,Ft=exports.RGBA_ASTC_8x5_Format=37813,Bt=exports.RGBA_ASTC_8x6_Format=37814,zt=exports.RGBA_ASTC_8x8_Format=37815,Gt=exports.RGBA_ASTC_10x5_Format=37816,Ht=exports.RGBA_ASTC_10x6_Format=37817,Vt=exports.RGBA_ASTC_10x8_Format=37818,Wt=exports.RGBA_ASTC_10x10_Format=37819,Xt=exports.RGBA_ASTC_12x10_Format=37820,jt=exports.RGBA_ASTC_12x12_Format=37821,qt=exports.RGBA_BPTC_Format=36492,Yt=exports.RGB_BPTC_SIGNED_Format=36494,Zt=exports.RGB_BPTC_UNSIGNED_Format=36495,Jt=exports.RED_RGTC1_Format=36283,Kt=exports.SIGNED_RED_RGTC1_Format=36284,Qt=exports.RED_GREEN_RGTC2_Format=36285,$t=exports.SIGNED_RED_GREEN_RGTC2_Format=36286,en=exports.LoopOnce=2200,tn=exports.LoopRepeat=2201,nn=exports.LoopPingPong=2202,rn=exports.InterpolateDiscrete=2300,an=exports.InterpolateLinear=2301,on=exports.InterpolateSmooth=2302,sn=exports.ZeroCurvatureEnding=2400,ln=exports.ZeroSlopeEnding=2401,un=exports.WrapAroundEnding=2402,cn=exports.NormalAnimationBlendMode=2500,hn=exports.AdditiveAnimationBlendMode=2501,pn=exports.TrianglesDrawMode=0,dn=exports.TriangleStripDrawMode=1,fn=exports.TriangleFanDrawMode=2,mn=exports.LinearEncoding=3e3,vn=exports.sRGBEncoding=3001,gn=exports.BasicDepthPacking=3200,yn=exports.RGBADepthPacking=3201,_n=exports.TangentSpaceNormalMap=0,xn=exports.ObjectSpaceNormalMap=1,Mn=exports.NoColorSpace="",Sn=exports.SRGBColorSpace="srgb",bn=exports.LinearSRGBColorSpace="srgb-linear",Tn=exports.DisplayP3ColorSpace="display-p3",En=exports.LinearDisplayP3ColorSpace="display-p3-linear",wn=exports.LinearTransfer="linear",An=exports.SRGBTransfer="srgb",Rn=exports.Rec709Primaries="rec709",Cn=exports.P3Primaries="p3",kn=exports.ZeroStencilOp=0,Ln=exports.KeepStencilOp=7680,Pn=exports.ReplaceStencilOp=7681,In=exports.IncrementStencilOp=7682,Un=exports.DecrementStencilOp=7683,Dn=exports.IncrementWrapStencilOp=34055,Nn=exports.DecrementWrapStencilOp=34056,On=exports.InvertStencilOp=5386,Fn=exports.NeverStencilFunc=512,Bn=exports.LessStencilFunc=513,zn=exports.EqualStencilFunc=514,Gn=exports.LessEqualStencilFunc=515,Hn=exports.GreaterStencilFunc=516,Vn=exports.NotEqualStencilFunc=517,Wn=exports.GreaterEqualStencilFunc=518,Xn=exports.AlwaysStencilFunc=519,jn=exports.NeverCompare=512,qn=exports.LessCompare=513,Yn=exports.EqualCompare=514,Zn=exports.LessEqualCompare=515,Jn=exports.GreaterCompare=516,Kn=exports.NotEqualCompare=517,Qn=exports.GreaterEqualCompare=518,$n=exports.AlwaysCompare=519,er=exports.StaticDrawUsage=35044,tr=exports.DynamicDrawUsage=35048,nr=exports.StreamDrawUsage=35040,rr=exports.StaticReadUsage=35045,ir=exports.DynamicReadUsage=35049,ar=exports.StreamReadUsage=35041,or=exports.StaticCopyUsage=35046,sr=exports.DynamicCopyUsage=35050,lr=exports.StreamCopyUsage=35042,ur=exports.GLSL1="100",cr=exports.GLSL3="300 es",hr=exports._SRGBAFormat=1035,pr=exports.WebGLCoordinateSystem=2e3,dr=exports.WebGPUCoordinateSystem=2001,fr=exports.EventDispatcher=function(){function e(){k(this,e)}return P(e,[{key:"addEventListener",value:function(e,t){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}},{key:"hasEventListener",value:function(e,t){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)}},{key:"removeEventListener",value:function(e,t){if(void 0!==this._listeners){var n=this._listeners[e];if(void 0!==n){var r=n.indexOf(t);-1!==r&&n.splice(r,1)}}}},{key:"dispatchEvent",value:function(e){if(void 0!==this._listeners){var t=this._listeners[e.type];if(void 0!==t){e.target=this;for(var n=t.slice(0),r=0,i=n.length;r<i;r++)n[r].call(this,e);e.target=null}}}}]),e}(),mr=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],vr=1234567,gr=Math.PI/180,yr=180/Math.PI;function _r(){var e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(mr[255&e]+mr[e>>8&255]+mr[e>>16&255]+mr[e>>24&255]+"-"+mr[255&t]+mr[t>>8&255]+"-"+mr[t>>16&15|64]+mr[t>>24&255]+"-"+mr[63&n|128]+mr[n>>8&255]+"-"+mr[n>>16&255]+mr[n>>24&255]+mr[255&r]+mr[r>>8&255]+mr[r>>16&255]+mr[r>>24&255]).toLowerCase()}function xr(e,t,n){return Math.max(t,Math.min(n,e))}function Mr(e,t){return(e%t+t)%t}function Sr(e,t,n,r,i){return r+(e-t)*(i-r)/(n-t)}function br(e,t,n){return e!==t?(n-e)/(t-e):0}function Tr(e,t,n){return(1-n)*e+n*t}function Er(e,t,n,r){return Tr(e,t,1-Math.exp(-n*r))}function wr(e,t=1){return t-Math.abs(Mr(e,2*t)-t)}function Ar(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*(3-2*e)}function Rr(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*e*(e*(6*e-15)+10)}function Cr(e,t){return e+Math.floor(Math.random()*(t-e+1))}function kr(e,t){return e+Math.random()*(t-e)}function Lr(e){return e*(.5-Math.random())}function Pr(e){void 0!==e&&(vr=e);var t=vr+=1831565813;return t=Math.imul(t^t>>>15,1|t),(((t^=t+Math.imul(t^t>>>7,61|t))^t>>>14)>>>0)/4294967296}function Ir(e){return e*gr}function Ur(e){return e*yr}function Dr(e){return 0==(e&e-1)&&0!==e}function Nr(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))}function Or(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}function Fr(e,t,n,r,i){var a=Math.cos,o=Math.sin,s=a(n/2),l=o(n/2),u=a((t+r)/2),c=o((t+r)/2),h=a((t-r)/2),p=o((t-r)/2),d=a((r-t)/2),f=o((r-t)/2);switch(i){case"XYX":e.set(s*c,l*h,l*p,s*u);break;case"YZY":e.set(l*p,s*c,l*h,s*u);break;case"ZXZ":e.set(l*h,l*p,s*c,s*u);break;case"XZX":e.set(s*c,l*f,l*d,s*u);break;case"YXY":e.set(l*d,s*c,l*f,s*u);break;case"ZYZ":e.set(l*f,l*d,s*c,s*u);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}}function Br(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return e/4294967295;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int32Array:return Math.max(e/2147483647,-1);case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw new Error("Invalid component type.")}}function zr(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return Math.round(4294967295*e);case Uint16Array:return Math.round(65535*e);case Uint8Array:return Math.round(255*e);case Int32Array:return Math.round(2147483647*e);case Int16Array:return Math.round(32767*e);case Int8Array:return Math.round(127*e);default:throw new Error("Invalid component type.")}}var Gr=exports.MathUtils={DEG2RAD:gr,RAD2DEG:yr,generateUUID:_r,clamp:xr,euclideanModulo:Mr,mapLinear:Sr,inverseLerp:br,lerp:Tr,damp:Er,pingpong:wr,smoothstep:Ar,smootherstep:Rr,randInt:Cr,randFloat:kr,randFloatSpread:Lr,seededRandom:Pr,degToRad:Ir,radToDeg:Ur,isPowerOfTwo:Dr,ceilPowerOfTwo:Nr,floorPowerOfTwo:Or,setQuaternionFromProperEuler:Fr,normalize:zr,denormalize:Br},Hr=exports.Vector2=function(e){function t(e=0,n=0){k(this,t),t.prototype.isVector2=!0,this.x=e,this.y=n}return P(t,[{key:"width",get:function(){return this.x},set:function(e){this.x=e}},{key:"height",get:function(){return this.y},set:function(e){this.y=e}},{key:"set",value:function(e,t){return this.x=e,this.y=t,this}},{key:"setScalar",value:function(e){return this.x=e,this.y=e,this}},{key:"setX",value:function(e){return this.x=e,this}},{key:"setY",value:function(e){return this.y=e,this}},{key:"setComponent",value:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}},{key:"getComponent",value:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}},{key:"clone",value:function(){return new this.constructor(this.x,this.y)}},{key:"copy",value:function(e){return this.x=e.x,this.y=e.y,this}},{key:"add",value:function(e){return this.x+=e.x,this.y+=e.y,this}},{key:"addScalar",value:function(e){return this.x+=e,this.y+=e,this}},{key:"addVectors",value:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}},{key:"addScaledVector",value:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}},{key:"sub",value:function(e){return this.x-=e.x,this.y-=e.y,this}},{key:"subScalar",value:function(e){return this.x-=e,this.y-=e,this}},{key:"subVectors",value:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}},{key:"multiply",value:function(e){return this.x*=e.x,this.y*=e.y,this}},{key:"multiplyScalar",value:function(e){return this.x*=e,this.y*=e,this}},{key:"divide",value:function(e){return this.x/=e.x,this.y/=e.y,this}},{key:"divideScalar",value:function(e){return this.multiplyScalar(1/e)}},{key:"applyMatrix3",value:function(e){var t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}},{key:"min",value:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}},{key:"max",value:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}},{key:"clamp",value:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}},{key:"clampScalar",value:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}},{key:"clampLength",value:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}},{key:"floor",value:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}},{key:"ceil",value:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}},{key:"round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},{key:"roundToZero",value:function(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}},{key:"negate",value:function(){return this.x=-this.x,this.y=-this.y,this}},{key:"dot",value:function(e){return this.x*e.x+this.y*e.y}},{key:"cross",value:function(e){return this.x*e.y-this.y*e.x}},{key:"lengthSq",value:function(){return this.x*this.x+this.y*this.y}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}},{key:"manhattanLength",value:function(){return Math.abs(this.x)+Math.abs(this.y)}},{key:"normalize",value:function(){return this.divideScalar(this.length()||1)}},{key:"angle",value:function(){var e=Math.atan2(-this.y,-this.x)+Math.PI;return e}},{key:"angleTo",value:function(e){var t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;var n=this.dot(e)/t;return Math.acos(xr(n,-1,1))}},{key:"distanceTo",value:function(e){return Math.sqrt(this.distanceToSquared(e))}},{key:"distanceToSquared",value:function(e){var t=this.x-e.x,n=this.y-e.y;return t*t+n*n}},{key:"manhattanDistanceTo",value:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}},{key:"setLength",value:function(e){return this.normalize().multiplyScalar(e)}},{key:"lerp",value:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}},{key:"lerpVectors",value:function(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}},{key:"equals",value:function(e){return e.x===this.x&&e.y===this.y}},{key:"fromArray",value:function(e,t=0){return this.x=e[t],this.y=e[t+1],this}},{key:"toArray",value:function(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}},{key:"fromBufferAttribute",value:function(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}},{key:"rotateAround",value:function(e,t){var n=Math.cos(t),r=Math.sin(t),i=this.x-e.x,a=this.y-e.y;return this.x=i*n-a*r+e.x,this.y=i*r+a*n+e.y,this}},{key:"random",value:function(){return this.x=Math.random(),this.y=Math.random(),this}},{key:Symbol.iterator,value:R().mark(function e(){return R().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.x;case 2:return e.next=4,this.y;case 4:case"end":return e.stop()}},e,this)})}]),t}(),Vr=exports.Matrix3=function(){function e(t,n,r,i,a,o,s,l,u){k(this,e),e.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==t&&this.set(t,n,r,i,a,o,s,l,u)}return P(e,[{key:"set",value:function(e,t,n,r,i,a,o,s,l){var u=this.elements;return u[0]=e,u[1]=r,u[2]=o,u[3]=t,u[4]=i,u[5]=s,u[6]=n,u[7]=a,u[8]=l,this}},{key:"identity",value:function(){return this.set(1,0,0,0,1,0,0,0,1),this}},{key:"copy",value:function(e){var t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}},{key:"extractBasis",value:function(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}},{key:"setFromMatrix4",value:function(e){var t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}},{key:"multiply",value:function(e){return this.multiplyMatrices(this,e)}},{key:"premultiply",value:function(e){return this.multiplyMatrices(e,this)}},{key:"multiplyMatrices",value:function(e,t){var n=e.elements,r=t.elements,i=this.elements,a=n[0],o=n[3],s=n[6],l=n[1],u=n[4],c=n[7],h=n[2],p=n[5],d=n[8],f=r[0],m=r[3],v=r[6],g=r[1],y=r[4],_=r[7],x=r[2],M=r[5],S=r[8];return i[0]=a*f+o*g+s*x,i[3]=a*m+o*y+s*M,i[6]=a*v+o*_+s*S,i[1]=l*f+u*g+c*x,i[4]=l*m+u*y+c*M,i[7]=l*v+u*_+c*S,i[2]=h*f+p*g+d*x,i[5]=h*m+p*y+d*M,i[8]=h*v+p*_+d*S,this}},{key:"multiplyScalar",value:function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}},{key:"determinant",value:function(){var e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],o=e[5],s=e[6],l=e[7],u=e[8];return t*a*u-t*o*l-n*i*u+n*o*s+r*i*l-r*a*s}},{key:"invert",value:function(){var e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],o=e[5],s=e[6],l=e[7],u=e[8],c=u*a-o*l,h=o*s-u*i,p=l*i-a*s,d=t*c+n*h+r*p;if(0===d)return this.set(0,0,0,0,0,0,0,0,0);var f=1/d;return e[0]=c*f,e[1]=(r*l-u*n)*f,e[2]=(o*n-r*a)*f,e[3]=h*f,e[4]=(u*t-r*s)*f,e[5]=(r*i-o*t)*f,e[6]=p*f,e[7]=(n*s-l*t)*f,e[8]=(a*t-n*i)*f,this}},{key:"transpose",value:function(){var e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}},{key:"getNormalMatrix",value:function(e){return this.setFromMatrix4(e).invert().transpose()}},{key:"transposeIntoArray",value:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}},{key:"setUvTransform",value:function(e,t,n,r,i,a,o){var s=Math.cos(i),l=Math.sin(i);return this.set(n*s,n*l,-n*(s*a+l*o)+a+e,-r*l,r*s,-r*(-l*a+s*o)+o+t,0,0,1),this}},{key:"scale",value:function(e,t){return this.premultiply(Wr.makeScale(e,t)),this}},{key:"rotate",value:function(e){return this.premultiply(Wr.makeRotation(-e)),this}},{key:"translate",value:function(e,t){return this.premultiply(Wr.makeTranslation(e,t)),this}},{key:"makeTranslation",value:function(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}},{key:"makeRotation",value:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}},{key:"makeScale",value:function(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}},{key:"equals",value:function(e){for(var t=this.elements,n=e.elements,r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}},{key:"fromArray",value:function(e,t=0){for(var n=0;n<9;n++)this.elements[n]=e[n+t];return this}},{key:"toArray",value:function(e=[],t=0){var n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}},{key:"clone",value:function(){return(new this.constructor).fromArray(this.elements)}}]),e}(),Wr=new Vr;function Xr(e){for(var t=e.length-1;t>=0;--t)if(e[t]>=65535)return!0;return!1}var jr={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function qr(e,t){return new jr[e](t)}function Yr(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}function Zr(){var e=Yr("canvas");return e.style.display="block",e}var Jr={};function Kr(e){e in Jr||(Jr[e]=!0,console.warn(e))}var Qr,$r=(new Vr).set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),ei=(new Vr).set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),ti=(A(t={},bn,{transfer:wn,primaries:Rn,toReference:function(e){return e},fromReference:function(e){return e}}),A(t,Sn,{transfer:An,primaries:Rn,toReference:function(e){return e.convertSRGBToLinear()},fromReference:function(e){return e.convertLinearToSRGB()}}),A(t,En,{transfer:wn,primaries:Cn,toReference:function(e){return e.applyMatrix3(ei)},fromReference:function(e){return e.applyMatrix3($r)}}),A(t,Tn,{transfer:An,primaries:Cn,toReference:function(e){return e.convertSRGBToLinear().applyMatrix3(ei)},fromReference:function(e){return e.applyMatrix3($r).convertLinearToSRGB()}}),t),ni=new Set([bn,En]),ri=exports.ColorManagement={enabled:!0,_workingColorSpace:bn,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(e){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!e},get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(e){if(!ni.has(e))throw new Error('Unsupported working color space, "'.concat(e,'".'));this._workingColorSpace=e},convert:function(e,t,n){if(!1===this.enabled||t===n||!t||!n)return e;var r=ti[t].toReference;return(0,ti[n].fromReference)(r(e))},fromWorkingColorSpace:function(e,t){return this.convert(e,this._workingColorSpace,t)},toWorkingColorSpace:function(e,t){return this.convert(e,t,this._workingColorSpace)},getPrimaries:function(e){return ti[e].primaries},getTransfer:function(e){return e===Mn?wn:ti[e].transfer}};function ii(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function ai(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}var oi=exports.ImageUtils=function(){function e(){k(this,e)}return P(e,null,[{key:"getDataURL",value:function(e){if(/^data:/i.test(e.src))return e.src;if("undefined"==typeof HTMLCanvasElement)return e.src;var t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===Qr&&(Qr=Yr("canvas")),Qr.width=e.width,Qr.height=e.height;var n=Qr.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=Qr}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}},{key:"sRGBToLinear",value:function(e){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){var t=Yr("canvas");t.width=e.width,t.height=e.height;var n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);for(var r=n.getImageData(0,0,e.width,e.height),i=r.data,a=0;a<i.length;a++)i[a]=255*ii(i[a]/255);return n.putImageData(r,0,0),t}if(e.data){for(var o=e.data.slice(0),s=0;s<o.length;s++)o instanceof Uint8Array||o instanceof Uint8ClampedArray?o[s]=Math.floor(255*ii(o[s]/255)):o[s]=ii(o[s]);return{data:o,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}]),e}(),si=0,li=exports.Source=function(){function e(t=null){k(this,e),this.isSource=!0,Object.defineProperty(this,"id",{value:si++}),this.uuid=_r(),this.data=t,this.version=0}return P(e,[{key:"needsUpdate",set:function(e){!0===e&&this.version++}},{key:"toJSON",value:function(e){var t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];var n={uuid:this.uuid,url:""},r=this.data;if(null!==r){var i;if(Array.isArray(r)){i=[];for(var a=0,o=r.length;a<o;a++)r[a].isDataTexture?i.push(ui(r[a].image)):i.push(ui(r[a]))}else i=ui(r);n.url=i}return t||(e.images[this.uuid]=n),n}}]),e}();function ui(e){return"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap?oi.getDataURL(e):e.data?{data:Array.from(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}var ci=0,hi=exports.Texture=function(e){x(n,fr);var t=S(n);function n(e=n.DEFAULT_IMAGE,r=n.DEFAULT_MAPPING,i=He,a=He,o=Ze,s=Qe,l=pt,u=et,c=n.DEFAULT_ANISOTROPY,h=Mn){var p;return k(this,n),(p=t.call(this)).isTexture=!0,Object.defineProperty(T(p),"id",{value:ci++}),p.uuid=_r(),p.name="",p.source=new li(e),p.mipmaps=[],p.mapping=r,p.channel=0,p.wrapS=i,p.wrapT=a,p.magFilter=o,p.minFilter=s,p.anisotropy=c,p.format=l,p.internalFormat=null,p.type=u,p.offset=new Hr(0,0),p.repeat=new Hr(1,1),p.center=new Hr(0,0),p.rotation=0,p.matrixAutoUpdate=!0,p.matrix=new Vr,p.generateMipmaps=!0,p.premultiplyAlpha=!1,p.flipY=!0,p.unpackAlignment=4,"string"==typeof h?p.colorSpace=h:(Kr("THREE.Texture: Property .encoding has been replaced by .colorSpace."),p.colorSpace=h===vn?Sn:Mn),p.userData={},p.version=0,p.onUpdate=null,p.isRenderTargetTexture=!1,p.needsPMREMUpdate=!1,p}return P(n,[{key:"image",get:function(){return this.source.data},set:function(e=null){this.source.data=e}},{key:"updateMatrix",value:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}},{key:"toJSON",value:function(e){var t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];var n={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}},{key:"transformUv",value:function(e){if(this.mapping!==De)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Ge:e.x=e.x-Math.floor(e.x);break;case He:e.x=e.x<0?0:1;break;case Ve:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case Ge:e.y=e.y-Math.floor(e.y);break;case He:e.y=e.y<0?0:1;break;case Ve:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}},{key:"needsUpdate",set:function(e){!0===e&&(this.version++,this.source.needsUpdate=!0)}},{key:"encoding",get:function(){return Kr("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===Sn?vn:mn},set:function(e){Kr("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=e===vn?Sn:Mn}}]),n}();hi.DEFAULT_IMAGE=null,hi.DEFAULT_MAPPING=De,hi.DEFAULT_ANISOTROPY=1;var pi=exports.Vector4=function(e){function t(e=0,n=0,r=0,i=1){k(this,t),t.prototype.isVector4=!0,this.x=e,this.y=n,this.z=r,this.w=i}return P(t,[{key:"width",get:function(){return this.z},set:function(e){this.z=e}},{key:"height",get:function(){return this.w},set:function(e){this.w=e}},{key:"set",value:function(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}},{key:"setScalar",value:function(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}},{key:"setX",value:function(e){return this.x=e,this}},{key:"setY",value:function(e){return this.y=e,this}},{key:"setZ",value:function(e){return this.z=e,this}},{key:"setW",value:function(e){return this.w=e,this}},{key:"setComponent",value:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}},{key:"getComponent",value:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}},{key:"clone",value:function(){return new this.constructor(this.x,this.y,this.z,this.w)}},{key:"copy",value:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}},{key:"add",value:function(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}},{key:"addScalar",value:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}},{key:"addVectors",value:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}},{key:"addScaledVector",value:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}},{key:"sub",value:function(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}},{key:"subScalar",value:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}},{key:"subVectors",value:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}},{key:"multiply",value:function(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}},{key:"multiplyScalar",value:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}},{key:"applyMatrix4",value:function(e){var t=this.x,n=this.y,r=this.z,i=this.w,a=e.elements;return this.x=a[0]*t+a[4]*n+a[8]*r+a[12]*i,this.y=a[1]*t+a[5]*n+a[9]*r+a[13]*i,this.z=a[2]*t+a[6]*n+a[10]*r+a[14]*i,this.w=a[3]*t+a[7]*n+a[11]*r+a[15]*i,this}},{key:"divideScalar",value:function(e){return this.multiplyScalar(1/e)}},{key:"setAxisAngleFromQuaternion",value:function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}},{key:"setAxisAngleFromRotationMatrix",value:function(e){var t,n,r,i,a=e.elements,o=a[0],s=a[4],l=a[8],u=a[1],c=a[5],h=a[9],p=a[2],d=a[6],f=a[10];if(Math.abs(s-u)<.01&&Math.abs(l-p)<.01&&Math.abs(h-d)<.01){if(Math.abs(s+u)<.1&&Math.abs(l+p)<.1&&Math.abs(h+d)<.1&&Math.abs(o+c+f-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;var m=(o+1)/2,v=(c+1)/2,g=(f+1)/2,y=(s+u)/4,_=(l+p)/4,x=(h+d)/4;return m>v&&m>g?m<.01?(n=0,r=.707106781,i=.707106781):(r=y/(n=Math.sqrt(m)),i=_/n):v>g?v<.01?(n=.707106781,r=0,i=.707106781):(n=y/(r=Math.sqrt(v)),i=x/r):g<.01?(n=.707106781,r=.707106781,i=0):(n=_/(i=Math.sqrt(g)),r=x/i),this.set(n,r,i,t),this}var M=Math.sqrt((d-h)*(d-h)+(l-p)*(l-p)+(u-s)*(u-s));return Math.abs(M)<.001&&(M=1),this.x=(d-h)/M,this.y=(l-p)/M,this.z=(u-s)/M,this.w=Math.acos((o+c+f-1)/2),this}},{key:"min",value:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}},{key:"max",value:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}},{key:"clamp",value:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}},{key:"clampScalar",value:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}},{key:"clampLength",value:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}},{key:"floor",value:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}},{key:"ceil",value:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}},{key:"round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}},{key:"roundToZero",value:function(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}},{key:"negate",value:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}},{key:"dot",value:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}},{key:"lengthSq",value:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}},{key:"manhattanLength",value:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}},{key:"normalize",value:function(){return this.divideScalar(this.length()||1)}},{key:"setLength",value:function(e){return this.normalize().multiplyScalar(e)}},{key:"lerp",value:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}},{key:"lerpVectors",value:function(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}},{key:"equals",value:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}},{key:"fromArray",value:function(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}},{key:"toArray",value:function(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}},{key:"fromBufferAttribute",value:function(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}},{key:"random",value:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}},{key:Symbol.iterator,value:R().mark(function e(){return R().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.x;case 2:return e.next=4,this.y;case 4:return e.next=6,this.z;case 6:return e.next=8,this.w;case 8:case"end":return e.stop()}},e,this)})}]),t}(),di=exports.RenderTarget=function(e){x(n,fr);var t=S(n);function n(e=1,r=1,i={}){var a;k(this,n),(a=t.call(this)).isRenderTarget=!0,a.width=e,a.height=r,a.depth=1,a.scissor=new pi(0,0,e,r),a.scissorTest=!1,a.viewport=new pi(0,0,e,r);var o={width:e,height:r,depth:1};return void 0!==i.encoding&&(Kr("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),i.colorSpace=i.encoding===vn?Sn:Mn),i=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Ze,depthBuffer:!0,stencilBuffer:!1,depthTexture:null,samples:0},i),a.texture=new hi(o,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace),a.texture.isRenderTargetTexture=!0,a.texture.flipY=!1,a.texture.generateMipmaps=i.generateMipmaps,a.texture.internalFormat=i.internalFormat,a.depthBuffer=i.depthBuffer,a.stencilBuffer=i.stencilBuffer,a.depthTexture=i.depthTexture,a.samples=i.samples,a}return P(n,[{key:"setSize",value:function(e,t,n=1){this.width===e&&this.height===t&&this.depth===n||(this.width=e,this.height=t,this.depth=n,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;var t=Object.assign({},e.texture.image);return this.texture.source=new li(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}}]),n}(),fi=exports.WebGLRenderTarget=function(e){x(n,di);var t=S(n);function n(e=1,r=1,i={}){var a;return k(this,n),(a=t.call(this,e,r,i)).isWebGLRenderTarget=!0,a}return P(n)}(),mi=exports.DataArrayTexture=function(e){x(n,hi);var t=S(n);function n(e=null,r=1,i=1,a=1){var o;return k(this,n),(o=t.call(this,null)).isDataArrayTexture=!0,o.image={data:e,width:r,height:i,depth:a},o.magFilter=We,o.minFilter=We,o.wrapR=He,o.generateMipmaps=!1,o.flipY=!1,o.unpackAlignment=1,o}return P(n)}(),vi=exports.WebGLArrayRenderTarget=function(e){x(n,fi);var t=S(n);function n(e=1,r=1,i=1){var a;return k(this,n),(a=t.call(this,e,r)).isWebGLArrayRenderTarget=!0,a.depth=i,a.texture=new mi(null,e,r,i),a.texture.isRenderTargetTexture=!0,a}return P(n)}(),gi=exports.Data3DTexture=function(e){x(n,hi);var t=S(n);function n(e=null,r=1,i=1,a=1){var o;return k(this,n),(o=t.call(this,null)).isData3DTexture=!0,o.image={data:e,width:r,height:i,depth:a},o.magFilter=We,o.minFilter=We,o.wrapR=He,o.generateMipmaps=!1,o.flipY=!1,o.unpackAlignment=1,o}return P(n)}(),yi=exports.WebGL3DRenderTarget=function(e){x(n,fi);var t=S(n);function n(e=1,r=1,i=1){var a;return k(this,n),(a=t.call(this,e,r)).isWebGL3DRenderTarget=!0,a.depth=i,a.texture=new gi(null,e,r,i),a.texture.isRenderTargetTexture=!0,a}return P(n)}(),_i=exports.WebGLMultipleRenderTargets=function(e){x(n,fi);var t=S(n);function n(e=1,r=1,i=1,a={}){var o;k(this,n),(o=t.call(this,e,r,a)).isWebGLMultipleRenderTargets=!0;var s=o.texture;o.texture=[];for(var l=0;l<i;l++)o.texture[l]=s.clone(),o.texture[l].isRenderTargetTexture=!0;return o}return P(n,[{key:"setSize",value:function(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(var r=0,i=this.texture.length;r<i;r++)this.texture[r].image.width=e,this.texture[r].image.height=t,this.texture[r].image.depth=n;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}},{key:"copy",value:function(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.texture.length=0;for(var t=0,n=e.texture.length;t<n;t++)this.texture[t]=e.texture[t].clone(),this.texture[t].isRenderTargetTexture=!0;return this}}]),n}(),xi=exports.Quaternion=function(e){function t(e=0,n=0,r=0,i=1){k(this,t),this.isQuaternion=!0,this._x=e,this._y=n,this._z=r,this._w=i}return P(t,[{key:"x",get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},{key:"w",get:function(){return this._w},set:function(e){this._w=e,this._onChangeCallback()}},{key:"set",value:function(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}},{key:"clone",value:function(){return new this.constructor(this._x,this._y,this._z,this._w)}},{key:"copy",value:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}},{key:"setFromEuler",value:function(e,t){var n=e._x,r=e._y,i=e._z,a=e._order,o=Math.cos,s=Math.sin,l=o(n/2),u=o(r/2),c=o(i/2),h=s(n/2),p=s(r/2),d=s(i/2);switch(a){case"XYZ":this._x=h*u*c+l*p*d,this._y=l*p*c-h*u*d,this._z=l*u*d+h*p*c,this._w=l*u*c-h*p*d;break;case"YXZ":this._x=h*u*c+l*p*d,this._y=l*p*c-h*u*d,this._z=l*u*d-h*p*c,this._w=l*u*c+h*p*d;break;case"ZXY":this._x=h*u*c-l*p*d,this._y=l*p*c+h*u*d,this._z=l*u*d+h*p*c,this._w=l*u*c-h*p*d;break;case"ZYX":this._x=h*u*c-l*p*d,this._y=l*p*c+h*u*d,this._z=l*u*d-h*p*c,this._w=l*u*c+h*p*d;break;case"YZX":this._x=h*u*c+l*p*d,this._y=l*p*c+h*u*d,this._z=l*u*d-h*p*c,this._w=l*u*c-h*p*d;break;case"XZY":this._x=h*u*c-l*p*d,this._y=l*p*c-h*u*d,this._z=l*u*d+h*p*c,this._w=l*u*c+h*p*d;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return!1!==t&&this._onChangeCallback(),this}},{key:"setFromAxisAngle",value:function(e,t){var n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}},{key:"setFromRotationMatrix",value:function(e){var t=e.elements,n=t[0],r=t[4],i=t[8],a=t[1],o=t[5],s=t[9],l=t[2],u=t[6],c=t[10],h=n+o+c;if(h>0){var p=.5/Math.sqrt(h+1);this._w=.25/p,this._x=(u-s)*p,this._y=(i-l)*p,this._z=(a-r)*p}else if(n>o&&n>c){var d=2*Math.sqrt(1+n-o-c);this._w=(u-s)/d,this._x=.25*d,this._y=(r+a)/d,this._z=(i+l)/d}else if(o>c){var f=2*Math.sqrt(1+o-n-c);this._w=(i-l)/f,this._x=(r+a)/f,this._y=.25*f,this._z=(s+u)/f}else{var m=2*Math.sqrt(1+c-n-o);this._w=(a-r)/m,this._x=(i+l)/m,this._y=(s+u)/m,this._z=.25*m}return this._onChangeCallback(),this}},{key:"setFromUnitVectors",value:function(e,t){var n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}},{key:"angleTo",value:function(e){return 2*Math.acos(Math.abs(xr(this.dot(e),-1,1)))}},{key:"rotateTowards",value:function(e,t){var n=this.angleTo(e);if(0===n)return this;var r=Math.min(1,t/n);return this.slerp(e,r),this}},{key:"identity",value:function(){return this.set(0,0,0,1)}},{key:"invert",value:function(){return this.conjugate()}},{key:"conjugate",value:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}},{key:"dot",value:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}},{key:"lengthSq",value:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}},{key:"length",value:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}},{key:"normalize",value:function(){var e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}},{key:"multiply",value:function(e){return this.multiplyQuaternions(this,e)}},{key:"premultiply",value:function(e){return this.multiplyQuaternions(e,this)}},{key:"multiplyQuaternions",value:function(e,t){var n=e._x,r=e._y,i=e._z,a=e._w,o=t._x,s=t._y,l=t._z,u=t._w;return this._x=n*u+a*o+r*l-i*s,this._y=r*u+a*s+i*o-n*l,this._z=i*u+a*l+n*s-r*o,this._w=a*u-n*o-r*s-i*l,this._onChangeCallback(),this}},{key:"slerp",value:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var n=this._x,r=this._y,i=this._z,a=this._w,o=a*e._w+n*e._x+r*e._y+i*e._z;if(o<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),o>=1)return this._w=a,this._x=n,this._y=r,this._z=i,this;var s=1-o*o;if(s<=Number.EPSILON){var l=1-t;return this._w=l*a+t*this._w,this._x=l*n+t*this._x,this._y=l*r+t*this._y,this._z=l*i+t*this._z,this.normalize(),this._onChangeCallback(),this}var u=Math.sqrt(s),c=Math.atan2(u,o),h=Math.sin((1-t)*c)/u,p=Math.sin(t*c)/u;return this._w=a*h+this._w*p,this._x=n*h+this._x*p,this._y=r*h+this._y*p,this._z=i*h+this._z*p,this._onChangeCallback(),this}},{key:"slerpQuaternions",value:function(e,t,n){return this.copy(e).slerp(t,n)}},{key:"random",value:function(){var e=Math.random(),t=Math.sqrt(1-e),n=Math.sqrt(e),r=2*Math.PI*Math.random(),i=2*Math.PI*Math.random();return this.set(t*Math.cos(r),n*Math.sin(i),n*Math.cos(i),t*Math.sin(r))}},{key:"equals",value:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}},{key:"fromArray",value:function(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}},{key:"toArray",value:function(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}},{key:"fromBufferAttribute",value:function(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}},{key:"toJSON",value:function(){return this.toArray()}},{key:"_onChange",value:function(e){return this._onChangeCallback=e,this}},{key:"_onChangeCallback",value:function(){}},{key:Symbol.iterator,value:R().mark(function e(){return R().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._x;case 2:return e.next=4,this._y;case 4:return e.next=6,this._z;case 6:return e.next=8,this._w;case 8:case"end":return e.stop()}},e,this)})}],[{key:"slerpFlat",value:function(e,t,n,r,i,a,o){var s=n[r+0],l=n[r+1],u=n[r+2],c=n[r+3],h=i[a+0],p=i[a+1],d=i[a+2],f=i[a+3];if(0===o)return e[t+0]=s,e[t+1]=l,e[t+2]=u,void(e[t+3]=c);if(1===o)return e[t+0]=h,e[t+1]=p,e[t+2]=d,void(e[t+3]=f);if(c!==f||s!==h||l!==p||u!==d){var m=1-o,v=s*h+l*p+u*d+c*f,g=v>=0?1:-1,y=1-v*v;if(y>Number.EPSILON){var _=Math.sqrt(y),x=Math.atan2(_,v*g);m=Math.sin(m*x)/_,o=Math.sin(o*x)/_}var M=o*g;if(s=s*m+h*M,l=l*m+p*M,u=u*m+d*M,c=c*m+f*M,m===1-o){var S=1/Math.sqrt(s*s+l*l+u*u+c*c);s*=S,l*=S,u*=S,c*=S}}e[t]=s,e[t+1]=l,e[t+2]=u,e[t+3]=c}},{key:"multiplyQuaternionsFlat",value:function(e,t,n,r,i,a){var o=n[r],s=n[r+1],l=n[r+2],u=n[r+3],c=i[a],h=i[a+1],p=i[a+2],d=i[a+3];return e[t]=o*d+u*c+s*p-l*h,e[t+1]=s*d+u*h+l*c-o*p,e[t+2]=l*d+u*p+o*h-s*c,e[t+3]=u*d-o*c-s*h-l*p,e}}]),t}(),Mi=exports.Vector3=function(e){function t(e=0,n=0,r=0){k(this,t),t.prototype.isVector3=!0,this.x=e,this.y=n,this.z=r}return P(t,[{key:"set",value:function(e,t,n){return void 0===n&&(n=this.z),this.x=e,this.y=t,this.z=n,this}},{key:"setScalar",value:function(e){return this.x=e,this.y=e,this.z=e,this}},{key:"setX",value:function(e){return this.x=e,this}},{key:"setY",value:function(e){return this.y=e,this}},{key:"setZ",value:function(e){return this.z=e,this}},{key:"setComponent",value:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}},{key:"getComponent",value:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}},{key:"clone",value:function(){return new this.constructor(this.x,this.y,this.z)}},{key:"copy",value:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}},{key:"add",value:function(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}},{key:"addScalar",value:function(e){return this.x+=e,this.y+=e,this.z+=e,this}},{key:"addVectors",value:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}},{key:"addScaledVector",value:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}},{key:"sub",value:function(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}},{key:"subScalar",value:function(e){return this.x-=e,this.y-=e,this.z-=e,this}},{key:"subVectors",value:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}},{key:"multiply",value:function(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}},{key:"multiplyScalar",value:function(e){return this.x*=e,this.y*=e,this.z*=e,this}},{key:"multiplyVectors",value:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}},{key:"applyEuler",value:function(e){return this.applyQuaternion(bi.setFromEuler(e))}},{key:"applyAxisAngle",value:function(e,t){return this.applyQuaternion(bi.setFromAxisAngle(e,t))}},{key:"applyMatrix3",value:function(e){var t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6]*r,this.y=i[1]*t+i[4]*n+i[7]*r,this.z=i[2]*t+i[5]*n+i[8]*r,this}},{key:"applyNormalMatrix",value:function(e){return this.applyMatrix3(e).normalize()}},{key:"applyMatrix4",value:function(e){var t=this.x,n=this.y,r=this.z,i=e.elements,a=1/(i[3]*t+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*t+i[4]*n+i[8]*r+i[12])*a,this.y=(i[1]*t+i[5]*n+i[9]*r+i[13])*a,this.z=(i[2]*t+i[6]*n+i[10]*r+i[14])*a,this}},{key:"applyQuaternion",value:function(e){var t=this.x,n=this.y,r=this.z,i=e.x,a=e.y,o=e.z,s=e.w,l=s*t+a*r-o*n,u=s*n+o*t-i*r,c=s*r+i*n-a*t,h=-i*t-a*n-o*r;return this.x=l*s+h*-i+u*-o-c*-a,this.y=u*s+h*-a+c*-i-l*-o,this.z=c*s+h*-o+l*-a-u*-i,this}},{key:"project",value:function(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}},{key:"unproject",value:function(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}},{key:"transformDirection",value:function(e){var t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[4]*n+i[8]*r,this.y=i[1]*t+i[5]*n+i[9]*r,this.z=i[2]*t+i[6]*n+i[10]*r,this.normalize()}},{key:"divide",value:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}},{key:"divideScalar",value:function(e){return this.multiplyScalar(1/e)}},{key:"min",value:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}},{key:"max",value:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}},{key:"clamp",value:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}},{key:"clampScalar",value:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}},{key:"clampLength",value:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}},{key:"floor",value:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}},{key:"ceil",value:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}},{key:"round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}},{key:"roundToZero",value:function(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}},{key:"negate",value:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}},{key:"dot",value:function(e){return this.x*e.x+this.y*e.y+this.z*e.z}},{key:"lengthSq",value:function(){return this.x*this.x+this.y*this.y+this.z*this.z}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}},{key:"manhattanLength",value:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}},{key:"normalize",value:function(){return this.divideScalar(this.length()||1)}},{key:"setLength",value:function(e){return this.normalize().multiplyScalar(e)}},{key:"lerp",value:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}},{key:"lerpVectors",value:function(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}},{key:"cross",value:function(e){return this.crossVectors(this,e)}},{key:"crossVectors",value:function(e,t){var n=e.x,r=e.y,i=e.z,a=t.x,o=t.y,s=t.z;return this.x=r*s-i*o,this.y=i*a-n*s,this.z=n*o-r*a,this}},{key:"projectOnVector",value:function(e){var t=e.lengthSq();if(0===t)return this.set(0,0,0);var n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}},{key:"projectOnPlane",value:function(e){return Si.copy(this).projectOnVector(e),this.sub(Si)}},{key:"reflect",value:function(e){return this.sub(Si.copy(e).multiplyScalar(2*this.dot(e)))}},{key:"angleTo",value:function(e){var t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;var n=this.dot(e)/t;return Math.acos(xr(n,-1,1))}},{key:"distanceTo",value:function(e){return Math.sqrt(this.distanceToSquared(e))}},{key:"distanceToSquared",value:function(e){var t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}},{key:"manhattanDistanceTo",value:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}},{key:"setFromSpherical",value:function(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}},{key:"setFromSphericalCoords",value:function(e,t,n){var r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}},{key:"setFromCylindrical",value:function(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}},{key:"setFromCylindricalCoords",value:function(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}},{key:"setFromMatrixPosition",value:function(e){var t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}},{key:"setFromMatrixScale",value:function(e){var t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}},{key:"setFromMatrixColumn",value:function(e,t){return this.fromArray(e.elements,4*t)}},{key:"setFromMatrix3Column",value:function(e,t){return this.fromArray(e.elements,3*t)}},{key:"setFromEuler",value:function(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}},{key:"setFromColor",value:function(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}},{key:"equals",value:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}},{key:"fromArray",value:function(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}},{key:"toArray",value:function(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}},{key:"fromBufferAttribute",value:function(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}},{key:"random",value:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}},{key:"randomDirection",value:function(){var e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,n=Math.sqrt(1-Math.pow(e,2));return this.x=n*Math.cos(t),this.y=n*Math.sin(t),this.z=e,this}},{key:Symbol.iterator,value:R().mark(function e(){return R().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.x;case 2:return e.next=4,this.y;case 4:return e.next=6,this.z;case 6:case"end":return e.stop()}},e,this)})}]),t}(),Si=new Mi,bi=new xi,Ti=exports.Box3=function(){function e(t=new Mi(1/0,1/0,1/0),n=new Mi(-1/0,-1/0,-1/0)){k(this,e),this.isBox3=!0,this.min=t,this.max=n}return P(e,[{key:"set",value:function(e,t){return this.min.copy(e),this.max.copy(t),this}},{key:"setFromArray",value:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t+=3)this.expandByPoint(wi.fromArray(e,t));return this}},{key:"setFromBufferAttribute",value:function(e){this.makeEmpty();for(var t=0,n=e.count;t<n;t++)this.expandByPoint(wi.fromBufferAttribute(e,t));return this}},{key:"setFromPoints",value:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}},{key:"setFromCenterAndSize",value:function(e,t){var n=wi.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}},{key:"setFromObject",value:function(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.min.copy(e.min),this.max.copy(e.max),this}},{key:"makeEmpty",value:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}},{key:"isEmpty",value:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}},{key:"getCenter",value:function(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}},{key:"getSize",value:function(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}},{key:"expandByPoint",value:function(e){return this.min.min(e),this.max.max(e),this}},{key:"expandByVector",value:function(e){return this.min.sub(e),this.max.add(e),this}},{key:"expandByScalar",value:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this}},{key:"expandByObject",value:function(e,t=!1){if(e.updateWorldMatrix(!1,!1),void 0!==e.boundingBox)null===e.boundingBox&&e.computeBoundingBox(),Ai.copy(e.boundingBox),Ai.applyMatrix4(e.matrixWorld),this.union(Ai);else{var n=e.geometry;if(void 0!==n)if(t&&void 0!==n.attributes&&void 0!==n.attributes.position)for(var r=n.attributes.position,i=0,a=r.count;i<a;i++)wi.fromBufferAttribute(r,i).applyMatrix4(e.matrixWorld),this.expandByPoint(wi);else null===n.boundingBox&&n.computeBoundingBox(),Ai.copy(n.boundingBox),Ai.applyMatrix4(e.matrixWorld),this.union(Ai)}for(var o=e.children,s=0,l=o.length;s<l;s++)this.expandByObject(o[s],t);return this}},{key:"containsPoint",value:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}},{key:"containsBox",value:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}},{key:"getParameter",value:function(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}},{key:"intersectsBox",value:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}},{key:"intersectsSphere",value:function(e){return this.clampPoint(e.center,wi),wi.distanceToSquared(e.center)<=e.radius*e.radius}},{key:"intersectsPlane",value:function(e){var t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}},{key:"intersectsTriangle",value:function(e){if(this.isEmpty())return!1;this.getCenter(Ui),Di.subVectors(this.max,Ui),Ri.subVectors(e.a,Ui),Ci.subVectors(e.b,Ui),ki.subVectors(e.c,Ui),Li.subVectors(Ci,Ri),Pi.subVectors(ki,Ci),Ii.subVectors(Ri,ki);var t=[0,-Li.z,Li.y,0,-Pi.z,Pi.y,0,-Ii.z,Ii.y,Li.z,0,-Li.x,Pi.z,0,-Pi.x,Ii.z,0,-Ii.x,-Li.y,Li.x,0,-Pi.y,Pi.x,0,-Ii.y,Ii.x,0];return!!Fi(t,Ri,Ci,ki,Di)&&(!!Fi(t=[1,0,0,0,1,0,0,0,1],Ri,Ci,ki,Di)&&(Ni.crossVectors(Li,Pi),Fi(t=[Ni.x,Ni.y,Ni.z],Ri,Ci,ki,Di)))}},{key:"clampPoint",value:function(e,t){return t.copy(e).clamp(this.min,this.max)}},{key:"distanceToPoint",value:function(e){return this.clampPoint(e,wi).distanceTo(e)}},{key:"getBoundingSphere",value:function(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(wi).length()),e}},{key:"intersect",value:function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}},{key:"union",value:function(e){return this.min.min(e.min),this.max.max(e.max),this}},{key:"applyMatrix4",value:function(e){return this.isEmpty()?this:(Ei[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Ei[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Ei[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Ei[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Ei[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Ei[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Ei[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Ei[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Ei),this)}},{key:"translate",value:function(e){return this.min.add(e),this.max.add(e),this}},{key:"equals",value:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}]),e}(),Ei=[new Mi,new Mi,new Mi,new Mi,new Mi,new Mi,new Mi,new Mi],wi=new Mi,Ai=new Ti,Ri=new Mi,Ci=new Mi,ki=new Mi,Li=new Mi,Pi=new Mi,Ii=new Mi,Ui=new Mi,Di=new Mi,Ni=new Mi,Oi=new Mi;function Fi(e,t,n,r,i){for(var a=0,o=e.length-3;a<=o;a+=3){Oi.fromArray(e,a);var s=i.x*Math.abs(Oi.x)+i.y*Math.abs(Oi.y)+i.z*Math.abs(Oi.z),l=t.dot(Oi),u=n.dot(Oi),c=r.dot(Oi);if(Math.max(-Math.max(l,u,c),Math.min(l,u,c))>s)return!1}return!0}var Bi=new Ti,zi=new Mi,Gi=new Mi,Hi=exports.Sphere=function(){function e(t=new Mi,n=-1){k(this,e),this.center=t,this.radius=n}return P(e,[{key:"set",value:function(e,t){return this.center.copy(e),this.radius=t,this}},{key:"setFromPoints",value:function(e,t){var n=this.center;void 0!==t?n.copy(t):Bi.setFromPoints(e).getCenter(n);for(var r=0,i=0,a=e.length;i<a;i++)r=Math.max(r,n.distanceToSquared(e[i]));return this.radius=Math.sqrt(r),this}},{key:"copy",value:function(e){return this.center.copy(e.center),this.radius=e.radius,this}},{key:"isEmpty",value:function(){return this.radius<0}},{key:"makeEmpty",value:function(){return this.center.set(0,0,0),this.radius=-1,this}},{key:"containsPoint",value:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}},{key:"distanceToPoint",value:function(e){return e.distanceTo(this.center)-this.radius}},{key:"intersectsSphere",value:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}},{key:"intersectsBox",value:function(e){return e.intersectsSphere(this)}},{key:"intersectsPlane",value:function(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}},{key:"clampPoint",value:function(e,t){var n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}},{key:"getBoundingBox",value:function(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}},{key:"applyMatrix4",value:function(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}},{key:"translate",value:function(e){return this.center.add(e),this}},{key:"expandByPoint",value:function(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;zi.subVectors(e,this.center);var t=zi.lengthSq();if(t>this.radius*this.radius){var n=Math.sqrt(t),r=.5*(n-this.radius);this.center.addScaledVector(zi,r/n),this.radius+=r}return this}},{key:"union",value:function(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(Gi.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(zi.copy(e.center).add(Gi)),this.expandByPoint(zi.copy(e.center).sub(Gi))),this)}},{key:"equals",value:function(e){return e.center.equals(this.center)&&e.radius===this.radius}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}(),Vi=new Mi,Wi=new Mi,Xi=new Mi,ji=new Mi,qi=new Mi,Yi=new Mi,Zi=new Mi,Ji=exports.Ray=function(){function e(t=new Mi,n=new Mi(0,0,-1)){k(this,e),this.origin=t,this.direction=n}return P(e,[{key:"set",value:function(e,t){return this.origin.copy(e),this.direction.copy(t),this}},{key:"copy",value:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}},{key:"at",value:function(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}},{key:"lookAt",value:function(e){return this.direction.copy(e).sub(this.origin).normalize(),this}},{key:"recast",value:function(e){return this.origin.copy(this.at(e,Vi)),this}},{key:"closestPointToPoint",value:function(e,t){t.subVectors(e,this.origin);var n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}},{key:"distanceToPoint",value:function(e){return Math.sqrt(this.distanceSqToPoint(e))}},{key:"distanceSqToPoint",value:function(e){var t=Vi.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Vi.copy(this.origin).addScaledVector(this.direction,t),Vi.distanceToSquared(e))}},{key:"distanceSqToSegment",value:function(e,t,n,r){Wi.copy(e).add(t).multiplyScalar(.5),Xi.copy(t).sub(e).normalize(),ji.copy(this.origin).sub(Wi);var i,a,o,s,l=.5*e.distanceTo(t),u=-this.direction.dot(Xi),c=ji.dot(this.direction),h=-ji.dot(Xi),p=ji.lengthSq(),d=Math.abs(1-u*u);if(d>0)if(a=u*c-h,s=l*d,(i=u*h-c)>=0)if(a>=-s)if(a<=s){var f=1/d;o=(i*=f)*(i+u*(a*=f)+2*c)+a*(u*i+a+2*h)+p}else a=l,o=-(i=Math.max(0,-(u*a+c)))*i+a*(a+2*h)+p;else a=-l,o=-(i=Math.max(0,-(u*a+c)))*i+a*(a+2*h)+p;else a<=-s?o=-(i=Math.max(0,-(-u*l+c)))*i+(a=i>0?-l:Math.min(Math.max(-l,-h),l))*(a+2*h)+p:a<=s?(i=0,o=(a=Math.min(Math.max(-l,-h),l))*(a+2*h)+p):o=-(i=Math.max(0,-(u*l+c)))*i+(a=i>0?l:Math.min(Math.max(-l,-h),l))*(a+2*h)+p;else a=u>0?-l:l,o=-(i=Math.max(0,-(u*a+c)))*i+a*(a+2*h)+p;return n&&n.copy(this.origin).addScaledVector(this.direction,i),r&&r.copy(Wi).addScaledVector(Xi,a),o}},{key:"intersectSphere",value:function(e,t){Vi.subVectors(e.center,this.origin);var n=Vi.dot(this.direction),r=Vi.dot(Vi)-n*n,i=e.radius*e.radius;if(r>i)return null;var a=Math.sqrt(i-r),o=n-a,s=n+a;return s<0?null:o<0?this.at(s,t):this.at(o,t)}},{key:"intersectsSphere",value:function(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}},{key:"distanceToPlane",value:function(e){var t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;var n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}},{key:"intersectPlane",value:function(e,t){var n=this.distanceToPlane(e);return null===n?null:this.at(n,t)}},{key:"intersectsPlane",value:function(e){var t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}},{key:"intersectBox",value:function(e,t){var n,r,i,a,o,s,l=1/this.direction.x,u=1/this.direction.y,c=1/this.direction.z,h=this.origin;return l>=0?(n=(e.min.x-h.x)*l,r=(e.max.x-h.x)*l):(n=(e.max.x-h.x)*l,r=(e.min.x-h.x)*l),u>=0?(i=(e.min.y-h.y)*u,a=(e.max.y-h.y)*u):(i=(e.max.y-h.y)*u,a=(e.min.y-h.y)*u),n>a||i>r?null:((i>n||isNaN(n))&&(n=i),(a<r||isNaN(r))&&(r=a),c>=0?(o=(e.min.z-h.z)*c,s=(e.max.z-h.z)*c):(o=(e.max.z-h.z)*c,s=(e.min.z-h.z)*c),n>s||o>r?null:((o>n||n!=n)&&(n=o),(s<r||r!=r)&&(r=s),r<0?null:this.at(n>=0?n:r,t)))}},{key:"intersectsBox",value:function(e){return null!==this.intersectBox(e,Vi)}},{key:"intersectTriangle",value:function(e,t,n,r,i){qi.subVectors(t,e),Yi.subVectors(n,e),Zi.crossVectors(qi,Yi);var a,o=this.direction.dot(Zi);if(o>0){if(r)return null;a=1}else{if(!(o<0))return null;a=-1,o=-o}ji.subVectors(this.origin,e);var s=a*this.direction.dot(Yi.crossVectors(ji,Yi));if(s<0)return null;var l=a*this.direction.dot(qi.cross(ji));if(l<0)return null;if(s+l>o)return null;var u=-a*ji.dot(Zi);return u<0?null:this.at(u/o,i)}},{key:"applyMatrix4",value:function(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}},{key:"equals",value:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}(),Ki=exports.Matrix4=function(){function e(t,n,r,i,a,o,s,l,u,c,h,p,d,f,m,v){k(this,e),e.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==t&&this.set(t,n,r,i,a,o,s,l,u,c,h,p,d,f,m,v)}return P(e,[{key:"set",value:function(e,t,n,r,i,a,o,s,l,u,c,h,p,d,f,m){var v=this.elements;return v[0]=e,v[4]=t,v[8]=n,v[12]=r,v[1]=i,v[5]=a,v[9]=o,v[13]=s,v[2]=l,v[6]=u,v[10]=c,v[14]=h,v[3]=p,v[7]=d,v[11]=f,v[15]=m,this}},{key:"identity",value:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}},{key:"clone",value:function(){return(new e).fromArray(this.elements)}},{key:"copy",value:function(e){var t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}},{key:"copyPosition",value:function(e){var t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}},{key:"setFromMatrix3",value:function(e){var t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}},{key:"extractBasis",value:function(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}},{key:"makeBasis",value:function(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}},{key:"extractRotation",value:function(e){var t=this.elements,n=e.elements,r=1/Qi.setFromMatrixColumn(e,0).length(),i=1/Qi.setFromMatrixColumn(e,1).length(),a=1/Qi.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*i,t[5]=n[5]*i,t[6]=n[6]*i,t[7]=0,t[8]=n[8]*a,t[9]=n[9]*a,t[10]=n[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}},{key:"makeRotationFromEuler",value:function(e){var t=this.elements,n=e.x,r=e.y,i=e.z,a=Math.cos(n),o=Math.sin(n),s=Math.cos(r),l=Math.sin(r),u=Math.cos(i),c=Math.sin(i);if("XYZ"===e.order){var h=a*u,p=a*c,d=o*u,f=o*c;t[0]=s*u,t[4]=-s*c,t[8]=l,t[1]=p+d*l,t[5]=h-f*l,t[9]=-o*s,t[2]=f-h*l,t[6]=d+p*l,t[10]=a*s}else if("YXZ"===e.order){var m=s*u,v=s*c,g=l*u,y=l*c;t[0]=m+y*o,t[4]=g*o-v,t[8]=a*l,t[1]=a*c,t[5]=a*u,t[9]=-o,t[2]=v*o-g,t[6]=y+m*o,t[10]=a*s}else if("ZXY"===e.order){var _=s*u,x=s*c,M=l*u,S=l*c;t[0]=_-S*o,t[4]=-a*c,t[8]=M+x*o,t[1]=x+M*o,t[5]=a*u,t[9]=S-_*o,t[2]=-a*l,t[6]=o,t[10]=a*s}else if("ZYX"===e.order){var b=a*u,T=a*c,E=o*u,w=o*c;t[0]=s*u,t[4]=E*l-T,t[8]=b*l+w,t[1]=s*c,t[5]=w*l+b,t[9]=T*l-E,t[2]=-l,t[6]=o*s,t[10]=a*s}else if("YZX"===e.order){var A=a*s,R=a*l,C=o*s,k=o*l;t[0]=s*u,t[4]=k-A*c,t[8]=C*c+R,t[1]=c,t[5]=a*u,t[9]=-o*u,t[2]=-l*u,t[6]=R*c+C,t[10]=A-k*c}else if("XZY"===e.order){var L=a*s,P=a*l,I=o*s,U=o*l;t[0]=s*u,t[4]=-c,t[8]=l*u,t[1]=L*c+U,t[5]=a*u,t[9]=P*c-I,t[2]=I*c-P,t[6]=o*u,t[10]=U*c+L}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}},{key:"makeRotationFromQuaternion",value:function(e){return this.compose(ea,e,ta)}},{key:"lookAt",value:function(e,t,n){var r=this.elements;return ia.subVectors(e,t),0===ia.lengthSq()&&(ia.z=1),ia.normalize(),na.crossVectors(n,ia),0===na.lengthSq()&&(1===Math.abs(n.z)?ia.x+=1e-4:ia.z+=1e-4,ia.normalize(),na.crossVectors(n,ia)),na.normalize(),ra.crossVectors(ia,na),r[0]=na.x,r[4]=ra.x,r[8]=ia.x,r[1]=na.y,r[5]=ra.y,r[9]=ia.y,r[2]=na.z,r[6]=ra.z,r[10]=ia.z,this}},{key:"multiply",value:function(e){return this.multiplyMatrices(this,e)}},{key:"premultiply",value:function(e){return this.multiplyMatrices(e,this)}},{key:"multiplyMatrices",value:function(e,t){var n=e.elements,r=t.elements,i=this.elements,a=n[0],o=n[4],s=n[8],l=n[12],u=n[1],c=n[5],h=n[9],p=n[13],d=n[2],f=n[6],m=n[10],v=n[14],g=n[3],y=n[7],_=n[11],x=n[15],M=r[0],S=r[4],b=r[8],T=r[12],E=r[1],w=r[5],A=r[9],R=r[13],C=r[2],k=r[6],L=r[10],P=r[14],I=r[3],U=r[7],D=r[11],N=r[15];return i[0]=a*M+o*E+s*C+l*I,i[4]=a*S+o*w+s*k+l*U,i[8]=a*b+o*A+s*L+l*D,i[12]=a*T+o*R+s*P+l*N,i[1]=u*M+c*E+h*C+p*I,i[5]=u*S+c*w+h*k+p*U,i[9]=u*b+c*A+h*L+p*D,i[13]=u*T+c*R+h*P+p*N,i[2]=d*M+f*E+m*C+v*I,i[6]=d*S+f*w+m*k+v*U,i[10]=d*b+f*A+m*L+v*D,i[14]=d*T+f*R+m*P+v*N,i[3]=g*M+y*E+_*C+x*I,i[7]=g*S+y*w+_*k+x*U,i[11]=g*b+y*A+_*L+x*D,i[15]=g*T+y*R+_*P+x*N,this}},{key:"multiplyScalar",value:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}},{key:"determinant",value:function(){var e=this.elements,t=e[0],n=e[4],r=e[8],i=e[12],a=e[1],o=e[5],s=e[9],l=e[13],u=e[2],c=e[6],h=e[10],p=e[14];return e[3]*(+i*s*c-r*l*c-i*o*h+n*l*h+r*o*p-n*s*p)+e[7]*(+t*s*p-t*l*h+i*a*h-r*a*p+r*l*u-i*s*u)+e[11]*(+t*l*c-t*o*p-i*a*c+n*a*p+i*o*u-n*l*u)+e[15]*(-r*o*u-t*s*c+t*o*h+r*a*c-n*a*h+n*s*u)}},{key:"transpose",value:function(){var e,t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}},{key:"setPosition",value:function(e,t,n){var r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}},{key:"invert",value:function(){var e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],o=e[5],s=e[6],l=e[7],u=e[8],c=e[9],h=e[10],p=e[11],d=e[12],f=e[13],m=e[14],v=e[15],g=c*m*l-f*h*l+f*s*p-o*m*p-c*s*v+o*h*v,y=d*h*l-u*m*l-d*s*p+a*m*p+u*s*v-a*h*v,_=u*f*l-d*c*l+d*o*p-a*f*p-u*o*v+a*c*v,x=d*c*s-u*f*s-d*o*h+a*f*h+u*o*m-a*c*m,M=t*g+n*y+r*_+i*x;if(0===M)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);var S=1/M;return e[0]=g*S,e[1]=(f*h*i-c*m*i-f*r*p+n*m*p+c*r*v-n*h*v)*S,e[2]=(o*m*i-f*s*i+f*r*l-n*m*l-o*r*v+n*s*v)*S,e[3]=(c*s*i-o*h*i-c*r*l+n*h*l+o*r*p-n*s*p)*S,e[4]=y*S,e[5]=(u*m*i-d*h*i+d*r*p-t*m*p-u*r*v+t*h*v)*S,e[6]=(d*s*i-a*m*i-d*r*l+t*m*l+a*r*v-t*s*v)*S,e[7]=(a*h*i-u*s*i+u*r*l-t*h*l-a*r*p+t*s*p)*S,e[8]=_*S,e[9]=(d*c*i-u*f*i-d*n*p+t*f*p+u*n*v-t*c*v)*S,e[10]=(a*f*i-d*o*i+d*n*l-t*f*l-a*n*v+t*o*v)*S,e[11]=(u*o*i-a*c*i-u*n*l+t*c*l+a*n*p-t*o*p)*S,e[12]=x*S,e[13]=(u*f*r-d*c*r+d*n*h-t*f*h-u*n*m+t*c*m)*S,e[14]=(d*o*r-a*f*r-d*n*s+t*f*s+a*n*m-t*o*m)*S,e[15]=(a*c*r-u*o*r+u*n*s-t*c*s-a*n*h+t*o*h)*S,this}},{key:"scale",value:function(e){var t=this.elements,n=e.x,r=e.y,i=e.z;return t[0]*=n,t[4]*=r,t[8]*=i,t[1]*=n,t[5]*=r,t[9]*=i,t[2]*=n,t[6]*=r,t[10]*=i,t[3]*=n,t[7]*=r,t[11]*=i,this}},{key:"getMaxScaleOnAxis",value:function(){var e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))}},{key:"makeTranslation",value:function(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}},{key:"makeRotationX",value:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}},{key:"makeRotationY",value:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}},{key:"makeRotationZ",value:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}},{key:"makeRotationAxis",value:function(e,t){var n=Math.cos(t),r=Math.sin(t),i=1-n,a=e.x,o=e.y,s=e.z,l=i*a,u=i*o;return this.set(l*a+n,l*o-r*s,l*s+r*o,0,l*o+r*s,u*o+n,u*s-r*a,0,l*s-r*o,u*s+r*a,i*s*s+n,0,0,0,0,1),this}},{key:"makeScale",value:function(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}},{key:"makeShear",value:function(e,t,n,r,i,a){return this.set(1,n,i,0,e,1,a,0,t,r,1,0,0,0,0,1),this}},{key:"compose",value:function(e,t,n){var r=this.elements,i=t._x,a=t._y,o=t._z,s=t._w,l=i+i,u=a+a,c=o+o,h=i*l,p=i*u,d=i*c,f=a*u,m=a*c,v=o*c,g=s*l,y=s*u,_=s*c,x=n.x,M=n.y,S=n.z;return r[0]=(1-(f+v))*x,r[1]=(p+_)*x,r[2]=(d-y)*x,r[3]=0,r[4]=(p-_)*M,r[5]=(1-(h+v))*M,r[6]=(m+g)*M,r[7]=0,r[8]=(d+y)*S,r[9]=(m-g)*S,r[10]=(1-(h+f))*S,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}},{key:"decompose",value:function(e,t,n){var r=this.elements,i=Qi.set(r[0],r[1],r[2]).length(),a=Qi.set(r[4],r[5],r[6]).length(),o=Qi.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),e.x=r[12],e.y=r[13],e.z=r[14],$i.copy(this);var s=1/i,l=1/a,u=1/o;return $i.elements[0]*=s,$i.elements[1]*=s,$i.elements[2]*=s,$i.elements[4]*=l,$i.elements[5]*=l,$i.elements[6]*=l,$i.elements[8]*=u,$i.elements[9]*=u,$i.elements[10]*=u,t.setFromRotationMatrix($i),n.x=i,n.y=a,n.z=o,this}},{key:"makePerspective",value:function(e,t,n,r,i,a,o=pr){var s,l,u=this.elements,c=2*i/(t-e),h=2*i/(n-r),p=(t+e)/(t-e),d=(n+r)/(n-r);if(o===pr)s=-(a+i)/(a-i),l=-2*a*i/(a-i);else{if(o!==dr)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+o);s=-a/(a-i),l=-a*i/(a-i)}return u[0]=c,u[4]=0,u[8]=p,u[12]=0,u[1]=0,u[5]=h,u[9]=d,u[13]=0,u[2]=0,u[6]=0,u[10]=s,u[14]=l,u[3]=0,u[7]=0,u[11]=-1,u[15]=0,this}},{key:"makeOrthographic",value:function(e,t,n,r,i,a,o=pr){var s,l,u=this.elements,c=1/(t-e),h=1/(n-r),p=1/(a-i),d=(t+e)*c,f=(n+r)*h;if(o===pr)s=(a+i)*p,l=-2*p;else{if(o!==dr)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+o);s=i*p,l=-1*p}return u[0]=2*c,u[4]=0,u[8]=0,u[12]=-d,u[1]=0,u[5]=2*h,u[9]=0,u[13]=-f,u[2]=0,u[6]=0,u[10]=l,u[14]=-s,u[3]=0,u[7]=0,u[11]=0,u[15]=1,this}},{key:"equals",value:function(e){for(var t=this.elements,n=e.elements,r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0}},{key:"fromArray",value:function(e,t=0){for(var n=0;n<16;n++)this.elements[n]=e[n+t];return this}},{key:"toArray",value:function(e=[],t=0){var n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}]),e}(),Qi=new Mi,$i=new Ki,ea=new Mi(0,0,0),ta=new Mi(1,1,1),na=new Mi,ra=new Mi,ia=new Mi,aa=new Ki,oa=new xi,sa=exports.Euler=function(e){function t(e=0,n=0,r=0,i=t.DEFAULT_ORDER){k(this,t),this.isEuler=!0,this._x=e,this._y=n,this._z=r,this._order=i}return P(t,[{key:"x",get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},{key:"order",get:function(){return this._order},set:function(e){this._order=e,this._onChangeCallback()}},{key:"set",value:function(e,t,n,r=this._order){return this._x=e,this._y=t,this._z=n,this._order=r,this._onChangeCallback(),this}},{key:"clone",value:function(){return new this.constructor(this._x,this._y,this._z,this._order)}},{key:"copy",value:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}},{key:"setFromRotationMatrix",value:function(e,t=this._order,n=!0){var r=e.elements,i=r[0],a=r[4],o=r[8],s=r[1],l=r[5],u=r[9],c=r[2],h=r[6],p=r[10];switch(t){case"XYZ":this._y=Math.asin(xr(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-u,p),this._z=Math.atan2(-a,i)):(this._x=Math.atan2(h,l),this._z=0);break;case"YXZ":this._x=Math.asin(-xr(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(o,p),this._z=Math.atan2(s,l)):(this._y=Math.atan2(-c,i),this._z=0);break;case"ZXY":this._x=Math.asin(xr(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-c,p),this._z=Math.atan2(-a,l)):(this._y=0,this._z=Math.atan2(s,i));break;case"ZYX":this._y=Math.asin(-xr(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(h,p),this._z=Math.atan2(s,i)):(this._x=0,this._z=Math.atan2(-a,l));break;case"YZX":this._z=Math.asin(xr(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-u,l),this._y=Math.atan2(-c,i)):(this._x=0,this._y=Math.atan2(o,p));break;case"XZY":this._z=Math.asin(-xr(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(h,l),this._y=Math.atan2(o,i)):(this._x=Math.atan2(-u,p),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!0===n&&this._onChangeCallback(),this}},{key:"setFromQuaternion",value:function(e,t,n){return aa.makeRotationFromQuaternion(e),this.setFromRotationMatrix(aa,t,n)}},{key:"setFromVector3",value:function(e,t=this._order){return this.set(e.x,e.y,e.z,t)}},{key:"reorder",value:function(e){return oa.setFromEuler(this),this.setFromQuaternion(oa,e)}},{key:"equals",value:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}},{key:"fromArray",value:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}},{key:"toArray",value:function(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}},{key:"_onChange",value:function(e){return this._onChangeCallback=e,this}},{key:"_onChangeCallback",value:function(){}},{key:Symbol.iterator,value:R().mark(function e(){return R().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._x;case 2:return e.next=4,this._y;case 4:return e.next=6,this._z;case 6:return e.next=8,this._order;case 8:case"end":return e.stop()}},e,this)})}]),t}();sa.DEFAULT_ORDER="XYZ";var la=exports.Layers=function(){function e(){k(this,e),this.mask=1}return P(e,[{key:"set",value:function(e){this.mask=(1<<e|0)>>>0}},{key:"enable",value:function(e){this.mask|=1<<e|0}},{key:"enableAll",value:function(){this.mask=-1}},{key:"toggle",value:function(e){this.mask^=1<<e|0}},{key:"disable",value:function(e){this.mask&=~(1<<e|0)}},{key:"disableAll",value:function(){this.mask=0}},{key:"test",value:function(e){return 0!=(this.mask&e.mask)}},{key:"isEnabled",value:function(e){return 0!=(this.mask&(1<<e|0))}}]),e}(),ua=0,ca=new Mi,ha=new xi,pa=new Ki,da=new Mi,fa=new Mi,ma=new Mi,va=new xi,ga=new Mi(1,0,0),ya=new Mi(0,1,0),_a=new Mi(0,0,1),xa={type:"added"},Ma={type:"removed"},Sa=exports.Object3D=function(e){x(n,fr);var t=S(n);function n(){var e;k(this,n),(e=t.call(this)).isObject3D=!0,Object.defineProperty(T(e),"id",{value:ua++}),e.uuid=_r(),e.name="",e.type="Object3D",e.parent=null,e.children=[],e.up=n.DEFAULT_UP.clone();var r=new Mi,i=new sa,a=new xi,o=new Mi(1,1,1);return i._onChange(function(){a.setFromEuler(i,!1)}),a._onChange(function(){i.setFromQuaternion(a,void 0,!1)}),Object.defineProperties(T(e),{position:{configurable:!0,enumerable:!0,value:r},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:a},scale:{configurable:!0,enumerable:!0,value:o},modelViewMatrix:{value:new Ki},normalMatrix:{value:new Vr}}),e.matrix=new Ki,e.matrixWorld=new Ki,e.matrixAutoUpdate=n.DEFAULT_MATRIX_AUTO_UPDATE,e.matrixWorldNeedsUpdate=!1,e.matrixWorldAutoUpdate=n.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,e.layers=new la,e.visible=!0,e.castShadow=!1,e.receiveShadow=!1,e.frustumCulled=!0,e.renderOrder=0,e.animations=[],e.userData={},e}return P(n,[{key:"onBeforeRender",value:function(){}},{key:"onAfterRender",value:function(){}},{key:"applyMatrix4",value:function(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}},{key:"applyQuaternion",value:function(e){return this.quaternion.premultiply(e),this}},{key:"setRotationFromAxisAngle",value:function(e,t){this.quaternion.setFromAxisAngle(e,t)}},{key:"setRotationFromEuler",value:function(e){this.quaternion.setFromEuler(e,!0)}},{key:"setRotationFromMatrix",value:function(e){this.quaternion.setFromRotationMatrix(e)}},{key:"setRotationFromQuaternion",value:function(e){this.quaternion.copy(e)}},{key:"rotateOnAxis",value:function(e,t){return ha.setFromAxisAngle(e,t),this.quaternion.multiply(ha),this}},{key:"rotateOnWorldAxis",value:function(e,t){return ha.setFromAxisAngle(e,t),this.quaternion.premultiply(ha),this}},{key:"rotateX",value:function(e){return this.rotateOnAxis(ga,e)}},{key:"rotateY",value:function(e){return this.rotateOnAxis(ya,e)}},{key:"rotateZ",value:function(e){return this.rotateOnAxis(_a,e)}},{key:"translateOnAxis",value:function(e,t){return ca.copy(e).applyQuaternion(this.quaternion),this.position.add(ca.multiplyScalar(t)),this}},{key:"translateX",value:function(e){return this.translateOnAxis(ga,e)}},{key:"translateY",value:function(e){return this.translateOnAxis(ya,e)}},{key:"translateZ",value:function(e){return this.translateOnAxis(_a,e)}},{key:"localToWorld",value:function(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}},{key:"worldToLocal",value:function(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(pa.copy(this.matrixWorld).invert())}},{key:"lookAt",value:function(e,t,n){e.isVector3?da.copy(e):da.set(e,t,n);var r=this.parent;this.updateWorldMatrix(!0,!1),fa.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?pa.lookAt(fa,da,this.up):pa.lookAt(da,fa,this.up),this.quaternion.setFromRotationMatrix(pa),r&&(pa.extractRotation(r.matrixWorld),ha.setFromRotationMatrix(pa),this.quaternion.premultiply(ha.invert()))}},{key:"add",value:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(xa)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}},{key:"remove",value:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}var n=this.children.indexOf(e);return-1!==n&&(e.parent=null,this.children.splice(n,1),e.dispatchEvent(Ma)),this}},{key:"removeFromParent",value:function(){var e=this.parent;return null!==e&&e.remove(this),this}},{key:"clear",value:function(){return this.remove.apply(this,f(this.children))}},{key:"attach",value:function(e){return this.updateWorldMatrix(!0,!1),pa.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),pa.multiply(e.parent.matrixWorld)),e.applyMatrix4(pa),this.add(e),e.updateWorldMatrix(!1,!0),this}},{key:"getObjectById",value:function(e){return this.getObjectByProperty("id",e)}},{key:"getObjectByName",value:function(e){return this.getObjectByProperty("name",e)}},{key:"getObjectByProperty",value:function(e,t){if(this[e]===t)return this;for(var n=0,r=this.children.length;n<r;n++){var i=this.children[n].getObjectByProperty(e,t);if(void 0!==i)return i}}},{key:"getObjectsByProperty",value:function(e,t){var n=[];this[e]===t&&n.push(this);for(var r=0,i=this.children.length;r<i;r++){var a=this.children[r].getObjectsByProperty(e,t);a.length>0&&(n=n.concat(a))}return n}},{key:"getWorldPosition",value:function(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}},{key:"getWorldQuaternion",value:function(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(fa,e,ma),e}},{key:"getWorldScale",value:function(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(fa,va,e),e}},{key:"getWorldDirection",value:function(e){this.updateWorldMatrix(!0,!1);var t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}},{key:"raycast",value:function(){}},{key:"traverse",value:function(e){e(this);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].traverse(e)}},{key:"traverseVisible",value:function(e){if(!1!==this.visible){e(this);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}}},{key:"traverseAncestors",value:function(e){var t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))}},{key:"updateMatrix",value:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}},{key:"updateMatrixWorld",value:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=this.children,n=0,r=t.length;n<r;n++){var i=t[n];!0!==i.matrixWorldAutoUpdate&&!0!==e||i.updateMatrixWorld(e)}}},{key:"updateWorldMatrix",value:function(e,t){var n=this.parent;if(!0===e&&null!==n&&!0===n.matrixWorldAutoUpdate&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t)for(var r=this.children,i=0,a=r.length;i<a;i++){var o=r[i];!0===o.matrixWorldAutoUpdate&&o.updateWorldMatrix(!1,!0)}}},{key:"toJSON",value:function(e){var t=void 0===e||"string"==typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});var r={};function i(t,n){return void 0===t[n.uuid]&&(t[n.uuid]=n.toJSON(e)),n.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(r.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=i(e.geometries,this.geometry);var a=this.geometry.parameters;if(void 0!==a&&void 0!==a.shapes){var o=a.shapes;if(Array.isArray(o))for(var s=0,l=o.length;s<l;s++){var u=o[s];i(e.shapes,u)}else i(e.shapes,o)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(i(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){for(var c=[],h=0,p=this.material.length;h<p;h++)c.push(i(e.materials,this.material[h]));r.material=c}else r.material=i(e.materials,this.material);if(this.children.length>0){r.children=[];for(var d=0;d<this.children.length;d++)r.children.push(this.children[d].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(var f=0;f<this.animations.length;f++){var m=this.animations[f];r.animations.push(i(e.animations,m))}}if(t){var v=T(e.geometries),g=T(e.materials),y=T(e.textures),_=T(e.images),x=T(e.shapes),M=T(e.skeletons),S=T(e.animations),b=T(e.nodes);v.length>0&&(n.geometries=v),g.length>0&&(n.materials=g),y.length>0&&(n.textures=y),_.length>0&&(n.images=_),x.length>0&&(n.shapes=x),M.length>0&&(n.skeletons=M),S.length>0&&(n.animations=S),b.length>0&&(n.nodes=b)}return n.object=r,n;function T(e){var t=[];for(var n in e){var r=e[n];delete r.metadata,t.push(r)}return t}}},{key:"clone",value:function(e){return(new this.constructor).copy(this,e)}},{key:"copy",value:function(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(var n=0;n<e.children.length;n++){var r=e.children[n];this.add(r.clone())}return this}}]),n}();Sa.DEFAULT_UP=new Mi(0,1,0),Sa.DEFAULT_MATRIX_AUTO_UPDATE=!0,Sa.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;var ba=new Mi,Ta=new Mi,Ea=new Mi,wa=new Mi,Aa=new Mi,Ra=new Mi,Ca=new Mi,ka=new Mi,La=new Mi,Pa=new Mi,Ia=!1,Ua=exports.Triangle=function(){function e(t=new Mi,n=new Mi,r=new Mi){k(this,e),this.a=t,this.b=n,this.c=r}return P(e,[{key:"set",value:function(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}},{key:"setFromPointsAndIndices",value:function(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}},{key:"setFromAttributeAndIndices",value:function(e,t,n,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}},{key:"getArea",value:function(){return ba.subVectors(this.c,this.b),Ta.subVectors(this.a,this.b),.5*ba.cross(Ta).length()}},{key:"getMidpoint",value:function(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}},{key:"getNormal",value:function(t){return e.getNormal(this.a,this.b,this.c,t)}},{key:"getPlane",value:function(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}},{key:"getBarycoord",value:function(t,n){return e.getBarycoord(t,this.a,this.b,this.c,n)}},{key:"getUV",value:function(t,n,r,i,a){return!1===Ia&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),Ia=!0),e.getInterpolation(t,this.a,this.b,this.c,n,r,i,a)}},{key:"getInterpolation",value:function(t,n,r,i,a){return e.getInterpolation(t,this.a,this.b,this.c,n,r,i,a)}},{key:"containsPoint",value:function(t){return e.containsPoint(t,this.a,this.b,this.c)}},{key:"isFrontFacing",value:function(t){return e.isFrontFacing(this.a,this.b,this.c,t)}},{key:"intersectsBox",value:function(e){return e.intersectsTriangle(this)}},{key:"closestPointToPoint",value:function(e,t){var n,r,i=this.a,a=this.b,o=this.c;Aa.subVectors(a,i),Ra.subVectors(o,i),ka.subVectors(e,i);var s=Aa.dot(ka),l=Ra.dot(ka);if(s<=0&&l<=0)return t.copy(i);La.subVectors(e,a);var u=Aa.dot(La),c=Ra.dot(La);if(u>=0&&c<=u)return t.copy(a);var h=s*c-u*l;if(h<=0&&s>=0&&u<=0)return n=s/(s-u),t.copy(i).addScaledVector(Aa,n);Pa.subVectors(e,o);var p=Aa.dot(Pa),d=Ra.dot(Pa);if(d>=0&&p<=d)return t.copy(o);var f=p*l-s*d;if(f<=0&&l>=0&&d<=0)return r=l/(l-d),t.copy(i).addScaledVector(Ra,r);var m=u*d-p*c;if(m<=0&&c-u>=0&&p-d>=0)return Ca.subVectors(o,a),r=(c-u)/(c-u+(p-d)),t.copy(a).addScaledVector(Ca,r);var v=1/(m+f+h);return n=f*v,r=h*v,t.copy(i).addScaledVector(Aa,n).addScaledVector(Ra,r)}},{key:"equals",value:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}],[{key:"getNormal",value:function(e,t,n,r){r.subVectors(n,t),ba.subVectors(e,t),r.cross(ba);var i=r.lengthSq();return i>0?r.multiplyScalar(1/Math.sqrt(i)):r.set(0,0,0)}},{key:"getBarycoord",value:function(e,t,n,r,i){ba.subVectors(r,t),Ta.subVectors(n,t),Ea.subVectors(e,t);var a=ba.dot(ba),o=ba.dot(Ta),s=ba.dot(Ea),l=Ta.dot(Ta),u=Ta.dot(Ea),c=a*l-o*o;if(0===c)return i.set(-2,-1,-1);var h=1/c,p=(l*s-o*u)*h,d=(a*u-o*s)*h;return i.set(1-p-d,d,p)}},{key:"containsPoint",value:function(e,t,n,r){return this.getBarycoord(e,t,n,r,wa),wa.x>=0&&wa.y>=0&&wa.x+wa.y<=1}},{key:"getUV",value:function(e,t,n,r,i,a,o,s){return!1===Ia&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),Ia=!0),this.getInterpolation(e,t,n,r,i,a,o,s)}},{key:"getInterpolation",value:function(e,t,n,r,i,a,o,s){return this.getBarycoord(e,t,n,r,wa),s.setScalar(0),s.addScaledVector(i,wa.x),s.addScaledVector(a,wa.y),s.addScaledVector(o,wa.z),s}},{key:"isFrontFacing",value:function(e,t,n,r){return ba.subVectors(n,t),Ta.subVectors(e,t),ba.cross(Ta).dot(r)<0}}]),e}(),Da=0,Na=exports.Material=function(e){x(n,fr);var t=S(n);function n(){var e;return k(this,n),(e=t.call(this)).isMaterial=!0,Object.defineProperty(T(e),"id",{value:Da++}),e.uuid=_r(),e.name="",e.type="Material",e.blending=K,e.side=j,e.vertexColors=!1,e.opacity=1,e.transparent=!1,e.alphaHash=!1,e.blendSrc=he,e.blendDst=pe,e.blendEquation=ne,e.blendSrcAlpha=null,e.blendDstAlpha=null,e.blendEquationAlpha=null,e.depthFunc=Me,e.depthTest=!0,e.depthWrite=!0,e.stencilWriteMask=255,e.stencilFunc=Xn,e.stencilRef=0,e.stencilFuncMask=255,e.stencilFail=Ln,e.stencilZFail=Ln,e.stencilZPass=Ln,e.stencilWrite=!1,e.clippingPlanes=null,e.clipIntersection=!1,e.clipShadows=!1,e.shadowSide=null,e.colorWrite=!0,e.precision=null,e.polygonOffset=!1,e.polygonOffsetFactor=0,e.polygonOffsetUnits=0,e.dithering=!1,e.alphaToCoverage=!1,e.premultipliedAlpha=!1,e.forceSinglePass=!1,e.visible=!0,e.toneMapped=!0,e.userData={},e.version=0,e._alphaTest=0,e}return P(n,[{key:"alphaTest",get:function(){return this._alphaTest},set:function(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}},{key:"onBuild",value:function(){}},{key:"onBeforeRender",value:function(){}},{key:"onBeforeCompile",value:function(){}},{key:"customProgramCacheKey",value:function(){return this.onBeforeCompile.toString()}},{key:"setValues",value:function(e){if(void 0!==e)for(var t in e){var n=e[t];if(void 0!==n){var r=this[t];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n:console.warn("THREE.Material: '".concat(t,"' is not a property of THREE.").concat(this.type,"."))}else console.warn("THREE.Material: parameter '".concat(t,"' has value of undefined."))}}},{key:"toJSON",value:function(e){var t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});var n={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};function r(e){var t=[];for(var n in e){var r=e[n];delete r.metadata,t.push(r)}return t}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(n.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(n.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),void 0!==this.anisotropy&&(n.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==K&&(n.blending=this.blending),this.side!==j&&(n.side=this.side),!0===this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=!0),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaHash&&(n.alphaHash=!0),!0===this.alphaToCoverage&&(n.alphaToCoverage=!0),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=!0),!0===this.forceSinglePass&&(n.forceSinglePass=!0),!0===this.wireframe&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=!0),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),!1===this.fog&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData),t){var i=r(e.textures),a=r(e.images);i.length>0&&(n.textures=i),a.length>0&&(n.images=a)}return n}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;var t=e.clippingPlanes,n=null;if(null!==t){var r=t.length;n=new Array(r);for(var i=0;i!==r;++i)n[i]=t[i].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}},{key:"needsUpdate",set:function(e){!0===e&&this.version++}}]),n}(),Oa={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Fa={h:0,s:0,l:0},Ba={h:0,s:0,l:0};function za(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}var Ga=exports.Color=function(e){function t(e,n,r){return k(this,t),this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,n,r)}return P(t,[{key:"set",value:function(e,t,n){if(void 0===t&&void 0===n){var r=e;r&&r.isColor?this.copy(r):"number"==typeof r?this.setHex(r):"string"==typeof r&&this.setStyle(r)}else this.setRGB(e,t,n);return this}},{key:"setScalar",value:function(e){return this.r=e,this.g=e,this.b=e,this}},{key:"setHex",value:function(e,t=Sn){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,ri.toWorkingColorSpace(this,t),this}},{key:"setRGB",value:function(e,t,n,r=ri.workingColorSpace){return this.r=e,this.g=t,this.b=n,ri.toWorkingColorSpace(this,r),this}},{key:"setHSL",value:function(e,t,n,r=ri.workingColorSpace){if(e=Mr(e,1),t=xr(t,0,1),n=xr(n,0,1),0===t)this.r=this.g=this.b=n;else{var i=n<=.5?n*(1+t):n+t-n*t,a=2*n-i;this.r=za(a,i,e+1/3),this.g=za(a,i,e),this.b=za(a,i,e-1/3)}return ri.toWorkingColorSpace(this,r),this}},{key:"setStyle",value:function(e,t=Sn){function n(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}var r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){var i,a=r[1],o=r[2];switch(a){case"rgb":case"rgba":if(i=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return n(i[4]),this.setRGB(Math.min(255,parseInt(i[1],10))/255,Math.min(255,parseInt(i[2],10))/255,Math.min(255,parseInt(i[3],10))/255,t);if(i=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return n(i[4]),this.setRGB(Math.min(100,parseInt(i[1],10))/100,Math.min(100,parseInt(i[2],10))/100,Math.min(100,parseInt(i[3],10))/100,t);break;case"hsl":case"hsla":if(i=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return n(i[4]),this.setHSL(parseFloat(i[1])/360,parseFloat(i[2])/100,parseFloat(i[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){var s=r[1],l=s.length;if(3===l)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(6===l)return this.setHex(parseInt(s,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}},{key:"setColorName",value:function(e,t=Sn){var n=Oa[e.toLowerCase()];return void 0!==n?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}},{key:"clone",value:function(){return new this.constructor(this.r,this.g,this.b)}},{key:"copy",value:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}},{key:"copySRGBToLinear",value:function(e){return this.r=ii(e.r),this.g=ii(e.g),this.b=ii(e.b),this}},{key:"copyLinearToSRGB",value:function(e){return this.r=ai(e.r),this.g=ai(e.g),this.b=ai(e.b),this}},{key:"convertSRGBToLinear",value:function(){return this.copySRGBToLinear(this),this}},{key:"convertLinearToSRGB",value:function(){return this.copyLinearToSRGB(this),this}},{key:"getHex",value:function(e=Sn){return ri.fromWorkingColorSpace(Ha.copy(this),e),65536*Math.round(xr(255*Ha.r,0,255))+256*Math.round(xr(255*Ha.g,0,255))+Math.round(xr(255*Ha.b,0,255))}},{key:"getHexString",value:function(e=Sn){return("000000"+this.getHex(e).toString(16)).slice(-6)}},{key:"getHSL",value:function(e,t=ri.workingColorSpace){ri.fromWorkingColorSpace(Ha.copy(this),t);var n,r,i=Ha.r,a=Ha.g,o=Ha.b,s=Math.max(i,a,o),l=Math.min(i,a,o),u=(l+s)/2;if(l===s)n=0,r=0;else{var c=s-l;switch(r=u<=.5?c/(s+l):c/(2-s-l),s){case i:n=(a-o)/c+(a<o?6:0);break;case a:n=(o-i)/c+2;break;case o:n=(i-a)/c+4}n/=6}return e.h=n,e.s=r,e.l=u,e}},{key:"getRGB",value:function(e,t=ri.workingColorSpace){return ri.fromWorkingColorSpace(Ha.copy(this),t),e.r=Ha.r,e.g=Ha.g,e.b=Ha.b,e}},{key:"getStyle",value:function(e=Sn){ri.fromWorkingColorSpace(Ha.copy(this),e);var t=Ha.r,n=Ha.g,r=Ha.b;return e!==Sn?"color(".concat(e," ").concat(t.toFixed(3)," ").concat(n.toFixed(3)," ").concat(r.toFixed(3),")"):"rgb(".concat(Math.round(255*t),",").concat(Math.round(255*n),",").concat(Math.round(255*r),")")}},{key:"offsetHSL",value:function(e,t,n){return this.getHSL(Fa),this.setHSL(Fa.h+e,Fa.s+t,Fa.l+n)}},{key:"add",value:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}},{key:"addColors",value:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}},{key:"addScalar",value:function(e){return this.r+=e,this.g+=e,this.b+=e,this}},{key:"sub",value:function(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}},{key:"multiply",value:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}},{key:"multiplyScalar",value:function(e){return this.r*=e,this.g*=e,this.b*=e,this}},{key:"lerp",value:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}},{key:"lerpColors",value:function(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}},{key:"lerpHSL",value:function(e,t){this.getHSL(Fa),e.getHSL(Ba);var n=Tr(Fa.h,Ba.h,t),r=Tr(Fa.s,Ba.s,t),i=Tr(Fa.l,Ba.l,t);return this.setHSL(n,r,i),this}},{key:"setFromVector3",value:function(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}},{key:"applyMatrix3",value:function(e){var t=this.r,n=this.g,r=this.b,i=e.elements;return this.r=i[0]*t+i[3]*n+i[6]*r,this.g=i[1]*t+i[4]*n+i[7]*r,this.b=i[2]*t+i[5]*n+i[8]*r,this}},{key:"equals",value:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}},{key:"fromArray",value:function(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}},{key:"toArray",value:function(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}},{key:"fromBufferAttribute",value:function(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}},{key:"toJSON",value:function(){return this.getHex()}},{key:Symbol.iterator,value:R().mark(function e(){return R().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.r;case 2:return e.next=4,this.g;case 4:return e.next=6,this.b;case 6:case"end":return e.stop()}},e,this)})}]),t}(),Ha=new Ga;Ga.NAMES=Oa;var Va=exports.MeshBasicMaterial=function(e){x(n,Na);var t=S(n);function n(e){var r;return k(this,n),(r=t.call(this)).isMeshBasicMaterial=!0,r.type="MeshBasicMaterial",r.color=new Ga(16777215),r.map=null,r.lightMap=null,r.lightMapIntensity=1,r.aoMap=null,r.aoMapIntensity=1,r.specularMap=null,r.alphaMap=null,r.envMap=null,r.combine=we,r.reflectivity=1,r.refractionRatio=.98,r.wireframe=!1,r.wireframeLinewidth=1,r.wireframeLinecap="round",r.wireframeLinejoin="round",r.fog=!0,r.setValues(e),r}return P(n,[{key:"copy",value:function(e){return p(w(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}]),n}(),Wa=Xa();function Xa(){for(var e=new ArrayBuffer(4),t=new Float32Array(e),n=new Uint32Array(e),r=new Uint32Array(512),i=new Uint32Array(512),a=0;a<256;++a){var o=a-127;o<-27?(r[a]=0,r[256|a]=32768,i[a]=24,i[256|a]=24):o<-14?(r[a]=1024>>-o-14,r[256|a]=1024>>-o-14|32768,i[a]=-o-1,i[256|a]=-o-1):o<=15?(r[a]=o+15<<10,r[256|a]=o+15<<10|32768,i[a]=13,i[256|a]=13):o<128?(r[a]=31744,r[256|a]=64512,i[a]=24,i[256|a]=24):(r[a]=31744,r[256|a]=64512,i[a]=13,i[256|a]=13)}for(var s=new Uint32Array(2048),l=new Uint32Array(64),u=new Uint32Array(64),c=1;c<1024;++c){for(var h=c<<13,p=0;0==(8388608&h);)h<<=1,p-=8388608;h&=-8388609,p+=947912704,s[c]=h|p}for(var d=1024;d<2048;++d)s[d]=939524096+(d-1024<<13);for(var f=1;f<31;++f)l[f]=f<<23;l[31]=1199570944,l[32]=2147483648;for(var m=33;m<63;++m)l[m]=2147483648+(m-32<<23);l[63]=3347054592;for(var v=1;v<64;++v)32!==v&&(u[v]=1024);return{floatView:t,uint32View:n,baseTable:r,shiftTable:i,mantissaTable:s,exponentTable:l,offsetTable:u}}function ja(e){Math.abs(e)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),e=xr(e,-65504,65504),Wa.floatView[0]=e;var t=Wa.uint32View[0],n=t>>23&511;return Wa.baseTable[n]+((8388607&t)>>Wa.shiftTable[n])}function qa(e){var t=e>>10;return Wa.uint32View[0]=Wa.mantissaTable[Wa.offsetTable[t]+(1023&e)]+Wa.exponentTable[t],Wa.floatView[0]}var Ya=exports.DataUtils={toHalfFloat:ja,fromHalfFloat:qa},Za=new Mi,Ja=new Hr,Ka=exports.BufferAttribute=function(){function e(t,n,r=!1){if(k(this,e),Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=t,this.itemSize=n,this.count=void 0!==t?t.length/n:0,this.normalized=r,this.usage=er,this.updateRange={offset:0,count:-1},this.gpuType=ot,this.version=0}return P(e,[{key:"onUploadCallback",value:function(){}},{key:"needsUpdate",set:function(e){!0===e&&this.version++}},{key:"setUsage",value:function(e){return this.usage=e,this}},{key:"copy",value:function(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}},{key:"copyAt",value:function(e,t,n){e*=this.itemSize,n*=t.itemSize;for(var r=0,i=this.itemSize;r<i;r++)this.array[e+r]=t.array[n+r];return this}},{key:"copyArray",value:function(e){return this.array.set(e),this}},{key:"applyMatrix3",value:function(e){if(2===this.itemSize)for(var t=0,n=this.count;t<n;t++)Ja.fromBufferAttribute(this,t),Ja.applyMatrix3(e),this.setXY(t,Ja.x,Ja.y);else if(3===this.itemSize)for(var r=0,i=this.count;r<i;r++)Za.fromBufferAttribute(this,r),Za.applyMatrix3(e),this.setXYZ(r,Za.x,Za.y,Za.z);return this}},{key:"applyMatrix4",value:function(e){for(var t=0,n=this.count;t<n;t++)Za.fromBufferAttribute(this,t),Za.applyMatrix4(e),this.setXYZ(t,Za.x,Za.y,Za.z);return this}},{key:"applyNormalMatrix",value:function(e){for(var t=0,n=this.count;t<n;t++)Za.fromBufferAttribute(this,t),Za.applyNormalMatrix(e),this.setXYZ(t,Za.x,Za.y,Za.z);return this}},{key:"transformDirection",value:function(e){for(var t=0,n=this.count;t<n;t++)Za.fromBufferAttribute(this,t),Za.transformDirection(e),this.setXYZ(t,Za.x,Za.y,Za.z);return this}},{key:"set",value:function(e,t=0){return this.array.set(e,t),this}},{key:"getComponent",value:function(e,t){var n=this.array[e*this.itemSize+t];return this.normalized&&(n=Br(n,this.array)),n}},{key:"setComponent",value:function(e,t,n){return this.normalized&&(n=zr(n,this.array)),this.array[e*this.itemSize+t]=n,this}},{key:"getX",value:function(e){var t=this.array[e*this.itemSize];return this.normalized&&(t=Br(t,this.array)),t}},{key:"setX",value:function(e,t){return this.normalized&&(t=zr(t,this.array)),this.array[e*this.itemSize]=t,this}},{key:"getY",value:function(e){var t=this.array[e*this.itemSize+1];return this.normalized&&(t=Br(t,this.array)),t}},{key:"setY",value:function(e,t){return this.normalized&&(t=zr(t,this.array)),this.array[e*this.itemSize+1]=t,this}},{key:"getZ",value:function(e){var t=this.array[e*this.itemSize+2];return this.normalized&&(t=Br(t,this.array)),t}},{key:"setZ",value:function(e,t){return this.normalized&&(t=zr(t,this.array)),this.array[e*this.itemSize+2]=t,this}},{key:"getW",value:function(e){var t=this.array[e*this.itemSize+3];return this.normalized&&(t=Br(t,this.array)),t}},{key:"setW",value:function(e,t){return this.normalized&&(t=zr(t,this.array)),this.array[e*this.itemSize+3]=t,this}},{key:"setXY",value:function(e,t,n){return e*=this.itemSize,this.normalized&&(t=zr(t,this.array),n=zr(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}},{key:"setXYZ",value:function(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=zr(t,this.array),n=zr(n,this.array),r=zr(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this}},{key:"setXYZW",value:function(e,t,n,r,i){return e*=this.itemSize,this.normalized&&(t=zr(t,this.array),n=zr(n,this.array),r=zr(r,this.array),i=zr(i,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=i,this}},{key:"onUpload",value:function(e){return this.onUploadCallback=e,this}},{key:"clone",value:function(){return new this.constructor(this.array,this.itemSize).copy(this)}},{key:"toJSON",value:function(){var e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==er&&(e.usage=this.usage),0===this.updateRange.offset&&-1===this.updateRange.count||(e.updateRange=this.updateRange),e}}]),e}(),Qa=exports.Int8BufferAttribute=function(e){x(n,Ka);var t=S(n);function n(e,r,i){return k(this,n),t.call(this,new Int8Array(e),r,i)}return P(n)}(),$a=exports.Uint8BufferAttribute=function(e){x(n,Ka);var t=S(n);function n(e,r,i){return k(this,n),t.call(this,new Uint8Array(e),r,i)}return P(n)}(),eo=exports.Uint8ClampedBufferAttribute=function(e){x(n,Ka);var t=S(n);function n(e,r,i){return k(this,n),t.call(this,new Uint8ClampedArray(e),r,i)}return P(n)}(),to=exports.Int16BufferAttribute=function(e){x(n,Ka);var t=S(n);function n(e,r,i){return k(this,n),t.call(this,new Int16Array(e),r,i)}return P(n)}(),no=exports.Uint16BufferAttribute=function(e){x(n,Ka);var t=S(n);function n(e,r,i){return k(this,n),t.call(this,new Uint16Array(e),r,i)}return P(n)}(),ro=exports.Int32BufferAttribute=function(e){x(n,Ka);var t=S(n);function n(e,r,i){return k(this,n),t.call(this,new Int32Array(e),r,i)}return P(n)}(),io=exports.Uint32BufferAttribute=function(e){x(n,Ka);var t=S(n);function n(e,r,i){return k(this,n),t.call(this,new Uint32Array(e),r,i)}return P(n)}(),ao=exports.Float16BufferAttribute=function(e){x(n,Ka);var t=S(n);function n(e,r,i){var a;return k(this,n),(a=t.call(this,new Uint16Array(e),r,i)).isFloat16BufferAttribute=!0,a}return P(n,[{key:"getX",value:function(e){var t=qa(this.array[e*this.itemSize]);return this.normalized&&(t=Br(t,this.array)),t}},{key:"setX",value:function(e,t){return this.normalized&&(t=zr(t,this.array)),this.array[e*this.itemSize]=ja(t),this}},{key:"getY",value:function(e){var t=qa(this.array[e*this.itemSize+1]);return this.normalized&&(t=Br(t,this.array)),t}},{key:"setY",value:function(e,t){return this.normalized&&(t=zr(t,this.array)),this.array[e*this.itemSize+1]=ja(t),this}},{key:"getZ",value:function(e){var t=qa(this.array[e*this.itemSize+2]);return this.normalized&&(t=Br(t,this.array)),t}},{key:"setZ",value:function(e,t){return this.normalized&&(t=zr(t,this.array)),this.array[e*this.itemSize+2]=ja(t),this}},{key:"getW",value:function(e){var t=qa(this.array[e*this.itemSize+3]);return this.normalized&&(t=Br(t,this.array)),t}},{key:"setW",value:function(e,t){return this.normalized&&(t=zr(t,this.array)),this.array[e*this.itemSize+3]=ja(t),this}},{key:"setXY",value:function(e,t,n){return e*=this.itemSize,this.normalized&&(t=zr(t,this.array),n=zr(n,this.array)),this.array[e+0]=ja(t),this.array[e+1]=ja(n),this}},{key:"setXYZ",value:function(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=zr(t,this.array),n=zr(n,this.array),r=zr(r,this.array)),this.array[e+0]=ja(t),this.array[e+1]=ja(n),this.array[e+2]=ja(r),this}},{key:"setXYZW",value:function(e,t,n,r,i){return e*=this.itemSize,this.normalized&&(t=zr(t,this.array),n=zr(n,this.array),r=zr(r,this.array),i=zr(i,this.array)),this.array[e+0]=ja(t),this.array[e+1]=ja(n),this.array[e+2]=ja(r),this.array[e+3]=ja(i),this}}]),n}(),oo=exports.Float32BufferAttribute=function(e){x(n,Ka);var t=S(n);function n(e,r,i){return k(this,n),t.call(this,new Float32Array(e),r,i)}return P(n)}(),so=exports.Float64BufferAttribute=function(e){x(n,Ka);var t=S(n);function n(e,r,i){return k(this,n),t.call(this,new Float64Array(e),r,i)}return P(n)}(),lo=0,uo=new Ki,co=new Sa,ho=new Mi,po=new Ti,fo=new Ti,mo=new Mi,vo=exports.BufferGeometry=function(e){x(n,fr);var t=S(n);function n(){var e;return k(this,n),(e=t.call(this)).isBufferGeometry=!0,Object.defineProperty(T(e),"id",{value:lo++}),e.uuid=_r(),e.name="",e.type="BufferGeometry",e.index=null,e.attributes={},e.morphAttributes={},e.morphTargetsRelative=!1,e.groups=[],e.boundingBox=null,e.boundingSphere=null,e.drawRange={start:0,count:1/0},e.userData={},e}return P(n,[{key:"getIndex",value:function(){return this.index}},{key:"setIndex",value:function(e){return Array.isArray(e)?this.index=new(Xr(e)?io:no)(e,1):this.index=e,this}},{key:"getAttribute",value:function(e){return this.attributes[e]}},{key:"setAttribute",value:function(e,t){return this.attributes[e]=t,this}},{key:"deleteAttribute",value:function(e){return delete this.attributes[e],this}},{key:"hasAttribute",value:function(e){return void 0!==this.attributes[e]}},{key:"addGroup",value:function(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}},{key:"clearGroups",value:function(){this.groups=[]}},{key:"setDrawRange",value:function(e,t){this.drawRange.start=e,this.drawRange.count=t}},{key:"applyMatrix4",value:function(e){var t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);var n=this.attributes.normal;if(void 0!==n){var r=(new Vr).getNormalMatrix(e);n.applyNormalMatrix(r),n.needsUpdate=!0}var i=this.attributes.tangent;return void 0!==i&&(i.transformDirection(e),i.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}},{key:"applyQuaternion",value:function(e){return uo.makeRotationFromQuaternion(e),this.applyMatrix4(uo),this}},{key:"rotateX",value:function(e){return uo.makeRotationX(e),this.applyMatrix4(uo),this}},{key:"rotateY",value:function(e){return uo.makeRotationY(e),this.applyMatrix4(uo),this}},{key:"rotateZ",value:function(e){return uo.makeRotationZ(e),this.applyMatrix4(uo),this}},{key:"translate",value:function(e,t,n){return uo.makeTranslation(e,t,n),this.applyMatrix4(uo),this}},{key:"scale",value:function(e,t,n){return uo.makeScale(e,t,n),this.applyMatrix4(uo),this}},{key:"lookAt",value:function(e){return co.lookAt(e),co.updateMatrix(),this.applyMatrix4(co.matrix),this}},{key:"center",value:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(ho).negate(),this.translate(ho.x,ho.y,ho.z),this}},{key:"setFromPoints",value:function(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n];t.push(i.x,i.y,i.z||0)}return this.setAttribute("position",new oo(t,3)),this}},{key:"computeBoundingBox",value:function(){null===this.boundingBox&&(this.boundingBox=new Ti);var e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new Mi(-1/0,-1/0,-1/0),new Mi(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(var n=0,r=t.length;n<r;n++){var i=t[n];po.setFromBufferAttribute(i),this.morphTargetsRelative?(mo.addVectors(this.boundingBox.min,po.min),this.boundingBox.expandByPoint(mo),mo.addVectors(this.boundingBox.max,po.max),this.boundingBox.expandByPoint(mo)):(this.boundingBox.expandByPoint(po.min),this.boundingBox.expandByPoint(po.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}},{key:"computeBoundingSphere",value:function(){null===this.boundingSphere&&(this.boundingSphere=new Hi);var e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new Mi,1/0);if(e){var n=this.boundingSphere.center;if(po.setFromBufferAttribute(e),t)for(var r=0,i=t.length;r<i;r++){var a=t[r];fo.setFromBufferAttribute(a),this.morphTargetsRelative?(mo.addVectors(po.min,fo.min),po.expandByPoint(mo),mo.addVectors(po.max,fo.max),po.expandByPoint(mo)):(po.expandByPoint(fo.min),po.expandByPoint(fo.max))}po.getCenter(n);for(var o=0,s=0,l=e.count;s<l;s++)mo.fromBufferAttribute(e,s),o=Math.max(o,n.distanceToSquared(mo));if(t)for(var u=0,c=t.length;u<c;u++)for(var h=t[u],p=this.morphTargetsRelative,d=0,f=h.count;d<f;d++)mo.fromBufferAttribute(h,d),p&&(ho.fromBufferAttribute(e,d),mo.add(ho)),o=Math.max(o,n.distanceToSquared(mo));this.boundingSphere.radius=Math.sqrt(o),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}},{key:"computeTangents",value:function(){var e=this.index,t=this.attributes;if(null!==e&&void 0!==t.position&&void 0!==t.normal&&void 0!==t.uv){var n=e.array,r=t.position.array,i=t.normal.array,a=t.uv.array,o=r.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new Ka(new Float32Array(4*o),4));for(var s=this.getAttribute("tangent").array,l=[],u=[],c=0;c<o;c++)l[c]=new Mi,u[c]=new Mi;var h=new Mi,p=new Mi,d=new Mi,f=new Hr,m=new Hr,v=new Hr,g=new Mi,y=new Mi,_=this.groups;0===_.length&&(_=[{start:0,count:n.length}]);for(var x=0,M=_.length;x<M;++x)for(var S=_[x],b=S.start,T=b,E=b+S.count;T<E;T+=3)N(n[T+0],n[T+1],n[T+2]);for(var w=new Mi,A=new Mi,R=new Mi,C=new Mi,k=0,L=_.length;k<L;++k)for(var P=_[k],I=P.start,U=I,D=I+P.count;U<D;U+=3)O(n[U+0]),O(n[U+1]),O(n[U+2])}else console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");function N(e,t,n){h.fromArray(r,3*e),p.fromArray(r,3*t),d.fromArray(r,3*n),f.fromArray(a,2*e),m.fromArray(a,2*t),v.fromArray(a,2*n),p.sub(h),d.sub(h),m.sub(f),v.sub(f);var i=1/(m.x*v.y-v.x*m.y);isFinite(i)&&(g.copy(p).multiplyScalar(v.y).addScaledVector(d,-m.y).multiplyScalar(i),y.copy(d).multiplyScalar(m.x).addScaledVector(p,-v.x).multiplyScalar(i),l[e].add(g),l[t].add(g),l[n].add(g),u[e].add(y),u[t].add(y),u[n].add(y))}function O(e){R.fromArray(i,3*e),C.copy(R);var t=l[e];w.copy(t),w.sub(R.multiplyScalar(R.dot(t))).normalize(),A.crossVectors(C,t);var n=A.dot(u[e])<0?-1:1;s[4*e]=w.x,s[4*e+1]=w.y,s[4*e+2]=w.z,s[4*e+3]=n}}},{key:"computeVertexNormals",value:function(){var e=this.index,t=this.getAttribute("position");if(void 0!==t){var n=this.getAttribute("normal");if(void 0===n)n=new Ka(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(var r=0,i=n.count;r<i;r++)n.setXYZ(r,0,0,0);var a=new Mi,o=new Mi,s=new Mi,l=new Mi,u=new Mi,c=new Mi,h=new Mi,p=new Mi;if(e)for(var d=0,f=e.count;d<f;d+=3){var m=e.getX(d+0),v=e.getX(d+1),g=e.getX(d+2);a.fromBufferAttribute(t,m),o.fromBufferAttribute(t,v),s.fromBufferAttribute(t,g),h.subVectors(s,o),p.subVectors(a,o),h.cross(p),l.fromBufferAttribute(n,m),u.fromBufferAttribute(n,v),c.fromBufferAttribute(n,g),l.add(h),u.add(h),c.add(h),n.setXYZ(m,l.x,l.y,l.z),n.setXYZ(v,u.x,u.y,u.z),n.setXYZ(g,c.x,c.y,c.z)}else for(var y=0,_=t.count;y<_;y+=3)a.fromBufferAttribute(t,y+0),o.fromBufferAttribute(t,y+1),s.fromBufferAttribute(t,y+2),h.subVectors(s,o),p.subVectors(a,o),h.cross(p),n.setXYZ(y+0,h.x,h.y,h.z),n.setXYZ(y+1,h.x,h.y,h.z),n.setXYZ(y+2,h.x,h.y,h.z);this.normalizeNormals(),n.needsUpdate=!0}}},{key:"normalizeNormals",value:function(){for(var e=this.attributes.normal,t=0,n=e.count;t<n;t++)mo.fromBufferAttribute(e,t),mo.normalize(),e.setXYZ(t,mo.x,mo.y,mo.z)}},{key:"toNonIndexed",value:function(){function e(e,t){for(var n=e.array,r=e.itemSize,i=e.normalized,a=new n.constructor(t.length*r),o=0,s=0,l=0,u=t.length;l<u;l++){o=e.isInterleavedBufferAttribute?t[l]*e.data.stride+e.offset:t[l]*r;for(var c=0;c<r;c++)a[s++]=n[o++]}return new Ka(a,r,i)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;var t=new n,r=this.index.array,i=this.attributes;for(var a in i){var o=e(i[a],r);t.setAttribute(a,o)}var s=this.morphAttributes;for(var l in s){for(var u=[],c=s[l],h=0,p=c.length;h<p;h++){var d=e(c[h],r);u.push(d)}t.morphAttributes[l]=u}t.morphTargetsRelative=this.morphTargetsRelative;for(var f=this.groups,m=0,v=f.length;m<v;m++){var g=f[m];t.addGroup(g.start,g.count,g.materialIndex)}return t}},{key:"toJSON",value:function(){var e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){var t=this.parameters;for(var n in t)void 0!==t[n]&&(e[n]=t[n]);return e}e.data={attributes:{}};var r=this.index;null!==r&&(e.data.index={type:r.array.constructor.name,array:Array.prototype.slice.call(r.array)});var i=this.attributes;for(var a in i){var o=i[a];e.data.attributes[a]=o.toJSON(e.data)}var s={},l=!1;for(var u in this.morphAttributes){for(var c=this.morphAttributes[u],h=[],p=0,d=c.length;p<d;p++){var f=c[p];h.push(f.toJSON(e.data))}h.length>0&&(s[u]=h,l=!0)}l&&(e.data.morphAttributes=s,e.data.morphTargetsRelative=this.morphTargetsRelative);var m=this.groups;m.length>0&&(e.data.groups=JSON.parse(JSON.stringify(m)));var v=this.boundingSphere;return null!==v&&(e.data.boundingSphere={center:v.center.toArray(),radius:v.radius}),e}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;var t={};this.name=e.name;var n=e.index;null!==n&&this.setIndex(n.clone(t));var r=e.attributes;for(var i in r){var a=r[i];this.setAttribute(i,a.clone(t))}var o=e.morphAttributes;for(var s in o){for(var l=[],u=o[s],c=0,h=u.length;c<h;c++)l.push(u[c].clone(t));this.morphAttributes[s]=l}this.morphTargetsRelative=e.morphTargetsRelative;for(var p=e.groups,d=0,f=p.length;d<f;d++){var m=p[d];this.addGroup(m.start,m.count,m.materialIndex)}var v=e.boundingBox;null!==v&&(this.boundingBox=v.clone());var g=e.boundingSphere;return null!==g&&(this.boundingSphere=g.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}}]),n}(),go=new Ki,yo=new Ji,_o=new Hi,xo=new Mi,Mo=new Mi,So=new Mi,bo=new Mi,To=new Mi,Eo=new Mi,wo=new Hr,Ao=new Hr,Ro=new Hr,Co=new Mi,ko=new Mi,Lo=new Mi,Po=new Mi,Io=new Mi,Uo=exports.Mesh=function(e){x(n,Sa);var t=S(n);function n(e=new vo,r=new Va){var i;return k(this,n),(i=t.call(this)).isMesh=!0,i.type="Mesh",i.geometry=e,i.material=r,i.updateMorphTargets(),i}return P(n,[{key:"copy",value:function(e,t){return p(w(n.prototype),"copy",this).call(this,e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}},{key:"updateMorphTargets",value:function(){var e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){var n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var r=0,i=n.length;r<i;r++){var a=n[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=r}}}}},{key:"getVertexPosition",value:function(e,t){var n=this.geometry,r=n.attributes.position,i=n.morphAttributes.position,a=n.morphTargetsRelative;t.fromBufferAttribute(r,e);var o=this.morphTargetInfluences;if(i&&o){Eo.set(0,0,0);for(var s=0,l=i.length;s<l;s++){var u=o[s],c=i[s];0!==u&&(To.fromBufferAttribute(c,e),a?Eo.addScaledVector(To,u):Eo.addScaledVector(To.sub(t),u))}t.add(Eo)}return t}},{key:"raycast",value:function(e,t){var n=this.geometry,r=this.material,i=this.matrixWorld;if(void 0!==r){if(null===n.boundingSphere&&n.computeBoundingSphere(),_o.copy(n.boundingSphere),_o.applyMatrix4(i),yo.copy(e.ray).recast(e.near),!1===_o.containsPoint(yo.origin)){if(null===yo.intersectSphere(_o,xo))return;if(yo.origin.distanceToSquared(xo)>Math.pow(e.far-e.near,2))return}go.copy(i).invert(),yo.copy(e.ray).applyMatrix4(go),null!==n.boundingBox&&!1===yo.intersectsBox(n.boundingBox)||this._computeIntersections(e,t,yo)}}},{key:"_computeIntersections",value:function(e,t,n){var r,i=this.geometry,a=this.material,o=i.index,s=i.attributes.position,l=i.attributes.uv,u=i.attributes.uv1,c=i.attributes.normal,h=i.groups,p=i.drawRange;if(null!==o)if(Array.isArray(a))for(var d=0,f=h.length;d<f;d++)for(var m=h[d],v=a[m.materialIndex],g=Math.max(m.start,p.start),y=Math.min(o.count,Math.min(m.start+m.count,p.start+p.count));g<y;g+=3){(r=No(this,v,e,n,l,u,c,o.getX(g),o.getX(g+1),o.getX(g+2)))&&(r.faceIndex=Math.floor(g/3),r.face.materialIndex=m.materialIndex,t.push(r))}else for(var _=Math.max(0,p.start),x=Math.min(o.count,p.start+p.count);_<x;_+=3){(r=No(this,a,e,n,l,u,c,o.getX(_),o.getX(_+1),o.getX(_+2)))&&(r.faceIndex=Math.floor(_/3),t.push(r))}else if(void 0!==s)if(Array.isArray(a))for(var M=0,S=h.length;M<S;M++)for(var b=h[M],T=a[b.materialIndex],E=Math.max(b.start,p.start),w=Math.min(s.count,Math.min(b.start+b.count,p.start+p.count));E<w;E+=3){(r=No(this,T,e,n,l,u,c,E,E+1,E+2))&&(r.faceIndex=Math.floor(E/3),r.face.materialIndex=b.materialIndex,t.push(r))}else for(var A=Math.max(0,p.start),R=Math.min(s.count,p.start+p.count);A<R;A+=3){(r=No(this,a,e,n,l,u,c,A,A+1,A+2))&&(r.faceIndex=Math.floor(A/3),t.push(r))}}}]),n}();function Do(e,t,n,r,i,a,o,s){if(null===(t.side===q?r.intersectTriangle(o,a,i,!0,s):r.intersectTriangle(i,a,o,t.side===j,s)))return null;Io.copy(s),Io.applyMatrix4(e.matrixWorld);var l=n.ray.origin.distanceTo(Io);return l<n.near||l>n.far?null:{distance:l,point:Io.clone(),object:e}}function No(e,t,n,r,i,a,o,s,l,u){e.getVertexPosition(s,Mo),e.getVertexPosition(l,So),e.getVertexPosition(u,bo);var c=Do(e,t,n,r,Mo,So,bo,Po);if(c){i&&(wo.fromBufferAttribute(i,s),Ao.fromBufferAttribute(i,l),Ro.fromBufferAttribute(i,u),c.uv=Ua.getInterpolation(Po,Mo,So,bo,wo,Ao,Ro,new Hr)),a&&(wo.fromBufferAttribute(a,s),Ao.fromBufferAttribute(a,l),Ro.fromBufferAttribute(a,u),c.uv1=Ua.getInterpolation(Po,Mo,So,bo,wo,Ao,Ro,new Hr),c.uv2=c.uv1),o&&(Co.fromBufferAttribute(o,s),ko.fromBufferAttribute(o,l),Lo.fromBufferAttribute(o,u),c.normal=Ua.getInterpolation(Po,Mo,So,bo,Co,ko,Lo,new Mi),c.normal.dot(r.direction)>0&&c.normal.multiplyScalar(-1));var h={a:s,b:l,c:u,normal:new Mi,materialIndex:0};Ua.getNormal(Mo,So,bo,h.normal),c.face=h}return c}var Oo=exports.BoxGeometry=function(e){x(n,vo);var t=S(n);function n(e=1,r=1,i=1,a=1,o=1,s=1){var l;k(this,n),(l=t.call(this)).type="BoxGeometry",l.parameters={width:e,height:r,depth:i,widthSegments:a,heightSegments:o,depthSegments:s};var u=T(l);a=Math.floor(a),o=Math.floor(o),s=Math.floor(s);var c=[],h=[],p=[],d=[],f=0,m=0;function v(e,t,n,r,i,a,o,s,l,v,g){for(var y=a/l,_=o/v,x=a/2,M=o/2,S=s/2,b=l+1,T=v+1,E=0,w=0,A=new Mi,R=0;R<T;R++)for(var C=R*_-M,k=0;k<b;k++){var L=k*y-x;A[e]=L*r,A[t]=C*i,A[n]=S,h.push(A.x,A.y,A.z),A[e]=0,A[t]=0,A[n]=s>0?1:-1,p.push(A.x,A.y,A.z),d.push(k/l),d.push(1-R/v),E+=1}for(var P=0;P<v;P++)for(var I=0;I<l;I++){var U=f+I+b*P,D=f+I+b*(P+1),N=f+(I+1)+b*(P+1),O=f+(I+1)+b*P;c.push(U,D,O),c.push(D,N,O),w+=6}u.addGroup(m,w,g),m+=w,f+=E}return v("z","y","x",-1,-1,i,r,e,s,o,0),v("z","y","x",1,-1,i,r,-e,s,o,1),v("x","z","y",1,1,e,i,r,a,s,2),v("x","z","y",1,-1,e,i,-r,a,s,3),v("x","y","z",1,-1,e,r,i,a,o,4),v("x","y","z",-1,-1,e,r,-i,a,o,5),l.setIndex(c),l.setAttribute("position",new oo(h,3)),l.setAttribute("normal",new oo(p,3)),l.setAttribute("uv",new oo(d,2)),l}return P(n,[{key:"copy",value:function(e){return p(w(n.prototype),"copy",this).call(this,e),this.parameters=Object.assign({},e.parameters),this}}],[{key:"fromJSON",value:function(e){return new n(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}]),n}();function Fo(e){var t={};for(var n in e)for(var r in t[n]={},e[n]){var i=e[n][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?i.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),t[n][r]=null):t[n][r]=i.clone():Array.isArray(i)?t[n][r]=i.slice():t[n][r]=i}return t}function Bo(e){for(var t={},n=0;n<e.length;n++){var r=Fo(e[n]);for(var i in r)t[i]=r[i]}return t}function zo(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n].clone());return t}function Go(e){return null===e.getRenderTarget()?e.outputColorSpace:ri.workingColorSpace}var Ho=exports.UniformsUtils={clone:Fo,merge:Bo},Vo="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",Wo="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",Xo=exports.ShaderMaterial=function(e){x(n,Na);var t=S(n);function n(e){var r;return k(this,n),(r=t.call(this)).isShaderMaterial=!0,r.type="ShaderMaterial",r.defines={},r.uniforms={},r.uniformsGroups=[],r.vertexShader=Vo,r.fragmentShader=Wo,r.linewidth=1,r.wireframe=!1,r.wireframeLinewidth=1,r.fog=!1,r.lights=!1,r.clipping=!1,r.forceSinglePass=!0,r.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},r.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},r.index0AttributeName=void 0,r.uniformsNeedUpdate=!1,r.glslVersion=null,void 0!==e&&r.setValues(e),r}return P(n,[{key:"copy",value:function(e){return p(w(n.prototype),"copy",this).call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Fo(e.uniforms),this.uniformsGroups=zo(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}},{key:"toJSON",value:function(e){var t=p(w(n.prototype),"toJSON",this).call(this,e);for(var r in t.glslVersion=this.glslVersion,t.uniforms={},this.uniforms){var i=this.uniforms[r].value;i&&i.isTexture?t.uniforms[r]={type:"t",value:i.toJSON(e).uuid}:i&&i.isColor?t.uniforms[r]={type:"c",value:i.getHex()}:i&&i.isVector2?t.uniforms[r]={type:"v2",value:i.toArray()}:i&&i.isVector3?t.uniforms[r]={type:"v3",value:i.toArray()}:i&&i.isVector4?t.uniforms[r]={type:"v4",value:i.toArray()}:i&&i.isMatrix3?t.uniforms[r]={type:"m3",value:i.toArray()}:i&&i.isMatrix4?t.uniforms[r]={type:"m4",value:i.toArray()}:t.uniforms[r]={value:i}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;var a={};for(var o in this.extensions)!0===this.extensions[o]&&(a[o]=!0);return Object.keys(a).length>0&&(t.extensions=a),t}}]),n}(),jo=exports.Camera=function(e){x(n,Sa);var t=S(n);function n(){var e;return k(this,n),(e=t.call(this)).isCamera=!0,e.type="Camera",e.matrixWorldInverse=new Ki,e.projectionMatrix=new Ki,e.projectionMatrixInverse=new Ki,e.coordinateSystem=pr,e}return P(n,[{key:"copy",value:function(e,t){return p(w(n.prototype),"copy",this).call(this,e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}},{key:"getWorldDirection",value:function(e){return p(w(n.prototype),"getWorldDirection",this).call(this,e).negate()}},{key:"updateMatrixWorld",value:function(e){p(w(n.prototype),"updateMatrixWorld",this).call(this,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}},{key:"updateWorldMatrix",value:function(e,t){p(w(n.prototype),"updateWorldMatrix",this).call(this,e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),n}(),qo=exports.PerspectiveCamera=function(e){x(n,jo);var t=S(n);function n(e=50,r=1,i=.1,a=2e3){var o;return k(this,n),(o=t.call(this)).isPerspectiveCamera=!0,o.type="PerspectiveCamera",o.fov=e,o.zoom=1,o.near=i,o.far=a,o.focus=10,o.aspect=r,o.view=null,o.filmGauge=35,o.filmOffset=0,o.updateProjectionMatrix(),o}return P(n,[{key:"copy",value:function(e,t){return p(w(n.prototype),"copy",this).call(this,e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}},{key:"setFocalLength",value:function(e){var t=.5*this.getFilmHeight()/e;this.fov=2*yr*Math.atan(t),this.updateProjectionMatrix()}},{key:"getFocalLength",value:function(){var e=Math.tan(.5*gr*this.fov);return.5*this.getFilmHeight()/e}},{key:"getEffectiveFOV",value:function(){return 2*yr*Math.atan(Math.tan(.5*gr*this.fov)/this.zoom)}},{key:"getFilmWidth",value:function(){return this.filmGauge*Math.min(this.aspect,1)}},{key:"getFilmHeight",value:function(){return this.filmGauge/Math.max(this.aspect,1)}},{key:"setViewOffset",value:function(e,t,n,r,i,a){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()}},{key:"clearViewOffset",value:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}},{key:"updateProjectionMatrix",value:function(){var e=this.near,t=e*Math.tan(.5*gr*this.fov)/this.zoom,n=2*t,r=this.aspect*n,i=-.5*r,a=this.view;if(null!==this.view&&this.view.enabled){var o=a.fullWidth,s=a.fullHeight;i+=a.offsetX*r/o,t-=a.offsetY*n/s,r*=a.width/o,n*=a.height/s}var l=this.filmOffset;0!==l&&(i+=e*l/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,t,t-n,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}},{key:"toJSON",value:function(e){var t=p(w(n.prototype),"toJSON",this).call(this,e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}]),n}(),Yo=-90,Zo=1,Jo=exports.CubeCamera=function(e){x(n,Sa);var t=S(n);function n(e,r,i){var a;k(this,n),(a=t.call(this)).type="CubeCamera",a.renderTarget=i,a.coordinateSystem=null,a.activeMipmapLevel=0;var o=new qo(Yo,Zo,e,r);o.layers=a.layers,a.add(o);var s=new qo(Yo,Zo,e,r);s.layers=a.layers,a.add(s);var l=new qo(Yo,Zo,e,r);l.layers=a.layers,a.add(l);var u=new qo(Yo,Zo,e,r);u.layers=a.layers,a.add(u);var c=new qo(Yo,Zo,e,r);c.layers=a.layers,a.add(c);var h=new qo(Yo,Zo,e,r);return h.layers=a.layers,a.add(h),a}return P(n,[{key:"updateCoordinateSystem",value:function(){var e,t=this.coordinateSystem,n=this.children.concat(),r=l(n,6),i=r[0],a=r[1],o=r[2],u=r[3],c=r[4],h=r[5],p=s(n);try{for(p.s();!(e=p.n()).done;){var d=e.value;this.remove(d)}}catch(g){p.e(g)}finally{p.f()}if(t===pr)i.up.set(0,1,0),i.lookAt(1,0,0),a.up.set(0,1,0),a.lookAt(-1,0,0),o.up.set(0,0,-1),o.lookAt(0,1,0),u.up.set(0,0,1),u.lookAt(0,-1,0),c.up.set(0,1,0),c.lookAt(0,0,1),h.up.set(0,1,0),h.lookAt(0,0,-1);else{if(t!==dr)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+t);i.up.set(0,-1,0),i.lookAt(-1,0,0),a.up.set(0,-1,0),a.lookAt(1,0,0),o.up.set(0,0,1),o.lookAt(0,1,0),u.up.set(0,0,-1),u.lookAt(0,-1,0),c.up.set(0,-1,0),c.lookAt(0,0,1),h.up.set(0,-1,0),h.lookAt(0,0,-1)}var f,m=s(n);try{for(m.s();!(f=m.n()).done;){var v=f.value;this.add(v),v.updateMatrixWorld()}}catch(g){m.e(g)}finally{m.f()}}},{key:"update",value:function(e,t){null===this.parent&&this.updateMatrixWorld();var n=this.renderTarget,r=this.activeMipmapLevel;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());var i=l(this.children,6),a=i[0],o=i[1],s=i[2],u=i[3],c=i[4],h=i[5],p=e.getRenderTarget(),d=e.getActiveCubeFace(),f=e.getActiveMipmapLevel(),m=e.xr.enabled;e.xr.enabled=!1;var v=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0,r),e.render(t,a),e.setRenderTarget(n,1,r),e.render(t,o),e.setRenderTarget(n,2,r),e.render(t,s),e.setRenderTarget(n,3,r),e.render(t,u),e.setRenderTarget(n,4,r),e.render(t,c),n.texture.generateMipmaps=v,e.setRenderTarget(n,5,r),e.render(t,h),e.setRenderTarget(p,d,f),e.xr.enabled=m,n.texture.needsPMREMUpdate=!0}}]),n}(),Ko=exports.CubeTexture=function(e){x(n,hi);var t=S(n);function n(e,r,i,a,o,s,l,u,c,h){var p;return k(this,n),e=void 0!==e?e:[],r=void 0!==r?r:Ne,(p=t.call(this,e,r,i,a,o,s,l,u,c,h)).isCubeTexture=!0,p.flipY=!1,p}return P(n,[{key:"images",get:function(){return this.image},set:function(e){this.image=e}}]),n}(),Qo=exports.WebGLCubeRenderTarget=function(e){x(n,fi);var t=S(n);function n(e=1,r={}){var i;k(this,n),(i=t.call(this,e,e,r)).isWebGLCubeRenderTarget=!0;var a={width:e,height:e,depth:1},o=[a,a,a,a,a,a];return void 0!==r.encoding&&(Kr("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),r.colorSpace=r.encoding===vn?Sn:Mn),i.texture=new Ko(o,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.colorSpace),i.texture.isRenderTargetTexture=!0,i.texture.generateMipmaps=void 0!==r.generateMipmaps&&r.generateMipmaps,i.texture.minFilter=void 0!==r.minFilter?r.minFilter:Ze,i}return P(n,[{key:"fromEquirectangularTexture",value:function(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;var n={tEquirect:{value:null}},r="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",i="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",a=new Oo(5,5,5),o=new Xo({name:"CubemapFromEquirect",uniforms:Fo(n),vertexShader:r,fragmentShader:i,side:q,blending:J});o.uniforms.tEquirect.value=t;var s=new Uo(a,o),l=t.minFilter;return t.minFilter===Qe&&(t.minFilter=Ze),new Jo(1,10,this).update(e,s),t.minFilter=l,s.geometry.dispose(),s.material.dispose(),this}},{key:"clear",value:function(e,t,n,r){for(var i=e.getRenderTarget(),a=0;a<6;a++)e.setRenderTarget(this,a),e.clear(t,n,r);e.setRenderTarget(i)}}]),n}(),$o=new Mi,es=new Mi,ts=new Vr,ns=exports.Plane=function(){function e(t=new Mi(1,0,0),n=0){k(this,e),this.isPlane=!0,this.normal=t,this.constant=n}return P(e,[{key:"set",value:function(e,t){return this.normal.copy(e),this.constant=t,this}},{key:"setComponents",value:function(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}},{key:"setFromNormalAndCoplanarPoint",value:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}},{key:"setFromCoplanarPoints",value:function(e,t,n){var r=$o.subVectors(n,t).cross(es.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}},{key:"copy",value:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this}},{key:"normalize",value:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}},{key:"negate",value:function(){return this.constant*=-1,this.normal.negate(),this}},{key:"distanceToPoint",value:function(e){return this.normal.dot(e)+this.constant}},{key:"distanceToSphere",value:function(e){return this.distanceToPoint(e.center)-e.radius}},{key:"projectPoint",value:function(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}},{key:"intersectLine",value:function(e,t){var n=e.delta($o),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;var i=-(e.start.dot(this.normal)+this.constant)/r;return i<0||i>1?null:t.copy(e.start).addScaledVector(n,i)}},{key:"intersectsLine",value:function(e){var t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}},{key:"intersectsBox",value:function(e){return e.intersectsPlane(this)}},{key:"intersectsSphere",value:function(e){return e.intersectsPlane(this)}},{key:"coplanarPoint",value:function(e){return e.copy(this.normal).multiplyScalar(-this.constant)}},{key:"applyMatrix4",value:function(e,t){var n=t||ts.getNormalMatrix(e),r=this.coplanarPoint($o).applyMatrix4(e),i=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(i),this}},{key:"translate",value:function(e){return this.constant-=e.dot(this.normal),this}},{key:"equals",value:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}(),rs=new Hi,is=new Mi,as=exports.Frustum=function(){function e(t=new ns,n=new ns,r=new ns,i=new ns,a=new ns,o=new ns){k(this,e),this.planes=[t,n,r,i,a,o]}return P(e,[{key:"set",value:function(e,t,n,r,i,a){var o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(n),o[3].copy(r),o[4].copy(i),o[5].copy(a),this}},{key:"copy",value:function(e){for(var t=this.planes,n=0;n<6;n++)t[n].copy(e.planes[n]);return this}},{key:"setFromProjectionMatrix",value:function(e,t=pr){var n=this.planes,r=e.elements,i=r[0],a=r[1],o=r[2],s=r[3],l=r[4],u=r[5],c=r[6],h=r[7],p=r[8],d=r[9],f=r[10],m=r[11],v=r[12],g=r[13],y=r[14],_=r[15];if(n[0].setComponents(s-i,h-l,m-p,_-v).normalize(),n[1].setComponents(s+i,h+l,m+p,_+v).normalize(),n[2].setComponents(s+a,h+u,m+d,_+g).normalize(),n[3].setComponents(s-a,h-u,m-d,_-g).normalize(),n[4].setComponents(s-o,h-c,m-f,_-y).normalize(),t===pr)n[5].setComponents(s+o,h+c,m+f,_+y).normalize();else{if(t!==dr)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);n[5].setComponents(o,c,f,y).normalize()}return this}},{key:"intersectsObject",value:function(e){if(void 0!==e.boundingSphere)null===e.boundingSphere&&e.computeBoundingSphere(),rs.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{var t=e.geometry;null===t.boundingSphere&&t.computeBoundingSphere(),rs.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(rs)}},{key:"intersectsSprite",value:function(e){return rs.center.set(0,0,0),rs.radius=.7071067811865476,rs.applyMatrix4(e.matrixWorld),this.intersectsSphere(rs)}},{key:"intersectsSphere",value:function(e){for(var t=this.planes,n=e.center,r=-e.radius,i=0;i<6;i++){if(t[i].distanceToPoint(n)<r)return!1}return!0}},{key:"intersectsBox",value:function(e){for(var t=this.planes,n=0;n<6;n++){var r=t[n];if(is.x=r.normal.x>0?e.max.x:e.min.x,is.y=r.normal.y>0?e.max.y:e.min.y,is.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(is)<0)return!1}return!0}},{key:"containsPoint",value:function(e){for(var t=this.planes,n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}();function os(){var e=null,t=!1,n=null,r=null;function i(t,a){n(t,a),r=e.requestAnimationFrame(i)}return{start:function(){!0!==t&&null!==n&&(r=e.requestAnimationFrame(i),t=!0)},stop:function(){e.cancelAnimationFrame(r),t=!1},setAnimationLoop:function(e){n=e},setContext:function(t){e=t}}}function ss(e,t){var n=t.isWebGL2,r=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),r.get(e)},remove:function(t){t.isInterleavedBufferAttribute&&(t=t.data);var n=r.get(t);n&&(e.deleteBuffer(n.buffer),r.delete(t))},update:function(t,i){if(t.isGLBufferAttribute){var a=r.get(t);(!a||a.version<t.version)&&r.set(t,{buffer:t.buffer,type:t.type,bytesPerElement:t.elementSize,version:t.version})}else{t.isInterleavedBufferAttribute&&(t=t.data);var o=r.get(t);void 0===o?r.set(t,function(t,r){var i,a=t.array,o=t.usage,s=e.createBuffer();if(e.bindBuffer(r,s),e.bufferData(r,a,o),t.onUploadCallback(),a instanceof Float32Array)i=e.FLOAT;else if(a instanceof Uint16Array)if(t.isFloat16BufferAttribute){if(!n)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");i=e.HALF_FLOAT}else i=e.UNSIGNED_SHORT;else if(a instanceof Int16Array)i=e.SHORT;else if(a instanceof Uint32Array)i=e.UNSIGNED_INT;else if(a instanceof Int32Array)i=e.INT;else if(a instanceof Int8Array)i=e.BYTE;else if(a instanceof Uint8Array)i=e.UNSIGNED_BYTE;else{if(!(a instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+a);i=e.UNSIGNED_BYTE}return{buffer:s,type:i,bytesPerElement:a.BYTES_PER_ELEMENT,version:t.version}}(t,i)):o.version<t.version&&(function(t,r,i){var a=r.array,o=r.updateRange;e.bindBuffer(i,t),-1===o.count?e.bufferSubData(i,0,a):(n?e.bufferSubData(i,o.offset*a.BYTES_PER_ELEMENT,a,o.offset,o.count):e.bufferSubData(i,o.offset*a.BYTES_PER_ELEMENT,a.subarray(o.offset,o.offset+o.count)),o.count=-1),r.onUploadCallback()}(o.buffer,t,i),o.version=t.version)}}}}var ls=exports.PlaneGeometry=function(e){x(n,vo);var t=S(n);function n(e=1,r=1,i=1,a=1){var o;k(this,n),(o=t.call(this)).type="PlaneGeometry",o.parameters={width:e,height:r,widthSegments:i,heightSegments:a};for(var s=e/2,l=r/2,u=Math.floor(i),c=Math.floor(a),h=u+1,p=c+1,d=e/u,f=r/c,m=[],v=[],g=[],y=[],_=0;_<p;_++)for(var x=_*f-l,M=0;M<h;M++){var S=M*d-s;v.push(S,-x,0),g.push(0,0,1),y.push(M/u),y.push(1-_/c)}for(var b=0;b<c;b++)for(var T=0;T<u;T++){var E=T+h*b,w=T+h*(b+1),A=T+1+h*(b+1),R=T+1+h*b;m.push(E,w,R),m.push(w,A,R)}return o.setIndex(m),o.setAttribute("position",new oo(v,3)),o.setAttribute("normal",new oo(g,3)),o.setAttribute("uv",new oo(y,2)),o}return P(n,[{key:"copy",value:function(e){return p(w(n.prototype),"copy",this).call(this,e),this.parameters=Object.assign({},e.parameters),this}}],[{key:"fromJSON",value:function(e){return new n(e.width,e.height,e.widthSegments,e.heightSegments)}}]),n}(),us="#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",cs="#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",hs="#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",ps="#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",ds="#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",fs="#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",ms="#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometryNormal, geometryViewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",vs="#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",gs="vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif",ys="vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",_s="float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",xs="#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",Ms="#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos.xyz );\n\t\tvec3 vSigmaY = dFdy( surf_pos.xyz );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",Ss="#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",bs="#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",Ts="#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",Es="#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",ws="#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",As="#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",Rs="#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",Cs="#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",ks="#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",Ls="#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_v0 0.339\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_v1 0.276\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_v4 0.046\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_v5 0.016\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_v6 0.0038\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",Ps="vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",Is="#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",Us="#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",Ds="#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",Ns="#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",Os="gl_FragColor = linearToOutputTexel( gl_FragColor );",Fs="\nconst mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(\n\tvec3( 0.8224621, 0.177538, 0.0 ),\n\tvec3( 0.0331941, 0.9668058, 0.0 ),\n\tvec3( 0.0170827, 0.0723974, 0.9105199 )\n);\nconst mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.2249401, - 0.2249404, 0.0 ),\n\tvec3( - 0.0420569, 1.0420571, 0.0 ),\n\tvec3( - 0.0196376, - 0.0786361, 1.0982735 )\n);\nvec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {\n\treturn vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );\n}\nvec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {\n\treturn vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );\n}\nvec4 LinearTransferOETF( in vec4 value ) {\n\treturn value;\n}\nvec4 sRGBTransferOETF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn sRGBTransferOETF( value );\n}",Bs="#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",zs="#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",Gs="#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",Hs="#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",Vs="#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",Ws="#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",Xs="#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",js="#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",qs="#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",Ys="#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",Zs="#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",Js="#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",Ks="LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",Qs="varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",$s="uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\n#if defined( USE_LIGHT_PROBES )\n\tuniform vec3 lightProbe[ 9 ];\n#endif\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( LEGACY_LIGHTS )\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#else\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",el="#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",tl="ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",nl="varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",rl="BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",il="varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",al="PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tanisotropyV /= material.anisotropy;\n\tmaterial.anisotropy = saturate( material.anisotropy );\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x - tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x + tbn[ 0 ] * anisotropyV.y;\n#endif",ol="struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometryNormal;\n\t\tvec3 viewDir = geometryViewDir;\n\t\tvec3 position = geometryPosition;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",sl="\nvec3 geometryPosition = - vViewPosition;\nvec3 geometryNormal = normal;\nvec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\nvec3 geometryClearcoatNormal;\n#ifdef USE_CLEARCOAT\n\tgeometryClearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometryViewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometryPosition, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometryPosition, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if defined( USE_LIGHT_PROBES )\n\t\tirradiance += getLightProbeIrradiance( lightProbe, geometryNormal );\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",ll="#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometryNormal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",ul="#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif",cl="#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",hl="#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",pl="#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",dl="#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",fl="#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",ml="#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",vl="#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",gl="#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",yl="float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",_l="#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",xl="#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",Ml="#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",Sl="#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",bl="#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",Tl="float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 nonPerturbedNormal = normal;",El="#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",wl="#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",Al="#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",Rl="#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",Cl="#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",kl="#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = nonPerturbedNormal;\n#endif",Ll="#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",Pl="#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",Il="#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",Ul="#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",Dl="vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec2 packDepthToRG( in highp float v ) {\n\treturn packDepthToRGBA( v ).yx;\n}\nfloat unpackRGToDepth( const in highp vec2 v ) {\n\treturn unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",Nl="#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",Ol="vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",Fl="#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",Bl="#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",zl="float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",Gl="#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",Hl="#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",Vl="#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",Wl="#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",Xl="float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",jl="#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",ql="#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tuniform int boneTextureSize;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tfloat j = i * 4.0;\n\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\ty = dy * ( y + 0.5 );\n\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\treturn bone;\n\t}\n#endif",Yl="#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",Zl="#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",Jl="float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",Kl="#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",Ql="#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",$l="#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",eu="#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",tu="#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",nu="#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",ru="#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",iu="#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",au="#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",ou="varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",su="uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",lu="varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",uu="#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",cu="varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",hu="uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",pu="#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",du="#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",fu="#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",mu="#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",vu="varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",gu="uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",yu="uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",_u="uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",xu="#include <common>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",Mu="uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",Su="#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",bu="#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",Tu="#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",Eu="#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",wu="#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",Au="#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",Ru="#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",Cu="#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",ku="#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",Lu="#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",Pu="#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",Iu="#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",Uu="uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",Du="uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",Nu="#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",Ou="uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",Fu="uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",Bu="uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",zu=exports.ShaderChunk={alphahash_fragment:us,alphahash_pars_fragment:cs,alphamap_fragment:hs,alphamap_pars_fragment:ps,alphatest_fragment:ds,alphatest_pars_fragment:fs,aomap_fragment:ms,aomap_pars_fragment:vs,begin_vertex:gs,beginnormal_vertex:ys,bsdfs:_s,iridescence_fragment:xs,bumpmap_pars_fragment:Ms,clipping_planes_fragment:Ss,clipping_planes_pars_fragment:bs,clipping_planes_pars_vertex:Ts,clipping_planes_vertex:Es,color_fragment:ws,color_pars_fragment:As,color_pars_vertex:Rs,color_vertex:Cs,common:ks,cube_uv_reflection_fragment:Ls,defaultnormal_vertex:Ps,displacementmap_pars_vertex:Is,displacementmap_vertex:Us,emissivemap_fragment:Ds,emissivemap_pars_fragment:Ns,colorspace_fragment:Os,colorspace_pars_fragment:Fs,envmap_fragment:Bs,envmap_common_pars_fragment:zs,envmap_pars_fragment:Gs,envmap_pars_vertex:Hs,envmap_physical_pars_fragment:el,envmap_vertex:Vs,fog_vertex:Ws,fog_pars_vertex:Xs,fog_fragment:js,fog_pars_fragment:qs,gradientmap_pars_fragment:Ys,lightmap_fragment:Zs,lightmap_pars_fragment:Js,lights_lambert_fragment:Ks,lights_lambert_pars_fragment:Qs,lights_pars_begin:$s,lights_toon_fragment:tl,lights_toon_pars_fragment:nl,lights_phong_fragment:rl,lights_phong_pars_fragment:il,lights_physical_fragment:al,lights_physical_pars_fragment:ol,lights_fragment_begin:sl,lights_fragment_maps:ll,lights_fragment_end:ul,logdepthbuf_fragment:cl,logdepthbuf_pars_fragment:hl,logdepthbuf_pars_vertex:pl,logdepthbuf_vertex:dl,map_fragment:fl,map_pars_fragment:ml,map_particle_fragment:vl,map_particle_pars_fragment:gl,metalnessmap_fragment:yl,metalnessmap_pars_fragment:_l,morphcolor_vertex:xl,morphnormal_vertex:Ml,morphtarget_pars_vertex:Sl,morphtarget_vertex:bl,normal_fragment_begin:Tl,normal_fragment_maps:El,normal_pars_fragment:wl,normal_pars_vertex:Al,normal_vertex:Rl,normalmap_pars_fragment:Cl,clearcoat_normal_fragment_begin:kl,clearcoat_normal_fragment_maps:Ll,clearcoat_pars_fragment:Pl,iridescence_pars_fragment:Il,opaque_fragment:Ul,packing:Dl,premultiplied_alpha_fragment:Nl,project_vertex:Ol,dithering_fragment:Fl,dithering_pars_fragment:Bl,roughnessmap_fragment:zl,roughnessmap_pars_fragment:Gl,shadowmap_pars_fragment:Hl,shadowmap_pars_vertex:Vl,shadowmap_vertex:Wl,shadowmask_pars_fragment:Xl,skinbase_vertex:jl,skinning_pars_vertex:ql,skinning_vertex:Yl,skinnormal_vertex:Zl,specularmap_fragment:Jl,specularmap_pars_fragment:Kl,tonemapping_fragment:Ql,tonemapping_pars_fragment:$l,transmission_fragment:eu,transmission_pars_fragment:tu,uv_pars_fragment:nu,uv_pars_vertex:ru,uv_vertex:iu,worldpos_vertex:au,background_vert:ou,background_frag:su,backgroundCube_vert:lu,backgroundCube_frag:uu,cube_vert:cu,cube_frag:hu,depth_vert:pu,depth_frag:du,distanceRGBA_vert:fu,distanceRGBA_frag:mu,equirect_vert:vu,equirect_frag:gu,linedashed_vert:yu,linedashed_frag:_u,meshbasic_vert:xu,meshbasic_frag:Mu,meshlambert_vert:Su,meshlambert_frag:bu,meshmatcap_vert:Tu,meshmatcap_frag:Eu,meshnormal_vert:wu,meshnormal_frag:Au,meshphong_vert:Ru,meshphong_frag:Cu,meshphysical_vert:ku,meshphysical_frag:Lu,meshtoon_vert:Pu,meshtoon_frag:Iu,points_vert:Uu,points_frag:Du,shadow_vert:Nu,shadow_frag:Ou,sprite_vert:Fu,sprite_frag:Bu},Gu=exports.UniformsLib={common:{diffuse:{value:new Ga(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Vr},alphaMap:{value:null},alphaMapTransform:{value:new Vr},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Vr}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Vr}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Vr}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Vr},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Vr},normalScale:{value:new Hr(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Vr},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Vr}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Vr}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Vr}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Ga(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Ga(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Vr},alphaTest:{value:0},uvTransform:{value:new Vr}},sprite:{diffuse:{value:new Ga(16777215)},opacity:{value:1},center:{value:new Hr(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Vr},alphaMap:{value:null},alphaMapTransform:{value:new Vr},alphaTest:{value:0}}},Hu=exports.ShaderLib={basic:{uniforms:Bo([Gu.common,Gu.specularmap,Gu.envmap,Gu.aomap,Gu.lightmap,Gu.fog]),vertexShader:zu.meshbasic_vert,fragmentShader:zu.meshbasic_frag},lambert:{uniforms:Bo([Gu.common,Gu.specularmap,Gu.envmap,Gu.aomap,Gu.lightmap,Gu.emissivemap,Gu.bumpmap,Gu.normalmap,Gu.displacementmap,Gu.fog,Gu.lights,{emissive:{value:new Ga(0)}}]),vertexShader:zu.meshlambert_vert,fragmentShader:zu.meshlambert_frag},phong:{uniforms:Bo([Gu.common,Gu.specularmap,Gu.envmap,Gu.aomap,Gu.lightmap,Gu.emissivemap,Gu.bumpmap,Gu.normalmap,Gu.displacementmap,Gu.fog,Gu.lights,{emissive:{value:new Ga(0)},specular:{value:new Ga(1118481)},shininess:{value:30}}]),vertexShader:zu.meshphong_vert,fragmentShader:zu.meshphong_frag},standard:{uniforms:Bo([Gu.common,Gu.envmap,Gu.aomap,Gu.lightmap,Gu.emissivemap,Gu.bumpmap,Gu.normalmap,Gu.displacementmap,Gu.roughnessmap,Gu.metalnessmap,Gu.fog,Gu.lights,{emissive:{value:new Ga(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:zu.meshphysical_vert,fragmentShader:zu.meshphysical_frag},toon:{uniforms:Bo([Gu.common,Gu.aomap,Gu.lightmap,Gu.emissivemap,Gu.bumpmap,Gu.normalmap,Gu.displacementmap,Gu.gradientmap,Gu.fog,Gu.lights,{emissive:{value:new Ga(0)}}]),vertexShader:zu.meshtoon_vert,fragmentShader:zu.meshtoon_frag},matcap:{uniforms:Bo([Gu.common,Gu.bumpmap,Gu.normalmap,Gu.displacementmap,Gu.fog,{matcap:{value:null}}]),vertexShader:zu.meshmatcap_vert,fragmentShader:zu.meshmatcap_frag},points:{uniforms:Bo([Gu.points,Gu.fog]),vertexShader:zu.points_vert,fragmentShader:zu.points_frag},dashed:{uniforms:Bo([Gu.common,Gu.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:zu.linedashed_vert,fragmentShader:zu.linedashed_frag},depth:{uniforms:Bo([Gu.common,Gu.displacementmap]),vertexShader:zu.depth_vert,fragmentShader:zu.depth_frag},normal:{uniforms:Bo([Gu.common,Gu.bumpmap,Gu.normalmap,Gu.displacementmap,{opacity:{value:1}}]),vertexShader:zu.meshnormal_vert,fragmentShader:zu.meshnormal_frag},sprite:{uniforms:Bo([Gu.sprite,Gu.fog]),vertexShader:zu.sprite_vert,fragmentShader:zu.sprite_frag},background:{uniforms:{uvTransform:{value:new Vr},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:zu.background_vert,fragmentShader:zu.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:zu.backgroundCube_vert,fragmentShader:zu.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:zu.cube_vert,fragmentShader:zu.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:zu.equirect_vert,fragmentShader:zu.equirect_frag},distanceRGBA:{uniforms:Bo([Gu.common,Gu.displacementmap,{referencePosition:{value:new Mi},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:zu.distanceRGBA_vert,fragmentShader:zu.distanceRGBA_frag},shadow:{uniforms:Bo([Gu.lights,Gu.fog,{color:{value:new Ga(0)},opacity:{value:1}}]),vertexShader:zu.shadow_vert,fragmentShader:zu.shadow_frag}};Hu.physical={uniforms:Bo([Hu.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Vr},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Vr},clearcoatNormalScale:{value:new Hr(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Vr},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Vr},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Vr},sheen:{value:0},sheenColor:{value:new Ga(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Vr},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Vr},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Vr},transmissionSamplerSize:{value:new Hr},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Vr},attenuationDistance:{value:0},attenuationColor:{value:new Ga(0)},specularColor:{value:new Ga(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Vr},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Vr},anisotropyVector:{value:new Hr},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Vr}}]),vertexShader:zu.meshphysical_vert,fragmentShader:zu.meshphysical_frag};var Vu={r:0,b:0,g:0};function Wu(e,t,n,r,i,a,o){var s,l,u=new Ga(0),c=!0===a?0:1,h=null,p=0,d=null;function f(t,n){t.getRGB(Vu,Go(e)),r.buffers.color.setClear(Vu.r,Vu.g,Vu.b,n,o)}return{getClearColor:function(){return u},setClearColor:function(e,t=1){u.set(e),f(u,c=t)},getClearAlpha:function(){return c},setClearAlpha:function(e){f(u,c=e)},render:function(a,m){var v=!1,g=!0===m.isScene?m.background:null;g&&g.isTexture&&(g=(m.backgroundBlurriness>0?n:t).get(g)),null===g?f(u,c):g&&g.isColor&&(f(g,1),v=!0);var y=e.xr.getEnvironmentBlendMode();"additive"===y?r.buffers.color.setClear(0,0,0,1,o):"alpha-blend"===y&&r.buffers.color.setClear(0,0,0,0,o),(e.autoClear||v)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),g&&(g.isCubeTexture||g.mapping===ze)?(void 0===l&&((l=new Uo(new Oo(1,1,1),new Xo({name:"BackgroundCubeMaterial",uniforms:Fo(Hu.backgroundCube.uniforms),vertexShader:Hu.backgroundCube.vertexShader,fragmentShader:Hu.backgroundCube.fragmentShader,side:q,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),l.geometry.deleteAttribute("uv"),l.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(l.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(l)),l.material.uniforms.envMap.value=g,l.material.uniforms.flipEnvMap.value=g.isCubeTexture&&!1===g.isRenderTargetTexture?-1:1,l.material.uniforms.backgroundBlurriness.value=m.backgroundBlurriness,l.material.uniforms.backgroundIntensity.value=m.backgroundIntensity,l.material.toneMapped=ri.getTransfer(g.colorSpace)!==An,h===g&&p===g.version&&d===e.toneMapping||(l.material.needsUpdate=!0,h=g,p=g.version,d=e.toneMapping),l.layers.enableAll(),a.unshift(l,l.geometry,l.material,0,0,null)):g&&g.isTexture&&(void 0===s&&((s=new Uo(new ls(2,2),new Xo({name:"BackgroundMaterial",uniforms:Fo(Hu.background.uniforms),vertexShader:Hu.background.vertexShader,fragmentShader:Hu.background.fragmentShader,side:j,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),Object.defineProperty(s.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(s)),s.material.uniforms.t2D.value=g,s.material.uniforms.backgroundIntensity.value=m.backgroundIntensity,s.material.toneMapped=ri.getTransfer(g.colorSpace)!==An,!0===g.matrixAutoUpdate&&g.updateMatrix(),s.material.uniforms.uvTransform.value.copy(g.matrix),h===g&&p===g.version&&d===e.toneMapping||(s.material.needsUpdate=!0,h=g,p=g.version,d=e.toneMapping),s.layers.enableAll(),a.unshift(s,s.geometry,s.material,0,0,null))}}}function Xu(e,t,n,r){var i=e.getParameter(e.MAX_VERTEX_ATTRIBS),a=r.isWebGL2?null:t.get("OES_vertex_array_object"),o=r.isWebGL2||null!==a,s={},l=d(null),u=l,c=!1;function h(t){return r.isWebGL2?e.bindVertexArray(t):a.bindVertexArrayOES(t)}function p(t){return r.isWebGL2?e.deleteVertexArray(t):a.deleteVertexArrayOES(t)}function d(e){for(var t=[],n=[],r=[],a=0;a<i;a++)t[a]=0,n[a]=0,r[a]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:n,attributeDivisors:r,object:e,attributes:{},index:null}}function f(){for(var e=u.newAttributes,t=0,n=e.length;t<n;t++)e[t]=0}function m(e){v(e,0)}function v(n,i){var a=u.newAttributes,o=u.enabledAttributes,s=u.attributeDivisors;(a[n]=1,0===o[n]&&(e.enableVertexAttribArray(n),o[n]=1),s[n]!==i)&&((r.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](n,i),s[n]=i)}function g(){for(var t=u.newAttributes,n=u.enabledAttributes,r=0,i=n.length;r<i;r++)n[r]!==t[r]&&(e.disableVertexAttribArray(r),n[r]=0)}function y(t,n,r,i,a,o,s){!0===s?e.vertexAttribIPointer(t,n,r,a,o):e.vertexAttribPointer(t,n,r,i,a,o)}function _(){x(),c=!0,u!==l&&h((u=l).object)}function x(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function(i,l,p,_,x){var M=!1;if(o){var S=function(t,n,i){var o=!0===i.wireframe,l=s[t.id];void 0===l&&(l={},s[t.id]=l);var u=l[n.id];void 0===u&&(u={},l[n.id]=u);var c=u[o];return void 0===c&&(c=d(r.isWebGL2?e.createVertexArray():a.createVertexArrayOES()),u[o]=c),c}(_,p,l);u!==S&&h((u=S).object),(M=function(e,t,n,r){var i=u.attributes,a=t.attributes,o=0,s=n.getAttributes();for(var l in s){var c=s[l];if(c.location>=0){var h=i[l],p=a[l];if(void 0===p&&("instanceMatrix"===l&&e.instanceMatrix&&(p=e.instanceMatrix),"instanceColor"===l&&e.instanceColor&&(p=e.instanceColor)),void 0===h)return!0;if(h.attribute!==p)return!0;if(p&&h.data!==p.data)return!0;o++}}return u.attributesNum!==o||u.index!==r}(i,_,p,x))&&function(e,t,n,r){var i={},a=t.attributes,o=0,s=n.getAttributes();for(var l in s){var c=s[l];if(c.location>=0){var h=a[l];void 0===h&&("instanceMatrix"===l&&e.instanceMatrix&&(h=e.instanceMatrix),"instanceColor"===l&&e.instanceColor&&(h=e.instanceColor));var p={};p.attribute=h,h&&h.data&&(p.data=h.data),i[l]=p,o++}}u.attributes=i,u.attributesNum=o,u.index=r}(i,_,p,x)}else{var b=!0===l.wireframe;u.geometry===_.id&&u.program===p.id&&u.wireframe===b||(u.geometry=_.id,u.program=p.id,u.wireframe=b,M=!0)}null!==x&&n.update(x,e.ELEMENT_ARRAY_BUFFER),(M||c)&&(c=!1,function(i,a,o,s){if(!1!==r.isWebGL2||!i.isInstancedMesh&&!s.isInstancedBufferGeometry||null!==t.get("ANGLE_instanced_arrays")){f();var l=s.attributes,u=o.getAttributes(),c=a.defaultAttributeValues;for(var h in u){var p=u[h];if(p.location>=0){var d=l[h];if(void 0===d&&("instanceMatrix"===h&&i.instanceMatrix&&(d=i.instanceMatrix),"instanceColor"===h&&i.instanceColor&&(d=i.instanceColor)),void 0!==d){var _=d.normalized,x=d.itemSize,M=n.get(d);if(void 0===M)continue;var S=M.buffer,b=M.type,T=M.bytesPerElement,E=!0===r.isWebGL2&&(b===e.INT||b===e.UNSIGNED_INT||d.gpuType===it);if(d.isInterleavedBufferAttribute){var w=d.data,A=w.stride,R=d.offset;if(w.isInstancedInterleavedBuffer){for(var C=0;C<p.locationSize;C++)v(p.location+C,w.meshPerAttribute);!0!==i.isInstancedMesh&&void 0===s._maxInstanceCount&&(s._maxInstanceCount=w.meshPerAttribute*w.count)}else for(var k=0;k<p.locationSize;k++)m(p.location+k);e.bindBuffer(e.ARRAY_BUFFER,S);for(var L=0;L<p.locationSize;L++)y(p.location+L,x/p.locationSize,b,_,A*T,(R+x/p.locationSize*L)*T,E)}else{if(d.isInstancedBufferAttribute){for(var P=0;P<p.locationSize;P++)v(p.location+P,d.meshPerAttribute);!0!==i.isInstancedMesh&&void 0===s._maxInstanceCount&&(s._maxInstanceCount=d.meshPerAttribute*d.count)}else for(var I=0;I<p.locationSize;I++)m(p.location+I);e.bindBuffer(e.ARRAY_BUFFER,S);for(var U=0;U<p.locationSize;U++)y(p.location+U,x/p.locationSize,b,_,x*T,x/p.locationSize*U*T,E)}}else if(void 0!==c){var D=c[h];if(void 0!==D)switch(D.length){case 2:e.vertexAttrib2fv(p.location,D);break;case 3:e.vertexAttrib3fv(p.location,D);break;case 4:e.vertexAttrib4fv(p.location,D);break;default:e.vertexAttrib1fv(p.location,D)}}}}g()}}(i,l,p,_),null!==x&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n.get(x).buffer))},reset:_,resetDefaultState:x,dispose:function(){for(var e in _(),s){var t=s[e];for(var n in t){var r=t[n];for(var i in r)p(r[i].object),delete r[i];delete t[n]}delete s[e]}},releaseStatesOfGeometry:function(e){if(void 0!==s[e.id]){var t=s[e.id];for(var n in t){var r=t[n];for(var i in r)p(r[i].object),delete r[i];delete t[n]}delete s[e.id]}},releaseStatesOfProgram:function(e){for(var t in s){var n=s[t];if(void 0!==n[e.id]){var r=n[e.id];for(var i in r)p(r[i].object),delete r[i];delete n[e.id]}}},initAttributes:f,enableAttribute:m,disableUnusedAttributes:g}}function ju(e,t,n,r){var i,a=r.isWebGL2;this.setMode=function(e){i=e},this.render=function(t,r){e.drawArrays(i,t,r),n.update(r,i,1)},this.renderInstances=function(r,o,s){if(0!==s){var l,u;if(a)l=e,u="drawArraysInstanced";else if(u="drawArraysInstancedANGLE",null===(l=t.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");l[u](i,r,o,s),n.update(o,i,s)}}}function qu(e,t,n){var r;function i(t){if("highp"===t){if(e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.MEDIUM_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var a="undefined"!=typeof WebGL2RenderingContext&&"WebGL2RenderingContext"===e.constructor.name,o=void 0!==n.precision?n.precision:"highp",s=i(o);s!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",s,"instead."),o=s);var l=a||t.has("WEBGL_draw_buffers"),u=!0===n.logarithmicDepthBuffer,c=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),h=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS),p=e.getParameter(e.MAX_TEXTURE_SIZE),d=e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),f=e.getParameter(e.MAX_VERTEX_ATTRIBS),m=e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),v=e.getParameter(e.MAX_VARYING_VECTORS),g=e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),y=h>0,_=a||t.has("OES_texture_float");return{isWebGL2:a,drawBuffers:l,getMaxAnisotropy:function(){if(void 0!==r)return r;if(!0===t.has("EXT_texture_filter_anisotropic")){var n=t.get("EXT_texture_filter_anisotropic");r=e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r},getMaxPrecision:i,precision:o,logarithmicDepthBuffer:u,maxTextures:c,maxVertexTextures:h,maxTextureSize:p,maxCubemapSize:d,maxAttributes:f,maxVertexUniforms:m,maxVaryings:v,maxFragmentUniforms:g,vertexTextures:y,floatFragmentTextures:_,floatVertexTextures:y&&_,maxSamples:a?e.getParameter(e.MAX_SAMPLES):0}}function Yu(e){var t=this,n=null,r=0,i=!1,a=!1,o=new ns,s=new Vr,l={value:null,needsUpdate:!1};function u(e,n,r,i){var a=null!==e?e.length:0,u=null;if(0!==a){if(u=l.value,!0!==i||null===u){var c=r+4*a,h=n.matrixWorldInverse;s.getNormalMatrix(h),(null===u||u.length<c)&&(u=new Float32Array(c));for(var p=0,d=r;p!==a;++p,d+=4)o.copy(e[p]).applyMatrix4(h,s),o.normal.toArray(u,d),u[d+3]=o.constant}l.value=u,l.needsUpdate=!0}return t.numPlanes=a,t.numIntersection=0,u}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t){var n=0!==e.length||t||0!==r||i;return i=t,r=e.length,n},this.beginShadows=function(){a=!0,u(null)},this.endShadows=function(){a=!1},this.setGlobalState=function(e,t){n=u(e,t,0)},this.setState=function(o,s,c){var h=o.clippingPlanes,p=o.clipIntersection,d=o.clipShadows,f=e.get(o);if(!i||null===h||0===h.length||a&&!d)a?u(null):function(){l.value!==n&&(l.value=n,l.needsUpdate=r>0);t.numPlanes=r,t.numIntersection=0}();else{var m=a?0:r,v=4*m,g=f.clippingState||null;l.value=g,g=u(h,s,v,c);for(var y=0;y!==v;++y)g[y]=n[y];f.clippingState=g,this.numIntersection=p?this.numPlanes:0,this.numPlanes+=m}}}function Zu(e){var t=new WeakMap;function n(e,t){return t===Fe?e.mapping=Ne:t===Be&&(e.mapping=Oe),e}function r(e){var n=e.target;n.removeEventListener("dispose",r);var i=t.get(n);void 0!==i&&(t.delete(n),i.dispose())}return{get:function(i){if(i&&i.isTexture&&!1===i.isRenderTargetTexture){var a=i.mapping;if(a===Fe||a===Be){if(t.has(i))return n(t.get(i).texture,i.mapping);var o=i.image;if(o&&o.height>0){var s=new Qo(o.height/2);return s.fromEquirectangularTexture(e,i),t.set(i,s),i.addEventListener("dispose",r),n(s.texture,i.mapping)}return null}}return i},dispose:function(){t=new WeakMap}}}var Ju=exports.OrthographicCamera=function(e){x(n,jo);var t=S(n);function n(e=-1,r=1,i=1,a=-1,o=.1,s=2e3){var l;return k(this,n),(l=t.call(this)).isOrthographicCamera=!0,l.type="OrthographicCamera",l.zoom=1,l.view=null,l.left=e,l.right=r,l.top=i,l.bottom=a,l.near=o,l.far=s,l.updateProjectionMatrix(),l}return P(n,[{key:"copy",value:function(e,t){return p(w(n.prototype),"copy",this).call(this,e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}},{key:"setViewOffset",value:function(e,t,n,r,i,a){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()}},{key:"clearViewOffset",value:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}},{key:"updateProjectionMatrix",value:function(){var e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2,i=n-e,a=n+e,o=r+t,s=r-t;if(null!==this.view&&this.view.enabled){var l=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;a=(i+=l*this.view.offsetX)+l*this.view.width,s=(o-=u*this.view.offsetY)-u*this.view.height}this.projectionMatrix.makeOrthographic(i,a,o,s,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}},{key:"toJSON",value:function(e){var t=p(w(n.prototype),"toJSON",this).call(this,e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}]),n}(),Ku=4,Qu=[.125,.215,.35,.446,.526,.582],$u=20,ec=new Ju,tc=new Ga,nc=null,rc=(1+Math.sqrt(5))/2,ic=1/rc,ac=[new Mi(1,1,1),new Mi(-1,1,1),new Mi(1,1,-1),new Mi(-1,1,-1),new Mi(0,rc,ic),new Mi(0,rc,-ic),new Mi(ic,0,rc),new Mi(-ic,0,rc),new Mi(rc,ic,0),new Mi(-rc,ic,0)],oc=exports.PMREMGenerator=function(){function e(t){k(this,e),this._renderer=t,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}return P(e,[{key:"fromScene",value:function(e,t=0,n=.1,r=100){nc=this._renderer.getRenderTarget(),this._setSize(256);var i=this._allocateTargets();return i.depthBuffer=!0,this._sceneToCubeUV(e,n,r,i),t>0&&this._blur(i,0,0,t),this._applyPMREM(i),this._cleanup(i),i}},{key:"fromEquirectangular",value:function(e,t=null){return this._fromTexture(e,t)}},{key:"fromCubemap",value:function(e,t=null){return this._fromTexture(e,t)}},{key:"compileCubemapShader",value:function(){null===this._cubemapMaterial&&(this._cubemapMaterial=pc(),this._compileMaterial(this._cubemapMaterial))}},{key:"compileEquirectangularShader",value:function(){null===this._equirectMaterial&&(this._equirectMaterial=hc(),this._compileMaterial(this._equirectMaterial))}},{key:"dispose",value:function(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}},{key:"_setSize",value:function(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}},{key:"_dispose",value:function(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(var e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}},{key:"_cleanup",value:function(e){this._renderer.setRenderTarget(nc),e.scissorTest=!1,uc(e,0,0,e.width,e.height)}},{key:"_fromTexture",value:function(e,t){e.mapping===Ne||e.mapping===Oe?this._setSize(0===e.image.length?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),nc=this._renderer.getRenderTarget();var n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}},{key:"_allocateTargets",value:function(){var e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:Ze,minFilter:Ze,generateMipmaps:!1,type:st,format:pt,colorSpace:bn,depthBuffer:!1},r=lc(e,t,n);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=lc(e,t,n);var i=this._lodMax,a=sc(i);this._sizeLods=a.sizeLods,this._lodPlanes=a.lodPlanes,this._sigmas=a.sigmas,this._blurMaterial=cc(i,e,t)}return r}},{key:"_compileMaterial",value:function(e){var t=new Uo(this._lodPlanes[0],e);this._renderer.compile(t,ec)}},{key:"_sceneToCubeUV",value:function(e,t,n,r){var i=new qo(90,1,t,n),a=[1,-1,1,1,1,1],o=[1,1,1,-1,-1,-1],s=this._renderer,l=s.autoClear,u=s.toneMapping;s.getClearColor(tc),s.toneMapping=Ce,s.autoClear=!1;var c=new Va({name:"PMREM.Background",side:q,depthWrite:!1,depthTest:!1}),h=new Uo(new Oo,c),p=!1,d=e.background;d?d.isColor&&(c.color.copy(d),e.background=null,p=!0):(c.color.copy(tc),p=!0);for(var f=0;f<6;f++){var m=f%3;0===m?(i.up.set(0,a[f],0),i.lookAt(o[f],0,0)):1===m?(i.up.set(0,0,a[f]),i.lookAt(0,o[f],0)):(i.up.set(0,a[f],0),i.lookAt(0,0,o[f]));var v=this._cubeSize;uc(r,m*v,f>2?v:0,v,v),s.setRenderTarget(r),p&&s.render(h,i),s.render(e,i)}h.geometry.dispose(),h.material.dispose(),s.toneMapping=u,s.autoClear=l,e.background=d}},{key:"_textureToCubeUV",value:function(e,t){var n=this._renderer,r=e.mapping===Ne||e.mapping===Oe;r?(null===this._cubemapMaterial&&(this._cubemapMaterial=pc()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=hc());var i=r?this._cubemapMaterial:this._equirectMaterial,a=new Uo(this._lodPlanes[0],i);i.uniforms.envMap.value=e;var o=this._cubeSize;uc(t,0,0,3*o,2*o),n.setRenderTarget(t),n.render(a,ec)}},{key:"_applyPMREM",value:function(e){var t=this._renderer,n=t.autoClear;t.autoClear=!1;for(var r=1;r<this._lodPlanes.length;r++){var i=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]),a=ac[(r-1)%ac.length];this._blur(e,r-1,r,i,a)}t.autoClear=n}},{key:"_blur",value:function(e,t,n,r,i){var a=this._pingPongRenderTarget;this._halfBlur(e,a,t,n,r,"latitudinal",i),this._halfBlur(a,e,n,n,r,"longitudinal",i)}},{key:"_halfBlur",value:function(e,t,n,r,i,a,o){var s=this._renderer,l=this._blurMaterial;"latitudinal"!==a&&"longitudinal"!==a&&console.error("blur direction must be either latitudinal or longitudinal!");var u=new Uo(this._lodPlanes[r],l),c=l.uniforms,h=this._sizeLods[n]-1,p=isFinite(i)?Math.PI/(2*h):2*Math.PI/(2*$u-1),d=i/p,f=isFinite(i)?1+Math.floor(3*d):$u;f>$u&&console.warn("sigmaRadians, ".concat(i,", is too large and will clip, as it requested ").concat(f," samples when the maximum is set to ").concat($u));for(var m=[],v=0,g=0;g<$u;++g){var y=g/d,_=Math.exp(-y*y/2);m.push(_),0===g?v+=_:g<f&&(v+=2*_)}for(var x=0;x<m.length;x++)m[x]=m[x]/v;c.envMap.value=e.texture,c.samples.value=f,c.weights.value=m,c.latitudinal.value="latitudinal"===a,o&&(c.poleAxis.value=o);var M=this._lodMax;c.dTheta.value=p,c.mipInt.value=M-n;var S=this._sizeLods[r];uc(t,3*S*(r>M-Ku?r-M+Ku:0),4*(this._cubeSize-S),3*S,2*S),s.setRenderTarget(t),s.render(u,ec)}}]),e}();function sc(e){for(var t=[],n=[],r=[],i=e,a=e-Ku+1+Qu.length,o=0;o<a;o++){var s=Math.pow(2,i);n.push(s);var l=1/s;o>e-Ku?l=Qu[o-e+Ku-1]:0===o&&(l=0),r.push(l);for(var u=1/(s-2),c=-u,h=1+u,p=[c,c,h,c,h,h,c,c,h,h,c,h],d=new Float32Array(108),f=new Float32Array(72),m=new Float32Array(36),v=0;v<6;v++){var g=v%3*2/3-1,y=v>2?0:-1,_=[g,y,0,g+2/3,y,0,g+2/3,y+1,0,g,y,0,g+2/3,y+1,0,g,y+1,0];d.set(_,18*v),f.set(p,12*v);var x=[v,v,v,v,v,v];m.set(x,6*v)}var M=new vo;M.setAttribute("position",new Ka(d,3)),M.setAttribute("uv",new Ka(f,2)),M.setAttribute("faceIndex",new Ka(m,1)),t.push(M),i>Ku&&i--}return{lodPlanes:t,sizeLods:n,sigmas:r}}function lc(e,t,n){var r=new fi(e,t,n);return r.texture.mapping=ze,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function uc(e,t,n,r,i){e.viewport.set(t,n,r,i),e.scissor.set(t,n,r,i)}function cc(e,t,n){var r=new Float32Array($u),i=new Mi(0,1,0);return new Xo({name:"SphericalGaussianBlur",defines:{n:$u,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:"".concat(e,".0")},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:dc(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:J,depthTest:!1,depthWrite:!1})}function hc(){return new Xo({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:dc(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:J,depthTest:!1,depthWrite:!1})}function pc(){return new Xo({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:dc(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:J,depthTest:!1,depthWrite:!1})}function dc(){return"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t"}function fc(e){var t=new WeakMap,n=null;function r(e){var n=e.target;n.removeEventListener("dispose",r);var i=t.get(n);void 0!==i&&(t.delete(n),i.dispose())}return{get:function(i){if(i&&i.isTexture){var a=i.mapping,o=a===Fe||a===Be,s=a===Ne||a===Oe;if(o||s){if(i.isRenderTargetTexture&&!0===i.needsPMREMUpdate){i.needsPMREMUpdate=!1;var l=t.get(i);return null===n&&(n=new oc(e)),l=o?n.fromEquirectangular(i,l):n.fromCubemap(i,l),t.set(i,l),l.texture}if(t.has(i))return t.get(i).texture;var u=i.image;if(o&&u&&u.height>0||s&&u&&function(e){for(var t=0,n=0;n<6;n++)void 0!==e[n]&&t++;return 6===t}(u)){null===n&&(n=new oc(e));var c=o?n.fromEquirectangular(i):n.fromCubemap(i);return t.set(i,c),i.addEventListener("dispose",r),c.texture}return null}}return i},dispose:function(){t=new WeakMap,null!==n&&(n.dispose(),n=null)}}}function mc(e){var t={};function n(n){if(void 0!==t[n])return t[n];var r;switch(n){case"WEBGL_depth_texture":r=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=e.getExtension(n)}return t[n]=r,r}return{has:function(e){return null!==n(e)},init:function(e){e.isWebGL2?n("EXT_color_buffer_float"):(n("WEBGL_depth_texture"),n("OES_texture_float"),n("OES_texture_half_float"),n("OES_texture_half_float_linear"),n("OES_standard_derivatives"),n("OES_element_index_uint"),n("OES_vertex_array_object"),n("ANGLE_instanced_arrays")),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture")},get:function(e){var t=n(e);return null===t&&console.warn("THREE.WebGLRenderer: "+e+" extension not supported."),t}}}function vc(e,t,n,r){var i={},a=new WeakMap;function o(e){var s=e.target;for(var l in null!==s.index&&t.remove(s.index),s.attributes)t.remove(s.attributes[l]);for(var u in s.morphAttributes)for(var c=s.morphAttributes[u],h=0,p=c.length;h<p;h++)t.remove(c[h]);s.removeEventListener("dispose",o),delete i[s.id];var d=a.get(s);d&&(t.remove(d),a.delete(s)),r.releaseStatesOfGeometry(s),!0===s.isInstancedBufferGeometry&&delete s._maxInstanceCount,n.memory.geometries--}function s(e){var n=[],r=e.index,i=e.attributes.position,o=0;if(null!==r){var s=r.array;o=r.version;for(var l=0,u=s.length;l<u;l+=3){var c=s[l+0],h=s[l+1],p=s[l+2];n.push(c,h,h,p,p,c)}}else{if(void 0===i)return;var d=i.array;o=i.version;for(var f=0,m=d.length/3-1;f<m;f+=3){var v=f+0,g=f+1,y=f+2;n.push(v,g,g,y,y,v)}}var _=new(Xr(n)?io:no)(n,1);_.version=o;var x=a.get(e);x&&t.remove(x),a.set(e,_)}return{get:function(e,t){return!0===i[t.id]?t:(t.addEventListener("dispose",o),i[t.id]=!0,n.memory.geometries++,t)},update:function(n){var r=n.attributes;for(var i in r)t.update(r[i],e.ARRAY_BUFFER);var a=n.morphAttributes;for(var o in a)for(var s=a[o],l=0,u=s.length;l<u;l++)t.update(s[l],e.ARRAY_BUFFER)},getWireframeAttribute:function(e){var t=a.get(e);if(t){var n=e.index;null!==n&&t.version<n.version&&s(e)}else s(e);return a.get(e)}}}function gc(e,t,n,r){var i,a,o,s=r.isWebGL2;this.setMode=function(e){i=e},this.setIndex=function(e){a=e.type,o=e.bytesPerElement},this.render=function(t,r){e.drawElements(i,r,a,t*o),n.update(r,i,1)},this.renderInstances=function(r,l,u){if(0!==u){var c,h;if(s)c=e,h="drawElementsInstanced";else if(h="drawElementsInstancedANGLE",null===(c=t.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");c[h](i,l,a,r*o,u),n.update(l,i,u)}}}function yc(e){var t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(n,r,i){switch(t.calls++,r){case e.TRIANGLES:t.triangles+=i*(n/3);break;case e.LINES:t.lines+=i*(n/2);break;case e.LINE_STRIP:t.lines+=i*(n-1);break;case e.LINE_LOOP:t.lines+=i*n;break;case e.POINTS:t.points+=i*n;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",r)}}}}function _c(e,t){return e[0]-t[0]}function xc(e,t){return Math.abs(t[1])-Math.abs(e[1])}function Mc(e,t,n){for(var r={},i=new Float32Array(8),a=new WeakMap,o=new pi,s=[],l=0;l<8;l++)s[l]=[l,0];return{update:function(l,u,c){var h=l.morphTargetInfluences;if(!0===t.isWebGL2){var p=u.morphAttributes.position||u.morphAttributes.normal||u.morphAttributes.color,d=void 0!==p?p.length:0,f=a.get(u);if(void 0===f||f.count!==d){void 0!==f&&f.texture.dispose();var m=void 0!==u.morphAttributes.position,v=void 0!==u.morphAttributes.normal,g=void 0!==u.morphAttributes.color,y=u.morphAttributes.position||[],_=u.morphAttributes.normal||[],x=u.morphAttributes.color||[],M=0;!0===m&&(M=1),!0===v&&(M=2),!0===g&&(M=3);var S=u.attributes.position.count*M,b=1;S>t.maxTextureSize&&(b=Math.ceil(S/t.maxTextureSize),S=t.maxTextureSize);var T=new Float32Array(S*b*4*d),E=new mi(T,S,b,d);E.type=ot,E.needsUpdate=!0;for(var w=4*M,A=0;A<d;A++)for(var R=y[A],C=_[A],k=x[A],L=S*b*4*A,P=0;P<R.count;P++){var I=P*w;!0===m&&(o.fromBufferAttribute(R,P),T[L+I+0]=o.x,T[L+I+1]=o.y,T[L+I+2]=o.z,T[L+I+3]=0),!0===v&&(o.fromBufferAttribute(C,P),T[L+I+4]=o.x,T[L+I+5]=o.y,T[L+I+6]=o.z,T[L+I+7]=0),!0===g&&(o.fromBufferAttribute(k,P),T[L+I+8]=o.x,T[L+I+9]=o.y,T[L+I+10]=o.z,T[L+I+11]=4===k.itemSize?o.w:1)}f={count:d,texture:E,size:new Hr(S,b)},a.set(u,f),u.addEventListener("dispose",function e(){E.dispose(),a.delete(u),u.removeEventListener("dispose",e)})}for(var U=0,D=0;D<h.length;D++)U+=h[D];var N=u.morphTargetsRelative?1:1-U;c.getUniforms().setValue(e,"morphTargetBaseInfluence",N),c.getUniforms().setValue(e,"morphTargetInfluences",h),c.getUniforms().setValue(e,"morphTargetsTexture",f.texture,n),c.getUniforms().setValue(e,"morphTargetsTextureSize",f.size)}else{var O=void 0===h?0:h.length,F=r[u.id];if(void 0===F||F.length!==O){F=[];for(var B=0;B<O;B++)F[B]=[B,0];r[u.id]=F}for(var z=0;z<O;z++){var G=F[z];G[0]=z,G[1]=h[z]}F.sort(xc);for(var H=0;H<8;H++)H<O&&F[H][1]?(s[H][0]=F[H][0],s[H][1]=F[H][1]):(s[H][0]=Number.MAX_SAFE_INTEGER,s[H][1]=0);s.sort(_c);for(var V=u.morphAttributes.position,W=u.morphAttributes.normal,X=0,j=0;j<8;j++){var q=s[j],Y=q[0],Z=q[1];Y!==Number.MAX_SAFE_INTEGER&&Z?(V&&u.getAttribute("morphTarget"+j)!==V[Y]&&u.setAttribute("morphTarget"+j,V[Y]),W&&u.getAttribute("morphNormal"+j)!==W[Y]&&u.setAttribute("morphNormal"+j,W[Y]),i[j]=Z,X+=Z):(V&&!0===u.hasAttribute("morphTarget"+j)&&u.deleteAttribute("morphTarget"+j),W&&!0===u.hasAttribute("morphNormal"+j)&&u.deleteAttribute("morphNormal"+j),i[j]=0)}var J=u.morphTargetsRelative?1:1-X;c.getUniforms().setValue(e,"morphTargetBaseInfluence",J),c.getUniforms().setValue(e,"morphTargetInfluences",i)}}}}function Sc(e,t,n,r){var i=new WeakMap;function a(e){var t=e.target;t.removeEventListener("dispose",a),n.remove(t.instanceMatrix),null!==t.instanceColor&&n.remove(t.instanceColor)}return{update:function(o){var s=r.render.frame,l=o.geometry,u=t.get(o,l);if(i.get(u)!==s&&(t.update(u),i.set(u,s)),o.isInstancedMesh&&(!1===o.hasEventListener("dispose",a)&&o.addEventListener("dispose",a),i.get(o)!==s&&(n.update(o.instanceMatrix,e.ARRAY_BUFFER),null!==o.instanceColor&&n.update(o.instanceColor,e.ARRAY_BUFFER),i.set(o,s))),o.isSkinnedMesh){var c=o.skeleton;i.get(c)!==s&&(c.update(),i.set(c,s))}return u},dispose:function(){i=new WeakMap}}}var bc=new hi,Tc=new mi,Ec=new gi,wc=new Ko,Ac=[],Rc=[],Cc=new Float32Array(16),kc=new Float32Array(9),Lc=new Float32Array(4);function Pc(e,t,n){var r=e[0];if(r<=0||r>0)return e;var i=t*n,a=Ac[i];if(void 0===a&&(a=new Float32Array(i),Ac[i]=a),0!==t){r.toArray(a,0);for(var o=1,s=0;o!==t;++o)s+=n,e[o].toArray(a,s)}return a}function Ic(e,t){if(e.length!==t.length)return!1;for(var n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0}function Uc(e,t){for(var n=0,r=t.length;n<r;n++)e[n]=t[n]}function Dc(e,t){var n=Rc[t];void 0===n&&(n=new Int32Array(t),Rc[t]=n);for(var r=0;r!==t;++r)n[r]=e.allocateTextureUnit();return n}function Nc(e,t){var n=this.cache;n[0]!==t&&(e.uniform1f(this.addr,t),n[0]=t)}function Oc(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(Ic(n,t))return;e.uniform2fv(this.addr,t),Uc(n,t)}}function Fc(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else if(void 0!==t.r)n[0]===t.r&&n[1]===t.g&&n[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),n[0]=t.r,n[1]=t.g,n[2]=t.b);else{if(Ic(n,t))return;e.uniform3fv(this.addr,t),Uc(n,t)}}function Bc(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(Ic(n,t))return;e.uniform4fv(this.addr,t),Uc(n,t)}}function zc(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(Ic(n,t))return;e.uniformMatrix2fv(this.addr,!1,t),Uc(n,t)}else{if(Ic(n,r))return;Lc.set(r),e.uniformMatrix2fv(this.addr,!1,Lc),Uc(n,r)}}function Gc(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(Ic(n,t))return;e.uniformMatrix3fv(this.addr,!1,t),Uc(n,t)}else{if(Ic(n,r))return;kc.set(r),e.uniformMatrix3fv(this.addr,!1,kc),Uc(n,r)}}function Hc(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(Ic(n,t))return;e.uniformMatrix4fv(this.addr,!1,t),Uc(n,t)}else{if(Ic(n,r))return;Cc.set(r),e.uniformMatrix4fv(this.addr,!1,Cc),Uc(n,r)}}function Vc(e,t){var n=this.cache;n[0]!==t&&(e.uniform1i(this.addr,t),n[0]=t)}function Wc(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2i(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(Ic(n,t))return;e.uniform2iv(this.addr,t),Uc(n,t)}}function Xc(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3i(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else{if(Ic(n,t))return;e.uniform3iv(this.addr,t),Uc(n,t)}}function jc(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4i(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(Ic(n,t))return;e.uniform4iv(this.addr,t),Uc(n,t)}}function qc(e,t){var n=this.cache;n[0]!==t&&(e.uniform1ui(this.addr,t),n[0]=t)}function Yc(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2ui(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(Ic(n,t))return;e.uniform2uiv(this.addr,t),Uc(n,t)}}function Zc(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3ui(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else{if(Ic(n,t))return;e.uniform3uiv(this.addr,t),Uc(n,t)}}function Jc(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4ui(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(Ic(n,t))return;e.uniform4uiv(this.addr,t),Uc(n,t)}}function Kc(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture2D(t||bc,i)}function Qc(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture3D(t||Ec,i)}function $c(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTextureCube(t||wc,i)}function eh(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture2DArray(t||Tc,i)}function th(e){switch(e){case 5126:return Nc;case 35664:return Oc;case 35665:return Fc;case 35666:return Bc;case 35674:return zc;case 35675:return Gc;case 35676:return Hc;case 5124:case 35670:return Vc;case 35667:case 35671:return Wc;case 35668:case 35672:return Xc;case 35669:case 35673:return jc;case 5125:return qc;case 36294:return Yc;case 36295:return Zc;case 36296:return Jc;case 35678:case 36198:case 36298:case 36306:case 35682:return Kc;case 35679:case 36299:case 36307:return Qc;case 35680:case 36300:case 36308:case 36293:return $c;case 36289:case 36303:case 36311:case 36292:return eh}}function nh(e,t){e.uniform1fv(this.addr,t)}function rh(e,t){var n=Pc(t,this.size,2);e.uniform2fv(this.addr,n)}function ih(e,t){var n=Pc(t,this.size,3);e.uniform3fv(this.addr,n)}function ah(e,t){var n=Pc(t,this.size,4);e.uniform4fv(this.addr,n)}function oh(e,t){var n=Pc(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,n)}function sh(e,t){var n=Pc(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,n)}function lh(e,t){var n=Pc(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,n)}function uh(e,t){e.uniform1iv(this.addr,t)}function ch(e,t){e.uniform2iv(this.addr,t)}function hh(e,t){e.uniform3iv(this.addr,t)}function ph(e,t){e.uniform4iv(this.addr,t)}function dh(e,t){e.uniform1uiv(this.addr,t)}function fh(e,t){e.uniform2uiv(this.addr,t)}function mh(e,t){e.uniform3uiv(this.addr,t)}function vh(e,t){e.uniform4uiv(this.addr,t)}function gh(e,t,n){var r=this.cache,i=t.length,a=Dc(n,i);Ic(r,a)||(e.uniform1iv(this.addr,a),Uc(r,a));for(var o=0;o!==i;++o)n.setTexture2D(t[o]||bc,a[o])}function yh(e,t,n){var r=this.cache,i=t.length,a=Dc(n,i);Ic(r,a)||(e.uniform1iv(this.addr,a),Uc(r,a));for(var o=0;o!==i;++o)n.setTexture3D(t[o]||Ec,a[o])}function _h(e,t,n){var r=this.cache,i=t.length,a=Dc(n,i);Ic(r,a)||(e.uniform1iv(this.addr,a),Uc(r,a));for(var o=0;o!==i;++o)n.setTextureCube(t[o]||wc,a[o])}function xh(e,t,n){var r=this.cache,i=t.length,a=Dc(n,i);Ic(r,a)||(e.uniform1iv(this.addr,a),Uc(r,a));for(var o=0;o!==i;++o)n.setTexture2DArray(t[o]||Tc,a[o])}function Mh(e){switch(e){case 5126:return nh;case 35664:return rh;case 35665:return ih;case 35666:return ah;case 35674:return oh;case 35675:return sh;case 35676:return lh;case 5124:case 35670:return uh;case 35667:case 35671:return ch;case 35668:case 35672:return hh;case 35669:case 35673:return ph;case 5125:return dh;case 36294:return fh;case 36295:return mh;case 36296:return vh;case 35678:case 36198:case 36298:case 36306:case 35682:return gh;case 35679:case 36299:case 36307:return yh;case 35680:case 36300:case 36308:case 36293:return _h;case 36289:case 36303:case 36311:case 36292:return xh}}var Sh=P(function e(t,n,r){k(this,e),this.id=t,this.addr=r,this.cache=[],this.setValue=th(n.type)}),bh=P(function e(t,n,r){k(this,e),this.id=t,this.addr=r,this.cache=[],this.size=n.size,this.setValue=Mh(n.type)}),Th=function(){function e(t){k(this,e),this.id=t,this.seq=[],this.map={}}return P(e,[{key:"setValue",value:function(e,t,n){for(var r=this.seq,i=0,a=r.length;i!==a;++i){var o=r[i];o.setValue(e,t[o.id],n)}}}]),e}(),Eh=/(\w+)(\])?(\[|\.)?/g;function wh(e,t){e.seq.push(t),e.map[t.id]=t}function Ah(e,t,n){var r=e.name,i=r.length;for(Eh.lastIndex=0;;){var a=Eh.exec(r),o=Eh.lastIndex,s=a[1],l="]"===a[2],u=a[3];if(l&&(s|=0),void 0===u||"["===u&&o+2===i){wh(n,void 0===u?new Sh(s,e,t):new bh(s,e,t));break}var c=n.map[s];void 0===c&&wh(n,c=new Th(s)),n=c}}var Rh=function(){function e(t,n){k(this,e),this.seq=[],this.map={};for(var r=t.getProgramParameter(n,t.ACTIVE_UNIFORMS),i=0;i<r;++i){var a=t.getActiveUniform(n,i);Ah(a,t.getUniformLocation(n,a.name),this)}}return P(e,[{key:"setValue",value:function(e,t,n,r){var i=this.map[t];void 0!==i&&i.setValue(e,n,r)}},{key:"setOptional",value:function(e,t,n){var r=t[n];void 0!==r&&this.setValue(e,n,r)}}],[{key:"upload",value:function(e,t,n,r){for(var i=0,a=t.length;i!==a;++i){var o=t[i],s=n[o.id];!1!==s.needsUpdate&&o.setValue(e,s.value,r)}}},{key:"seqWithValue",value:function(e,t){for(var n=[],r=0,i=e.length;r!==i;++r){var a=e[r];a.id in t&&n.push(a)}return n}}]),e}();function Ch(e,t,n){var r=e.createShader(t);return e.shaderSource(r,n),e.compileShader(r),r}var kh=0;function Lh(e,t){for(var n=e.split("\n"),r=[],i=Math.max(t-6,0),a=Math.min(t+6,n.length),o=i;o<a;o++){var s=o+1;r.push("".concat(s===t?">":" "," ").concat(s,": ").concat(n[o]))}return r.join("\n")}function Ph(e){var t,n=ri.getPrimaries(ri.workingColorSpace),r=ri.getPrimaries(e);switch(n===r?t="":n===Cn&&r===Rn?t="LinearDisplayP3ToLinearSRGB":n===Rn&&r===Cn&&(t="LinearSRGBToLinearDisplayP3"),e){case bn:case En:return[t,"LinearTransferOETF"];case Sn:case Tn:return[t,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",e),[t,"LinearTransferOETF"]}}function Ih(e,t,n){var r=e.getShaderParameter(t,e.COMPILE_STATUS),i=e.getShaderInfoLog(t).trim();if(r&&""===i)return"";var a=/ERROR: 0:(\d+)/.exec(i);if(a){var o=parseInt(a[1]);return n.toUpperCase()+"\n\n"+i+"\n\n"+Lh(e.getShaderSource(t),o)}return i}function Uh(e,t){var n=Ph(t);return"vec4 ".concat(e,"( vec4 value ) { return ").concat(n[0],"( ").concat(n[1],"( value ) ); }")}function Dh(e,t){var n;switch(t){case ke:n="Linear";break;case Le:n="Reinhard";break;case Pe:n="OptimizedCineon";break;case Ie:n="ACESFilmic";break;case Ue:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),n="Linear"}return"vec3 "+e+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function Nh(e){return[e.extensionDerivatives||e.envMapCubeUVHeight||e.bumpMap||e.normalMapTangentSpace||e.clearcoatNormalMap||e.flatShading||"physical"===e.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap||e.transmission)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Bh).join("\n")}function Oh(e){var t=[];for(var n in e){var r=e[n];!1!==r&&t.push("#define "+n+" "+r)}return t.join("\n")}function Fh(e,t){for(var n={},r=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),i=0;i<r;i++){var a=e.getActiveAttrib(t,i),o=a.name,s=1;a.type===e.FLOAT_MAT2&&(s=2),a.type===e.FLOAT_MAT3&&(s=3),a.type===e.FLOAT_MAT4&&(s=4),n[o]={type:a.type,location:e.getAttribLocation(t,o),locationSize:s}}return n}function Bh(e){return""!==e}function zh(e,t){var n=t.numSpotLightShadows+t.numSpotLightMaps-t.numSpotLightShadowsWithMaps;return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,t.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,t.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function Gh(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}var Hh=/^[ \t]*#include +<([\w\d./]+)>/gm;function Vh(e){return e.replace(Hh,Xh)}var Wh=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function Xh(e,t){var n=zu[t];if(void 0===n){var r=Wh.get(t);if(void 0===r)throw new Error("Can not resolve #include <"+t+">");n=zu[r],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',t,r)}return Vh(n)}var jh=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function qh(e){return e.replace(jh,Yh)}function Yh(e,t,n,r){for(var i="",a=parseInt(t);a<parseInt(n);a++)i+=r.replace(/\[\s*i\s*\]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a);return i}function Zh(e){var t="precision "+e.precision+" float;\nprecision "+e.precision+" int;";return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function Jh(e){var t="SHADOWMAP_TYPE_BASIC";return e.shadowMapType===V?t="SHADOWMAP_TYPE_PCF":e.shadowMapType===W?t="SHADOWMAP_TYPE_PCF_SOFT":e.shadowMapType===X&&(t="SHADOWMAP_TYPE_VSM"),t}function Kh(e){var t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case Ne:case Oe:t="ENVMAP_TYPE_CUBE";break;case ze:t="ENVMAP_TYPE_CUBE_UV"}return t}function Qh(e){var t="ENVMAP_MODE_REFLECTION";if(e.envMap)switch(e.envMapMode){case Oe:t="ENVMAP_MODE_REFRACTION"}return t}function $h(e){var t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case we:t="ENVMAP_BLENDING_MULTIPLY";break;case Ae:t="ENVMAP_BLENDING_MIX";break;case Re:t="ENVMAP_BLENDING_ADD"}return t}function ep(e){var t=e.envMapCubeUVHeight;if(null===t)return null;var n=Math.log2(t)-2,r=1/t;return{texelWidth:1/(3*Math.max(Math.pow(2,n),112)),texelHeight:r,maxMip:n}}function tp(e,t,n,r){var i,a,o=e.getContext(),s=n.defines,l=n.vertexShader,u=n.fragmentShader,c=Jh(n),h=Kh(n),p=Qh(n),d=$h(n),f=ep(n),m=n.isWebGL2?"":Nh(n),v=Oh(s),g=o.createProgram(),y=n.glslVersion?"#version "+n.glslVersion+"\n":"";n.isRawShaderMaterial?((i=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,v].filter(Bh).join("\n")).length>0&&(i+="\n"),(a=[m,"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,v].filter(Bh).join("\n")).length>0&&(a+="\n")):(i=[Zh(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,v,n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+p:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.displacementMap?"#define USE_DISPLACEMENTMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.mapUv?"#define MAP_UV "+n.mapUv:"",n.alphaMapUv?"#define ALPHAMAP_UV "+n.alphaMapUv:"",n.lightMapUv?"#define LIGHTMAP_UV "+n.lightMapUv:"",n.aoMapUv?"#define AOMAP_UV "+n.aoMapUv:"",n.emissiveMapUv?"#define EMISSIVEMAP_UV "+n.emissiveMapUv:"",n.bumpMapUv?"#define BUMPMAP_UV "+n.bumpMapUv:"",n.normalMapUv?"#define NORMALMAP_UV "+n.normalMapUv:"",n.displacementMapUv?"#define DISPLACEMENTMAP_UV "+n.displacementMapUv:"",n.metalnessMapUv?"#define METALNESSMAP_UV "+n.metalnessMapUv:"",n.roughnessMapUv?"#define ROUGHNESSMAP_UV "+n.roughnessMapUv:"",n.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+n.anisotropyMapUv:"",n.clearcoatMapUv?"#define CLEARCOATMAP_UV "+n.clearcoatMapUv:"",n.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+n.clearcoatNormalMapUv:"",n.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+n.clearcoatRoughnessMapUv:"",n.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+n.iridescenceMapUv:"",n.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+n.iridescenceThicknessMapUv:"",n.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+n.sheenColorMapUv:"",n.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+n.sheenRoughnessMapUv:"",n.specularMapUv?"#define SPECULARMAP_UV "+n.specularMapUv:"",n.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+n.specularColorMapUv:"",n.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+n.specularIntensityMapUv:"",n.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+n.transmissionMapUv:"",n.thicknessMapUv?"#define THICKNESSMAP_UV "+n.thicknessMapUv:"",n.vertexTangents&&!1===n.flatShading?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.morphColors&&n.isWebGL2?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+c:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.useLegacyLights?"#define LEGACY_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Bh).join("\n"),a=[m,Zh(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,v,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+h:"",n.envMap?"#define "+p:"",n.envMap?"#define "+d:"",f?"#define CUBEUV_TEXEL_WIDTH "+f.texelWidth:"",f?"#define CUBEUV_TEXEL_HEIGHT "+f.texelHeight:"",f?"#define CUBEUV_MAX_MIP "+f.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents&&!1===n.flatShading?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+c:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.useLegacyLights?"#define LEGACY_LIGHTS":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==Ce?"#define TONE_MAPPING":"",n.toneMapping!==Ce?zu.tonemapping_pars_fragment:"",n.toneMapping!==Ce?Dh("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",zu.colorspace_pars_fragment,Uh("linearToOutputTexel",n.outputColorSpace),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(Bh).join("\n")),l=Gh(l=zh(l=Vh(l),n),n),u=Gh(u=zh(u=Vh(u),n),n),l=qh(l),u=qh(u),n.isWebGL2&&!0!==n.isRawShaderMaterial&&(y="#version 300 es\n",i=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+i,a=["#define varying in",n.glslVersion===cr?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===cr?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+a);var _,x,M=y+i+l,S=y+a+u,b=Ch(o,o.VERTEX_SHADER,M),T=Ch(o,o.FRAGMENT_SHADER,S);if(o.attachShader(g,b),o.attachShader(g,T),void 0!==n.index0AttributeName?o.bindAttribLocation(g,0,n.index0AttributeName):!0===n.morphTargets&&o.bindAttribLocation(g,0,"position"),o.linkProgram(g),e.debug.checkShaderErrors){var E=o.getProgramInfoLog(g).trim(),w=o.getShaderInfoLog(b).trim(),A=o.getShaderInfoLog(T).trim(),R=!0,C=!0;if(!1===o.getProgramParameter(g,o.LINK_STATUS))if(R=!1,"function"==typeof e.debug.onShaderError)e.debug.onShaderError(o,g,b,T);else{var k=Ih(o,b,"vertex"),L=Ih(o,T,"fragment");console.error("THREE.WebGLProgram: Shader Error "+o.getError()+" - VALIDATE_STATUS "+o.getProgramParameter(g,o.VALIDATE_STATUS)+"\n\nProgram Info Log: "+E+"\n"+k+"\n"+L)}else""!==E?console.warn("THREE.WebGLProgram: Program Info Log:",E):""!==w&&""!==A||(C=!1);C&&(this.diagnostics={runnable:R,programLog:E,vertexShader:{log:w,prefix:i},fragmentShader:{log:A,prefix:a}})}return o.deleteShader(b),o.deleteShader(T),this.getUniforms=function(){return void 0===_&&(_=new Rh(o,g)),_},this.getAttributes=function(){return void 0===x&&(x=Fh(o,g)),x},this.destroy=function(){r.releaseStatesOfProgram(this),o.deleteProgram(g),this.program=void 0},this.type=n.shaderType,this.name=n.shaderName,this.id=kh++,this.cacheKey=t,this.usedTimes=1,this.program=g,this.vertexShader=b,this.fragmentShader=T,this}var np=0,rp=function(){function e(){k(this,e),this.shaderCache=new Map,this.materialCache=new Map}return P(e,[{key:"update",value:function(e){var t=e.vertexShader,n=e.fragmentShader,r=this._getShaderStage(t),i=this._getShaderStage(n),a=this._getShaderCacheForMaterial(e);return!1===a.has(r)&&(a.add(r),r.usedTimes++),!1===a.has(i)&&(a.add(i),i.usedTimes++),this}},{key:"remove",value:function(e){var t,n=s(this.materialCache.get(e));try{for(n.s();!(t=n.n()).done;){var r=t.value;r.usedTimes--,0===r.usedTimes&&this.shaderCache.delete(r.code)}}catch(i){n.e(i)}finally{n.f()}return this.materialCache.delete(e),this}},{key:"getVertexShaderID",value:function(e){return this._getShaderStage(e.vertexShader).id}},{key:"getFragmentShaderID",value:function(e){return this._getShaderStage(e.fragmentShader).id}},{key:"dispose",value:function(){this.shaderCache.clear(),this.materialCache.clear()}},{key:"_getShaderCacheForMaterial",value:function(e){var t=this.materialCache,n=t.get(e);return void 0===n&&(n=new Set,t.set(e,n)),n}},{key:"_getShaderStage",value:function(e){var t=this.shaderCache,n=t.get(e);return void 0===n&&(n=new ip(e),t.set(e,n)),n}}]),e}(),ip=P(function e(t){k(this,e),this.id=np++,this.code=t,this.usedTimes=0});function ap(e,t,n,r,i,a,o){var s=new la,l=new rp,u=[],c=i.isWebGL2,h=i.logarithmicDepthBuffer,p=i.vertexTextures,d=i.precision,f={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function m(e){return 0===e?"uv":"uv".concat(e)}return{getParameters:function(a,s,u,v,g){var y=v.fog,_=g.geometry,x=a.isMeshStandardMaterial?v.environment:null,M=(a.isMeshStandardMaterial?n:t).get(a.envMap||x),S=M&&M.mapping===ze?M.image.height:null,b=f[a.type];null!==a.precision&&(d=i.getMaxPrecision(a.precision))!==a.precision&&console.warn("THREE.WebGLProgram.getParameters:",a.precision,"not supported, using",d,"instead.");var T,E,w,A,R=_.morphAttributes.position||_.morphAttributes.normal||_.morphAttributes.color,C=void 0!==R?R.length:0,k=0;if(void 0!==_.morphAttributes.position&&(k=1),void 0!==_.morphAttributes.normal&&(k=2),void 0!==_.morphAttributes.color&&(k=3),b){var L=Hu[b];T=L.vertexShader,E=L.fragmentShader}else T=a.vertexShader,E=a.fragmentShader,l.update(a),w=l.getVertexShaderID(a),A=l.getFragmentShaderID(a);var P=e.getRenderTarget(),I=!0===g.isInstancedMesh,U=!!a.map,D=!!a.matcap,N=!!M,O=!!a.aoMap,F=!!a.lightMap,B=!!a.bumpMap,z=!!a.normalMap,G=!!a.displacementMap,H=!!a.emissiveMap,V=!!a.metalnessMap,W=!!a.roughnessMap,X=a.anisotropy>0,j=a.clearcoat>0,Z=a.iridescence>0,J=a.sheen>0,Q=a.transmission>0,$=X&&!!a.anisotropyMap,ee=j&&!!a.clearcoatMap,te=j&&!!a.clearcoatNormalMap,ne=j&&!!a.clearcoatRoughnessMap,re=Z&&!!a.iridescenceMap,ie=Z&&!!a.iridescenceThicknessMap,ae=J&&!!a.sheenColorMap,oe=J&&!!a.sheenRoughnessMap,se=!!a.specularMap,le=!!a.specularColorMap,ue=!!a.specularIntensityMap,ce=Q&&!!a.transmissionMap,he=Q&&!!a.thicknessMap,pe=!!a.gradientMap,de=!!a.alphaMap,fe=a.alphaTest>0,me=!!a.alphaHash,ve=!!a.extensions,ge=!!_.attributes.uv1,ye=!!_.attributes.uv2,_e=!!_.attributes.uv3,xe=Ce;return a.toneMapped&&(null!==P&&!0!==P.isXRRenderTarget||(xe=e.toneMapping)),{isWebGL2:c,shaderID:b,shaderType:a.type,shaderName:a.name,vertexShader:T,fragmentShader:E,defines:a.defines,customVertexShaderID:w,customFragmentShaderID:A,isRawShaderMaterial:!0===a.isRawShaderMaterial,glslVersion:a.glslVersion,precision:d,instancing:I,instancingColor:I&&null!==g.instanceColor,supportsVertexTextures:p,outputColorSpace:null===P?e.outputColorSpace:!0===P.isXRRenderTarget?P.texture.colorSpace:bn,map:U,matcap:D,envMap:N,envMapMode:N&&M.mapping,envMapCubeUVHeight:S,aoMap:O,lightMap:F,bumpMap:B,normalMap:z,displacementMap:p&&G,emissiveMap:H,normalMapObjectSpace:z&&a.normalMapType===xn,normalMapTangentSpace:z&&a.normalMapType===_n,metalnessMap:V,roughnessMap:W,anisotropy:X,anisotropyMap:$,clearcoat:j,clearcoatMap:ee,clearcoatNormalMap:te,clearcoatRoughnessMap:ne,iridescence:Z,iridescenceMap:re,iridescenceThicknessMap:ie,sheen:J,sheenColorMap:ae,sheenRoughnessMap:oe,specularMap:se,specularColorMap:le,specularIntensityMap:ue,transmission:Q,transmissionMap:ce,thicknessMap:he,gradientMap:pe,opaque:!1===a.transparent&&a.blending===K,alphaMap:de,alphaTest:fe,alphaHash:me,combine:a.combine,mapUv:U&&m(a.map.channel),aoMapUv:O&&m(a.aoMap.channel),lightMapUv:F&&m(a.lightMap.channel),bumpMapUv:B&&m(a.bumpMap.channel),normalMapUv:z&&m(a.normalMap.channel),displacementMapUv:G&&m(a.displacementMap.channel),emissiveMapUv:H&&m(a.emissiveMap.channel),metalnessMapUv:V&&m(a.metalnessMap.channel),roughnessMapUv:W&&m(a.roughnessMap.channel),anisotropyMapUv:$&&m(a.anisotropyMap.channel),clearcoatMapUv:ee&&m(a.clearcoatMap.channel),clearcoatNormalMapUv:te&&m(a.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:ne&&m(a.clearcoatRoughnessMap.channel),iridescenceMapUv:re&&m(a.iridescenceMap.channel),iridescenceThicknessMapUv:ie&&m(a.iridescenceThicknessMap.channel),sheenColorMapUv:ae&&m(a.sheenColorMap.channel),sheenRoughnessMapUv:oe&&m(a.sheenRoughnessMap.channel),specularMapUv:se&&m(a.specularMap.channel),specularColorMapUv:le&&m(a.specularColorMap.channel),specularIntensityMapUv:ue&&m(a.specularIntensityMap.channel),transmissionMapUv:ce&&m(a.transmissionMap.channel),thicknessMapUv:he&&m(a.thicknessMap.channel),alphaMapUv:de&&m(a.alphaMap.channel),vertexTangents:!!_.attributes.tangent&&(z||X),vertexColors:a.vertexColors,vertexAlphas:!0===a.vertexColors&&!!_.attributes.color&&4===_.attributes.color.itemSize,vertexUv1s:ge,vertexUv2s:ye,vertexUv3s:_e,pointsUvs:!0===g.isPoints&&!!_.attributes.uv&&(U||de),fog:!!y,useFog:!0===a.fog,fogExp2:y&&y.isFogExp2,flatShading:!0===a.flatShading,sizeAttenuation:!0===a.sizeAttenuation,logarithmicDepthBuffer:h,skinning:!0===g.isSkinnedMesh,morphTargets:void 0!==_.morphAttributes.position,morphNormals:void 0!==_.morphAttributes.normal,morphColors:void 0!==_.morphAttributes.color,morphTargetsCount:C,morphTextureStride:k,numDirLights:s.directional.length,numPointLights:s.point.length,numSpotLights:s.spot.length,numSpotLightMaps:s.spotLightMap.length,numRectAreaLights:s.rectArea.length,numHemiLights:s.hemi.length,numDirLightShadows:s.directionalShadowMap.length,numPointLightShadows:s.pointShadowMap.length,numSpotLightShadows:s.spotShadowMap.length,numSpotLightShadowsWithMaps:s.numSpotLightShadowsWithMaps,numLightProbes:s.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:a.dithering,shadowMapEnabled:e.shadowMap.enabled&&u.length>0,shadowMapType:e.shadowMap.type,toneMapping:xe,useLegacyLights:e._useLegacyLights,decodeVideoTexture:U&&!0===a.map.isVideoTexture&&ri.getTransfer(a.map.colorSpace)===An,premultipliedAlpha:a.premultipliedAlpha,doubleSided:a.side===Y,flipSided:a.side===q,useDepthPacking:a.depthPacking>=0,depthPacking:a.depthPacking||0,index0AttributeName:a.index0AttributeName,extensionDerivatives:ve&&!0===a.extensions.derivatives,extensionFragDepth:ve&&!0===a.extensions.fragDepth,extensionDrawBuffers:ve&&!0===a.extensions.drawBuffers,extensionShaderTextureLOD:ve&&!0===a.extensions.shaderTextureLOD,rendererExtensionFragDepth:c||r.has("EXT_frag_depth"),rendererExtensionDrawBuffers:c||r.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:c||r.has("EXT_shader_texture_lod"),customProgramCacheKey:a.customProgramCacheKey()}},getProgramCacheKey:function(t){var n=[];if(t.shaderID?n.push(t.shaderID):(n.push(t.customVertexShaderID),n.push(t.customFragmentShaderID)),void 0!==t.defines)for(var r in t.defines)n.push(r),n.push(t.defines[r]);return!1===t.isRawShaderMaterial&&(function(e,t){e.push(t.precision),e.push(t.outputColorSpace),e.push(t.envMapMode),e.push(t.envMapCubeUVHeight),e.push(t.mapUv),e.push(t.alphaMapUv),e.push(t.lightMapUv),e.push(t.aoMapUv),e.push(t.bumpMapUv),e.push(t.normalMapUv),e.push(t.displacementMapUv),e.push(t.emissiveMapUv),e.push(t.metalnessMapUv),e.push(t.roughnessMapUv),e.push(t.anisotropyMapUv),e.push(t.clearcoatMapUv),e.push(t.clearcoatNormalMapUv),e.push(t.clearcoatRoughnessMapUv),e.push(t.iridescenceMapUv),e.push(t.iridescenceThicknessMapUv),e.push(t.sheenColorMapUv),e.push(t.sheenRoughnessMapUv),e.push(t.specularMapUv),e.push(t.specularColorMapUv),e.push(t.specularIntensityMapUv),e.push(t.transmissionMapUv),e.push(t.thicknessMapUv),e.push(t.combine),e.push(t.fogExp2),e.push(t.sizeAttenuation),e.push(t.morphTargetsCount),e.push(t.morphAttributeCount),e.push(t.numDirLights),e.push(t.numPointLights),e.push(t.numSpotLights),e.push(t.numSpotLightMaps),e.push(t.numHemiLights),e.push(t.numRectAreaLights),e.push(t.numDirLightShadows),e.push(t.numPointLightShadows),e.push(t.numSpotLightShadows),e.push(t.numSpotLightShadowsWithMaps),e.push(t.numLightProbes),e.push(t.shadowMapType),e.push(t.toneMapping),e.push(t.numClippingPlanes),e.push(t.numClipIntersection),e.push(t.depthPacking)}(n,t),function(e,t){s.disableAll(),t.isWebGL2&&s.enable(0),t.supportsVertexTextures&&s.enable(1),t.instancing&&s.enable(2),t.instancingColor&&s.enable(3),t.matcap&&s.enable(4),t.envMap&&s.enable(5),t.normalMapObjectSpace&&s.enable(6),t.normalMapTangentSpace&&s.enable(7),t.clearcoat&&s.enable(8),t.iridescence&&s.enable(9),t.alphaTest&&s.enable(10),t.vertexColors&&s.enable(11),t.vertexAlphas&&s.enable(12),t.vertexUv1s&&s.enable(13),t.vertexUv2s&&s.enable(14),t.vertexUv3s&&s.enable(15),t.vertexTangents&&s.enable(16),t.anisotropy&&s.enable(17),e.push(s.mask),s.disableAll(),t.fog&&s.enable(0),t.useFog&&s.enable(1),t.flatShading&&s.enable(2),t.logarithmicDepthBuffer&&s.enable(3),t.skinning&&s.enable(4),t.morphTargets&&s.enable(5),t.morphNormals&&s.enable(6),t.morphColors&&s.enable(7),t.premultipliedAlpha&&s.enable(8),t.shadowMapEnabled&&s.enable(9),t.useLegacyLights&&s.enable(10),t.doubleSided&&s.enable(11),t.flipSided&&s.enable(12),t.useDepthPacking&&s.enable(13),t.dithering&&s.enable(14),t.transmission&&s.enable(15),t.sheen&&s.enable(16),t.opaque&&s.enable(17),t.pointsUvs&&s.enable(18),t.decodeVideoTexture&&s.enable(19),e.push(s.mask)}(n,t),n.push(e.outputColorSpace)),n.push(t.customProgramCacheKey),n.join()},getUniforms:function(e){var t,n=f[e.type];if(n){var r=Hu[n];t=Ho.clone(r.uniforms)}else t=e.uniforms;return t},acquireProgram:function(t,n){for(var r,i=0,o=u.length;i<o;i++){var s=u[i];if(s.cacheKey===n){++(r=s).usedTimes;break}}return void 0===r&&(r=new tp(e,n,t,a),u.push(r)),r},releaseProgram:function(e){if(0==--e.usedTimes){var t=u.indexOf(e);u[t]=u[u.length-1],u.pop(),e.destroy()}},releaseShaderCache:function(e){l.remove(e)},programs:u,dispose:function(){l.dispose()}}}function op(){var e=new WeakMap;return{get:function(t){var n=e.get(t);return void 0===n&&(n={},e.set(t,n)),n},remove:function(t){e.delete(t)},update:function(t,n,r){e.get(t)[n]=r},dispose:function(){e=new WeakMap}}}function sp(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function lp(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function up(){var e=[],t=0,n=[],r=[],i=[];function a(n,r,i,a,o,s){var l=e[t];return void 0===l?(l={id:n.id,object:n,geometry:r,material:i,groupOrder:a,renderOrder:n.renderOrder,z:o,group:s},e[t]=l):(l.id=n.id,l.object=n,l.geometry=r,l.material=i,l.groupOrder=a,l.renderOrder=n.renderOrder,l.z=o,l.group=s),t++,l}return{opaque:n,transmissive:r,transparent:i,init:function(){t=0,n.length=0,r.length=0,i.length=0},push:function(e,t,o,s,l,u){var c=a(e,t,o,s,l,u);o.transmission>0?r.push(c):!0===o.transparent?i.push(c):n.push(c)},unshift:function(e,t,o,s,l,u){var c=a(e,t,o,s,l,u);o.transmission>0?r.unshift(c):!0===o.transparent?i.unshift(c):n.unshift(c)},finish:function(){for(var n=t,r=e.length;n<r;n++){var i=e[n];if(null===i.id)break;i.id=null,i.object=null,i.geometry=null,i.material=null,i.group=null}},sort:function(e,t){n.length>1&&n.sort(e||sp),r.length>1&&r.sort(t||lp),i.length>1&&i.sort(t||lp)}}}function cp(){var e=new WeakMap;return{get:function(t,n){var r,i=e.get(t);return void 0===i?(r=new up,e.set(t,[r])):n>=i.length?(r=new up,i.push(r)):r=i[n],r},dispose:function(){e=new WeakMap}}}function hp(){var e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];var n;switch(t.type){case"DirectionalLight":n={direction:new Mi,color:new Ga};break;case"SpotLight":n={position:new Mi,direction:new Mi,color:new Ga,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new Mi,color:new Ga,distance:0,decay:0};break;case"HemisphereLight":n={direction:new Mi,skyColor:new Ga,groundColor:new Ga};break;case"RectAreaLight":n={color:new Ga,position:new Mi,halfWidth:new Mi,halfHeight:new Mi}}return e[t.id]=n,n}}}function pp(){var e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];var n;switch(t.type){case"DirectionalLight":case"SpotLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Hr};break;case"PointLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Hr,shadowCameraNear:1,shadowCameraFar:1e3}}return e[t.id]=n,n}}}var dp=0;function fp(e,t){return(t.castShadow?2:0)-(e.castShadow?2:0)+(t.map?1:0)-(e.map?1:0)}function mp(e,t){for(var n=new hp,r=pp(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0},a=0;a<9;a++)i.probe.push(new Mi);var o=new Mi,s=new Ki,l=new Ki;return{setup:function(a,o){for(var s=0,l=0,u=0,c=0;c<9;c++)i.probe[c].set(0,0,0);var h=0,p=0,d=0,f=0,m=0,v=0,g=0,y=0,_=0,x=0,M=0;a.sort(fp);for(var S=!0===o?Math.PI:1,b=0,T=a.length;b<T;b++){var E=a[b],w=E.color,A=E.intensity,R=E.distance,C=E.shadow&&E.shadow.map?E.shadow.map.texture:null;if(E.isAmbientLight)s+=w.r*A*S,l+=w.g*A*S,u+=w.b*A*S;else if(E.isLightProbe){for(var k=0;k<9;k++)i.probe[k].addScaledVector(E.sh.coefficients[k],A);M++}else if(E.isDirectionalLight){var L=n.get(E);if(L.color.copy(E.color).multiplyScalar(E.intensity*S),E.castShadow){var P=E.shadow,I=r.get(E);I.shadowBias=P.bias,I.shadowNormalBias=P.normalBias,I.shadowRadius=P.radius,I.shadowMapSize=P.mapSize,i.directionalShadow[h]=I,i.directionalShadowMap[h]=C,i.directionalShadowMatrix[h]=E.shadow.matrix,v++}i.directional[h]=L,h++}else if(E.isSpotLight){var U=n.get(E);U.position.setFromMatrixPosition(E.matrixWorld),U.color.copy(w).multiplyScalar(A*S),U.distance=R,U.coneCos=Math.cos(E.angle),U.penumbraCos=Math.cos(E.angle*(1-E.penumbra)),U.decay=E.decay,i.spot[d]=U;var D=E.shadow;if(E.map&&(i.spotLightMap[_]=E.map,_++,D.updateMatrices(E),E.castShadow&&x++),i.spotLightMatrix[d]=D.matrix,E.castShadow){var N=r.get(E);N.shadowBias=D.bias,N.shadowNormalBias=D.normalBias,N.shadowRadius=D.radius,N.shadowMapSize=D.mapSize,i.spotShadow[d]=N,i.spotShadowMap[d]=C,y++}d++}else if(E.isRectAreaLight){var O=n.get(E);O.color.copy(w).multiplyScalar(A),O.halfWidth.set(.5*E.width,0,0),O.halfHeight.set(0,.5*E.height,0),i.rectArea[f]=O,f++}else if(E.isPointLight){var F=n.get(E);if(F.color.copy(E.color).multiplyScalar(E.intensity*S),F.distance=E.distance,F.decay=E.decay,E.castShadow){var B=E.shadow,z=r.get(E);z.shadowBias=B.bias,z.shadowNormalBias=B.normalBias,z.shadowRadius=B.radius,z.shadowMapSize=B.mapSize,z.shadowCameraNear=B.camera.near,z.shadowCameraFar=B.camera.far,i.pointShadow[p]=z,i.pointShadowMap[p]=C,i.pointShadowMatrix[p]=E.shadow.matrix,g++}i.point[p]=F,p++}else if(E.isHemisphereLight){var G=n.get(E);G.skyColor.copy(E.color).multiplyScalar(A*S),G.groundColor.copy(E.groundColor).multiplyScalar(A*S),i.hemi[m]=G,m++}}f>0&&(t.isWebGL2?(i.rectAreaLTC1=Gu.LTC_FLOAT_1,i.rectAreaLTC2=Gu.LTC_FLOAT_2):!0===e.has("OES_texture_float_linear")?(i.rectAreaLTC1=Gu.LTC_FLOAT_1,i.rectAreaLTC2=Gu.LTC_FLOAT_2):!0===e.has("OES_texture_half_float_linear")?(i.rectAreaLTC1=Gu.LTC_HALF_1,i.rectAreaLTC2=Gu.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),i.ambient[0]=s,i.ambient[1]=l,i.ambient[2]=u;var H=i.hash;H.directionalLength===h&&H.pointLength===p&&H.spotLength===d&&H.rectAreaLength===f&&H.hemiLength===m&&H.numDirectionalShadows===v&&H.numPointShadows===g&&H.numSpotShadows===y&&H.numSpotMaps===_&&H.numLightProbes===M||(i.directional.length=h,i.spot.length=d,i.rectArea.length=f,i.point.length=p,i.hemi.length=m,i.directionalShadow.length=v,i.directionalShadowMap.length=v,i.pointShadow.length=g,i.pointShadowMap.length=g,i.spotShadow.length=y,i.spotShadowMap.length=y,i.directionalShadowMatrix.length=v,i.pointShadowMatrix.length=g,i.spotLightMatrix.length=y+_-x,i.spotLightMap.length=_,i.numSpotLightShadowsWithMaps=x,i.numLightProbes=M,H.directionalLength=h,H.pointLength=p,H.spotLength=d,H.rectAreaLength=f,H.hemiLength=m,H.numDirectionalShadows=v,H.numPointShadows=g,H.numSpotShadows=y,H.numSpotMaps=_,H.numLightProbes=M,i.version=dp++)},setupView:function(e,t){for(var n=0,r=0,a=0,u=0,c=0,h=t.matrixWorldInverse,p=0,d=e.length;p<d;p++){var f=e[p];if(f.isDirectionalLight){var m=i.directional[n];m.direction.setFromMatrixPosition(f.matrixWorld),o.setFromMatrixPosition(f.target.matrixWorld),m.direction.sub(o),m.direction.transformDirection(h),n++}else if(f.isSpotLight){var v=i.spot[a];v.position.setFromMatrixPosition(f.matrixWorld),v.position.applyMatrix4(h),v.direction.setFromMatrixPosition(f.matrixWorld),o.setFromMatrixPosition(f.target.matrixWorld),v.direction.sub(o),v.direction.transformDirection(h),a++}else if(f.isRectAreaLight){var g=i.rectArea[u];g.position.setFromMatrixPosition(f.matrixWorld),g.position.applyMatrix4(h),l.identity(),s.copy(f.matrixWorld),s.premultiply(h),l.extractRotation(s),g.halfWidth.set(.5*f.width,0,0),g.halfHeight.set(0,.5*f.height,0),g.halfWidth.applyMatrix4(l),g.halfHeight.applyMatrix4(l),u++}else if(f.isPointLight){var y=i.point[r];y.position.setFromMatrixPosition(f.matrixWorld),y.position.applyMatrix4(h),r++}else if(f.isHemisphereLight){var _=i.hemi[c];_.direction.setFromMatrixPosition(f.matrixWorld),_.direction.transformDirection(h),c++}}},state:i}}function vp(e,t){var n=new mp(e,t),r=[],i=[];return{init:function(){r.length=0,i.length=0},state:{lightsArray:r,shadowsArray:i,lights:n},setupLights:function(e){n.setup(r,e)},setupLightsView:function(e){n.setupView(r,e)},pushLight:function(e){r.push(e)},pushShadow:function(e){i.push(e)}}}function gp(e,t){var n=new WeakMap;return{get:function(r,i=0){var a,o=n.get(r);return void 0===o?(a=new vp(e,t),n.set(r,[a])):i>=o.length?(a=new vp(e,t),o.push(a)):a=o[i],a},dispose:function(){n=new WeakMap}}}var yp=exports.MeshDepthMaterial=function(e){x(n,Na);var t=S(n);function n(e){var r;return k(this,n),(r=t.call(this)).isMeshDepthMaterial=!0,r.type="MeshDepthMaterial",r.depthPacking=gn,r.map=null,r.alphaMap=null,r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.wireframe=!1,r.wireframeLinewidth=1,r.setValues(e),r}return P(n,[{key:"copy",value:function(e){return p(w(n.prototype),"copy",this).call(this,e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}]),n}(),_p=exports.MeshDistanceMaterial=function(e){x(n,Na);var t=S(n);function n(e){var r;return k(this,n),(r=t.call(this)).isMeshDistanceMaterial=!0,r.type="MeshDistanceMaterial",r.map=null,r.alphaMap=null,r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.setValues(e),r}return P(n,[{key:"copy",value:function(e){return p(w(n.prototype),"copy",this).call(this,e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}]),n}(),xp="void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",Mp="uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}";function Sp(e,t,n){var r,i=new as,a=new Hr,o=new Hr,s=new pi,l=new yp({depthPacking:yn}),u=new _p,c={},h=n.maxTextureSize,p=(A(r={},j,q),A(r,q,j),A(r,Y,Y),r),d=new Xo({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Hr},radius:{value:4}},vertexShader:xp,fragmentShader:Mp}),f=d.clone();f.defines.HORIZONTAL_PASS=1;var m=new vo;m.setAttribute("position",new Ka(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));var v=new Uo(m,d),g=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=V;var y=this.type;function _(n,r){var i=t.update(v);d.defines.VSM_SAMPLES!==n.blurSamples&&(d.defines.VSM_SAMPLES=n.blurSamples,f.defines.VSM_SAMPLES=n.blurSamples,d.needsUpdate=!0,f.needsUpdate=!0),null===n.mapPass&&(n.mapPass=new fi(a.x,a.y)),d.uniforms.shadow_pass.value=n.map.texture,d.uniforms.resolution.value=n.mapSize,d.uniforms.radius.value=n.radius,e.setRenderTarget(n.mapPass),e.clear(),e.renderBufferDirect(r,null,i,d,v,null),f.uniforms.shadow_pass.value=n.mapPass.texture,f.uniforms.resolution.value=n.mapSize,f.uniforms.radius.value=n.radius,e.setRenderTarget(n.map),e.clear(),e.renderBufferDirect(r,null,i,f,v,null)}function x(t,n,r,i){var a=null,o=!0===r.isPointLight?t.customDistanceMaterial:t.customDepthMaterial;if(void 0!==o)a=o;else if(a=!0===r.isPointLight?u:l,e.localClippingEnabled&&!0===n.clipShadows&&Array.isArray(n.clippingPlanes)&&0!==n.clippingPlanes.length||n.displacementMap&&0!==n.displacementScale||n.alphaMap&&n.alphaTest>0||n.map&&n.alphaTest>0){var s=a.uuid,h=n.uuid,d=c[s];void 0===d&&(d={},c[s]=d);var f=d[h];void 0===f&&(f=a.clone(),d[h]=f),a=f}(a.visible=n.visible,a.wireframe=n.wireframe,a.side=i===X?null!==n.shadowSide?n.shadowSide:n.side:null!==n.shadowSide?n.shadowSide:p[n.side],a.alphaMap=n.alphaMap,a.alphaTest=n.alphaTest,a.map=n.map,a.clipShadows=n.clipShadows,a.clippingPlanes=n.clippingPlanes,a.clipIntersection=n.clipIntersection,a.displacementMap=n.displacementMap,a.displacementScale=n.displacementScale,a.displacementBias=n.displacementBias,a.wireframeLinewidth=n.wireframeLinewidth,a.linewidth=n.linewidth,!0===r.isPointLight&&!0===a.isMeshDistanceMaterial)&&(e.properties.get(a).light=r);return a}function M(n,r,a,o,s){if(!1!==n.visible){if(n.layers.test(r.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&s===X)&&(!n.frustumCulled||i.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(a.matrixWorldInverse,n.matrixWorld);var l=t.update(n),u=n.material;if(Array.isArray(u))for(var c=l.groups,h=0,p=c.length;h<p;h++){var d=c[h],f=u[d.materialIndex];if(f&&f.visible){var m=x(n,f,o,s);e.renderBufferDirect(a,null,l,m,n,d)}}else if(u.visible){var v=x(n,u,o,s);e.renderBufferDirect(a,null,l,v,n,null)}}for(var g=n.children,y=0,_=g.length;y<_;y++)M(g[y],r,a,o,s)}}this.render=function(t,n,r){if(!1!==g.enabled&&(!1!==g.autoUpdate||!1!==g.needsUpdate)&&0!==t.length){var l=e.getRenderTarget(),u=e.getActiveCubeFace(),c=e.getActiveMipmapLevel(),p=e.state;p.setBlending(J),p.buffers.color.setClear(1,1,1,1),p.buffers.depth.setTest(!0),p.setScissorTest(!1);for(var d=y!==X&&this.type===X,f=y===X&&this.type!==X,m=0,v=t.length;m<v;m++){var x=t[m],S=x.shadow;if(void 0!==S){if(!1!==S.autoUpdate||!1!==S.needsUpdate){a.copy(S.mapSize);var b=S.getFrameExtents();if(a.multiply(b),o.copy(S.mapSize),(a.x>h||a.y>h)&&(a.x>h&&(o.x=Math.floor(h/b.x),a.x=o.x*b.x,S.mapSize.x=o.x),a.y>h&&(o.y=Math.floor(h/b.y),a.y=o.y*b.y,S.mapSize.y=o.y)),null===S.map||!0===d||!0===f){var T=this.type!==X?{minFilter:We,magFilter:We}:{};null!==S.map&&S.map.dispose(),S.map=new fi(a.x,a.y,T),S.map.texture.name=x.name+".shadowMap",S.camera.updateProjectionMatrix()}e.setRenderTarget(S.map),e.clear();for(var E=S.getViewportCount(),w=0;w<E;w++){var A=S.getViewport(w);s.set(o.x*A.x,o.y*A.y,o.x*A.z,o.y*A.w),p.viewport(s),S.updateMatrices(x,w),i=S.getFrustum(),M(n,r,S.camera,x,this.type)}!0!==S.isPointLightShadow&&this.type===X&&_(S,r),S.needsUpdate=!1}}else console.warn("THREE.WebGLShadowMap:",x,"has no shadow.")}y=this.type,g.needsUpdate=!1,e.setRenderTarget(l,u,c)}}}function bp(e,t,n){var r,i,a=n.isWebGL2;var o=new function(){var t=!1,n=new pi,r=null,i=new pi(0,0,0,0);return{setMask:function(n){r===n||t||(e.colorMask(n,n,n,n),r=n)},setLocked:function(e){t=e},setClear:function(t,r,a,o,s){!0===s&&(t*=o,r*=o,a*=o),n.set(t,r,a,o),!1===i.equals(n)&&(e.clearColor(t,r,a,o),i.copy(n))},reset:function(){t=!1,r=null,i.set(-1,0,0,0)}}},s=new function(){var t=!1,n=null,r=null,i=null;return{setTest:function(t){t?j(e.DEPTH_TEST):Z(e.DEPTH_TEST)},setMask:function(r){n===r||t||(e.depthMask(r),n=r)},setFunc:function(t){if(r!==t){switch(t){case ye:e.depthFunc(e.NEVER);break;case _e:e.depthFunc(e.ALWAYS);break;case xe:e.depthFunc(e.LESS);break;case Me:e.depthFunc(e.LEQUAL);break;case Se:e.depthFunc(e.EQUAL);break;case be:e.depthFunc(e.GEQUAL);break;case Te:e.depthFunc(e.GREATER);break;case Ee:e.depthFunc(e.NOTEQUAL);break;default:e.depthFunc(e.LEQUAL)}r=t}},setLocked:function(e){t=e},setClear:function(t){i!==t&&(e.clearDepth(t),i=t)},reset:function(){t=!1,n=null,r=null,i=null}}},l=new function(){var t=!1,n=null,r=null,i=null,a=null,o=null,s=null,l=null,u=null;return{setTest:function(n){t||(n?j(e.STENCIL_TEST):Z(e.STENCIL_TEST))},setMask:function(r){n===r||t||(e.stencilMask(r),n=r)},setFunc:function(t,n,o){r===t&&i===n&&a===o||(e.stencilFunc(t,n,o),r=t,i=n,a=o)},setOp:function(t,n,r){o===t&&s===n&&l===r||(e.stencilOp(t,n,r),o=t,s=n,l=r)},setLocked:function(e){t=e},setClear:function(t){u!==t&&(e.clearStencil(t),u=t)},reset:function(){t=!1,n=null,r=null,i=null,a=null,o=null,s=null,l=null,u=null}}},u=new WeakMap,c=new WeakMap,h={},p={},d=new WeakMap,f=[],m=null,v=!1,g=null,y=null,_=null,x=null,M=null,S=null,b=null,T=!1,E=null,w=null,R=null,C=null,k=null,L=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS),P=!1,I=0,U=e.getParameter(e.VERSION);-1!==U.indexOf("WebGL")?(I=parseFloat(/^WebGL (\d)/.exec(U)[1]),P=I>=1):-1!==U.indexOf("OpenGL ES")&&(I=parseFloat(/^OpenGL ES (\d)/.exec(U)[1]),P=I>=2);var D=null,N={},O=e.getParameter(e.SCISSOR_BOX),G=e.getParameter(e.VIEWPORT),H=(new pi).fromArray(O),V=(new pi).fromArray(G);function W(t,n,r,i){var o=new Uint8Array(4),s=e.createTexture();e.bindTexture(t,s),e.texParameteri(t,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(t,e.TEXTURE_MAG_FILTER,e.NEAREST);for(var l=0;l<r;l++)!a||t!==e.TEXTURE_3D&&t!==e.TEXTURE_2D_ARRAY?e.texImage2D(n+l,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,o):e.texImage3D(n,0,e.RGBA,1,1,i,0,e.RGBA,e.UNSIGNED_BYTE,o);return s}var X={};function j(t){!0!==h[t]&&(e.enable(t),h[t]=!0)}function Z(t){!1!==h[t]&&(e.disable(t),h[t]=!1)}X[e.TEXTURE_2D]=W(e.TEXTURE_2D,e.TEXTURE_2D,1),X[e.TEXTURE_CUBE_MAP]=W(e.TEXTURE_CUBE_MAP,e.TEXTURE_CUBE_MAP_POSITIVE_X,6),a&&(X[e.TEXTURE_2D_ARRAY]=W(e.TEXTURE_2D_ARRAY,e.TEXTURE_2D_ARRAY,1,1),X[e.TEXTURE_3D]=W(e.TEXTURE_3D,e.TEXTURE_3D,1,1)),o.setClear(0,0,0,1),s.setClear(1),l.setClear(0),j(e.DEPTH_TEST),s.setFunc(Me),ke(!1),Le(B),j(e.CULL_FACE),Ce(J);var we=(A(r={},ne,e.FUNC_ADD),A(r,re,e.FUNC_SUBTRACT),A(r,ie,e.FUNC_REVERSE_SUBTRACT),r);if(a)we[ae]=e.MIN,we[oe]=e.MAX;else{var Ae=t.get("EXT_blend_minmax");null!==Ae&&(we[ae]=Ae.MIN_EXT,we[oe]=Ae.MAX_EXT)}var Re=(A(i={},se,e.ZERO),A(i,le,e.ONE),A(i,ue,e.SRC_COLOR),A(i,he,e.SRC_ALPHA),A(i,ge,e.SRC_ALPHA_SATURATE),A(i,me,e.DST_COLOR),A(i,de,e.DST_ALPHA),A(i,ce,e.ONE_MINUS_SRC_COLOR),A(i,pe,e.ONE_MINUS_SRC_ALPHA),A(i,ve,e.ONE_MINUS_DST_COLOR),A(i,fe,e.ONE_MINUS_DST_ALPHA),i);function Ce(t,n,r,i,a,o,s,l){if(t!==J){if(!1===v&&(j(e.BLEND),v=!0),t===te)a=a||n,o=o||r,s=s||i,n===y&&a===M||(e.blendEquationSeparate(we[n],we[a]),y=n,M=a),r===_&&i===x&&o===S&&s===b||(e.blendFuncSeparate(Re[r],Re[i],Re[o],Re[s]),_=r,x=i,S=o,b=s),g=t,T=!1;else if(t!==g||l!==T){if(y===ne&&M===ne||(e.blendEquation(e.FUNC_ADD),y=ne,M=ne),l)switch(t){case K:e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case Q:e.blendFunc(e.ONE,e.ONE);break;case $:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case ee:e.blendFuncSeparate(e.ZERO,e.SRC_COLOR,e.ZERO,e.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case K:e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case Q:e.blendFunc(e.SRC_ALPHA,e.ONE);break;case $:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case ee:e.blendFunc(e.ZERO,e.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}_=null,x=null,S=null,b=null,g=t,T=l}}else!0===v&&(Z(e.BLEND),v=!1)}function ke(t){E!==t&&(t?e.frontFace(e.CW):e.frontFace(e.CCW),E=t)}function Le(t){t!==F?(j(e.CULL_FACE),t!==w&&(t===B?e.cullFace(e.BACK):t===z?e.cullFace(e.FRONT):e.cullFace(e.FRONT_AND_BACK))):Z(e.CULL_FACE),w=t}function Pe(t,n,r){t?(j(e.POLYGON_OFFSET_FILL),C===n&&k===r||(e.polygonOffset(n,r),C=n,k=r)):Z(e.POLYGON_OFFSET_FILL)}return{buffers:{color:o,depth:s,stencil:l},enable:j,disable:Z,bindFramebuffer:function(t,n){return p[t]!==n&&(e.bindFramebuffer(t,n),p[t]=n,a&&(t===e.DRAW_FRAMEBUFFER&&(p[e.FRAMEBUFFER]=n),t===e.FRAMEBUFFER&&(p[e.DRAW_FRAMEBUFFER]=n)),!0)},drawBuffers:function(r,i){var a=f,o=!1;if(r)if(void 0===(a=d.get(i))&&(a=[],d.set(i,a)),r.isWebGLMultipleRenderTargets){var s=r.texture;if(a.length!==s.length||a[0]!==e.COLOR_ATTACHMENT0){for(var l=0,u=s.length;l<u;l++)a[l]=e.COLOR_ATTACHMENT0+l;a.length=s.length,o=!0}}else a[0]!==e.COLOR_ATTACHMENT0&&(a[0]=e.COLOR_ATTACHMENT0,o=!0);else a[0]!==e.BACK&&(a[0]=e.BACK,o=!0);o&&(n.isWebGL2?e.drawBuffers(a):t.get("WEBGL_draw_buffers").drawBuffersWEBGL(a))},useProgram:function(t){return m!==t&&(e.useProgram(t),m=t,!0)},setBlending:Ce,setMaterial:function(t,n){t.side===Y?Z(e.CULL_FACE):j(e.CULL_FACE);var r=t.side===q;n&&(r=!r),ke(r),t.blending===K&&!1===t.transparent?Ce(J):Ce(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha),s.setFunc(t.depthFunc),s.setTest(t.depthTest),s.setMask(t.depthWrite),o.setMask(t.colorWrite);var i=t.stencilWrite;l.setTest(i),i&&(l.setMask(t.stencilWriteMask),l.setFunc(t.stencilFunc,t.stencilRef,t.stencilFuncMask),l.setOp(t.stencilFail,t.stencilZFail,t.stencilZPass)),Pe(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits),!0===t.alphaToCoverage?j(e.SAMPLE_ALPHA_TO_COVERAGE):Z(e.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:ke,setCullFace:Le,setLineWidth:function(t){t!==R&&(P&&e.lineWidth(t),R=t)},setPolygonOffset:Pe,setScissorTest:function(t){t?j(e.SCISSOR_TEST):Z(e.SCISSOR_TEST)},activeTexture:function(t){void 0===t&&(t=e.TEXTURE0+L-1),D!==t&&(e.activeTexture(t),D=t)},bindTexture:function(t,n,r){void 0===r&&(r=null===D?e.TEXTURE0+L-1:D);var i=N[r];void 0===i&&(i={type:void 0,texture:void 0},N[r]=i),i.type===t&&i.texture===n||(D!==r&&(e.activeTexture(r),D=r),e.bindTexture(t,n||X[t]),i.type=t,i.texture=n)},unbindTexture:function(){var t=N[D];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},compressedTexImage3D:function(){try{e.compressedTexImage3D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},updateUBOMapping:function(t,n){var r=c.get(n);void 0===r&&(r=new WeakMap,c.set(n,r));var i=r.get(t);void 0===i&&(i=e.getUniformBlockIndex(n,t.name),r.set(t,i))},uniformBlockBinding:function(t,n){var r=c.get(n).get(t);u.get(n)!==r&&(e.uniformBlockBinding(n,r,t.__bindingPointIndex),u.set(n,r))},texStorage2D:function(){try{e.texStorage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texStorage3D:function(){try{e.texStorage3D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texSubImage2D:function(){try{e.texSubImage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texSubImage3D:function(){try{e.texSubImage3D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},compressedTexSubImage2D:function(){try{e.compressedTexSubImage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},compressedTexSubImage3D:function(){try{e.compressedTexSubImage3D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},scissor:function(t){!1===H.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),H.copy(t))},viewport:function(t){!1===V.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),V.copy(t))},reset:function(){e.disable(e.BLEND),e.disable(e.CULL_FACE),e.disable(e.DEPTH_TEST),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SCISSOR_TEST),e.disable(e.STENCIL_TEST),e.disable(e.SAMPLE_ALPHA_TO_COVERAGE),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ZERO),e.blendFuncSeparate(e.ONE,e.ZERO,e.ONE,e.ZERO),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(e.LESS),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(e.ALWAYS,0,4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.clearStencil(0),e.cullFace(e.BACK),e.frontFace(e.CCW),e.polygonOffset(0,0),e.activeTexture(e.TEXTURE0),e.bindFramebuffer(e.FRAMEBUFFER,null),!0===a&&(e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),e.bindFramebuffer(e.READ_FRAMEBUFFER,null)),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),h={},D=null,N={},p={},d=new WeakMap,f=[],m=null,v=!1,g=null,y=null,_=null,x=null,M=null,S=null,b=null,T=!1,E=null,w=null,R=null,C=null,k=null,H.set(0,0,e.canvas.width,e.canvas.height),V.set(0,0,e.canvas.width,e.canvas.height),o.reset(),s.reset(),l.reset()}}}function Tp(e,t,n,r,i,a,o){var s,l,u,c,h=i.isWebGL2,p=i.maxTextures,d=i.maxCubemapSize,f=i.maxTextureSize,m=i.maxSamples,v=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):null,g="undefined"!=typeof navigator&&/OculusBrowser/g.test(navigator.userAgent),y=new WeakMap,_=new WeakMap,x=!1;try{x="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(q){}function M(e,t){return x?new OffscreenCanvas(e,t):Yr("canvas")}function S(e,t,n,r){var i=1;if((e.width>r||e.height>r)&&(i=r/Math.max(e.width,e.height)),i<1||!0===t){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){var a=t?Or:Math.floor,o=a(i*e.width),s=a(i*e.height);void 0===c&&(c=M(o,s));var l=n?M(o,s):c;return l.width=o,l.height=s,l.getContext("2d").drawImage(e,0,0,o,s),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+e.width+"x"+e.height+") to ("+o+"x"+s+")."),l}return"data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+e.width+"x"+e.height+")."),e}return e}function b(e){return Dr(e.width)&&Dr(e.height)}function T(e,t){return e.generateMipmaps&&t&&e.minFilter!==We&&e.minFilter!==Ze}function E(t){e.generateMipmap(t)}function w(n,r,i,a,o=!1){if(!1===h)return r;if(null!==n){if(void 0!==e[n])return e[n];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}var s=r;if(r===e.RED&&(i===e.FLOAT&&(s=e.R32F),i===e.HALF_FLOAT&&(s=e.R16F),i===e.UNSIGNED_BYTE&&(s=e.R8)),r===e.RED_INTEGER&&(i===e.UNSIGNED_BYTE&&(s=e.R8UI),i===e.UNSIGNED_SHORT&&(s=e.R16UI),i===e.UNSIGNED_INT&&(s=e.R32UI),i===e.BYTE&&(s=e.R8I),i===e.SHORT&&(s=e.R16I),i===e.INT&&(s=e.R32I)),r===e.RG&&(i===e.FLOAT&&(s=e.RG32F),i===e.HALF_FLOAT&&(s=e.RG16F),i===e.UNSIGNED_BYTE&&(s=e.RG8)),r===e.RGBA){var l=o?wn:ri.getTransfer(a);i===e.FLOAT&&(s=e.RGBA32F),i===e.HALF_FLOAT&&(s=e.RGBA16F),i===e.UNSIGNED_BYTE&&(s=l===An?e.SRGB8_ALPHA8:e.RGBA8),i===e.UNSIGNED_SHORT_4_4_4_4&&(s=e.RGBA4),i===e.UNSIGNED_SHORT_5_5_5_1&&(s=e.RGB5_A1)}return s!==e.R16F&&s!==e.R32F&&s!==e.RG16F&&s!==e.RG32F&&s!==e.RGBA16F&&s!==e.RGBA32F||t.get("EXT_color_buffer_float"),s}function R(e,t,n){return!0===T(e,n)||e.isFramebufferTexture&&e.minFilter!==We&&e.minFilter!==Ze?Math.log2(Math.max(t.width,t.height))+1:void 0!==e.mipmaps&&e.mipmaps.length>0?e.mipmaps.length:e.isCompressedTexture&&Array.isArray(e.image)?t.mipmaps.length:1}function C(t){return t===We||t===Xe||t===qe?e.NEAREST:e.LINEAR}function k(e){var t=e.target;t.removeEventListener("dispose",k),function(e){var t=r.get(e);if(void 0===t.__webglInit)return;var n=e.source,i=_.get(n);if(i){var a=i[t.__cacheKey];a.usedTimes--,0===a.usedTimes&&P(e),0===Object.keys(i).length&&_.delete(n)}r.remove(e)}(t),t.isVideoTexture&&y.delete(t)}function L(t){var n=t.target;n.removeEventListener("dispose",L),function(t){var n=t.texture,i=r.get(t),a=r.get(n);void 0!==a.__webglTexture&&(e.deleteTexture(a.__webglTexture),o.memory.textures--);t.depthTexture&&t.depthTexture.dispose();if(t.isWebGLCubeRenderTarget)for(var s=0;s<6;s++){if(Array.isArray(i.__webglFramebuffer[s]))for(var l=0;l<i.__webglFramebuffer[s].length;l++)e.deleteFramebuffer(i.__webglFramebuffer[s][l]);else e.deleteFramebuffer(i.__webglFramebuffer[s]);i.__webglDepthbuffer&&e.deleteRenderbuffer(i.__webglDepthbuffer[s])}else{if(Array.isArray(i.__webglFramebuffer))for(var u=0;u<i.__webglFramebuffer.length;u++)e.deleteFramebuffer(i.__webglFramebuffer[u]);else e.deleteFramebuffer(i.__webglFramebuffer);if(i.__webglDepthbuffer&&e.deleteRenderbuffer(i.__webglDepthbuffer),i.__webglMultisampledFramebuffer&&e.deleteFramebuffer(i.__webglMultisampledFramebuffer),i.__webglColorRenderbuffer)for(var c=0;c<i.__webglColorRenderbuffer.length;c++)i.__webglColorRenderbuffer[c]&&e.deleteRenderbuffer(i.__webglColorRenderbuffer[c]);i.__webglDepthRenderbuffer&&e.deleteRenderbuffer(i.__webglDepthRenderbuffer)}if(t.isWebGLMultipleRenderTargets)for(var h=0,p=n.length;h<p;h++){var d=r.get(n[h]);d.__webglTexture&&(e.deleteTexture(d.__webglTexture),o.memory.textures--),r.remove(n[h])}r.remove(n),r.remove(t)}(n)}function P(t){var n=r.get(t);e.deleteTexture(n.__webglTexture);var i=t.source;delete _.get(i)[n.__cacheKey],o.memory.textures--}var I=0;function U(t,i){var a=r.get(t);if(t.isVideoTexture&&function(e){var t=o.render.frame;y.get(e)!==t&&(y.set(e,t),e.update())}(t),!1===t.isRenderTargetTexture&&t.version>0&&a.__version!==t.version){var s=t.image;if(null===s)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==s.complete)return void z(a,t,i);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.bindTexture(e.TEXTURE_2D,a.__webglTexture,e.TEXTURE0+i)}var D=(A(s={},Ge,e.REPEAT),A(s,He,e.CLAMP_TO_EDGE),A(s,Ve,e.MIRRORED_REPEAT),s),N=(A(l={},We,e.NEAREST),A(l,Xe,e.NEAREST_MIPMAP_NEAREST),A(l,qe,e.NEAREST_MIPMAP_LINEAR),A(l,Ze,e.LINEAR),A(l,Je,e.LINEAR_MIPMAP_NEAREST),A(l,Qe,e.LINEAR_MIPMAP_LINEAR),l),O=(A(u={},jn,e.NEVER),A(u,$n,e.ALWAYS),A(u,qn,e.LESS),A(u,Zn,e.LEQUAL),A(u,Yn,e.EQUAL),A(u,Qn,e.GEQUAL),A(u,Jn,e.GREATER),A(u,Kn,e.NOTEQUAL),u);function F(n,a,o){if(o?(e.texParameteri(n,e.TEXTURE_WRAP_S,D[a.wrapS]),e.texParameteri(n,e.TEXTURE_WRAP_T,D[a.wrapT]),n!==e.TEXTURE_3D&&n!==e.TEXTURE_2D_ARRAY||e.texParameteri(n,e.TEXTURE_WRAP_R,D[a.wrapR]),e.texParameteri(n,e.TEXTURE_MAG_FILTER,N[a.magFilter]),e.texParameteri(n,e.TEXTURE_MIN_FILTER,N[a.minFilter])):(e.texParameteri(n,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(n,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),n!==e.TEXTURE_3D&&n!==e.TEXTURE_2D_ARRAY||e.texParameteri(n,e.TEXTURE_WRAP_R,e.CLAMP_TO_EDGE),a.wrapS===He&&a.wrapT===He||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(n,e.TEXTURE_MAG_FILTER,C(a.magFilter)),e.texParameteri(n,e.TEXTURE_MIN_FILTER,C(a.minFilter)),a.minFilter!==We&&a.minFilter!==Ze&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),a.compareFunction&&(e.texParameteri(n,e.TEXTURE_COMPARE_MODE,e.COMPARE_REF_TO_TEXTURE),e.texParameteri(n,e.TEXTURE_COMPARE_FUNC,O[a.compareFunction])),!0===t.has("EXT_texture_filter_anisotropic")){var s=t.get("EXT_texture_filter_anisotropic");if(a.magFilter===We)return;if(a.minFilter!==qe&&a.minFilter!==Qe)return;if(a.type===ot&&!1===t.has("OES_texture_float_linear"))return;if(!1===h&&a.type===st&&!1===t.has("OES_texture_half_float_linear"))return;(a.anisotropy>1||r.get(a).__currentAnisotropy)&&(e.texParameterf(n,s.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(a.anisotropy,i.getMaxAnisotropy())),r.get(a).__currentAnisotropy=a.anisotropy)}}function B(t,n){var r=!1;void 0===t.__webglInit&&(t.__webglInit=!0,n.addEventListener("dispose",k));var i=n.source,a=_.get(i);void 0===a&&(a={},_.set(i,a));var s=function(e){var t=[];return t.push(e.wrapS),t.push(e.wrapT),t.push(e.wrapR||0),t.push(e.magFilter),t.push(e.minFilter),t.push(e.anisotropy),t.push(e.internalFormat),t.push(e.format),t.push(e.type),t.push(e.generateMipmaps),t.push(e.premultiplyAlpha),t.push(e.flipY),t.push(e.unpackAlignment),t.push(e.colorSpace),t.join()}(n);if(s!==t.__cacheKey){void 0===a[s]&&(a[s]={texture:e.createTexture(),usedTimes:0},o.memory.textures++,r=!0),a[s].usedTimes++;var l=a[t.__cacheKey];void 0!==l&&(a[t.__cacheKey].usedTimes--,0===l.usedTimes&&P(n)),t.__cacheKey=s,t.__webglTexture=a[s].texture}return r}function z(t,i,o){var s=e.TEXTURE_2D;(i.isDataArrayTexture||i.isCompressedArrayTexture)&&(s=e.TEXTURE_2D_ARRAY),i.isData3DTexture&&(s=e.TEXTURE_3D);var l=B(t,i),u=i.source;n.bindTexture(s,t.__webglTexture,e.TEXTURE0+o);var c=r.get(u);if(u.version!==c.__version||!0===l){n.activeTexture(e.TEXTURE0+o);var p=ri.getPrimaries(ri.workingColorSpace),d=i.colorSpace===Mn?null:ri.getPrimaries(i.colorSpace),m=i.colorSpace===Mn||p===d?e.NONE:e.BROWSER_DEFAULT_WEBGL;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,i.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,i.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,m);var v,g=function(e){return!h&&(e.wrapS!==He||e.wrapT!==He||e.minFilter!==We&&e.minFilter!==Ze)}(i)&&!1===b(i.image),y=S(i.image,g,!1,f),_=b(y=j(i,y))||h,x=a.convert(i.format,i.colorSpace),M=a.convert(i.type),A=w(i.internalFormat,x,M,i.colorSpace,i.isVideoTexture);F(s,i,_);var C=i.mipmaps,k=h&&!0!==i.isVideoTexture,L=void 0===c.__version||!0===l,P=R(i,y,_);if(i.isDepthTexture)A=e.DEPTH_COMPONENT,h?A=i.type===ot?e.DEPTH_COMPONENT32F:i.type===at?e.DEPTH_COMPONENT24:i.type===ct?e.DEPTH24_STENCIL8:e.DEPTH_COMPONENT16:i.type===ot&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),i.format===mt&&A===e.DEPTH_COMPONENT&&i.type!==rt&&i.type!==at&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),i.type=at,M=a.convert(i.type)),i.format===vt&&A===e.DEPTH_COMPONENT&&(A=e.DEPTH_STENCIL,i.type!==ct&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),i.type=ct,M=a.convert(i.type))),L&&(k?n.texStorage2D(e.TEXTURE_2D,1,A,y.width,y.height):n.texImage2D(e.TEXTURE_2D,0,A,y.width,y.height,0,x,M,null));else if(i.isDataTexture)if(C.length>0&&_){k&&L&&n.texStorage2D(e.TEXTURE_2D,P,A,C[0].width,C[0].height);for(var I=0,U=C.length;I<U;I++)v=C[I],k?n.texSubImage2D(e.TEXTURE_2D,I,0,0,v.width,v.height,x,M,v.data):n.texImage2D(e.TEXTURE_2D,I,A,v.width,v.height,0,x,M,v.data);i.generateMipmaps=!1}else k?(L&&n.texStorage2D(e.TEXTURE_2D,P,A,y.width,y.height),n.texSubImage2D(e.TEXTURE_2D,0,0,0,y.width,y.height,x,M,y.data)):n.texImage2D(e.TEXTURE_2D,0,A,y.width,y.height,0,x,M,y.data);else if(i.isCompressedTexture)if(i.isCompressedArrayTexture){k&&L&&n.texStorage3D(e.TEXTURE_2D_ARRAY,P,A,C[0].width,C[0].height,y.depth);for(var D=0,N=C.length;D<N;D++)v=C[D],i.format!==pt?null!==x?k?n.compressedTexSubImage3D(e.TEXTURE_2D_ARRAY,D,0,0,0,v.width,v.height,y.depth,x,v.data,0,0):n.compressedTexImage3D(e.TEXTURE_2D_ARRAY,D,A,v.width,v.height,y.depth,0,v.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):k?n.texSubImage3D(e.TEXTURE_2D_ARRAY,D,0,0,0,v.width,v.height,y.depth,x,M,v.data):n.texImage3D(e.TEXTURE_2D_ARRAY,D,A,v.width,v.height,y.depth,0,x,M,v.data)}else{k&&L&&n.texStorage2D(e.TEXTURE_2D,P,A,C[0].width,C[0].height);for(var O=0,z=C.length;O<z;O++)v=C[O],i.format!==pt?null!==x?k?n.compressedTexSubImage2D(e.TEXTURE_2D,O,0,0,v.width,v.height,x,v.data):n.compressedTexImage2D(e.TEXTURE_2D,O,A,v.width,v.height,0,v.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):k?n.texSubImage2D(e.TEXTURE_2D,O,0,0,v.width,v.height,x,M,v.data):n.texImage2D(e.TEXTURE_2D,O,A,v.width,v.height,0,x,M,v.data)}else if(i.isDataArrayTexture)k?(L&&n.texStorage3D(e.TEXTURE_2D_ARRAY,P,A,y.width,y.height,y.depth),n.texSubImage3D(e.TEXTURE_2D_ARRAY,0,0,0,0,y.width,y.height,y.depth,x,M,y.data)):n.texImage3D(e.TEXTURE_2D_ARRAY,0,A,y.width,y.height,y.depth,0,x,M,y.data);else if(i.isData3DTexture)k?(L&&n.texStorage3D(e.TEXTURE_3D,P,A,y.width,y.height,y.depth),n.texSubImage3D(e.TEXTURE_3D,0,0,0,0,y.width,y.height,y.depth,x,M,y.data)):n.texImage3D(e.TEXTURE_3D,0,A,y.width,y.height,y.depth,0,x,M,y.data);else if(i.isFramebufferTexture){if(L)if(k)n.texStorage2D(e.TEXTURE_2D,P,A,y.width,y.height);else for(var G=y.width,H=y.height,V=0;V<P;V++)n.texImage2D(e.TEXTURE_2D,V,A,G,H,0,x,M,null),G>>=1,H>>=1}else if(C.length>0&&_){k&&L&&n.texStorage2D(e.TEXTURE_2D,P,A,C[0].width,C[0].height);for(var W=0,X=C.length;W<X;W++)v=C[W],k?n.texSubImage2D(e.TEXTURE_2D,W,0,0,x,M,v):n.texImage2D(e.TEXTURE_2D,W,A,x,M,v);i.generateMipmaps=!1}else k?(L&&n.texStorage2D(e.TEXTURE_2D,P,A,y.width,y.height),n.texSubImage2D(e.TEXTURE_2D,0,0,0,x,M,y)):n.texImage2D(e.TEXTURE_2D,0,A,x,M,y);T(i,_)&&E(s),c.__version=u.version,i.onUpdate&&i.onUpdate(i)}t.__version=i.version}function G(t,i,o,s,l,u){var c=a.convert(o.format,o.colorSpace),h=a.convert(o.type),p=w(o.internalFormat,c,h,o.colorSpace);if(!r.get(i).__hasExternalTextures){var d=Math.max(1,i.width>>u),f=Math.max(1,i.height>>u);l===e.TEXTURE_3D||l===e.TEXTURE_2D_ARRAY?n.texImage3D(l,u,p,d,f,i.depth,0,c,h,null):n.texImage2D(l,u,p,d,f,0,c,h,null)}n.bindFramebuffer(e.FRAMEBUFFER,t),X(i)?v.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,s,l,r.get(o).__webglTexture,0,W(i)):(l===e.TEXTURE_2D||l>=e.TEXTURE_CUBE_MAP_POSITIVE_X&&l<=e.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&e.framebufferTexture2D(e.FRAMEBUFFER,s,l,r.get(o).__webglTexture,u),n.bindFramebuffer(e.FRAMEBUFFER,null)}function H(t,n,r){if(e.bindRenderbuffer(e.RENDERBUFFER,t),n.depthBuffer&&!n.stencilBuffer){var i=!0===h?e.DEPTH_COMPONENT24:e.DEPTH_COMPONENT16;if(r||X(n)){var o=n.depthTexture;o&&o.isDepthTexture&&(o.type===ot?i=e.DEPTH_COMPONENT32F:o.type===at&&(i=e.DEPTH_COMPONENT24));var s=W(n);X(n)?v.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,s,i,n.width,n.height):e.renderbufferStorageMultisample(e.RENDERBUFFER,s,i,n.width,n.height)}else e.renderbufferStorage(e.RENDERBUFFER,i,n.width,n.height);e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t)}else if(n.depthBuffer&&n.stencilBuffer){var l=W(n);r&&!1===X(n)?e.renderbufferStorageMultisample(e.RENDERBUFFER,l,e.DEPTH24_STENCIL8,n.width,n.height):X(n)?v.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,l,e.DEPTH24_STENCIL8,n.width,n.height):e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,n.width,n.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,t)}else for(var u=!0===n.isWebGLMultipleRenderTargets?n.texture:[n.texture],c=0;c<u.length;c++){var p=u[c],d=a.convert(p.format,p.colorSpace),f=a.convert(p.type),m=w(p.internalFormat,d,f,p.colorSpace),g=W(n);r&&!1===X(n)?e.renderbufferStorageMultisample(e.RENDERBUFFER,g,m,n.width,n.height):X(n)?v.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,g,m,n.width,n.height):e.renderbufferStorage(e.RENDERBUFFER,m,n.width,n.height)}e.bindRenderbuffer(e.RENDERBUFFER,null)}function V(t){var i=r.get(t),a=!0===t.isWebGLCubeRenderTarget;if(t.depthTexture&&!i.__autoAllocateDepthBuffer){if(a)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,i){if(i&&i.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(e.FRAMEBUFFER,t),!i.depthTexture||!i.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");r.get(i.depthTexture).__webglTexture&&i.depthTexture.image.width===i.width&&i.depthTexture.image.height===i.height||(i.depthTexture.image.width=i.width,i.depthTexture.image.height=i.height,i.depthTexture.needsUpdate=!0),U(i.depthTexture,0);var a=r.get(i.depthTexture).__webglTexture,o=W(i);if(i.depthTexture.format===mt)X(i)?v.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,a,0,o):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,a,0);else{if(i.depthTexture.format!==vt)throw new Error("Unknown depthTexture format");X(i)?v.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,a,0,o):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,a,0)}}(i.__webglFramebuffer,t)}else if(a){i.__webglDepthbuffer=[];for(var o=0;o<6;o++)n.bindFramebuffer(e.FRAMEBUFFER,i.__webglFramebuffer[o]),i.__webglDepthbuffer[o]=e.createRenderbuffer(),H(i.__webglDepthbuffer[o],t,!1)}else n.bindFramebuffer(e.FRAMEBUFFER,i.__webglFramebuffer),i.__webglDepthbuffer=e.createRenderbuffer(),H(i.__webglDepthbuffer,t,!1);n.bindFramebuffer(e.FRAMEBUFFER,null)}function W(e){return Math.min(m,e.samples)}function X(e){var n=r.get(e);return h&&e.samples>0&&!0===t.has("WEBGL_multisampled_render_to_texture")&&!1!==n.__useRenderToTexture}function j(e,n){var r=e.colorSpace,i=e.format,a=e.type;return!0===e.isCompressedTexture||!0===e.isVideoTexture||e.format===hr?n:(r!==bn&&r!==Mn&&(ri.getTransfer(r)===An?!1===h?!0===t.has("EXT_sRGB")&&i===pt?(e.format=hr,e.minFilter=Ze,e.generateMipmaps=!1):n=oi.sRGBToLinear(n):i===pt&&a===et||console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",r)),n)}this.allocateTextureUnit=function(){var e=I;return e>=p&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+p),I+=1,e},this.resetTextureUnits=function(){I=0},this.setTexture2D=U,this.setTexture2DArray=function(t,i){var a=r.get(t);t.version>0&&a.__version!==t.version?z(a,t,i):n.bindTexture(e.TEXTURE_2D_ARRAY,a.__webglTexture,e.TEXTURE0+i)},this.setTexture3D=function(t,i){var a=r.get(t);t.version>0&&a.__version!==t.version?z(a,t,i):n.bindTexture(e.TEXTURE_3D,a.__webglTexture,e.TEXTURE0+i)},this.setTextureCube=function(t,i){var o=r.get(t);t.version>0&&o.__version!==t.version?function(t,i,o){if(6===i.image.length){var s=B(t,i),l=i.source;n.bindTexture(e.TEXTURE_CUBE_MAP,t.__webglTexture,e.TEXTURE0+o);var u=r.get(l);if(l.version!==u.__version||!0===s){n.activeTexture(e.TEXTURE0+o);var c=ri.getPrimaries(ri.workingColorSpace),p=i.colorSpace===Mn?null:ri.getPrimaries(i.colorSpace),f=i.colorSpace===Mn||c===p?e.NONE:e.BROWSER_DEFAULT_WEBGL;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,i.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,i.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,f);for(var m=i.isCompressedTexture||i.image[0].isCompressedTexture,v=i.image[0]&&i.image[0].isDataTexture,g=[],y=0;y<6;y++)g[y]=m||v?v?i.image[y].image:i.image[y]:S(i.image[y],!1,!0,d),g[y]=j(i,g[y]);var _,x=g[0],M=b(x)||h,A=a.convert(i.format,i.colorSpace),C=a.convert(i.type),k=w(i.internalFormat,A,C,i.colorSpace),L=h&&!0!==i.isVideoTexture,P=void 0===u.__version||!0===s,I=R(i,x,M);if(F(e.TEXTURE_CUBE_MAP,i,M),m){L&&P&&n.texStorage2D(e.TEXTURE_CUBE_MAP,I,k,x.width,x.height);for(var U=0;U<6;U++){_=g[U].mipmaps;for(var D=0;D<_.length;D++){var N=_[D];i.format!==pt?null!==A?L?n.compressedTexSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+U,D,0,0,N.width,N.height,A,N.data):n.compressedTexImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+U,D,k,N.width,N.height,0,N.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):L?n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+U,D,0,0,N.width,N.height,A,C,N.data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+U,D,k,N.width,N.height,0,A,C,N.data)}}}else{_=i.mipmaps,L&&P&&(_.length>0&&I++,n.texStorage2D(e.TEXTURE_CUBE_MAP,I,k,g[0].width,g[0].height));for(var O=0;O<6;O++)if(v){L?n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+O,0,0,0,g[O].width,g[O].height,A,C,g[O].data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+O,0,k,g[O].width,g[O].height,0,A,C,g[O].data);for(var z=0;z<_.length;z++){var G=_[z],H=G.image[O].image;L?n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+O,z+1,0,0,H.width,H.height,A,C,H.data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+O,z+1,k,H.width,H.height,0,A,C,H.data)}}else{L?n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+O,0,0,0,A,C,g[O]):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+O,0,k,A,C,g[O]);for(var V=0;V<_.length;V++){var W=_[V];L?n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+O,V+1,0,0,A,C,W.image[O]):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+O,V+1,k,A,C,W.image[O])}}}T(i,M)&&E(e.TEXTURE_CUBE_MAP),u.__version=l.version,i.onUpdate&&i.onUpdate(i)}t.__version=i.version}}(o,t,i):n.bindTexture(e.TEXTURE_CUBE_MAP,o.__webglTexture,e.TEXTURE0+i)},this.rebindTextures=function(t,n,i){var a=r.get(t);void 0!==n&&G(a.__webglFramebuffer,t,t.texture,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,0),void 0!==i&&V(t)},this.setupRenderTarget=function(t){var s=t.texture,l=r.get(t),u=r.get(s);t.addEventListener("dispose",L),!0!==t.isWebGLMultipleRenderTargets&&(void 0===u.__webglTexture&&(u.__webglTexture=e.createTexture()),u.__version=s.version,o.memory.textures++);var c=!0===t.isWebGLCubeRenderTarget,p=!0===t.isWebGLMultipleRenderTargets,d=b(t)||h;if(c){l.__webglFramebuffer=[];for(var f=0;f<6;f++)if(h&&s.mipmaps&&s.mipmaps.length>0){l.__webglFramebuffer[f]=[];for(var m=0;m<s.mipmaps.length;m++)l.__webglFramebuffer[f][m]=e.createFramebuffer()}else l.__webglFramebuffer[f]=e.createFramebuffer()}else{if(h&&s.mipmaps&&s.mipmaps.length>0){l.__webglFramebuffer=[];for(var v=0;v<s.mipmaps.length;v++)l.__webglFramebuffer[v]=e.createFramebuffer()}else l.__webglFramebuffer=e.createFramebuffer();if(p)if(i.drawBuffers)for(var g=t.texture,y=0,_=g.length;y<_;y++){var x=r.get(g[y]);void 0===x.__webglTexture&&(x.__webglTexture=e.createTexture(),o.memory.textures++)}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(h&&t.samples>0&&!1===X(t)){var M=p?s:[s];l.__webglMultisampledFramebuffer=e.createFramebuffer(),l.__webglColorRenderbuffer=[],n.bindFramebuffer(e.FRAMEBUFFER,l.__webglMultisampledFramebuffer);for(var S=0;S<M.length;S++){var A=M[S];l.__webglColorRenderbuffer[S]=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,l.__webglColorRenderbuffer[S]);var R=a.convert(A.format,A.colorSpace),C=a.convert(A.type),k=w(A.internalFormat,R,C,A.colorSpace,!0===t.isXRRenderTarget),P=W(t);e.renderbufferStorageMultisample(e.RENDERBUFFER,P,k,t.width,t.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+S,e.RENDERBUFFER,l.__webglColorRenderbuffer[S])}e.bindRenderbuffer(e.RENDERBUFFER,null),t.depthBuffer&&(l.__webglDepthRenderbuffer=e.createRenderbuffer(),H(l.__webglDepthRenderbuffer,t,!0)),n.bindFramebuffer(e.FRAMEBUFFER,null)}}if(c){n.bindTexture(e.TEXTURE_CUBE_MAP,u.__webglTexture),F(e.TEXTURE_CUBE_MAP,s,d);for(var I=0;I<6;I++)if(h&&s.mipmaps&&s.mipmaps.length>0)for(var U=0;U<s.mipmaps.length;U++)G(l.__webglFramebuffer[I][U],t,s,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+I,U);else G(l.__webglFramebuffer[I],t,s,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+I,0);T(s,d)&&E(e.TEXTURE_CUBE_MAP),n.unbindTexture()}else if(p){for(var D=t.texture,N=0,O=D.length;N<O;N++){var B=D[N],z=r.get(B);n.bindTexture(e.TEXTURE_2D,z.__webglTexture),F(e.TEXTURE_2D,B,d),G(l.__webglFramebuffer,t,B,e.COLOR_ATTACHMENT0+N,e.TEXTURE_2D,0),T(B,d)&&E(e.TEXTURE_2D)}n.unbindTexture()}else{var j=e.TEXTURE_2D;if((t.isWebGL3DRenderTarget||t.isWebGLArrayRenderTarget)&&(h?j=t.isWebGL3DRenderTarget?e.TEXTURE_3D:e.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),n.bindTexture(j,u.__webglTexture),F(j,s,d),h&&s.mipmaps&&s.mipmaps.length>0)for(var q=0;q<s.mipmaps.length;q++)G(l.__webglFramebuffer[q],t,s,e.COLOR_ATTACHMENT0,j,q);else G(l.__webglFramebuffer,t,s,e.COLOR_ATTACHMENT0,j,0);T(s,d)&&E(j),n.unbindTexture()}t.depthBuffer&&V(t)},this.updateRenderTargetMipmap=function(t){for(var i=b(t)||h,a=!0===t.isWebGLMultipleRenderTargets?t.texture:[t.texture],o=0,s=a.length;o<s;o++){var l=a[o];if(T(l,i)){var u=t.isWebGLCubeRenderTarget?e.TEXTURE_CUBE_MAP:e.TEXTURE_2D,c=r.get(l).__webglTexture;n.bindTexture(u,c),E(u),n.unbindTexture()}}},this.updateMultisampleRenderTarget=function(t){if(h&&t.samples>0&&!1===X(t)){var i=t.isWebGLMultipleRenderTargets?t.texture:[t.texture],a=t.width,o=t.height,s=e.COLOR_BUFFER_BIT,l=[],u=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,c=r.get(t),p=!0===t.isWebGLMultipleRenderTargets;if(p)for(var d=0;d<i.length;d++)n.bindFramebuffer(e.FRAMEBUFFER,c.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+d,e.RENDERBUFFER,null),n.bindFramebuffer(e.FRAMEBUFFER,c.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+d,e.TEXTURE_2D,null,0);n.bindFramebuffer(e.READ_FRAMEBUFFER,c.__webglMultisampledFramebuffer),n.bindFramebuffer(e.DRAW_FRAMEBUFFER,c.__webglFramebuffer);for(var f=0;f<i.length;f++){l.push(e.COLOR_ATTACHMENT0+f),t.depthBuffer&&l.push(u);var m=void 0!==c.__ignoreDepthValues&&c.__ignoreDepthValues;if(!1===m&&(t.depthBuffer&&(s|=e.DEPTH_BUFFER_BIT),t.stencilBuffer&&(s|=e.STENCIL_BUFFER_BIT)),p&&e.framebufferRenderbuffer(e.READ_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.RENDERBUFFER,c.__webglColorRenderbuffer[f]),!0===m&&(e.invalidateFramebuffer(e.READ_FRAMEBUFFER,[u]),e.invalidateFramebuffer(e.DRAW_FRAMEBUFFER,[u])),p){var v=r.get(i[f]).__webglTexture;e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,v,0)}e.blitFramebuffer(0,0,a,o,0,0,a,o,s,e.NEAREST),g&&e.invalidateFramebuffer(e.READ_FRAMEBUFFER,l)}if(n.bindFramebuffer(e.READ_FRAMEBUFFER,null),n.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),p)for(var y=0;y<i.length;y++){n.bindFramebuffer(e.FRAMEBUFFER,c.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+y,e.RENDERBUFFER,c.__webglColorRenderbuffer[y]);var _=r.get(i[y]).__webglTexture;n.bindFramebuffer(e.FRAMEBUFFER,c.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+y,e.TEXTURE_2D,_,0)}n.bindFramebuffer(e.DRAW_FRAMEBUFFER,c.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=V,this.setupFrameBufferTexture=G,this.useMultisampledRTT=X}function Ep(e,t,n){var r=n.isWebGL2;return{convert:function(n,i=Mn){var a,o=ri.getTransfer(i);if(n===et)return e.UNSIGNED_BYTE;if(n===lt)return e.UNSIGNED_SHORT_4_4_4_4;if(n===ut)return e.UNSIGNED_SHORT_5_5_5_1;if(n===tt)return e.BYTE;if(n===nt)return e.SHORT;if(n===rt)return e.UNSIGNED_SHORT;if(n===it)return e.INT;if(n===at)return e.UNSIGNED_INT;if(n===ot)return e.FLOAT;if(n===st)return r?e.HALF_FLOAT:null!==(a=t.get("OES_texture_half_float"))?a.HALF_FLOAT_OES:null;if(n===ht)return e.ALPHA;if(n===pt)return e.RGBA;if(n===dt)return e.LUMINANCE;if(n===ft)return e.LUMINANCE_ALPHA;if(n===mt)return e.DEPTH_COMPONENT;if(n===vt)return e.DEPTH_STENCIL;if(n===hr)return null!==(a=t.get("EXT_sRGB"))?a.SRGB_ALPHA_EXT:null;if(n===gt)return e.RED;if(n===yt)return e.RED_INTEGER;if(n===_t)return e.RG;if(n===xt)return e.RG_INTEGER;if(n===Mt)return e.RGBA_INTEGER;if(n===St||n===bt||n===Tt||n===Et)if(o===An){if(null===(a=t.get("WEBGL_compressed_texture_s3tc_srgb")))return null;if(n===St)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===bt)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===Tt)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===Et)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(null===(a=t.get("WEBGL_compressed_texture_s3tc")))return null;if(n===St)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===bt)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===Tt)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===Et)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(n===wt||n===At||n===Rt||n===Ct){if(null===(a=t.get("WEBGL_compressed_texture_pvrtc")))return null;if(n===wt)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===At)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===Rt)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===Ct)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(n===kt)return null!==(a=t.get("WEBGL_compressed_texture_etc1"))?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(n===Lt||n===Pt){if(null===(a=t.get("WEBGL_compressed_texture_etc")))return null;if(n===Lt)return o===An?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(n===Pt)return o===An?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}if(n===It||n===Ut||n===Dt||n===Nt||n===Ot||n===Ft||n===Bt||n===zt||n===Gt||n===Ht||n===Vt||n===Wt||n===Xt||n===jt){if(null===(a=t.get("WEBGL_compressed_texture_astc")))return null;if(n===It)return o===An?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===Ut)return o===An?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===Dt)return o===An?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===Nt)return o===An?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===Ot)return o===An?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===Ft)return o===An?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===Bt)return o===An?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===zt)return o===An?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===Gt)return o===An?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===Ht)return o===An?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===Vt)return o===An?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===Wt)return o===An?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===Xt)return o===An?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===jt)return o===An?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}if(n===qt||n===Yt||n===Zt){if(null===(a=t.get("EXT_texture_compression_bptc")))return null;if(n===qt)return o===An?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===Yt)return a.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===Zt)return a.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}if(n===Jt||n===Kt||n===Qt||n===$t){if(null===(a=t.get("EXT_texture_compression_rgtc")))return null;if(n===qt)return a.COMPRESSED_RED_RGTC1_EXT;if(n===Kt)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===Qt)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===$t)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return n===ct?r?e.UNSIGNED_INT_24_8:null!==(a=t.get("WEBGL_depth_texture"))?a.UNSIGNED_INT_24_8_WEBGL:null:void 0!==e[n]?e[n]:null}}}var wp=exports.ArrayCamera=function(e){x(n,qo);var t=S(n);function n(e=[]){var r;return k(this,n),(r=t.call(this)).isArrayCamera=!0,r.cameras=e,r}return P(n)}(),Ap=exports.Group=function(e){x(n,Sa);var t=S(n);function n(){var e;return k(this,n),(e=t.call(this)).isGroup=!0,e.type="Group",e}return P(n)}(),Rp={type:"move"},Cp=function(){function e(){k(this,e),this._targetRay=null,this._grip=null,this._hand=null}return P(e,[{key:"getHandSpace",value:function(){return null===this._hand&&(this._hand=new Ap,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}},{key:"getTargetRaySpace",value:function(){return null===this._targetRay&&(this._targetRay=new Ap,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Mi,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Mi),this._targetRay}},{key:"getGripSpace",value:function(){return null===this._grip&&(this._grip=new Ap,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Mi,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Mi),this._grip}},{key:"dispatchEvent",value:function(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}},{key:"connect",value:function(e){if(e&&e.hand){var t=this._hand;if(t){var n,r=s(e.hand.values());try{for(r.s();!(n=r.n()).done;){var i=n.value;this._getHandJoint(t,i)}}catch(a){r.e(a)}finally{r.f()}}}return this.dispatchEvent({type:"connected",data:e}),this}},{key:"disconnect",value:function(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}},{key:"update",value:function(e,t,n){var r=null,i=null,a=null,o=this._targetRay,l=this._grip,u=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(u&&e.hand){a=!0;var c,h=s(e.hand.values());try{for(h.s();!(c=h.n()).done;){var p=c.value,d=t.getJointPose(p,n),f=this._getHandJoint(u,p);null!==d&&(f.matrix.fromArray(d.transform.matrix),f.matrix.decompose(f.position,f.rotation,f.scale),f.matrixWorldNeedsUpdate=!0,f.jointRadius=d.radius),f.visible=null!==d}}catch(y){h.e(y)}finally{h.f()}var m=u.joints["index-finger-tip"],v=u.joints["thumb-tip"],g=m.position.distanceTo(v.position);u.inputState.pinching&&g>.025?(u.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!u.inputState.pinching&&g<=.015&&(u.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==l&&e.gripSpace&&null!==(i=t.getPose(e.gripSpace,n))&&(l.matrix.fromArray(i.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,i.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(i.linearVelocity)):l.hasLinearVelocity=!1,i.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(i.angularVelocity)):l.hasAngularVelocity=!1);null!==o&&(null===(r=t.getPose(e.targetRaySpace,n))&&null!==i&&(r=i),null!==r&&(o.matrix.fromArray(r.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),o.matrixWorldNeedsUpdate=!0,r.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(r.linearVelocity)):o.hasLinearVelocity=!1,r.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(r.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(Rp)))}return null!==o&&(o.visible=null!==r),null!==l&&(l.visible=null!==i),null!==u&&(u.visible=null!==a),this}},{key:"_getHandJoint",value:function(e,t){if(void 0===e.joints[t.jointName]){var n=new Ap;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}}]),e}(),kp=exports.DepthTexture=function(e){x(n,hi);var t=S(n);function n(e,r,i,a,o,s,l,u,c,h){var p;if(k(this,n),(h=void 0!==h?h:mt)!==mt&&h!==vt)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");return void 0===i&&h===mt&&(i=at),void 0===i&&h===vt&&(i=ct),(p=t.call(this,null,a,o,s,l,u,h,i,c)).isDepthTexture=!0,p.image={width:e,height:r},p.magFilter=void 0!==l?l:We,p.minFilter=void 0!==u?u:We,p.flipY=!1,p.generateMipmaps=!1,p.compareFunction=null,p}return P(n,[{key:"copy",value:function(e){return p(w(n.prototype),"copy",this).call(this,e),this.compareFunction=e.compareFunction,this}},{key:"toJSON",value:function(e){var t=p(w(n.prototype),"toJSON",this).call(this,e);return null!==this.compareFunction&&(t.compareFunction=this.compareFunction),t}}]),n}(),Lp=function(e){x(n,fr);var t=S(n);function n(e,r){var i;k(this,n);var a=T(i=t.call(this)),s=null,l=1,u=null,c="local-floor",h=1,p=null,d=null,f=null,m=null,v=null,g=null,y=r.getContextAttributes(),_=null,x=null,M=[],S=[],b=new qo;b.layers.enable(1),b.viewport=new pi;var E=new qo;E.layers.enable(2),E.viewport=new pi;var w=[b,E],A=new wp;A.layers.enable(1),A.layers.enable(2);var C=null,L=null;function P(e){var t=S.indexOf(e.inputSource);if(-1!==t){var n=M[t];void 0!==n&&(n.update(e.inputSource,e.frame,p||u),n.dispatchEvent({type:e.type,data:e.inputSource}))}}function I(){s.removeEventListener("select",P),s.removeEventListener("selectstart",P),s.removeEventListener("selectend",P),s.removeEventListener("squeeze",P),s.removeEventListener("squeezestart",P),s.removeEventListener("squeezeend",P),s.removeEventListener("end",I),s.removeEventListener("inputsourceschange",U);for(var t=0;t<M.length;t++){var n=S[t];null!==n&&(S[t]=null,M[t].disconnect(n))}C=null,L=null,e.setRenderTarget(_),v=null,m=null,f=null,s=null,x=null,B.stop(),a.isPresenting=!1,a.dispatchEvent({type:"sessionend"})}function U(e){for(var t=0;t<e.removed.length;t++){var n=e.removed[t],r=S.indexOf(n);r>=0&&(S[r]=null,M[r].disconnect(n))}for(var i=0;i<e.added.length;i++){var a=e.added[i],o=S.indexOf(a);if(-1===o){for(var s=0;s<M.length;s++){if(s>=S.length){S.push(a),o=s;break}if(null===S[s]){S[s]=a,o=s;break}}if(-1===o)break}var l=M[o];l&&l.connect(a)}}i.cameraAutoUpdate=!0,i.enabled=!1,i.isPresenting=!1,i.getController=function(e){var t=M[e];return void 0===t&&(t=new Cp,M[e]=t),t.getTargetRaySpace()},i.getControllerGrip=function(e){var t=M[e];return void 0===t&&(t=new Cp,M[e]=t),t.getGripSpace()},i.getHand=function(e){var t=M[e];return void 0===t&&(t=new Cp,M[e]=t),t.getHandSpace()},i.setFramebufferScaleFactor=function(e){l=e,!0===a.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},i.setReferenceSpaceType=function(e){c=e,!0===a.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},i.getReferenceSpace=function(){return p||u},i.setReferenceSpace=function(e){p=e},i.getBaseLayer=function(){return null!==m?m:v},i.getBinding=function(){return f},i.getFrame=function(){return g},i.getSession=function(){return s},i.setSession=function(){var t=o(R().mark(function t(n){var i,o,d,g,M;return R().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(null===(s=n)){t.next=25;break}if(_=e.getRenderTarget(),s.addEventListener("select",P),s.addEventListener("selectstart",P),s.addEventListener("selectend",P),s.addEventListener("squeeze",P),s.addEventListener("squeezestart",P),s.addEventListener("squeezeend",P),s.addEventListener("end",I),s.addEventListener("inputsourceschange",U),!0===y.xrCompatible){t.next=14;break}return t.next=14,r.makeXRCompatible();case 14:return void 0===s.renderState.layers||!1===e.capabilities.isWebGL2?(i={antialias:void 0!==s.renderState.layers||y.antialias,alpha:!0,depth:y.depth,stencil:y.stencil,framebufferScaleFactor:l},v=new XRWebGLLayer(s,r,i),s.updateRenderState({baseLayer:v}),x=new fi(v.framebufferWidth,v.framebufferHeight,{format:pt,type:et,colorSpace:e.outputColorSpace,stencilBuffer:y.stencil})):(o=null,d=null,g=null,y.depth&&(g=y.stencil?r.DEPTH24_STENCIL8:r.DEPTH_COMPONENT24,o=y.stencil?vt:mt,d=y.stencil?ct:at),M={colorFormat:r.RGBA8,depthFormat:g,scaleFactor:l},f=new XRWebGLBinding(s,r),m=f.createProjectionLayer(M),s.updateRenderState({layers:[m]}),x=new fi(m.textureWidth,m.textureHeight,{format:pt,type:et,depthTexture:new kp(m.textureWidth,m.textureHeight,d,void 0,void 0,void 0,void 0,void 0,void 0,o),stencilBuffer:y.stencil,colorSpace:e.outputColorSpace,samples:y.antialias?4:0}),e.properties.get(x).__ignoreDepthValues=m.ignoreDepthValues),x.isXRRenderTarget=!0,this.setFoveation(h),p=null,t.next=20,s.requestReferenceSpace(c);case 20:u=t.sent,B.setContext(s),B.start(),a.isPresenting=!0,a.dispatchEvent({type:"sessionstart"});case 25:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),i.getEnvironmentBlendMode=function(){if(null!==s)return s.environmentBlendMode};var D=new Mi,N=new Mi;function O(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.copy(e.matrixWorld).invert()}i.updateCamera=function(e){if(null!==s){A.near=E.near=b.near=e.near,A.far=E.far=b.far=e.far,C===A.near&&L===A.far||(s.updateRenderState({depthNear:A.near,depthFar:A.far}),C=A.near,L=A.far);var t=e.parent,n=A.cameras;O(A,t);for(var r=0;r<n.length;r++)O(n[r],t);2===n.length?function(e,t,n){D.setFromMatrixPosition(t.matrixWorld),N.setFromMatrixPosition(n.matrixWorld);var r=D.distanceTo(N),i=t.projectionMatrix.elements,a=n.projectionMatrix.elements,o=i[14]/(i[10]-1),s=i[14]/(i[10]+1),l=(i[9]+1)/i[5],u=(i[9]-1)/i[5],c=(i[8]-1)/i[0],h=(a[8]+1)/a[0],p=o*c,d=o*h,f=r/(-c+h),m=f*-c;t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(m),e.translateZ(f),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.copy(e.matrixWorld).invert();var v=o+f,g=s+f,y=p-m,_=d+(r-m),x=l*s/g*v,M=u*s/g*v;e.projectionMatrix.makePerspective(y,_,x,M,v,g),e.projectionMatrixInverse.copy(e.projectionMatrix).invert()}(A,b,E):A.projectionMatrix.copy(b.projectionMatrix),function(e,t,n){null===n?e.matrix.copy(t.matrixWorld):(e.matrix.copy(n.matrixWorld),e.matrix.invert(),e.matrix.multiply(t.matrixWorld));e.matrix.decompose(e.position,e.quaternion,e.scale),e.updateMatrixWorld(!0),e.projectionMatrix.copy(t.projectionMatrix),e.projectionMatrixInverse.copy(t.projectionMatrixInverse),e.isPerspectiveCamera&&(e.fov=2*yr*Math.atan(1/e.projectionMatrix.elements[5]),e.zoom=1)}(e,A,t)}},i.getCamera=function(){return A},i.getFoveation=function(){if(null!==m||null!==v)return h},i.setFoveation=function(e){h=e,null!==m&&(m.fixedFoveation=e),null!==v&&void 0!==v.fixedFoveation&&(v.fixedFoveation=e)};var F=null;var B=new os;return B.setAnimationLoop(function(t,n){if(d=n.getViewerPose(p||u),g=n,null!==d){var r=d.views;null!==v&&(e.setRenderTargetFramebuffer(x,v.framebuffer),e.setRenderTarget(x));var i=!1;r.length!==A.cameras.length&&(A.cameras.length=0,i=!0);for(var o=0;o<r.length;o++){var s=r[o],l=null;if(null!==v)l=v.getViewport(s);else{var c=f.getViewSubImage(m,s);l=c.viewport,0===o&&(e.setRenderTargetTextures(x,c.colorTexture,m.ignoreDepthValues?void 0:c.depthStencilTexture),e.setRenderTarget(x))}var h=w[o];void 0===h&&((h=new qo).layers.enable(o),h.viewport=new pi,w[o]=h),h.matrix.fromArray(s.transform.matrix),h.matrix.decompose(h.position,h.quaternion,h.scale),h.projectionMatrix.fromArray(s.projectionMatrix),h.projectionMatrixInverse.copy(h.projectionMatrix).invert(),h.viewport.set(l.x,l.y,l.width,l.height),0===o&&(A.matrix.copy(h.matrix),A.matrix.decompose(A.position,A.quaternion,A.scale)),!0===i&&A.cameras.push(h)}}for(var y=0;y<M.length;y++){var _=S[y],b=M[y];null!==_&&void 0!==b&&b.update(_,n,p||u)}F&&F(t,n),n.detectedPlanes&&a.dispatchEvent({type:"planesdetected",data:n}),g=null}),i.setAnimationLoop=function(e){F=e},i.dispose=function(){},i}return P(n)}();function Pp(e,t){function n(e,t){!0===e.matrixAutoUpdate&&e.updateMatrix(),t.value.copy(e.matrix)}function r(r,i){r.opacity.value=i.opacity,i.color&&r.diffuse.value.copy(i.color),i.emissive&&r.emissive.value.copy(i.emissive).multiplyScalar(i.emissiveIntensity),i.map&&(r.map.value=i.map,n(i.map,r.mapTransform)),i.alphaMap&&(r.alphaMap.value=i.alphaMap,n(i.alphaMap,r.alphaMapTransform)),i.bumpMap&&(r.bumpMap.value=i.bumpMap,n(i.bumpMap,r.bumpMapTransform),r.bumpScale.value=i.bumpScale,i.side===q&&(r.bumpScale.value*=-1)),i.normalMap&&(r.normalMap.value=i.normalMap,n(i.normalMap,r.normalMapTransform),r.normalScale.value.copy(i.normalScale),i.side===q&&r.normalScale.value.negate()),i.displacementMap&&(r.displacementMap.value=i.displacementMap,n(i.displacementMap,r.displacementMapTransform),r.displacementScale.value=i.displacementScale,r.displacementBias.value=i.displacementBias),i.emissiveMap&&(r.emissiveMap.value=i.emissiveMap,n(i.emissiveMap,r.emissiveMapTransform)),i.specularMap&&(r.specularMap.value=i.specularMap,n(i.specularMap,r.specularMapTransform)),i.alphaTest>0&&(r.alphaTest.value=i.alphaTest);var a=t.get(i).envMap;if(a&&(r.envMap.value=a,r.flipEnvMap.value=a.isCubeTexture&&!1===a.isRenderTargetTexture?-1:1,r.reflectivity.value=i.reflectivity,r.ior.value=i.ior,r.refractionRatio.value=i.refractionRatio),i.lightMap){r.lightMap.value=i.lightMap;var o=!0===e._useLegacyLights?Math.PI:1;r.lightMapIntensity.value=i.lightMapIntensity*o,n(i.lightMap,r.lightMapTransform)}i.aoMap&&(r.aoMap.value=i.aoMap,r.aoMapIntensity.value=i.aoMapIntensity,n(i.aoMap,r.aoMapTransform))}return{refreshFogUniforms:function(t,n){n.color.getRGB(t.fogColor.value,Go(e)),n.isFog?(t.fogNear.value=n.near,t.fogFar.value=n.far):n.isFogExp2&&(t.fogDensity.value=n.density)},refreshMaterialUniforms:function(e,i,a,o,s){i.isMeshBasicMaterial?r(e,i):i.isMeshLambertMaterial?r(e,i):i.isMeshToonMaterial?(r(e,i),function(e,t){t.gradientMap&&(e.gradientMap.value=t.gradientMap)}(e,i)):i.isMeshPhongMaterial?(r(e,i),function(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4)}(e,i)):i.isMeshStandardMaterial?(r(e,i),function(e,r){e.metalness.value=r.metalness,r.metalnessMap&&(e.metalnessMap.value=r.metalnessMap,n(r.metalnessMap,e.metalnessMapTransform)),e.roughness.value=r.roughness,r.roughnessMap&&(e.roughnessMap.value=r.roughnessMap,n(r.roughnessMap,e.roughnessMapTransform)),t.get(r).envMap&&(e.envMapIntensity.value=r.envMapIntensity)}(e,i),i.isMeshPhysicalMaterial&&function(e,t,r){e.ior.value=t.ior,t.sheen>0&&(e.sheenColor.value.copy(t.sheenColor).multiplyScalar(t.sheen),e.sheenRoughness.value=t.sheenRoughness,t.sheenColorMap&&(e.sheenColorMap.value=t.sheenColorMap,n(t.sheenColorMap,e.sheenColorMapTransform)),t.sheenRoughnessMap&&(e.sheenRoughnessMap.value=t.sheenRoughnessMap,n(t.sheenRoughnessMap,e.sheenRoughnessMapTransform))),t.clearcoat>0&&(e.clearcoat.value=t.clearcoat,e.clearcoatRoughness.value=t.clearcoatRoughness,t.clearcoatMap&&(e.clearcoatMap.value=t.clearcoatMap,n(t.clearcoatMap,e.clearcoatMapTransform)),t.clearcoatRoughnessMap&&(e.clearcoatRoughnessMap.value=t.clearcoatRoughnessMap,n(t.clearcoatRoughnessMap,e.clearcoatRoughnessMapTransform)),t.clearcoatNormalMap&&(e.clearcoatNormalMap.value=t.clearcoatNormalMap,n(t.clearcoatNormalMap,e.clearcoatNormalMapTransform),e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),t.side===q&&e.clearcoatNormalScale.value.negate())),t.iridescence>0&&(e.iridescence.value=t.iridescence,e.iridescenceIOR.value=t.iridescenceIOR,e.iridescenceThicknessMinimum.value=t.iridescenceThicknessRange[0],e.iridescenceThicknessMaximum.value=t.iridescenceThicknessRange[1],t.iridescenceMap&&(e.iridescenceMap.value=t.iridescenceMap,n(t.iridescenceMap,e.iridescenceMapTransform)),t.iridescenceThicknessMap&&(e.iridescenceThicknessMap.value=t.iridescenceThicknessMap,n(t.iridescenceThicknessMap,e.iridescenceThicknessMapTransform))),t.transmission>0&&(e.transmission.value=t.transmission,e.transmissionSamplerMap.value=r.texture,e.transmissionSamplerSize.value.set(r.width,r.height),t.transmissionMap&&(e.transmissionMap.value=t.transmissionMap,n(t.transmissionMap,e.transmissionMapTransform)),e.thickness.value=t.thickness,t.thicknessMap&&(e.thicknessMap.value=t.thicknessMap,n(t.thicknessMap,e.thicknessMapTransform)),e.attenuationDistance.value=t.attenuationDistance,e.attenuationColor.value.copy(t.attenuationColor)),t.anisotropy>0&&(e.anisotropyVector.value.set(t.anisotropy*Math.cos(t.anisotropyRotation),t.anisotropy*Math.sin(t.anisotropyRotation)),t.anisotropyMap&&(e.anisotropyMap.value=t.anisotropyMap,n(t.anisotropyMap,e.anisotropyMapTransform))),e.specularIntensity.value=t.specularIntensity,e.specularColor.value.copy(t.specularColor),t.specularColorMap&&(e.specularColorMap.value=t.specularColorMap,n(t.specularColorMap,e.specularColorMapTransform)),t.specularIntensityMap&&(e.specularIntensityMap.value=t.specularIntensityMap,n(t.specularIntensityMap,e.specularIntensityMapTransform))}(e,i,s)):i.isMeshMatcapMaterial?(r(e,i),function(e,t){t.matcap&&(e.matcap.value=t.matcap)}(e,i)):i.isMeshDepthMaterial?r(e,i):i.isMeshDistanceMaterial?(r(e,i),function(e,n){var r=t.get(n).light;e.referencePosition.value.setFromMatrixPosition(r.matrixWorld),e.nearDistance.value=r.shadow.camera.near,e.farDistance.value=r.shadow.camera.far}(e,i)):i.isMeshNormalMaterial?r(e,i):i.isLineBasicMaterial?(function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,t.map&&(e.map.value=t.map,n(t.map,e.mapTransform))}(e,i),i.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(e,i)):i.isPointsMaterial?function(e,t,r,i){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*r,e.scale.value=.5*i,t.map&&(e.map.value=t.map,n(t.map,e.uvTransform)),t.alphaMap&&(e.alphaMap.value=t.alphaMap,n(t.alphaMap,e.alphaMapTransform)),t.alphaTest>0&&(e.alphaTest.value=t.alphaTest)}(e,i,a,o):i.isSpriteMaterial?function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,t.map&&(e.map.value=t.map,n(t.map,e.mapTransform)),t.alphaMap&&(e.alphaMap.value=t.alphaMap,n(t.alphaMap,e.alphaMapTransform)),t.alphaTest>0&&(e.alphaTest.value=t.alphaTest)}(e,i):i.isShadowMaterial?(e.color.value.copy(i.color),e.opacity.value=i.opacity):i.isShaderMaterial&&(i.uniformsNeedUpdate=!1)}}}function Ip(e,t,n,r){var i={},a={},o=[],s=n.isWebGL2?e.getParameter(e.MAX_UNIFORM_BUFFER_BINDINGS):0;function l(e,t,n){var r=e.value;if(void 0===n[t]){if("number"==typeof r)n[t]=r;else{for(var i=Array.isArray(r)?r:[r],a=[],o=0;o<i.length;o++)a.push(i[o].clone());n[t]=a}return!0}if("number"==typeof r){if(n[t]!==r)return n[t]=r,!0}else for(var s=Array.isArray(n[t])?n[t]:[n[t]],l=Array.isArray(r)?r:[r],u=0;u<s.length;u++){var c=s[u];if(!1===c.equals(l[u]))return c.copy(l[u]),!0}return!1}function u(e){var t={boundary:0,storage:0};return"number"==typeof e?(t.boundary=4,t.storage=4):e.isVector2?(t.boundary=8,t.storage=8):e.isVector3||e.isColor?(t.boundary=16,t.storage=12):e.isVector4?(t.boundary=16,t.storage=16):e.isMatrix3?(t.boundary=48,t.storage=48):e.isMatrix4?(t.boundary=64,t.storage=64):e.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",e),t}function c(t){var n=t.target;n.removeEventListener("dispose",c);var r=o.indexOf(n.__bindingPointIndex);o.splice(r,1),e.deleteBuffer(i[n.id]),delete i[n.id],delete a[n.id]}return{bind:function(e,t){var n=t.program;r.uniformBlockBinding(e,n)},update:function(n,h){var p=i[n.id];void 0===p&&(function(e){for(var t=e.uniforms,n=0,r=0,i=0,a=t.length;i<a;i++){for(var o=t[i],s={boundary:0,storage:0},l=Array.isArray(o.value)?o.value:[o.value],c=0,h=l.length;c<h;c++){var p=l[c],d=u(p);s.boundary+=d.boundary,s.storage+=d.storage}if(o.__data=new Float32Array(s.storage/Float32Array.BYTES_PER_ELEMENT),o.__offset=n,i>0){var f=16-(r=n%16);0!==r&&f-s.boundary<0&&(n+=16-r,o.__offset=n)}n+=s.storage}(r=n%16)>0&&(n+=16-r),e.__size=n,e.__cache={}}(n),p=function(t){var n=function(){for(var e=0;e<s;e++)if(-1===o.indexOf(e))return o.push(e),e;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();t.__bindingPointIndex=n;var r=e.createBuffer(),i=t.__size,a=t.usage;return e.bindBuffer(e.UNIFORM_BUFFER,r),e.bufferData(e.UNIFORM_BUFFER,i,a),e.bindBuffer(e.UNIFORM_BUFFER,null),e.bindBufferBase(e.UNIFORM_BUFFER,n,r),r}(n),i[n.id]=p,n.addEventListener("dispose",c));var d=h.program;r.updateUBOMapping(n,d);var f=t.render.frame;a[n.id]!==f&&(function(t){var n=i[t.id],r=t.uniforms,a=t.__cache;e.bindBuffer(e.UNIFORM_BUFFER,n);for(var o=0,s=r.length;o<s;o++){var c=r[o];if(!0===l(c,o,a)){for(var h=c.__offset,p=Array.isArray(c.value)?c.value:[c.value],d=0,f=0;f<p.length;f++){var m=p[f],v=u(m);"number"==typeof m?(c.__data[0]=m,e.bufferSubData(e.UNIFORM_BUFFER,h+d,c.__data)):m.isMatrix3?(c.__data[0]=m.elements[0],c.__data[1]=m.elements[1],c.__data[2]=m.elements[2],c.__data[3]=m.elements[0],c.__data[4]=m.elements[3],c.__data[5]=m.elements[4],c.__data[6]=m.elements[5],c.__data[7]=m.elements[0],c.__data[8]=m.elements[6],c.__data[9]=m.elements[7],c.__data[10]=m.elements[8],c.__data[11]=m.elements[0]):(m.toArray(c.__data,d),d+=v.storage/Float32Array.BYTES_PER_ELEMENT)}e.bufferSubData(e.UNIFORM_BUFFER,h,c.__data)}}e.bindBuffer(e.UNIFORM_BUFFER,null)}(n),a[n.id]=f)},dispose:function(){for(var t in i)e.deleteBuffer(i[t]);o=[],i={},a={}}}}var Up=exports.WebGLRenderer=function(){function e(t={}){k(this,e);var n,r=t.canvas,i=void 0===r?Zr():r,a=t.context,o=void 0===a?null:a,s=t.depth,l=void 0===s||s,u=t.stencil,c=void 0===u||u,h=t.alpha,p=void 0!==h&&h,d=t.antialias,f=void 0!==d&&d,m=t.premultipliedAlpha,v=void 0===m||m,g=t.preserveDrawingBuffer,y=void 0!==g&&g,_=t.powerPreference,x=void 0===_?"default":_,M=t.failIfMajorPerformanceCaveat,S=void 0!==M&&M;this.isWebGLRenderer=!0,n=null!==o?o.getContextAttributes().alpha:p;var b=new Uint32Array(4),T=new Int32Array(4),E=null,w=null,A=[],R=[];this.domElement=i,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=Sn,this._useLegacyLights=!1,this.toneMapping=Ce,this.toneMappingExposure=1;var C=this,L=!1,P=0,I=0,U=null,N=-1,O=null,F=new pi,B=new pi,z=null,G=new Ga(0),H=0,V=i.width,W=i.height,X=1,Z=null,J=null,K=new pi(0,0,V,W),Q=new pi(0,0,V,W),$=!1,ee=new as,te=!1,ne=!1,re=null,ie=new Ki,ae=new Hr,oe=new Mi,se={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function le(){return null===U?X:1}var ue,ce,he,pe,de,fe,me,ve,ge,ye,_e,xe,Me,Se,be,Te,Ee,we,Ae,Re,ke,Le,Pe,Ie,Ue=o;function De(e,t){for(var n=0;n<e.length;n++){var r=e[n],a=i.getContext(r,t);if(null!==a)return a}return null}try{var Ne={alpha:!0,depth:l,stencil:c,antialias:f,premultipliedAlpha:v,preserveDrawingBuffer:y,powerPreference:x,failIfMajorPerformanceCaveat:S};if("setAttribute"in i&&i.setAttribute("data-engine","three.js r".concat(D)),i.addEventListener("webglcontextlost",ze,!1),i.addEventListener("webglcontextrestored",Ge,!1),i.addEventListener("webglcontextcreationerror",He,!1),null===Ue){var Oe=["webgl2","webgl","experimental-webgl"];if(!0===C.isWebGL1Renderer&&Oe.shift(),null===(Ue=De(Oe,Ne)))throw De(Oe)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}"undefined"!=typeof WebGLRenderingContext&&Ue instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),void 0===Ue.getShaderPrecisionFormat&&(Ue.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(tt){throw console.error("THREE.WebGLRenderer: "+tt.message),tt}function Fe(){ue=new mc(Ue),ce=new qu(Ue,ue,t),ue.init(ce),Le=new Ep(Ue,ue,ce),he=new bp(Ue,ue,ce),pe=new yc(Ue),de=new op,fe=new Tp(Ue,ue,he,de,ce,Le,pe),me=new Zu(C),ve=new fc(C),ge=new ss(Ue,ce),Pe=new Xu(Ue,ue,ge,ce),ye=new vc(Ue,ge,pe,Pe),_e=new Sc(Ue,ye,ge,pe),Ae=new Mc(Ue,ce,fe),Te=new Yu(de),xe=new ap(C,me,ve,ue,ce,Pe,Te),Me=new Pp(C,de),Se=new cp,be=new gp(ue,ce),we=new Wu(C,me,ve,he,_e,n,v),Ee=new Sp(C,_e,ce),Ie=new Ip(Ue,pe,ce,he),Re=new ju(Ue,ue,pe,ce),ke=new gc(Ue,ue,pe,ce),pe.programs=xe.programs,C.capabilities=ce,C.extensions=ue,C.properties=de,C.renderLists=Se,C.shadowMap=Ee,C.state=he,C.info=pe}Fe();var Be=new Lp(C,Ue);function ze(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),L=!0}function Ge(){console.log("THREE.WebGLRenderer: Context Restored."),L=!1;var e=pe.autoReset,t=Ee.enabled,n=Ee.autoUpdate,r=Ee.needsUpdate,i=Ee.type;Fe(),pe.autoReset=e,Ee.enabled=t,Ee.autoUpdate=n,Ee.needsUpdate=r,Ee.type=i}function He(e){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",e.statusMessage)}function Ve(e){var t=e.target;t.removeEventListener("dispose",Ve),function(e){(function(e){var t=de.get(e).programs;void 0!==t&&(t.forEach(function(e){xe.releaseProgram(e)}),e.isShaderMaterial&&xe.releaseShaderCache(e))})(e),de.remove(e)}(t)}this.xr=Be,this.getContext=function(){return Ue},this.getContextAttributes=function(){return Ue.getContextAttributes()},this.forceContextLoss=function(){var e=ue.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){var e=ue.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return X},this.setPixelRatio=function(e){void 0!==e&&(X=e,this.setSize(V,W,!1))},this.getSize=function(e){return e.set(V,W)},this.setSize=function(e,t,n=!0){Be.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(V=e,W=t,i.width=Math.floor(e*X),i.height=Math.floor(t*X),!0===n&&(i.style.width=e+"px",i.style.height=t+"px"),this.setViewport(0,0,e,t))},this.getDrawingBufferSize=function(e){return e.set(V*X,W*X).floor()},this.setDrawingBufferSize=function(e,t,n){V=e,W=t,X=n,i.width=Math.floor(e*n),i.height=Math.floor(t*n),this.setViewport(0,0,e,t)},this.getCurrentViewport=function(e){return e.copy(F)},this.getViewport=function(e){return e.copy(K)},this.setViewport=function(e,t,n,r){e.isVector4?K.set(e.x,e.y,e.z,e.w):K.set(e,t,n,r),he.viewport(F.copy(K).multiplyScalar(X).floor())},this.getScissor=function(e){return e.copy(Q)},this.setScissor=function(e,t,n,r){e.isVector4?Q.set(e.x,e.y,e.z,e.w):Q.set(e,t,n,r),he.scissor(B.copy(Q).multiplyScalar(X).floor())},this.getScissorTest=function(){return $},this.setScissorTest=function(e){he.setScissorTest($=e)},this.setOpaqueSort=function(e){Z=e},this.setTransparentSort=function(e){J=e},this.getClearColor=function(e){return e.copy(we.getClearColor())},this.setClearColor=function(){we.setClearColor.apply(we,arguments)},this.getClearAlpha=function(){return we.getClearAlpha()},this.setClearAlpha=function(){we.setClearAlpha.apply(we,arguments)},this.clear=function(e=!0,t=!0,n=!0){var r=0;if(e){var i=!1;if(null!==U){var a=U.texture.format;i=a===Mt||a===xt||a===yt}if(i){var o=U.texture.type,s=o===et||o===at||o===rt||o===ct||o===lt||o===ut,l=we.getClearColor(),u=we.getClearAlpha(),c=l.r,h=l.g,p=l.b;s?(b[0]=c,b[1]=h,b[2]=p,b[3]=u,Ue.clearBufferuiv(Ue.COLOR,0,b)):(T[0]=c,T[1]=h,T[2]=p,T[3]=u,Ue.clearBufferiv(Ue.COLOR,0,T))}else r|=Ue.COLOR_BUFFER_BIT}t&&(r|=Ue.DEPTH_BUFFER_BIT),n&&(r|=Ue.STENCIL_BUFFER_BIT),Ue.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){i.removeEventListener("webglcontextlost",ze,!1),i.removeEventListener("webglcontextrestored",Ge,!1),i.removeEventListener("webglcontextcreationerror",He,!1),Se.dispose(),be.dispose(),de.dispose(),me.dispose(),ve.dispose(),_e.dispose(),Pe.dispose(),Ie.dispose(),xe.dispose(),Be.dispose(),Be.removeEventListener("sessionstart",Xe),Be.removeEventListener("sessionend",je),re&&(re.dispose(),re=null),qe.stop()},this.renderBufferDirect=function(e,t,n,r,i,a){null===t&&(t=se);var o=i.isMesh&&i.matrixWorld.determinant()<0,s=function(e,t,n,r,i){!0!==t.isScene&&(t=se);fe.resetTextureUnits();var a=t.fog,o=r.isMeshStandardMaterial?t.environment:null,s=null===U?C.outputColorSpace:!0===U.isXRRenderTarget?U.texture.colorSpace:bn,l=(r.isMeshStandardMaterial?ve:me).get(r.envMap||o),u=!0===r.vertexColors&&!!n.attributes.color&&4===n.attributes.color.itemSize,c=!!n.attributes.tangent&&(!!r.normalMap||r.anisotropy>0),h=!!n.morphAttributes.position,p=!!n.morphAttributes.normal,d=!!n.morphAttributes.color,f=Ce;r.toneMapped&&(null!==U&&!0!==U.isXRRenderTarget||(f=C.toneMapping));var m=n.morphAttributes.position||n.morphAttributes.normal||n.morphAttributes.color,v=void 0!==m?m.length:0,g=de.get(r),y=w.state.lights;if(!0===te&&(!0===ne||e!==O)){var _=e===O&&r.id===N;Te.setState(r,e,_)}var x=!1;r.version===g.__version?g.needsLights&&g.lightsStateVersion!==y.state.version?x=!0:g.outputColorSpace!==s?x=!0:i.isInstancedMesh&&!1===g.instancing?x=!0:i.isInstancedMesh||!0!==g.instancing?i.isSkinnedMesh&&!1===g.skinning?x=!0:i.isSkinnedMesh||!0!==g.skinning?i.isInstancedMesh&&!0===g.instancingColor&&null===i.instanceColor?x=!0:i.isInstancedMesh&&!1===g.instancingColor&&null!==i.instanceColor?x=!0:g.envMap!==l?x=!0:!0===r.fog&&g.fog!==a?x=!0:void 0===g.numClippingPlanes||g.numClippingPlanes===Te.numPlanes&&g.numIntersection===Te.numIntersection?g.vertexAlphas!==u?x=!0:g.vertexTangents!==c?x=!0:g.morphTargets!==h?x=!0:g.morphNormals!==p?x=!0:g.morphColors!==d?x=!0:g.toneMapping!==f?x=!0:!0===ce.isWebGL2&&g.morphTargetsCount!==v&&(x=!0):x=!0:x=!0:x=!0:(x=!0,g.__version=r.version);var M=g.currentProgram;!0===x&&(M=Ke(r,t,i));var S=!1,b=!1,T=!1,E=M.getUniforms(),A=g.uniforms;he.useProgram(M.program)&&(S=!0,b=!0,T=!0);r.id!==N&&(N=r.id,b=!0);if(S||O!==e){E.setValue(Ue,"projectionMatrix",e.projectionMatrix),E.setValue(Ue,"viewMatrix",e.matrixWorldInverse);var R=E.map.cameraPosition;void 0!==R&&R.setValue(Ue,oe.setFromMatrixPosition(e.matrixWorld)),ce.logarithmicDepthBuffer&&E.setValue(Ue,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),(r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial)&&E.setValue(Ue,"isOrthographic",!0===e.isOrthographicCamera),O!==e&&(O=e,b=!0,T=!0)}if(i.isSkinnedMesh){E.setOptional(Ue,i,"bindMatrix"),E.setOptional(Ue,i,"bindMatrixInverse");var k=i.skeleton;k&&(ce.floatVertexTextures?(null===k.boneTexture&&k.computeBoneTexture(),E.setValue(Ue,"boneTexture",k.boneTexture,fe),E.setValue(Ue,"boneTextureSize",k.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}var L=n.morphAttributes;(void 0!==L.position||void 0!==L.normal||void 0!==L.color&&!0===ce.isWebGL2)&&Ae.update(i,n,M);(b||g.receiveShadow!==i.receiveShadow)&&(g.receiveShadow=i.receiveShadow,E.setValue(Ue,"receiveShadow",i.receiveShadow));r.isMeshGouraudMaterial&&null!==r.envMap&&(A.envMap.value=l,A.flipEnvMap.value=l.isCubeTexture&&!1===l.isRenderTargetTexture?-1:1);b&&(E.setValue(Ue,"toneMappingExposure",C.toneMappingExposure),g.needsLights&&(I=T,(P=A).ambientLightColor.needsUpdate=I,P.lightProbe.needsUpdate=I,P.directionalLights.needsUpdate=I,P.directionalLightShadows.needsUpdate=I,P.pointLights.needsUpdate=I,P.pointLightShadows.needsUpdate=I,P.spotLights.needsUpdate=I,P.spotLightShadows.needsUpdate=I,P.rectAreaLights.needsUpdate=I,P.hemisphereLights.needsUpdate=I),a&&!0===r.fog&&Me.refreshFogUniforms(A,a),Me.refreshMaterialUniforms(A,r,X,W,re),Rh.upload(Ue,g.uniformsList,A,fe));var P,I;r.isShaderMaterial&&!0===r.uniformsNeedUpdate&&(Rh.upload(Ue,g.uniformsList,A,fe),r.uniformsNeedUpdate=!1);r.isSpriteMaterial&&E.setValue(Ue,"center",i.center);if(E.setValue(Ue,"modelViewMatrix",i.modelViewMatrix),E.setValue(Ue,"normalMatrix",i.normalMatrix),E.setValue(Ue,"modelMatrix",i.matrixWorld),r.isShaderMaterial||r.isRawShaderMaterial)for(var D=r.uniformsGroups,F=0,B=D.length;F<B;F++)if(ce.isWebGL2){var z=D[F];Ie.update(z,M),Ie.bind(z,M)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.");return M}(e,t,n,r,i);he.setMaterial(r,o);var l=n.index,u=1;if(!0===r.wireframe){if(void 0===(l=ye.getWireframeAttribute(n)))return;u=2}var c=n.drawRange,h=n.attributes.position,p=c.start*u,d=(c.start+c.count)*u;null!==a&&(p=Math.max(p,a.start*u),d=Math.min(d,(a.start+a.count)*u)),null!==l?(p=Math.max(p,0),d=Math.min(d,l.count)):null!=h&&(p=Math.max(p,0),d=Math.min(d,h.count));var f=d-p;if(!(f<0||f===1/0)){var m;Pe.setup(i,r,s,n,l);var v=Re;if(null!==l&&(m=ge.get(l),(v=ke).setIndex(m)),i.isMesh)!0===r.wireframe?(he.setLineWidth(r.wireframeLinewidth*le()),v.setMode(Ue.LINES)):v.setMode(Ue.TRIANGLES);else if(i.isLine){var g=r.linewidth;void 0===g&&(g=1),he.setLineWidth(g*le()),i.isLineSegments?v.setMode(Ue.LINES):i.isLineLoop?v.setMode(Ue.LINE_LOOP):v.setMode(Ue.LINE_STRIP)}else i.isPoints?v.setMode(Ue.POINTS):i.isSprite&&v.setMode(Ue.TRIANGLES);if(i.isInstancedMesh)v.renderInstances(p,f,i.count);else if(n.isInstancedBufferGeometry){var y=void 0!==n._maxInstanceCount?n._maxInstanceCount:1/0,_=Math.min(n.instanceCount,y);v.renderInstances(p,f,_)}else v.render(p,f)}},this.compile=function(e,t){function n(e,t,n){!0===e.transparent&&e.side===Y&&!1===e.forceSinglePass?(e.side=q,e.needsUpdate=!0,Ke(e,t,n),e.side=j,e.needsUpdate=!0,Ke(e,t,n),e.side=Y):Ke(e,t,n)}(w=be.get(e)).init(),R.push(w),e.traverseVisible(function(e){e.isLight&&e.layers.test(t.layers)&&(w.pushLight(e),e.castShadow&&w.pushShadow(e))}),w.setupLights(C._useLegacyLights),e.traverse(function(t){var r=t.material;if(r)if(Array.isArray(r))for(var i=0;i<r.length;i++){n(r[i],e,t)}else n(r,e,t)}),R.pop(),w=null};var We=null;function Xe(){qe.stop()}function je(){qe.start()}var qe=new os;function Ye(e,t,n,r){var i=e.opaque,a=e.transmissive,o=e.transparent;w.setupLightsView(n),!0===te&&Te.setGlobalState(C.clippingPlanes,n),a.length>0&&function(e,t,n,r){var i=ce.isWebGL2;null===re&&(re=new fi(1,1,{generateMipmaps:!0,type:ue.has("EXT_color_buffer_half_float")?st:et,minFilter:Qe,samples:i?4:0}));C.getDrawingBufferSize(ae),i?re.setSize(ae.x,ae.y):re.setSize(Or(ae.x),Or(ae.y));var a=C.getRenderTarget();C.setRenderTarget(re),C.getClearColor(G),(H=C.getClearAlpha())<1&&C.setClearColor(16777215,.5);C.clear();var o=C.toneMapping;C.toneMapping=Ce,Ze(e,n,r),fe.updateMultisampleRenderTarget(re),fe.updateRenderTargetMipmap(re);for(var s=!1,l=0,u=t.length;l<u;l++){var c=t[l],h=c.object,p=c.geometry,d=c.material,f=c.group;if(d.side===Y&&h.layers.test(r.layers)){var m=d.side;d.side=q,d.needsUpdate=!0,Je(h,n,r,p,d,f),d.side=m,d.needsUpdate=!0,s=!0}}!0===s&&(fe.updateMultisampleRenderTarget(re),fe.updateRenderTargetMipmap(re));C.setRenderTarget(a),C.setClearColor(G,H),C.toneMapping=o}(i,a,t,n),r&&he.viewport(F.copy(r)),i.length>0&&Ze(i,t,n),a.length>0&&Ze(a,t,n),o.length>0&&Ze(o,t,n),he.buffers.depth.setTest(!0),he.buffers.depth.setMask(!0),he.buffers.color.setMask(!0),he.setPolygonOffset(!1)}function Ze(e,t,n){for(var r=!0===t.isScene?t.overrideMaterial:null,i=0,a=e.length;i<a;i++){var o=e[i],s=o.object,l=o.geometry,u=null===r?o.material:r,c=o.group;s.layers.test(n.layers)&&Je(s,t,n,l,u,c)}}function Je(e,t,n,r,i,a){e.onBeforeRender(C,t,n,r,i,a),e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),i.onBeforeRender(C,t,n,r,e,a),!0===i.transparent&&i.side===Y&&!1===i.forceSinglePass?(i.side=q,i.needsUpdate=!0,C.renderBufferDirect(n,t,r,i,e,a),i.side=j,i.needsUpdate=!0,C.renderBufferDirect(n,t,r,i,e,a),i.side=Y):C.renderBufferDirect(n,t,r,i,e,a),e.onAfterRender(C,t,n,r,i,a)}function Ke(e,t,n){!0!==t.isScene&&(t=se);var r=de.get(e),i=w.state.lights,a=w.state.shadowsArray,o=i.state.version,s=xe.getParameters(e,i.state,a,t,n),l=xe.getProgramCacheKey(s),u=r.programs;r.environment=e.isMeshStandardMaterial?t.environment:null,r.fog=t.fog,r.envMap=(e.isMeshStandardMaterial?ve:me).get(e.envMap||r.environment),void 0===u&&(e.addEventListener("dispose",Ve),u=new Map,r.programs=u);var c=u.get(l);if(void 0!==c){if(r.currentProgram===c&&r.lightsStateVersion===o)return $e(e,s),c}else s.uniforms=xe.getUniforms(e),e.onBuild(n,s,C),e.onBeforeCompile(s,C),c=xe.acquireProgram(s,l),u.set(l,c),r.uniforms=s.uniforms;var h=r.uniforms;(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(h.clippingPlanes=Te.uniform),$e(e,s),r.needsLights=function(e){return e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights}(e),r.lightsStateVersion=o,r.needsLights&&(h.ambientLightColor.value=i.state.ambient,h.lightProbe.value=i.state.probe,h.directionalLights.value=i.state.directional,h.directionalLightShadows.value=i.state.directionalShadow,h.spotLights.value=i.state.spot,h.spotLightShadows.value=i.state.spotShadow,h.rectAreaLights.value=i.state.rectArea,h.ltc_1.value=i.state.rectAreaLTC1,h.ltc_2.value=i.state.rectAreaLTC2,h.pointLights.value=i.state.point,h.pointLightShadows.value=i.state.pointShadow,h.hemisphereLights.value=i.state.hemi,h.directionalShadowMap.value=i.state.directionalShadowMap,h.directionalShadowMatrix.value=i.state.directionalShadowMatrix,h.spotShadowMap.value=i.state.spotShadowMap,h.spotLightMatrix.value=i.state.spotLightMatrix,h.spotLightMap.value=i.state.spotLightMap,h.pointShadowMap.value=i.state.pointShadowMap,h.pointShadowMatrix.value=i.state.pointShadowMatrix);var p=c.getUniforms(),d=Rh.seqWithValue(p.seq,h);return r.currentProgram=c,r.uniformsList=d,c}function $e(e,t){var n=de.get(e);n.outputColorSpace=t.outputColorSpace,n.instancing=t.instancing,n.instancingColor=t.instancingColor,n.skinning=t.skinning,n.morphTargets=t.morphTargets,n.morphNormals=t.morphNormals,n.morphColors=t.morphColors,n.morphTargetsCount=t.morphTargetsCount,n.numClippingPlanes=t.numClippingPlanes,n.numIntersection=t.numClipIntersection,n.vertexAlphas=t.vertexAlphas,n.vertexTangents=t.vertexTangents,n.toneMapping=t.toneMapping}qe.setAnimationLoop(function(e){We&&We(e)}),"undefined"!=typeof self&&qe.setContext(self),this.setAnimationLoop=function(e){We=e,Be.setAnimationLoop(e),null===e?qe.stop():qe.start()},Be.addEventListener("sessionstart",Xe),Be.addEventListener("sessionend",je),this.render=function(e,t){if(void 0===t||!0===t.isCamera){if(!0!==L){!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),null===t.parent&&!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),!0===Be.enabled&&!0===Be.isPresenting&&(!0===Be.cameraAutoUpdate&&Be.updateCamera(t),t=Be.getCamera()),!0===e.isScene&&e.onBeforeRender(C,e,t,U),(w=be.get(e,R.length)).init(),R.push(w),ie.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),ee.setFromProjectionMatrix(ie),ne=this.localClippingEnabled,te=Te.init(this.clippingPlanes,ne),(E=Se.get(e,A.length)).init(),A.push(E),function e(t,n,r,i){if(!1===t.visible)return;var a=t.layers.test(n.layers);if(a)if(t.isGroup)r=t.renderOrder;else if(t.isLOD)!0===t.autoUpdate&&t.update(n);else if(t.isLight)w.pushLight(t),t.castShadow&&w.pushShadow(t);else if(t.isSprite){if(!t.frustumCulled||ee.intersectsSprite(t)){i&&oe.setFromMatrixPosition(t.matrixWorld).applyMatrix4(ie);var o=_e.update(t),s=t.material;s.visible&&E.push(t,o,s,r,oe.z,null)}}else if((t.isMesh||t.isLine||t.isPoints)&&(!t.frustumCulled||ee.intersectsObject(t))){var l=_e.update(t),u=t.material;if(i&&(void 0!==t.boundingSphere?(null===t.boundingSphere&&t.computeBoundingSphere(),oe.copy(t.boundingSphere.center)):(null===l.boundingSphere&&l.computeBoundingSphere(),oe.copy(l.boundingSphere.center)),oe.applyMatrix4(t.matrixWorld).applyMatrix4(ie)),Array.isArray(u))for(var c=l.groups,h=0,p=c.length;h<p;h++){var d=c[h],f=u[d.materialIndex];f&&f.visible&&E.push(t,l,f,r,oe.z,d)}else u.visible&&E.push(t,l,u,r,oe.z,null)}var m=t.children;for(var v=0,g=m.length;v<g;v++)e(m[v],n,r,i)}(e,t,0,C.sortObjects),E.finish(),!0===C.sortObjects&&E.sort(Z,J),this.info.render.frame++,!0===te&&Te.beginShadows();var n=w.state.shadowsArray;if(Ee.render(n,e,t),!0===te&&Te.endShadows(),!0===this.info.autoReset&&this.info.reset(),we.render(E,e),w.setupLights(C._useLegacyLights),t.isArrayCamera)for(var r=t.cameras,i=0,a=r.length;i<a;i++){var o=r[i];Ye(E,e,o,o.viewport)}else Ye(E,e,t);null!==U&&(fe.updateMultisampleRenderTarget(U),fe.updateRenderTargetMipmap(U)),!0===e.isScene&&e.onAfterRender(C,e,t),Pe.resetDefaultState(),N=-1,O=null,R.pop(),w=R.length>0?R[R.length-1]:null,A.pop(),E=A.length>0?A[A.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return P},this.getActiveMipmapLevel=function(){return I},this.getRenderTarget=function(){return U},this.setRenderTargetTextures=function(e,t,n){de.get(e.texture).__webglTexture=t,de.get(e.depthTexture).__webglTexture=n;var r=de.get(e);r.__hasExternalTextures=!0,r.__hasExternalTextures&&(r.__autoAllocateDepthBuffer=void 0===n,r.__autoAllocateDepthBuffer||!0===ue.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),r.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(e,t){var n=de.get(e);n.__webglFramebuffer=t,n.__useDefaultFramebuffer=void 0===t},this.setRenderTarget=function(e,t=0,n=0){U=e,P=t,I=n;var r=!0,i=null,a=!1,o=!1;if(e){var s=de.get(e);void 0!==s.__useDefaultFramebuffer?(he.bindFramebuffer(Ue.FRAMEBUFFER,null),r=!1):void 0===s.__webglFramebuffer?fe.setupRenderTarget(e):s.__hasExternalTextures&&fe.rebindTextures(e,de.get(e.texture).__webglTexture,de.get(e.depthTexture).__webglTexture);var l=e.texture;(l.isData3DTexture||l.isDataArrayTexture||l.isCompressedArrayTexture)&&(o=!0);var u=de.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget?(i=Array.isArray(u[t])?u[t][n]:u[t],a=!0):i=ce.isWebGL2&&e.samples>0&&!1===fe.useMultisampledRTT(e)?de.get(e).__webglMultisampledFramebuffer:Array.isArray(u)?u[n]:u,F.copy(e.viewport),B.copy(e.scissor),z=e.scissorTest}else F.copy(K).multiplyScalar(X).floor(),B.copy(Q).multiplyScalar(X).floor(),z=$;if(he.bindFramebuffer(Ue.FRAMEBUFFER,i)&&ce.drawBuffers&&r&&he.drawBuffers(e,i),he.viewport(F),he.scissor(B),he.setScissorTest(z),a){var c=de.get(e.texture);Ue.framebufferTexture2D(Ue.FRAMEBUFFER,Ue.COLOR_ATTACHMENT0,Ue.TEXTURE_CUBE_MAP_POSITIVE_X+t,c.__webglTexture,n)}else if(o){var h=de.get(e.texture),p=t||0;Ue.framebufferTextureLayer(Ue.FRAMEBUFFER,Ue.COLOR_ATTACHMENT0,h.__webglTexture,n||0,p)}N=-1},this.readRenderTargetPixels=function(e,t,n,r,i,a,o){if(e&&e.isWebGLRenderTarget){var s=de.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==o&&(s=s[o]),s){he.bindFramebuffer(Ue.FRAMEBUFFER,s);try{var l=e.texture,u=l.format,c=l.type;if(u!==pt&&Le.convert(u)!==Ue.getParameter(Ue.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");var h=c===st&&(ue.has("EXT_color_buffer_half_float")||ce.isWebGL2&&ue.has("EXT_color_buffer_float"));if(!(c===et||Le.convert(c)===Ue.getParameter(Ue.IMPLEMENTATION_COLOR_READ_TYPE)||c===ot&&(ce.isWebGL2||ue.has("OES_texture_float")||ue.has("WEBGL_color_buffer_float"))||h))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");t>=0&&t<=e.width-r&&n>=0&&n<=e.height-i&&Ue.readPixels(t,n,r,i,Le.convert(u),Le.convert(c),a)}finally{var p=null!==U?de.get(U).__webglFramebuffer:null;he.bindFramebuffer(Ue.FRAMEBUFFER,p)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(e,t,n=0){var r=Math.pow(2,-n),i=Math.floor(t.image.width*r),a=Math.floor(t.image.height*r);fe.setTexture2D(t,0),Ue.copyTexSubImage2D(Ue.TEXTURE_2D,n,0,0,e.x,e.y,i,a),he.unbindTexture()},this.copyTextureToTexture=function(e,t,n,r=0){var i=t.image.width,a=t.image.height,o=Le.convert(n.format),s=Le.convert(n.type);fe.setTexture2D(n,0),Ue.pixelStorei(Ue.UNPACK_FLIP_Y_WEBGL,n.flipY),Ue.pixelStorei(Ue.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n.premultiplyAlpha),Ue.pixelStorei(Ue.UNPACK_ALIGNMENT,n.unpackAlignment),t.isDataTexture?Ue.texSubImage2D(Ue.TEXTURE_2D,r,e.x,e.y,i,a,o,s,t.image.data):t.isCompressedTexture?Ue.compressedTexSubImage2D(Ue.TEXTURE_2D,r,e.x,e.y,t.mipmaps[0].width,t.mipmaps[0].height,o,t.mipmaps[0].data):Ue.texSubImage2D(Ue.TEXTURE_2D,r,e.x,e.y,o,s,t.image),0===r&&n.generateMipmaps&&Ue.generateMipmap(Ue.TEXTURE_2D),he.unbindTexture()},this.copyTextureToTexture3D=function(e,t,n,r,i=0){if(C.isWebGL1Renderer)console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");else{var a,o=e.max.x-e.min.x+1,s=e.max.y-e.min.y+1,l=e.max.z-e.min.z+1,u=Le.convert(r.format),c=Le.convert(r.type);if(r.isData3DTexture)fe.setTexture3D(r,0),a=Ue.TEXTURE_3D;else{if(!r.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");fe.setTexture2DArray(r,0),a=Ue.TEXTURE_2D_ARRAY}Ue.pixelStorei(Ue.UNPACK_FLIP_Y_WEBGL,r.flipY),Ue.pixelStorei(Ue.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.premultiplyAlpha),Ue.pixelStorei(Ue.UNPACK_ALIGNMENT,r.unpackAlignment);var h=Ue.getParameter(Ue.UNPACK_ROW_LENGTH),p=Ue.getParameter(Ue.UNPACK_IMAGE_HEIGHT),d=Ue.getParameter(Ue.UNPACK_SKIP_PIXELS),f=Ue.getParameter(Ue.UNPACK_SKIP_ROWS),m=Ue.getParameter(Ue.UNPACK_SKIP_IMAGES),v=n.isCompressedTexture?n.mipmaps[0]:n.image;Ue.pixelStorei(Ue.UNPACK_ROW_LENGTH,v.width),Ue.pixelStorei(Ue.UNPACK_IMAGE_HEIGHT,v.height),Ue.pixelStorei(Ue.UNPACK_SKIP_PIXELS,e.min.x),Ue.pixelStorei(Ue.UNPACK_SKIP_ROWS,e.min.y),Ue.pixelStorei(Ue.UNPACK_SKIP_IMAGES,e.min.z),n.isDataTexture||n.isData3DTexture?Ue.texSubImage3D(a,i,t.x,t.y,t.z,o,s,l,u,c,v.data):n.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),Ue.compressedTexSubImage3D(a,i,t.x,t.y,t.z,o,s,l,u,v.data)):Ue.texSubImage3D(a,i,t.x,t.y,t.z,o,s,l,u,c,v),Ue.pixelStorei(Ue.UNPACK_ROW_LENGTH,h),Ue.pixelStorei(Ue.UNPACK_IMAGE_HEIGHT,p),Ue.pixelStorei(Ue.UNPACK_SKIP_PIXELS,d),Ue.pixelStorei(Ue.UNPACK_SKIP_ROWS,f),Ue.pixelStorei(Ue.UNPACK_SKIP_IMAGES,m),0===i&&r.generateMipmaps&&Ue.generateMipmap(a),he.unbindTexture()}},this.initTexture=function(e){e.isCubeTexture?fe.setTextureCube(e,0):e.isData3DTexture?fe.setTexture3D(e,0):e.isDataArrayTexture||e.isCompressedArrayTexture?fe.setTexture2DArray(e,0):fe.setTexture2D(e,0),he.unbindTexture()},this.resetState=function(){P=0,I=0,U=null,he.reset(),Pe.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}return P(e,[{key:"coordinateSystem",get:function(){return pr}},{key:"outputColorSpace",get:function(){return this._outputColorSpace},set:function(e){this._outputColorSpace=e;var t=this.getContext();t.drawingBufferColorSpace=e===Tn?"display-p3":"srgb",t.unpackColorSpace=ri.workingColorSpace===En?"display-p3":"srgb"}},{key:"physicallyCorrectLights",get:function(){return console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights},set:function(e){console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!e}},{key:"outputEncoding",get:function(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===Sn?vn:mn},set:function(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=e===vn?Sn:bn}},{key:"useLegacyLights",get:function(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights},set:function(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}}]),e}(),Dp=exports.WebGL1Renderer=function(e){x(n,Up);var t=S(n);function n(){return k(this,n),t.apply(this,arguments)}return P(n)}();Dp.prototype.isWebGL1Renderer=!0;var Np,Op=exports.FogExp2=function(){function e(t,n=25e-5){k(this,e),this.isFogExp2=!0,this.name="",this.color=new Ga(t),this.density=n}return P(e,[{key:"clone",value:function(){return new e(this.color,this.density)}},{key:"toJSON",value:function(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}]),e}(),Fp=exports.Fog=function(){function e(t,n=1,r=1e3){k(this,e),this.isFog=!0,this.name="",this.color=new Ga(t),this.near=n,this.far=r}return P(e,[{key:"clone",value:function(){return new e(this.color,this.near,this.far)}},{key:"toJSON",value:function(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}]),e}(),Bp=exports.Scene=function(e){x(n,Sa);var t=S(n);function n(){var e;return k(this,n),(e=t.call(this)).isScene=!0,e.type="Scene",e.background=null,e.environment=null,e.fog=null,e.backgroundBlurriness=0,e.backgroundIntensity=1,e.overrideMaterial=null,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:T(e)})),e}return P(n,[{key:"copy",value:function(e,t){return p(w(n.prototype),"copy",this).call(this,e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}},{key:"toJSON",value:function(e){var t=p(w(n.prototype),"toJSON",this).call(this,e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t}}]),n}(),zp=exports.InterleavedBuffer=function(){function e(t,n){k(this,e),this.isInterleavedBuffer=!0,this.array=t,this.stride=n,this.count=void 0!==t?t.length/n:0,this.usage=er,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=_r()}return P(e,[{key:"onUploadCallback",value:function(){}},{key:"needsUpdate",set:function(e){!0===e&&this.version++}},{key:"setUsage",value:function(e){return this.usage=e,this}},{key:"copy",value:function(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}},{key:"copyAt",value:function(e,t,n){e*=this.stride,n*=t.stride;for(var r=0,i=this.stride;r<i;r++)this.array[e+r]=t.array[n+r];return this}},{key:"set",value:function(e,t=0){return this.array.set(e,t),this}},{key:"clone",value:function(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=_r()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);var t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}},{key:"onUpload",value:function(e){return this.onUploadCallback=e,this}},{key:"toJSON",value:function(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=_r()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}]),e}(),Gp=new Mi,Hp=exports.InterleavedBufferAttribute=function(){function e(t,n,r,i=!1){k(this,e),this.isInterleavedBufferAttribute=!0,this.name="",this.data=t,this.itemSize=n,this.offset=r,this.normalized=i}return P(e,[{key:"count",get:function(){return this.data.count}},{key:"array",get:function(){return this.data.array}},{key:"needsUpdate",set:function(e){this.data.needsUpdate=e}},{key:"applyMatrix4",value:function(e){for(var t=0,n=this.data.count;t<n;t++)Gp.fromBufferAttribute(this,t),Gp.applyMatrix4(e),this.setXYZ(t,Gp.x,Gp.y,Gp.z);return this}},{key:"applyNormalMatrix",value:function(e){for(var t=0,n=this.count;t<n;t++)Gp.fromBufferAttribute(this,t),Gp.applyNormalMatrix(e),this.setXYZ(t,Gp.x,Gp.y,Gp.z);return this}},{key:"transformDirection",value:function(e){for(var t=0,n=this.count;t<n;t++)Gp.fromBufferAttribute(this,t),Gp.transformDirection(e),this.setXYZ(t,Gp.x,Gp.y,Gp.z);return this}},{key:"setX",value:function(e,t){return this.normalized&&(t=zr(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}},{key:"setY",value:function(e,t){return this.normalized&&(t=zr(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}},{key:"setZ",value:function(e,t){return this.normalized&&(t=zr(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}},{key:"setW",value:function(e,t){return this.normalized&&(t=zr(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}},{key:"getX",value:function(e){var t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Br(t,this.array)),t}},{key:"getY",value:function(e){var t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Br(t,this.array)),t}},{key:"getZ",value:function(e){var t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Br(t,this.array)),t}},{key:"getW",value:function(e){var t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Br(t,this.array)),t}},{key:"setXY",value:function(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=zr(t,this.array),n=zr(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}},{key:"setXYZ",value:function(e,t,n,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=zr(t,this.array),n=zr(n,this.array),r=zr(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this}},{key:"setXYZW",value:function(e,t,n,r,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=zr(t,this.array),n=zr(n,this.array),r=zr(r,this.array),i=zr(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=i,this}},{key:"clone",value:function(t){if(void 0===t){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");for(var n=[],r=0;r<this.count;r++)for(var i=r*this.data.stride+this.offset,a=0;a<this.itemSize;a++)n.push(this.data.array[i+a]);return new Ka(new this.array.constructor(n),this.itemSize,this.normalized)}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.clone(t)),new e(t.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}},{key:"toJSON",value:function(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");for(var t=[],n=0;n<this.count;n++)for(var r=n*this.data.stride+this.offset,i=0;i<this.itemSize;i++)t.push(this.data.array[r+i]);return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}]),e}(),Vp=exports.SpriteMaterial=function(e){x(n,Na);var t=S(n);function n(e){var r;return k(this,n),(r=t.call(this)).isSpriteMaterial=!0,r.type="SpriteMaterial",r.color=new Ga(16777215),r.map=null,r.alphaMap=null,r.rotation=0,r.sizeAttenuation=!0,r.transparent=!0,r.fog=!0,r.setValues(e),r}return P(n,[{key:"copy",value:function(e){return p(w(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}]),n}(),Wp=new Mi,Xp=new Mi,jp=new Mi,qp=new Hr,Yp=new Hr,Zp=new Ki,Jp=new Mi,Kp=new Mi,Qp=new Mi,$p=new Hr,ed=new Hr,td=new Hr,nd=exports.Sprite=function(e){x(n,Sa);var t=S(n);function n(e=new Vp){var r;if(k(this,n),(r=t.call(this)).isSprite=!0,r.type="Sprite",void 0===Np){Np=new vo;var i=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),a=new zp(i,5);Np.setIndex([0,1,2,0,2,3]),Np.setAttribute("position",new Hp(a,3,0,!1)),Np.setAttribute("uv",new Hp(a,2,3,!1))}return r.geometry=Np,r.material=e,r.center=new Hr(.5,.5),r}return P(n,[{key:"raycast",value:function(e,t){null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Xp.setFromMatrixScale(this.matrixWorld),Zp.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),jp.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&Xp.multiplyScalar(-jp.z);var n,r,i=this.material.rotation;0!==i&&(r=Math.cos(i),n=Math.sin(i));var a=this.center;rd(Jp.set(-.5,-.5,0),jp,a,Xp,n,r),rd(Kp.set(.5,-.5,0),jp,a,Xp,n,r),rd(Qp.set(.5,.5,0),jp,a,Xp,n,r),$p.set(0,0),ed.set(1,0),td.set(1,1);var o=e.ray.intersectTriangle(Jp,Kp,Qp,!1,Wp);if(null!==o||(rd(Kp.set(-.5,.5,0),jp,a,Xp,n,r),ed.set(0,1),null!==(o=e.ray.intersectTriangle(Jp,Qp,Kp,!1,Wp)))){var s=e.ray.origin.distanceTo(Wp);s<e.near||s>e.far||t.push({distance:s,point:Wp.clone(),uv:Ua.getInterpolation(Wp,Jp,Kp,Qp,$p,ed,td,new Hr),face:null,object:this})}}},{key:"copy",value:function(e,t){return p(w(n.prototype),"copy",this).call(this,e,t),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}}]),n}();function rd(e,t,n,r,i,a){qp.subVectors(e,n).addScalar(.5).multiply(r),void 0!==i?(Yp.x=a*qp.x-i*qp.y,Yp.y=i*qp.x+a*qp.y):Yp.copy(qp),e.copy(t),e.x+=Yp.x,e.y+=Yp.y,e.applyMatrix4(Zp)}var id=new Mi,ad=new Mi,od=exports.LOD=function(e){x(n,Sa);var t=S(n);function n(){var e;return k(this,n),(e=t.call(this))._currentLevel=0,e.type="LOD",Object.defineProperties(T(e),{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),e.autoUpdate=!0,e}return P(n,[{key:"copy",value:function(e){p(w(n.prototype),"copy",this).call(this,e,!1);for(var t=e.levels,r=0,i=t.length;r<i;r++){var a=t[r];this.addLevel(a.object.clone(),a.distance,a.hysteresis)}return this.autoUpdate=e.autoUpdate,this}},{key:"addLevel",value:function(e,t=0,n=0){t=Math.abs(t);var r,i=this.levels;for(r=0;r<i.length&&!(t<i[r].distance);r++);return i.splice(r,0,{distance:t,hysteresis:n,object:e}),this.add(e),this}},{key:"getCurrentLevel",value:function(){return this._currentLevel}},{key:"getObjectForDistance",value:function(e){var t=this.levels;if(t.length>0){var n,r;for(n=1,r=t.length;n<r;n++){var i=t[n].distance;if(t[n].object.visible&&(i-=i*t[n].hysteresis),e<i)break}return t[n-1].object}return null}},{key:"raycast",value:function(e,t){if(this.levels.length>0){id.setFromMatrixPosition(this.matrixWorld);var n=e.ray.origin.distanceTo(id);this.getObjectForDistance(n).raycast(e,t)}}},{key:"update",value:function(e){var t=this.levels;if(t.length>1){id.setFromMatrixPosition(e.matrixWorld),ad.setFromMatrixPosition(this.matrixWorld);var n,r,i=id.distanceTo(ad)/e.zoom;for(t[0].object.visible=!0,n=1,r=t.length;n<r;n++){var a=t[n].distance;if(t[n].object.visible&&(a-=a*t[n].hysteresis),!(i>=a))break;t[n-1].object.visible=!1,t[n].object.visible=!0}for(this._currentLevel=n-1;n<r;n++)t[n].object.visible=!1}}},{key:"toJSON",value:function(e){var t=p(w(n.prototype),"toJSON",this).call(this,e);!1===this.autoUpdate&&(t.object.autoUpdate=!1),t.object.levels=[];for(var r=this.levels,i=0,a=r.length;i<a;i++){var o=r[i];t.object.levels.push({object:o.object.uuid,distance:o.distance,hysteresis:o.hysteresis})}return t}}]),n}(),sd=new Mi,ld=new pi,ud=new pi,cd=new Mi,hd=new Ki,pd=new Mi,dd=new Hi,fd=new Ki,md=new Ji,vd=exports.SkinnedMesh=function(e){x(n,Uo);var t=S(n);function n(e,r){var i;return k(this,n),(i=t.call(this,e,r)).isSkinnedMesh=!0,i.type="SkinnedMesh",i.bindMode="attached",i.bindMatrix=new Ki,i.bindMatrixInverse=new Ki,i.boundingBox=null,i.boundingSphere=null,i}return P(n,[{key:"computeBoundingBox",value:function(){var e=this.geometry;null===this.boundingBox&&(this.boundingBox=new Ti),this.boundingBox.makeEmpty();for(var t=e.getAttribute("position"),n=0;n<t.count;n++)pd.fromBufferAttribute(t,n),this.applyBoneTransform(n,pd),this.boundingBox.expandByPoint(pd)}},{key:"computeBoundingSphere",value:function(){var e=this.geometry;null===this.boundingSphere&&(this.boundingSphere=new Hi),this.boundingSphere.makeEmpty();for(var t=e.getAttribute("position"),n=0;n<t.count;n++)pd.fromBufferAttribute(t,n),this.applyBoneTransform(n,pd),this.boundingSphere.expandByPoint(pd)}},{key:"copy",value:function(e,t){return p(w(n.prototype),"copy",this).call(this,e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}},{key:"raycast",value:function(e,t){var n=this.material,r=this.matrixWorld;void 0!==n&&(null===this.boundingSphere&&this.computeBoundingSphere(),dd.copy(this.boundingSphere),dd.applyMatrix4(r),!1!==e.ray.intersectsSphere(dd)&&(fd.copy(r).invert(),md.copy(e.ray).applyMatrix4(fd),null!==this.boundingBox&&!1===md.intersectsBox(this.boundingBox)||this._computeIntersections(e,t,md)))}},{key:"getVertexPosition",value:function(e,t){return p(w(n.prototype),"getVertexPosition",this).call(this,e,t),this.applyBoneTransform(e,t),t}},{key:"bind",value:function(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}},{key:"pose",value:function(){this.skeleton.pose()}},{key:"normalizeSkinWeights",value:function(){for(var e=new pi,t=this.geometry.attributes.skinWeight,n=0,r=t.count;n<r;n++){e.fromBufferAttribute(t,n);var i=1/e.manhattanLength();i!==1/0?e.multiplyScalar(i):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}},{key:"updateMatrixWorld",value:function(e){p(w(n.prototype),"updateMatrixWorld",this).call(this,e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}},{key:"applyBoneTransform",value:function(e,t){var n=this.skeleton,r=this.geometry;ld.fromBufferAttribute(r.attributes.skinIndex,e),ud.fromBufferAttribute(r.attributes.skinWeight,e),sd.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(var i=0;i<4;i++){var a=ud.getComponent(i);if(0!==a){var o=ld.getComponent(i);hd.multiplyMatrices(n.bones[o].matrixWorld,n.boneInverses[o]),t.addScaledVector(cd.copy(sd).applyMatrix4(hd),a)}}return t.applyMatrix4(this.bindMatrixInverse)}},{key:"boneTransform",value:function(e,t){return console.warn("THREE.SkinnedMesh: .boneTransform() was renamed to .applyBoneTransform() in r151."),this.applyBoneTransform(e,t)}}]),n}(),gd=exports.Bone=function(e){x(n,Sa);var t=S(n);function n(){var e;return k(this,n),(e=t.call(this)).isBone=!0,e.type="Bone",e}return P(n)}(),yd=exports.DataTexture=function(e){x(n,hi);var t=S(n);function n(e=null,r=1,i=1,a,o,s,l,u,c=We,h=We,p,d){var f;return k(this,n),(f=t.call(this,null,s,l,u,c,h,a,o,p,d)).isDataTexture=!0,f.image={data:e,width:r,height:i},f.generateMipmaps=!1,f.flipY=!1,f.unpackAlignment=1,f}return P(n)}(),_d=new Ki,xd=new Ki,Md=exports.Skeleton=function(){function e(t=[],n=[]){k(this,e),this.uuid=_r(),this.bones=t.slice(0),this.boneInverses=n,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.init()}return P(e,[{key:"init",value:function(){var e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(var n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new Ki)}}},{key:"calculateInverses",value:function(){this.boneInverses.length=0;for(var e=0,t=this.bones.length;e<t;e++){var n=new Ki;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}},{key:"pose",value:function(){for(var e=0,t=this.bones.length;e<t;e++){var n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(var r=0,i=this.bones.length;r<i;r++){var a=this.bones[r];a&&(a.parent&&a.parent.isBone?(a.matrix.copy(a.parent.matrixWorld).invert(),a.matrix.multiply(a.matrixWorld)):a.matrix.copy(a.matrixWorld),a.matrix.decompose(a.position,a.quaternion,a.scale))}}},{key:"update",value:function(){for(var e=this.bones,t=this.boneInverses,n=this.boneMatrices,r=this.boneTexture,i=0,a=e.length;i<a;i++){var o=e[i]?e[i].matrixWorld:xd;_d.multiplyMatrices(o,t[i]),_d.toArray(n,16*i)}null!==r&&(r.needsUpdate=!0)}},{key:"clone",value:function(){return new e(this.bones,this.boneInverses)}},{key:"computeBoneTexture",value:function(){var e=Math.sqrt(4*this.bones.length);e=Nr(e),e=Math.max(e,4);var t=new Float32Array(e*e*4);t.set(this.boneMatrices);var n=new yd(t,e,e,pt,ot);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this.boneTextureSize=e,this}},{key:"getBoneByName",value:function(e){for(var t=0,n=this.bones.length;t<n;t++){var r=this.bones[t];if(r.name===e)return r}}},{key:"dispose",value:function(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}},{key:"fromJSON",value:function(e,t){this.uuid=e.uuid;for(var n=0,r=e.bones.length;n<r;n++){var i=e.bones[n],a=t[i];void 0===a&&(console.warn("THREE.Skeleton: No bone found with UUID:",i),a=new gd),this.bones.push(a),this.boneInverses.push((new Ki).fromArray(e.boneInverses[n]))}return this.init(),this}},{key:"toJSON",value:function(){var e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;for(var t=this.bones,n=this.boneInverses,r=0,i=t.length;r<i;r++){var a=t[r];e.bones.push(a.uuid);var o=n[r];e.boneInverses.push(o.toArray())}return e}}]),e}(),Sd=exports.InstancedBufferAttribute=function(e){x(n,Ka);var t=S(n);function n(e,r,i,a=1){var o;return k(this,n),(o=t.call(this,e,r,i)).isInstancedBufferAttribute=!0,o.meshPerAttribute=a,o}return P(n,[{key:"copy",value:function(e){return p(w(n.prototype),"copy",this).call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}},{key:"toJSON",value:function(){var e=p(w(n.prototype),"toJSON",this).call(this);return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}]),n}(),bd=new Ki,Td=new Ki,Ed=[],wd=new Ti,Ad=new Ki,Rd=new Uo,Cd=new Hi,kd=exports.InstancedMesh=function(e){x(n,Uo);var t=S(n);function n(e,r,i){var a;k(this,n),(a=t.call(this,e,r)).isInstancedMesh=!0,a.instanceMatrix=new Sd(new Float32Array(16*i),16),a.instanceColor=null,a.count=i,a.boundingBox=null,a.boundingSphere=null;for(var o=0;o<i;o++)a.setMatrixAt(o,Ad);return a}return P(n,[{key:"computeBoundingBox",value:function(){var e=this.geometry,t=this.count;null===this.boundingBox&&(this.boundingBox=new Ti),null===e.boundingBox&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(var n=0;n<t;n++)this.getMatrixAt(n,bd),wd.copy(e.boundingBox).applyMatrix4(bd),this.boundingBox.union(wd)}},{key:"computeBoundingSphere",value:function(){var e=this.geometry,t=this.count;null===this.boundingSphere&&(this.boundingSphere=new Hi),null===e.boundingSphere&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(var n=0;n<t;n++)this.getMatrixAt(n,bd),Cd.copy(e.boundingSphere).applyMatrix4(bd),this.boundingSphere.union(Cd)}},{key:"copy",value:function(e,t){return p(w(n.prototype),"copy",this).call(this,e,t),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}},{key:"getColorAt",value:function(e,t){t.fromArray(this.instanceColor.array,3*e)}},{key:"getMatrixAt",value:function(e,t){t.fromArray(this.instanceMatrix.array,16*e)}},{key:"raycast",value:function(e,t){var n=this.matrixWorld,r=this.count;if(Rd.geometry=this.geometry,Rd.material=this.material,void 0!==Rd.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),Cd.copy(this.boundingSphere),Cd.applyMatrix4(n),!1!==e.ray.intersectsSphere(Cd)))for(var i=0;i<r;i++){this.getMatrixAt(i,bd),Td.multiplyMatrices(n,bd),Rd.matrixWorld=Td,Rd.raycast(e,Ed);for(var a=0,o=Ed.length;a<o;a++){var s=Ed[a];s.instanceId=i,s.object=this,t.push(s)}Ed.length=0}}},{key:"setColorAt",value:function(e,t){null===this.instanceColor&&(this.instanceColor=new Sd(new Float32Array(3*this.instanceMatrix.count),3)),t.toArray(this.instanceColor.array,3*e)}},{key:"setMatrixAt",value:function(e,t){t.toArray(this.instanceMatrix.array,16*e)}},{key:"updateMorphTargets",value:function(){}},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}}]),n}(),Ld=exports.LineBasicMaterial=function(e){x(n,Na);var t=S(n);function n(e){var r;return k(this,n),(r=t.call(this)).isLineBasicMaterial=!0,r.type="LineBasicMaterial",r.color=new Ga(16777215),r.map=null,r.linewidth=1,r.linecap="round",r.linejoin="round",r.fog=!0,r.setValues(e),r}return P(n,[{key:"copy",value:function(e){return p(w(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}]),n}(),Pd=new Mi,Id=new Mi,Ud=new Ki,Dd=new Ji,Nd=new Hi,Od=exports.Line=function(e){x(n,Sa);var t=S(n);function n(e=new vo,r=new Ld){var i;return k(this,n),(i=t.call(this)).isLine=!0,i.type="Line",i.geometry=e,i.material=r,i.updateMorphTargets(),i}return P(n,[{key:"copy",value:function(e,t){return p(w(n.prototype),"copy",this).call(this,e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}},{key:"computeLineDistances",value:function(){var e=this.geometry;if(null===e.index){for(var t=e.attributes.position,n=[0],r=1,i=t.count;r<i;r++)Pd.fromBufferAttribute(t,r-1),Id.fromBufferAttribute(t,r),n[r]=n[r-1],n[r]+=Pd.distanceTo(Id);e.setAttribute("lineDistance",new oo(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}},{key:"raycast",value:function(e,t){var n=this.geometry,r=this.matrixWorld,i=e.params.Line.threshold,a=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),Nd.copy(n.boundingSphere),Nd.applyMatrix4(r),Nd.radius+=i,!1!==e.ray.intersectsSphere(Nd)){Ud.copy(r).invert(),Dd.copy(e.ray).applyMatrix4(Ud);var o=i/((this.scale.x+this.scale.y+this.scale.z)/3),s=o*o,l=new Mi,u=new Mi,c=new Mi,h=new Mi,p=this.isLineSegments?2:1,d=n.index,f=n.attributes.position;if(null!==d)for(var m=Math.max(0,a.start),v=Math.min(d.count,a.start+a.count)-1;m<v;m+=p){var g=d.getX(m),y=d.getX(m+1);if(l.fromBufferAttribute(f,g),u.fromBufferAttribute(f,y),!(Dd.distanceSqToSegment(l,u,h,c)>s)){h.applyMatrix4(this.matrixWorld);var _=e.ray.origin.distanceTo(h);_<e.near||_>e.far||t.push({distance:_,point:c.clone().applyMatrix4(this.matrixWorld),index:m,face:null,faceIndex:null,object:this})}}else for(var x=Math.max(0,a.start),M=Math.min(f.count,a.start+a.count)-1;x<M;x+=p){if(l.fromBufferAttribute(f,x),u.fromBufferAttribute(f,x+1),!(Dd.distanceSqToSegment(l,u,h,c)>s)){h.applyMatrix4(this.matrixWorld);var S=e.ray.origin.distanceTo(h);S<e.near||S>e.far||t.push({distance:S,point:c.clone().applyMatrix4(this.matrixWorld),index:x,face:null,faceIndex:null,object:this})}}}}},{key:"updateMorphTargets",value:function(){var e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){var n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var r=0,i=n.length;r<i;r++){var a=n[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=r}}}}}]),n}(),Fd=new Mi,Bd=new Mi,zd=exports.LineSegments=function(e){x(n,Od);var t=S(n);function n(e,r){var i;return k(this,n),(i=t.call(this,e,r)).isLineSegments=!0,i.type="LineSegments",i}return P(n,[{key:"computeLineDistances",value:function(){var e=this.geometry;if(null===e.index){for(var t=e.attributes.position,n=[],r=0,i=t.count;r<i;r+=2)Fd.fromBufferAttribute(t,r),Bd.fromBufferAttribute(t,r+1),n[r]=0===r?0:n[r-1],n[r+1]=n[r]+Fd.distanceTo(Bd);e.setAttribute("lineDistance",new oo(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}]),n}(),Gd=exports.LineLoop=function(e){x(n,Od);var t=S(n);function n(e,r){var i;return k(this,n),(i=t.call(this,e,r)).isLineLoop=!0,i.type="LineLoop",i}return P(n)}(),Hd=exports.PointsMaterial=function(e){x(n,Na);var t=S(n);function n(e){var r;return k(this,n),(r=t.call(this)).isPointsMaterial=!0,r.type="PointsMaterial",r.color=new Ga(16777215),r.map=null,r.alphaMap=null,r.size=1,r.sizeAttenuation=!0,r.fog=!0,r.setValues(e),r}return P(n,[{key:"copy",value:function(e){return p(w(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}]),n}(),Vd=new Ki,Wd=new Ji,Xd=new Hi,jd=new Mi,qd=exports.Points=function(e){x(n,Sa);var t=S(n);function n(e=new vo,r=new Hd){var i;return k(this,n),(i=t.call(this)).isPoints=!0,i.type="Points",i.geometry=e,i.material=r,i.updateMorphTargets(),i}return P(n,[{key:"copy",value:function(e,t){return p(w(n.prototype),"copy",this).call(this,e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}},{key:"raycast",value:function(e,t){var n=this.geometry,r=this.matrixWorld,i=e.params.Points.threshold,a=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),Xd.copy(n.boundingSphere),Xd.applyMatrix4(r),Xd.radius+=i,!1!==e.ray.intersectsSphere(Xd)){Vd.copy(r).invert(),Wd.copy(e.ray).applyMatrix4(Vd);var o=i/((this.scale.x+this.scale.y+this.scale.z)/3),s=o*o,l=n.index,u=n.attributes.position;if(null!==l)for(var c=Math.max(0,a.start),h=Math.min(l.count,a.start+a.count);c<h;c++){var p=l.getX(c);jd.fromBufferAttribute(u,p),Yd(jd,p,s,r,e,t,this)}else for(var d=Math.max(0,a.start),f=Math.min(u.count,a.start+a.count);d<f;d++)jd.fromBufferAttribute(u,d),Yd(jd,d,s,r,e,t,this)}}},{key:"updateMorphTargets",value:function(){var e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){var n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var r=0,i=n.length;r<i;r++){var a=n[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=r}}}}}]),n}();function Yd(e,t,n,r,i,a,o){var s=Wd.distanceSqToPoint(e);if(s<n){var l=new Mi;Wd.closestPointToPoint(e,l),l.applyMatrix4(r);var u=i.ray.origin.distanceTo(l);if(u<i.near||u>i.far)return;a.push({distance:u,distanceToRay:Math.sqrt(s),point:l,index:t,face:null,object:o})}}var Zd=exports.VideoTexture=function(e){x(n,hi);var t=S(n);function n(e,r,i,a,o,s,l,u,c){var h;k(this,n),(h=t.call(this,e,r,i,a,o,s,l,u,c)).isVideoTexture=!0,h.minFilter=void 0!==s?s:Ze,h.magFilter=void 0!==o?o:Ze,h.generateMipmaps=!1;var p=T(h);return"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(function t(){p.needsUpdate=!0,e.requestVideoFrameCallback(t)}),h}return P(n,[{key:"clone",value:function(){return new this.constructor(this.image).copy(this)}},{key:"update",value:function(){var e=this.image;!1==="requestVideoFrameCallback"in e&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}]),n}(),Jd=exports.FramebufferTexture=function(e){x(n,hi);var t=S(n);function n(e,r){var i;return k(this,n),(i=t.call(this,{width:e,height:r})).isFramebufferTexture=!0,i.magFilter=We,i.minFilter=We,i.generateMipmaps=!1,i.needsUpdate=!0,i}return P(n)}(),Kd=exports.CompressedTexture=function(e){x(n,hi);var t=S(n);function n(e,r,i,a,o,s,l,u,c,h,p,d){var f;return k(this,n),(f=t.call(this,null,s,l,u,c,h,a,o,p,d)).isCompressedTexture=!0,f.image={width:r,height:i},f.mipmaps=e,f.flipY=!1,f.generateMipmaps=!1,f}return P(n)}(),Qd=exports.CompressedArrayTexture=function(e){x(n,Kd);var t=S(n);function n(e,r,i,a,o,s){var l;return k(this,n),(l=t.call(this,e,r,i,o,s)).isCompressedArrayTexture=!0,l.image.depth=a,l.wrapR=He,l}return P(n)}(),$d=exports.CompressedCubeTexture=function(e){x(n,Kd);var t=S(n);function n(e,r,i){var a;return k(this,n),(a=t.call(this,void 0,e[0].width,e[0].height,r,i,Ne)).isCompressedCubeTexture=!0,a.isCubeTexture=!0,a.image=e,a}return P(n)}(),ef=exports.CanvasTexture=function(e){x(n,hi);var t=S(n);function n(e,r,i,a,o,s,l,u,c){var h;return k(this,n),(h=t.call(this,e,r,i,a,o,s,l,u,c)).isCanvasTexture=!0,h.needsUpdate=!0,h}return P(n)}(),tf=exports.Curve=function(){function e(){k(this,e),this.type="Curve",this.arcLengthDivisions=200}return P(e,[{key:"getPoint",value:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}},{key:"getPointAt",value:function(e,t){var n=this.getUtoTmapping(e);return this.getPoint(n,t)}},{key:"getPoints",value:function(e=5){for(var t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}},{key:"getSpacedPoints",value:function(e=5){for(var t=[],n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}},{key:"getLength",value:function(){var e=this.getLengths();return e[e.length-1]}},{key:"getLengths",value:function(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var t,n=[],r=this.getPoint(0),i=0;n.push(0);for(var a=1;a<=e;a++)i+=(t=this.getPoint(a/e)).distanceTo(r),n.push(i),r=t;return this.cacheArcLengths=n,n}},{key:"updateArcLengths",value:function(){this.needsUpdate=!0,this.getLengths()}},{key:"getUtoTmapping",value:function(e,t){var n,r=this.getLengths(),i=0,a=r.length;n=t||e*r[a-1];for(var o,s=0,l=a-1;s<=l;)if((o=r[i=Math.floor(s+(l-s)/2)]-n)<0)s=i+1;else{if(!(o>0)){l=i;break}l=i-1}if(r[i=l]===n)return i/(a-1);var u=r[i];return(i+(n-u)/(r[i+1]-u))/(a-1)}},{key:"getTangent",value:function(e,t){var n=e-1e-4,r=e+1e-4;n<0&&(n=0),r>1&&(r=1);var i=this.getPoint(n),a=this.getPoint(r),o=t||(i.isVector2?new Hr:new Mi);return o.copy(a).sub(i).normalize(),o}},{key:"getTangentAt",value:function(e,t){var n=this.getUtoTmapping(e);return this.getTangent(n,t)}},{key:"computeFrenetFrames",value:function(e,t){for(var n=new Mi,r=[],i=[],a=[],o=new Mi,s=new Ki,l=0;l<=e;l++){var u=l/e;r[l]=this.getTangentAt(u,new Mi)}i[0]=new Mi,a[0]=new Mi;var c=Number.MAX_VALUE,h=Math.abs(r[0].x),p=Math.abs(r[0].y),d=Math.abs(r[0].z);h<=c&&(c=h,n.set(1,0,0)),p<=c&&(c=p,n.set(0,1,0)),d<=c&&n.set(0,0,1),o.crossVectors(r[0],n).normalize(),i[0].crossVectors(r[0],o),a[0].crossVectors(r[0],i[0]);for(var f=1;f<=e;f++){if(i[f]=i[f-1].clone(),a[f]=a[f-1].clone(),o.crossVectors(r[f-1],r[f]),o.length()>Number.EPSILON){o.normalize();var m=Math.acos(xr(r[f-1].dot(r[f]),-1,1));i[f].applyMatrix4(s.makeRotationAxis(o,m))}a[f].crossVectors(r[f],i[f])}if(!0===t){var v=Math.acos(xr(i[0].dot(i[e]),-1,1));v/=e,r[0].dot(o.crossVectors(i[0],i[e]))>0&&(v=-v);for(var g=1;g<=e;g++)i[g].applyMatrix4(s.makeRotationAxis(r[g],v*g)),a[g].crossVectors(r[g],i[g])}return{tangents:r,normals:i,binormals:a}}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}},{key:"toJSON",value:function(){var e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}},{key:"fromJSON",value:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}]),e}(),nf=exports.EllipseCurve=function(e){x(n,tf);var t=S(n);function n(e=0,r=0,i=1,a=1,o=0,s=2*Math.PI,l=!1,u=0){var c;return k(this,n),(c=t.call(this)).isEllipseCurve=!0,c.type="EllipseCurve",c.aX=e,c.aY=r,c.xRadius=i,c.yRadius=a,c.aStartAngle=o,c.aEndAngle=s,c.aClockwise=l,c.aRotation=u,c}return P(n,[{key:"getPoint",value:function(e,t){for(var n=t||new Hr,r=2*Math.PI,i=this.aEndAngle-this.aStartAngle,a=Math.abs(i)<Number.EPSILON;i<0;)i+=r;for(;i>r;)i-=r;i<Number.EPSILON&&(i=a?0:r),!0!==this.aClockwise||a||(i===r?i=-r:i-=r);var o=this.aStartAngle+e*i,s=this.aX+this.xRadius*Math.cos(o),l=this.aY+this.yRadius*Math.sin(o);if(0!==this.aRotation){var u=Math.cos(this.aRotation),c=Math.sin(this.aRotation),h=s-this.aX,p=l-this.aY;s=h*u-p*c+this.aX,l=h*c+p*u+this.aY}return n.set(s,l)}},{key:"copy",value:function(e){return p(w(n.prototype),"copy",this).call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}},{key:"toJSON",value:function(){var e=p(w(n.prototype),"toJSON",this).call(this);return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}},{key:"fromJSON",value:function(e){return p(w(n.prototype),"fromJSON",this).call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}]),n}(),rf=exports.ArcCurve=function(e){x(n,nf);var t=S(n);function n(e,r,i,a,o,s){var l;return k(this,n),(l=t.call(this,e,r,i,i,a,o,s)).isArcCurve=!0,l.type="ArcCurve",l}return P(n)}();function af(){var e=0,t=0,n=0,r=0;function i(i,a,o,s){e=i,t=o,n=-3*i+3*a-2*o-s,r=2*i-2*a+o+s}return{initCatmullRom:function(e,t,n,r,a){i(t,n,a*(n-e),a*(r-t))},initNonuniformCatmullRom:function(e,t,n,r,a,o,s){var l=(t-e)/a-(n-e)/(a+o)+(n-t)/o,u=(n-t)/o-(r-t)/(o+s)+(r-n)/s;i(t,n,l*=o,u*=o)},calc:function(i){var a=i*i;return e+t*i+n*a+r*(a*i)}}}var of=new Mi,sf=new af,lf=new af,uf=new af,cf=exports.CatmullRomCurve3=function(e){x(n,tf);var t=S(n);function n(e=[],r=!1,i="centripetal",a=.5){var o;return k(this,n),(o=t.call(this)).isCatmullRomCurve3=!0,o.type="CatmullRomCurve3",o.points=e,o.closed=r,o.curveType=i,o.tension=a,o}return P(n,[{key:"getPoint",value:function(e,t=new Mi){var n,r,i=t,a=this.points,o=a.length,s=(o-(this.closed?0:1))*e,l=Math.floor(s),u=s-l;this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/o)+1)*o:0===u&&l===o-1&&(l=o-2,u=1),this.closed||l>0?n=a[(l-1)%o]:(of.subVectors(a[0],a[1]).add(a[0]),n=of);var c=a[l%o],h=a[(l+1)%o];if(this.closed||l+2<o?r=a[(l+2)%o]:(of.subVectors(a[o-1],a[o-2]).add(a[o-1]),r=of),"centripetal"===this.curveType||"chordal"===this.curveType){var p="chordal"===this.curveType?.5:.25,d=Math.pow(n.distanceToSquared(c),p),f=Math.pow(c.distanceToSquared(h),p),m=Math.pow(h.distanceToSquared(r),p);f<1e-4&&(f=1),d<1e-4&&(d=f),m<1e-4&&(m=f),sf.initNonuniformCatmullRom(n.x,c.x,h.x,r.x,d,f,m),lf.initNonuniformCatmullRom(n.y,c.y,h.y,r.y,d,f,m),uf.initNonuniformCatmullRom(n.z,c.z,h.z,r.z,d,f,m)}else"catmullrom"===this.curveType&&(sf.initCatmullRom(n.x,c.x,h.x,r.x,this.tension),lf.initCatmullRom(n.y,c.y,h.y,r.y,this.tension),uf.initCatmullRom(n.z,c.z,h.z,r.z,this.tension));return i.set(sf.calc(u),lf.calc(u),uf.calc(u)),i}},{key:"copy",value:function(e){p(w(n.prototype),"copy",this).call(this,e),this.points=[];for(var t=0,r=e.points.length;t<r;t++){var i=e.points[t];this.points.push(i.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}},{key:"toJSON",value:function(){var e=p(w(n.prototype),"toJSON",this).call(this);e.points=[];for(var t=0,r=this.points.length;t<r;t++){var i=this.points[t];e.points.push(i.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}},{key:"fromJSON",value:function(e){p(w(n.prototype),"fromJSON",this).call(this,e),this.points=[];for(var t=0,r=e.points.length;t<r;t++){var i=e.points[t];this.points.push((new Mi).fromArray(i))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}]),n}();function hf(e,t,n,r,i){var a=.5*(r-t),o=.5*(i-n),s=e*e;return(2*n-2*r+a+o)*(e*s)+(-3*n+3*r-2*a-o)*s+a*e+n}function pf(e,t){var n=1-e;return n*n*t}function df(e,t){return 2*(1-e)*e*t}function ff(e,t){return e*e*t}function mf(e,t,n,r){return pf(e,t)+df(e,n)+ff(e,r)}function vf(e,t){var n=1-e;return n*n*n*t}function gf(e,t){var n=1-e;return 3*n*n*e*t}function yf(e,t){return 3*(1-e)*e*e*t}function _f(e,t){return e*e*e*t}function xf(e,t,n,r,i){return vf(e,t)+gf(e,n)+yf(e,r)+_f(e,i)}var Mf=exports.CubicBezierCurve=function(e){x(n,tf);var t=S(n);function n(e=new Hr,r=new Hr,i=new Hr,a=new Hr){var o;return k(this,n),(o=t.call(this)).isCubicBezierCurve=!0,o.type="CubicBezierCurve",o.v0=e,o.v1=r,o.v2=i,o.v3=a,o}return P(n,[{key:"getPoint",value:function(e,t=new Hr){var n=t,r=this.v0,i=this.v1,a=this.v2,o=this.v3;return n.set(xf(e,r.x,i.x,a.x,o.x),xf(e,r.y,i.y,a.y,o.y)),n}},{key:"copy",value:function(e){return p(w(n.prototype),"copy",this).call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}},{key:"toJSON",value:function(){var e=p(w(n.prototype),"toJSON",this).call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}},{key:"fromJSON",value:function(e){return p(w(n.prototype),"fromJSON",this).call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}]),n}(),Sf=exports.CubicBezierCurve3=function(e){x(n,tf);var t=S(n);function n(e=new Mi,r=new Mi,i=new Mi,a=new Mi){var o;return k(this,n),(o=t.call(this)).isCubicBezierCurve3=!0,o.type="CubicBezierCurve3",o.v0=e,o.v1=r,o.v2=i,o.v3=a,o}return P(n,[{key:"getPoint",value:function(e,t=new Mi){var n=t,r=this.v0,i=this.v1,a=this.v2,o=this.v3;return n.set(xf(e,r.x,i.x,a.x,o.x),xf(e,r.y,i.y,a.y,o.y),xf(e,r.z,i.z,a.z,o.z)),n}},{key:"copy",value:function(e){return p(w(n.prototype),"copy",this).call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}},{key:"toJSON",value:function(){var e=p(w(n.prototype),"toJSON",this).call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}},{key:"fromJSON",value:function(e){return p(w(n.prototype),"fromJSON",this).call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}]),n}(),bf=exports.LineCurve=function(e){x(n,tf);var t=S(n);function n(e=new Hr,r=new Hr){var i;return k(this,n),(i=t.call(this)).isLineCurve=!0,i.type="LineCurve",i.v1=e,i.v2=r,i}return P(n,[{key:"getPoint",value:function(e,t=new Hr){var n=t;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}},{key:"getPointAt",value:function(e,t){return this.getPoint(e,t)}},{key:"getTangent",value:function(e,t=new Hr){return t.subVectors(this.v2,this.v1).normalize()}},{key:"getTangentAt",value:function(e,t){return this.getTangent(e,t)}},{key:"copy",value:function(e){return p(w(n.prototype),"copy",this).call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}},{key:"toJSON",value:function(){var e=p(w(n.prototype),"toJSON",this).call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}},{key:"fromJSON",value:function(e){return p(w(n.prototype),"fromJSON",this).call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}]),n}(),Tf=exports.LineCurve3=function(e){x(n,tf);var t=S(n);function n(e=new Mi,r=new Mi){var i;return k(this,n),(i=t.call(this)).isLineCurve3=!0,i.type="LineCurve3",i.v1=e,i.v2=r,i}return P(n,[{key:"getPoint",value:function(e,t=new Mi){var n=t;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}},{key:"getPointAt",value:function(e,t){return this.getPoint(e,t)}},{key:"getTangent",value:function(e,t=new Mi){return t.subVectors(this.v2,this.v1).normalize()}},{key:"getTangentAt",value:function(e,t){return this.getTangent(e,t)}},{key:"copy",value:function(e){return p(w(n.prototype),"copy",this).call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}},{key:"toJSON",value:function(){var e=p(w(n.prototype),"toJSON",this).call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}},{key:"fromJSON",value:function(e){return p(w(n.prototype),"fromJSON",this).call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}]),n}(),Ef=exports.QuadraticBezierCurve=function(e){x(n,tf);var t=S(n);function n(e=new Hr,r=new Hr,i=new Hr){var a;return k(this,n),(a=t.call(this)).isQuadraticBezierCurve=!0,a.type="QuadraticBezierCurve",a.v0=e,a.v1=r,a.v2=i,a}return P(n,[{key:"getPoint",value:function(e,t=new Hr){var n=t,r=this.v0,i=this.v1,a=this.v2;return n.set(mf(e,r.x,i.x,a.x),mf(e,r.y,i.y,a.y)),n}},{key:"copy",value:function(e){return p(w(n.prototype),"copy",this).call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}},{key:"toJSON",value:function(){var e=p(w(n.prototype),"toJSON",this).call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}},{key:"fromJSON",value:function(e){return p(w(n.prototype),"fromJSON",this).call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}]),n}(),wf=exports.QuadraticBezierCurve3=function(e){x(n,tf);var t=S(n);function n(e=new Mi,r=new Mi,i=new Mi){var a;return k(this,n),(a=t.call(this)).isQuadraticBezierCurve3=!0,a.type="QuadraticBezierCurve3",a.v0=e,a.v1=r,a.v2=i,a}return P(n,[{key:"getPoint",value:function(e,t=new Mi){var n=t,r=this.v0,i=this.v1,a=this.v2;return n.set(mf(e,r.x,i.x,a.x),mf(e,r.y,i.y,a.y),mf(e,r.z,i.z,a.z)),n}},{key:"copy",value:function(e){return p(w(n.prototype),"copy",this).call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}},{key:"toJSON",value:function(){var e=p(w(n.prototype),"toJSON",this).call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}},{key:"fromJSON",value:function(e){return p(w(n.prototype),"fromJSON",this).call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}]),n}(),Af=exports.SplineCurve=function(e){x(n,tf);var t=S(n);function n(e=[]){var r;return k(this,n),(r=t.call(this)).isSplineCurve=!0,r.type="SplineCurve",r.points=e,r}return P(n,[{key:"getPoint",value:function(e,t=new Hr){var n=t,r=this.points,i=(r.length-1)*e,a=Math.floor(i),o=i-a,s=r[0===a?a:a-1],l=r[a],u=r[a>r.length-2?r.length-1:a+1],c=r[a>r.length-3?r.length-1:a+2];return n.set(hf(o,s.x,l.x,u.x,c.x),hf(o,s.y,l.y,u.y,c.y)),n}},{key:"copy",value:function(e){p(w(n.prototype),"copy",this).call(this,e),this.points=[];for(var t=0,r=e.points.length;t<r;t++){var i=e.points[t];this.points.push(i.clone())}return this}},{key:"toJSON",value:function(){var e=p(w(n.prototype),"toJSON",this).call(this);e.points=[];for(var t=0,r=this.points.length;t<r;t++){var i=this.points[t];e.points.push(i.toArray())}return e}},{key:"fromJSON",value:function(e){p(w(n.prototype),"fromJSON",this).call(this,e),this.points=[];for(var t=0,r=e.points.length;t<r;t++){var i=e.points[t];this.points.push((new Hr).fromArray(i))}return this}}]),n}(),Rf=Object.freeze({__proto__:null,ArcCurve:rf,CatmullRomCurve3:cf,CubicBezierCurve:Mf,CubicBezierCurve3:Sf,EllipseCurve:nf,LineCurve:bf,LineCurve3:Tf,QuadraticBezierCurve:Ef,QuadraticBezierCurve3:wf,SplineCurve:Af}),Cf=exports.CurvePath=function(e){x(n,tf);var t=S(n);function n(){var e;return k(this,n),(e=t.call(this)).type="CurvePath",e.curves=[],e.autoClose=!1,e}return P(n,[{key:"add",value:function(e){this.curves.push(e)}},{key:"closePath",value:function(){var e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){var n=!0===e.isVector2?"LineCurve":"LineCurve3";this.curves.push(new Rf[n](t,e))}return this}},{key:"getPoint",value:function(e,t){for(var n=e*this.getLength(),r=this.getCurveLengths(),i=0;i<r.length;){if(r[i]>=n){var a=r[i]-n,o=this.curves[i],s=o.getLength(),l=0===s?0:1-a/s;return o.getPointAt(l,t)}i++}return null}},{key:"getLength",value:function(){var e=this.getCurveLengths();return e[e.length-1]}},{key:"updateArcLengths",value:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}},{key:"getCurveLengths",value:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var e=[],t=0,n=0,r=this.curves.length;n<r;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}},{key:"getSpacedPoints",value:function(e=40){for(var t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}},{key:"getPoints",value:function(e=12){for(var t,n=[],r=0,i=this.curves;r<i.length;r++)for(var a=i[r],o=a.isEllipseCurve?2*e:a.isLineCurve||a.isLineCurve3?1:a.isSplineCurve?e*a.points.length:e,s=a.getPoints(o),l=0;l<s.length;l++){var u=s[l];t&&t.equals(u)||(n.push(u),t=u)}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n}},{key:"copy",value:function(e){p(w(n.prototype),"copy",this).call(this,e),this.curves=[];for(var t=0,r=e.curves.length;t<r;t++){var i=e.curves[t];this.curves.push(i.clone())}return this.autoClose=e.autoClose,this}},{key:"toJSON",value:function(){var e=p(w(n.prototype),"toJSON",this).call(this);e.autoClose=this.autoClose,e.curves=[];for(var t=0,r=this.curves.length;t<r;t++){var i=this.curves[t];e.curves.push(i.toJSON())}return e}},{key:"fromJSON",value:function(e){p(w(n.prototype),"fromJSON",this).call(this,e),this.autoClose=e.autoClose,this.curves=[];for(var t=0,r=e.curves.length;t<r;t++){var i=e.curves[t];this.curves.push((new Rf[i.type]).fromJSON(i))}return this}}]),n}(),kf=exports.Path=function(e){x(n,Cf);var t=S(n);function n(e){var r;return k(this,n),(r=t.call(this)).type="Path",r.currentPoint=new Hr,e&&r.setFromPoints(e),r}return P(n,[{key:"setFromPoints",value:function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}},{key:"moveTo",value:function(e,t){return this.currentPoint.set(e,t),this}},{key:"lineTo",value:function(e,t){var n=new bf(this.currentPoint.clone(),new Hr(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}},{key:"quadraticCurveTo",value:function(e,t,n,r){var i=new Ef(this.currentPoint.clone(),new Hr(e,t),new Hr(n,r));return this.curves.push(i),this.currentPoint.set(n,r),this}},{key:"bezierCurveTo",value:function(e,t,n,r,i,a){var o=new Mf(this.currentPoint.clone(),new Hr(e,t),new Hr(n,r),new Hr(i,a));return this.curves.push(o),this.currentPoint.set(i,a),this}},{key:"splineThru",value:function(e){var t=[this.currentPoint.clone()].concat(e),n=new Af(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}},{key:"arc",value:function(e,t,n,r,i,a){var o=this.currentPoint.x,s=this.currentPoint.y;return this.absarc(e+o,t+s,n,r,i,a),this}},{key:"absarc",value:function(e,t,n,r,i,a){return this.absellipse(e,t,n,n,r,i,a),this}},{key:"ellipse",value:function(e,t,n,r,i,a,o,s){var l=this.currentPoint.x,u=this.currentPoint.y;return this.absellipse(e+l,t+u,n,r,i,a,o,s),this}},{key:"absellipse",value:function(e,t,n,r,i,a,o,s){var l=new nf(e,t,n,r,i,a,o,s);if(this.curves.length>0){var u=l.getPoint(0);u.equals(this.currentPoint)||this.lineTo(u.x,u.y)}this.curves.push(l);var c=l.getPoint(1);return this.currentPoint.copy(c),this}},{key:"copy",value:function(e){return p(w(n.prototype),"copy",this).call(this,e),this.currentPoint.copy(e.currentPoint),this}},{key:"toJSON",value:function(){var e=p(w(n.prototype),"toJSON",this).call(this);return e.currentPoint=this.currentPoint.toArray(),e}},{key:"fromJSON",value:function(e){return p(w(n.prototype),"fromJSON",this).call(this,e),this.currentPoint.fromArray(e.currentPoint),this}}]),n}(),Lf=exports.LatheGeometry=function(e){x(n,vo);var t=S(n);function n(e=[new Hr(0,-.5),new Hr(.5,0),new Hr(0,.5)],r=12,i=0,a=2*Math.PI){var o;k(this,n),(o=t.call(this)).type="LatheGeometry",o.parameters={points:e,segments:r,phiStart:i,phiLength:a},r=Math.floor(r),a=xr(a,0,2*Math.PI);for(var s=[],l=[],u=[],c=[],h=[],p=1/r,d=new Mi,f=new Hr,m=new Mi,v=new Mi,g=new Mi,y=0,_=0,x=0;x<=e.length-1;x++)switch(x){case 0:y=e[x+1].x-e[x].x,_=e[x+1].y-e[x].y,m.x=1*_,m.y=-y,m.z=0*_,g.copy(m),m.normalize(),c.push(m.x,m.y,m.z);break;case e.length-1:c.push(g.x,g.y,g.z);break;default:y=e[x+1].x-e[x].x,_=e[x+1].y-e[x].y,m.x=1*_,m.y=-y,m.z=0*_,v.copy(m),m.x+=g.x,m.y+=g.y,m.z+=g.z,m.normalize(),c.push(m.x,m.y,m.z),g.copy(v)}for(var M=0;M<=r;M++)for(var S=i+M*p*a,b=Math.sin(S),T=Math.cos(S),E=0;E<=e.length-1;E++){d.x=e[E].x*b,d.y=e[E].y,d.z=e[E].x*T,l.push(d.x,d.y,d.z),f.x=M/r,f.y=E/(e.length-1),u.push(f.x,f.y);var w=c[3*E+0]*b,A=c[3*E+1],R=c[3*E+0]*T;h.push(w,A,R)}for(var C=0;C<r;C++)for(var L=0;L<e.length-1;L++){var P=L+C*e.length,I=P,U=P+e.length,D=P+e.length+1,N=P+1;s.push(I,U,N),s.push(D,N,U)}return o.setIndex(s),o.setAttribute("position",new oo(l,3)),o.setAttribute("uv",new oo(u,2)),o.setAttribute("normal",new oo(h,3)),o}return P(n,[{key:"copy",value:function(e){return p(w(n.prototype),"copy",this).call(this,e),this.parameters=Object.assign({},e.parameters),this}}],[{key:"fromJSON",value:function(e){return new n(e.points,e.segments,e.phiStart,e.phiLength)}}]),n}(),Pf=exports.CapsuleGeometry=function(e){x(n,Lf);var t=S(n);function n(e=1,r=1,i=4,a=8){var o;k(this,n);var s=new kf;return s.absarc(0,-r/2,e,1.5*Math.PI,0),s.absarc(0,r/2,e,0,.5*Math.PI),(o=t.call(this,s.getPoints(i),a)).type="CapsuleGeometry",o.parameters={radius:e,length:r,capSegments:i,radialSegments:a},o}return P(n,null,[{key:"fromJSON",value:function(e){return new n(e.radius,e.length,e.capSegments,e.radialSegments)}}]),n}(),If=exports.CircleGeometry=function(e){x(n,vo);var t=S(n);function n(e=1,r=32,i=0,a=2*Math.PI){var o;k(this,n),(o=t.call(this)).type="CircleGeometry",o.parameters={radius:e,segments:r,thetaStart:i,thetaLength:a},r=Math.max(3,r);var s=[],l=[],u=[],c=[],h=new Mi,p=new Hr;l.push(0,0,0),u.push(0,0,1),c.push(.5,.5);for(var d=0,f=3;d<=r;d++,f+=3){var m=i+d/r*a;h.x=e*Math.cos(m),h.y=e*Math.sin(m),l.push(h.x,h.y,h.z),u.push(0,0,1),p.x=(l[f]/e+1)/2,p.y=(l[f+1]/e+1)/2,c.push(p.x,p.y)}for(var v=1;v<=r;v++)s.push(v,v+1,0);return o.setIndex(s),o.setAttribute("position",new oo(l,3)),o.setAttribute("normal",new oo(u,3)),o.setAttribute("uv",new oo(c,2)),o}return P(n,[{key:"copy",value:function(e){return p(w(n.prototype),"copy",this).call(this,e),this.parameters=Object.assign({},e.parameters),this}}],[{key:"fromJSON",value:function(e){return new n(e.radius,e.segments,e.thetaStart,e.thetaLength)}}]),n}(),Uf=exports.CylinderGeometry=function(e){x(n,vo);var t=S(n);function n(e=1,r=1,i=1,a=32,o=1,s=!1,l=0,u=2*Math.PI){var c;k(this,n),(c=t.call(this)).type="CylinderGeometry",c.parameters={radiusTop:e,radiusBottom:r,height:i,radialSegments:a,heightSegments:o,openEnded:s,thetaStart:l,thetaLength:u};var h=T(c);a=Math.floor(a),o=Math.floor(o);var p=[],d=[],f=[],m=[],v=0,g=[],y=i/2,_=0;function x(t){for(var n=v,i=new Hr,o=new Mi,s=0,c=!0===t?e:r,g=!0===t?1:-1,x=1;x<=a;x++)d.push(0,y*g,0),f.push(0,g,0),m.push(.5,.5),v++;for(var M=v,S=0;S<=a;S++){var b=S/a*u+l,T=Math.cos(b),E=Math.sin(b);o.x=c*E,o.y=y*g,o.z=c*T,d.push(o.x,o.y,o.z),f.push(0,g,0),i.x=.5*T+.5,i.y=.5*E*g+.5,m.push(i.x,i.y),v++}for(var w=0;w<a;w++){var A=n+w,R=M+w;!0===t?p.push(R,R+1,A):p.push(R+1,R,A),s+=3}h.addGroup(_,s,!0===t?1:2),_+=s}return function(){for(var t=new Mi,n=new Mi,s=0,c=(r-e)/i,x=0;x<=o;x++){for(var M=[],S=x/o,b=S*(r-e)+e,T=0;T<=a;T++){var E=T/a,w=E*u+l,A=Math.sin(w),R=Math.cos(w);n.x=b*A,n.y=-S*i+y,n.z=b*R,d.push(n.x,n.y,n.z),t.set(A,c,R).normalize(),f.push(t.x,t.y,t.z),m.push(E,1-S),M.push(v++)}g.push(M)}for(var C=0;C<a;C++)for(var k=0;k<o;k++){var L=g[k][C],P=g[k+1][C],I=g[k+1][C+1],U=g[k][C+1];p.push(L,P,U),p.push(P,I,U),s+=6}h.addGroup(_,s,0),_+=s}(),!1===s&&(e>0&&x(!0),r>0&&x(!1)),c.setIndex(p),c.setAttribute("position",new oo(d,3)),c.setAttribute("normal",new oo(f,3)),c.setAttribute("uv",new oo(m,2)),c}return P(n,[{key:"copy",value:function(e){return p(w(n.prototype),"copy",this).call(this,e),this.parameters=Object.assign({},e.parameters),this}}],[{key:"fromJSON",value:function(e){return new n(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}]),n}(),Df=exports.ConeGeometry=function(e){x(n,Uf);var t=S(n);function n(e=1,r=1,i=32,a=1,o=!1,s=0,l=2*Math.PI){var u;return k(this,n),(u=t.call(this,0,e,r,i,a,o,s,l)).type="ConeGeometry",u.parameters={radius:e,height:r,radialSegments:i,heightSegments:a,openEnded:o,thetaStart:s,thetaLength:l},u}return P(n,null,[{key:"fromJSON",value:function(e){return new n(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}]),n}(),Nf=exports.PolyhedronGeometry=function(e){x(n,vo);var t=S(n);function n(e=[],r=[],i=1,a=0){var o;k(this,n),(o=t.call(this)).type="PolyhedronGeometry",o.parameters={vertices:e,indices:r,radius:i,detail:a};var s=[],l=[];function u(e,t,n,r){for(var i=r+1,a=[],o=0;o<=i;o++){a[o]=[];for(var s=e.clone().lerp(n,o/i),l=t.clone().lerp(n,o/i),u=i-o,h=0;h<=u;h++)a[o][h]=0===h&&o===i?s:s.clone().lerp(l,h/u)}for(var p=0;p<i;p++)for(var d=0;d<2*(i-p)-1;d++){var f=Math.floor(d/2);d%2==0?(c(a[p][f+1]),c(a[p+1][f]),c(a[p][f])):(c(a[p][f+1]),c(a[p+1][f+1]),c(a[p+1][f]))}}function c(e){s.push(e.x,e.y,e.z)}function h(t,n){var r=3*t;n.x=e[r+0],n.y=e[r+1],n.z=e[r+2]}function p(e,t,n,r){r<0&&1===e.x&&(l[t]=e.x-1),0===n.x&&0===n.z&&(l[t]=r/2/Math.PI+.5)}function d(e){return Math.atan2(e.z,-e.x)}return function(e){for(var t=new Mi,n=new Mi,i=new Mi,a=0;a<r.length;a+=3)h(r[a+0],t),h(r[a+1],n),h(r[a+2],i),u(t,n,i,e)}(a),function(e){for(var t=new Mi,n=0;n<s.length;n+=3)t.x=s[n+0],t.y=s[n+1],t.z=s[n+2],t.normalize().multiplyScalar(e),s[n+0]=t.x,s[n+1]=t.y,s[n+2]=t.z}(i),function(){for(var e=new Mi,t=0;t<s.length;t+=3){e.x=s[t+0],e.y=s[t+1],e.z=s[t+2];var n=d(e)/2/Math.PI+.5,r=(i=e,Math.atan2(-i.y,Math.sqrt(i.x*i.x+i.z*i.z))/Math.PI+.5);l.push(n,1-r)}var i;(function(){for(var e=new Mi,t=new Mi,n=new Mi,r=new Mi,i=new Hr,a=new Hr,o=new Hr,u=0,c=0;u<s.length;u+=9,c+=6){e.set(s[u+0],s[u+1],s[u+2]),t.set(s[u+3],s[u+4],s[u+5]),n.set(s[u+6],s[u+7],s[u+8]),i.set(l[c+0],l[c+1]),a.set(l[c+2],l[c+3]),o.set(l[c+4],l[c+5]),r.copy(e).add(t).add(n).divideScalar(3);var h=d(r);p(i,c+0,e,h),p(a,c+2,t,h),p(o,c+4,n,h)}})(),function(){for(var e=0;e<l.length;e+=6){var t=l[e+0],n=l[e+2],r=l[e+4],i=Math.max(t,n,r),a=Math.min(t,n,r);i>.9&&a<.1&&(t<.2&&(l[e+0]+=1),n<.2&&(l[e+2]+=1),r<.2&&(l[e+4]+=1))}}()}(),o.setAttribute("position",new oo(s,3)),o.setAttribute("normal",new oo(s.slice(),3)),o.setAttribute("uv",new oo(l,2)),0===a?o.computeVertexNormals():o.normalizeNormals(),o}return P(n,[{key:"copy",value:function(e){return p(w(n.prototype),"copy",this).call(this,e),this.parameters=Object.assign({},e.parameters),this}}],[{key:"fromJSON",value:function(e){return new n(e.vertices,e.indices,e.radius,e.details)}}]),n}(),Of=exports.DodecahedronGeometry=function(e){x(n,Nf);var t=S(n);function n(e=1,r=0){var i;k(this,n);var a=(1+Math.sqrt(5))/2,o=1/a,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-o,-a,0,-o,a,0,o,-a,0,o,a,-o,-a,0,-o,a,0,o,-a,0,o,a,0,-a,0,-o,a,0,-o,-a,0,o,a,0,o];return(i=t.call(this,s,[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,r)).type="DodecahedronGeometry",i.parameters={radius:e,detail:r},i}return P(n,null,[{key:"fromJSON",value:function(e){return new n(e.radius,e.detail)}}]),n}(),Ff=new Mi,Bf=new Mi,zf=new Mi,Gf=new Ua,Hf=exports.EdgesGeometry=function(e){x(n,vo);var t=S(n);function n(e=null,r=1){var i;if(k(this,n),(i=t.call(this)).type="EdgesGeometry",i.parameters={geometry:e,thresholdAngle:r},null!==e){for(var a=Math.pow(10,4),o=Math.cos(gr*r),s=e.getIndex(),l=e.getAttribute("position"),u=s?s.count:l.count,c=[0,0,0],h=["a","b","c"],p=new Array(3),d={},f=[],m=0;m<u;m+=3){s?(c[0]=s.getX(m),c[1]=s.getX(m+1),c[2]=s.getX(m+2)):(c[0]=m,c[1]=m+1,c[2]=m+2);var v=Gf.a,g=Gf.b,y=Gf.c;if(v.fromBufferAttribute(l,c[0]),g.fromBufferAttribute(l,c[1]),y.fromBufferAttribute(l,c[2]),Gf.getNormal(zf),p[0]="".concat(Math.round(v.x*a),",").concat(Math.round(v.y*a),",").concat(Math.round(v.z*a)),p[1]="".concat(Math.round(g.x*a),",").concat(Math.round(g.y*a),",").concat(Math.round(g.z*a)),p[2]="".concat(Math.round(y.x*a),",").concat(Math.round(y.y*a),",").concat(Math.round(y.z*a)),p[0]!==p[1]&&p[1]!==p[2]&&p[2]!==p[0])for(var _=0;_<3;_++){var x=(_+1)%3,M=p[_],S=p[x],b=Gf[h[_]],T=Gf[h[x]],E="".concat(M,"_").concat(S),w="".concat(S,"_").concat(M);w in d&&d[w]?(zf.dot(d[w].normal)<=o&&(f.push(b.x,b.y,b.z),f.push(T.x,T.y,T.z)),d[w]=null):E in d||(d[E]={index0:c[_],index1:c[x],normal:zf.clone()})}}for(var A in d)if(d[A]){var R=d[A],C=R.index0,L=R.index1;Ff.fromBufferAttribute(l,C),Bf.fromBufferAttribute(l,L),f.push(Ff.x,Ff.y,Ff.z),f.push(Bf.x,Bf.y,Bf.z)}i.setAttribute("position",new oo(f,3))}return i}return P(n,[{key:"copy",value:function(e){return p(w(n.prototype),"copy",this).call(this,e),this.parameters=Object.assign({},e.parameters),this}}]),n}(),Vf=exports.Shape=function(e){x(n,kf);var t=S(n);function n(e){var r;return k(this,n),(r=t.call(this,e)).uuid=_r(),r.type="Shape",r.holes=[],r}return P(n,[{key:"getPointsHoles",value:function(e){for(var t=[],n=0,r=this.holes.length;n<r;n++)t[n]=this.holes[n].getPoints(e);return t}},{key:"extractPoints",value:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}},{key:"copy",value:function(e){p(w(n.prototype),"copy",this).call(this,e),this.holes=[];for(var t=0,r=e.holes.length;t<r;t++){var i=e.holes[t];this.holes.push(i.clone())}return this}},{key:"toJSON",value:function(){var e=p(w(n.prototype),"toJSON",this).call(this);e.uuid=this.uuid,e.holes=[];for(var t=0,r=this.holes.length;t<r;t++){var i=this.holes[t];e.holes.push(i.toJSON())}return e}},{key:"fromJSON",value:function(e){p(w(n.prototype),"fromJSON",this).call(this,e),this.uuid=e.uuid,this.holes=[];for(var t=0,r=e.holes.length;t<r;t++){var i=e.holes[t];this.holes.push((new kf).fromJSON(i))}return this}}]),n}(),Wf={triangulate:function(e,t,n=2){var r,i,a,o,s,l,u,c=t&&t.length,h=c?t[0]*n:e.length,p=Xf(e,0,h,n,!0),d=[];if(!p||p.next===p.prev)return d;if(c&&(p=Qf(e,t,p,n)),e.length>80*n){r=a=e[0],i=o=e[1];for(var f=n;f<h;f+=n)(s=e[f])<r&&(r=s),(l=e[f+1])<i&&(i=l),s>a&&(a=s),l>o&&(o=l);u=0!==(u=Math.max(a-r,o-i))?32767/u:0}return qf(p,d,n,r,i,u,0),d}};function Xf(e,t,n,r,i){var a,o;if(i===Mm(e,t,n,r)>0)for(a=t;a<n;a+=r)o=ym(a,e[a],e[a+1],o);else for(a=n-r;a>=t;a-=r)o=ym(a,e[a],e[a+1],o);return o&&cm(o,o.next)&&(_m(o),o=o.next),o}function jf(e,t){if(!e)return e;t||(t=e);var n,r=e;do{if(n=!1,r.steiner||!cm(r,r.next)&&0!==um(r.prev,r,r.next))r=r.next;else{if(_m(r),(r=t=r.prev)===r.next)break;n=!0}}while(n||r!==t);return t}function qf(e,t,n,r,i,a,o){if(e){!o&&a&&rm(e,r,i,a);for(var s,l,u=e;e.prev!==e.next;)if(s=e.prev,l=e.next,a?Zf(e,r,i,a):Yf(e))t.push(s.i/n|0),t.push(e.i/n|0),t.push(l.i/n|0),_m(e),e=l.next,u=l.next;else if((e=l)===u){o?1===o?qf(e=Jf(jf(e),t,n),t,n,r,i,a,2):2===o&&Kf(e,t,n,r,i,a):qf(jf(e),t,n,r,i,a,1);break}}}function Yf(e){var t=e.prev,n=e,r=e.next;if(um(t,n,r)>=0)return!1;for(var i=t.x,a=n.x,o=r.x,s=t.y,l=n.y,u=r.y,c=i<a?i<o?i:o:a<o?a:o,h=s<l?s<u?s:u:l<u?l:u,p=i>a?i>o?i:o:a>o?a:o,d=s>l?s>u?s:u:l>u?l:u,f=r.next;f!==t;){if(f.x>=c&&f.x<=p&&f.y>=h&&f.y<=d&&sm(i,s,a,l,o,u,f.x,f.y)&&um(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function Zf(e,t,n,r){var i=e.prev,a=e,o=e.next;if(um(i,a,o)>=0)return!1;for(var s=i.x,l=a.x,u=o.x,c=i.y,h=a.y,p=o.y,d=s<l?s<u?s:u:l<u?l:u,f=c<h?c<p?c:p:h<p?h:p,m=s>l?s>u?s:u:l>u?l:u,v=c>h?c>p?c:p:h>p?h:p,g=am(d,f,t,n,r),y=am(m,v,t,n,r),_=e.prevZ,x=e.nextZ;_&&_.z>=g&&x&&x.z<=y;){if(_.x>=d&&_.x<=m&&_.y>=f&&_.y<=v&&_!==i&&_!==o&&sm(s,c,l,h,u,p,_.x,_.y)&&um(_.prev,_,_.next)>=0)return!1;if(_=_.prevZ,x.x>=d&&x.x<=m&&x.y>=f&&x.y<=v&&x!==i&&x!==o&&sm(s,c,l,h,u,p,x.x,x.y)&&um(x.prev,x,x.next)>=0)return!1;x=x.nextZ}for(;_&&_.z>=g;){if(_.x>=d&&_.x<=m&&_.y>=f&&_.y<=v&&_!==i&&_!==o&&sm(s,c,l,h,u,p,_.x,_.y)&&um(_.prev,_,_.next)>=0)return!1;_=_.prevZ}for(;x&&x.z<=y;){if(x.x>=d&&x.x<=m&&x.y>=f&&x.y<=v&&x!==i&&x!==o&&sm(s,c,l,h,u,p,x.x,x.y)&&um(x.prev,x,x.next)>=0)return!1;x=x.nextZ}return!0}function Jf(e,t,n){var r=e;do{var i=r.prev,a=r.next.next;!cm(i,a)&&hm(i,r,r.next,a)&&mm(i,a)&&mm(a,i)&&(t.push(i.i/n|0),t.push(r.i/n|0),t.push(a.i/n|0),_m(r),_m(r.next),r=e=a),r=r.next}while(r!==e);return jf(r)}function Kf(e,t,n,r,i,a){var o=e;do{for(var s=o.next.next;s!==o.prev;){if(o.i!==s.i&&lm(o,s)){var l=gm(o,s);return o=jf(o,o.next),l=jf(l,l.next),qf(o,t,n,r,i,a,0),void qf(l,t,n,r,i,a,0)}s=s.next}o=o.next}while(o!==e)}function Qf(e,t,n,r){var i,a,o,s=[];for(i=0,a=t.length;i<a;i++)(o=Xf(e,t[i]*r,i<a-1?t[i+1]*r:e.length,r,!1))===o.next&&(o.steiner=!0),s.push(om(o));for(s.sort($f),i=0;i<s.length;i++)n=em(s[i],n);return n}function $f(e,t){return e.x-t.x}function em(e,t){var n=tm(e,t);if(!n)return t;var r=gm(n,e);return jf(r,r.next),jf(n,n.next)}function tm(e,t){var n,r=t,i=-1/0,a=e.x,o=e.y;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var s=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=a&&s>i&&(i=s,n=r.x<r.next.x?r:r.next,s===a))return n}r=r.next}while(r!==t);if(!n)return null;var l,u=n,c=n.x,h=n.y,p=1/0;r=n;do{a>=r.x&&r.x>=c&&a!==r.x&&sm(o<h?a:i,o,c,h,o<h?i:a,o,r.x,r.y)&&(l=Math.abs(o-r.y)/(a-r.x),mm(r,e)&&(l<p||l===p&&(r.x>n.x||r.x===n.x&&nm(n,r)))&&(n=r,p=l)),r=r.next}while(r!==u);return n}function nm(e,t){return um(e.prev,e,t.prev)<0&&um(t.next,e,e.next)<0}function rm(e,t,n,r){var i=e;do{0===i.z&&(i.z=am(i.x,i.y,t,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,im(i)}function im(e){var t,n,r,i,a,o,s,l,u=1;do{for(n=e,e=null,a=null,o=0;n;){for(o++,r=n,s=0,t=0;t<u&&(s++,r=r.nextZ);t++);for(l=u;s>0||l>0&&r;)0!==s&&(0===l||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,l--),a?a.nextZ=i:e=i,i.prevZ=a,a=i;n=r}a.nextZ=null,u*=2}while(o>1);return e}function am(e,t,n,r,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*i|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-r)*i|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function om(e){var t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function sm(e,t,n,r,i,a,o,s){return(i-o)*(t-s)>=(e-o)*(a-s)&&(e-o)*(r-s)>=(n-o)*(t-s)&&(n-o)*(a-s)>=(i-o)*(r-s)}function lm(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!fm(e,t)&&(mm(e,t)&&mm(t,e)&&vm(e,t)&&(um(e.prev,e,t.prev)||um(e,t.prev,t))||cm(e,t)&&um(e.prev,e,e.next)>0&&um(t.prev,t,t.next)>0)}function um(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function cm(e,t){return e.x===t.x&&e.y===t.y}function hm(e,t,n,r){var i=dm(um(e,t,n)),a=dm(um(e,t,r)),o=dm(um(n,r,e)),s=dm(um(n,r,t));return i!==a&&o!==s||(!(0!==i||!pm(e,n,t))||(!(0!==a||!pm(e,r,t))||(!(0!==o||!pm(n,e,r))||!(0!==s||!pm(n,t,r)))))}function pm(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function dm(e){return e>0?1:e<0?-1:0}function fm(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&hm(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}function mm(e,t){return um(e.prev,e,e.next)<0?um(e,t,e.next)>=0&&um(e,e.prev,t)>=0:um(e,t,e.prev)<0||um(e,e.next,t)<0}function vm(e,t){var n=e,r=!1,i=(e.x+t.x)/2,a=(e.y+t.y)/2;do{n.y>a!=n.next.y>a&&n.next.y!==n.y&&i<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==e);return r}function gm(e,t){var n=new xm(e.i,e.x,e.y),r=new xm(t.i,t.x,t.y),i=e.next,a=t.prev;return e.next=t,t.prev=e,n.next=i,i.prev=n,r.next=n,n.prev=r,a.next=r,r.prev=a,r}function ym(e,t,n,r){var i=new xm(e,t,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function _m(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function xm(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Mm(e,t,n,r){for(var i=0,a=t,o=n-r;a<n;a+=r)i+=(e[o]-e[a])*(e[a+1]+e[o+1]),o=a;return i}var Sm=exports.ShapeUtils=function(){function e(){k(this,e)}return P(e,null,[{key:"area",value:function(e){for(var t=e.length,n=0,r=t-1,i=0;i<t;r=i++)n+=e[r].x*e[i].y-e[i].x*e[r].y;return.5*n}},{key:"isClockWise",value:function(t){return e.area(t)<0}},{key:"triangulateShape",value:function(e,t){var n=[],r=[],i=[];bm(e),Tm(n,e);var a=e.length;t.forEach(bm);for(var o=0;o<t.length;o++)r.push(a),a+=t[o].length,Tm(n,t[o]);for(var s=Wf.triangulate(n,r),l=0;l<s.length;l+=3)i.push(s.slice(l,l+3));return i}}]),e}();function bm(e){var t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function Tm(e,t){for(var n=0;n<t.length;n++)e.push(t[n].x),e.push(t[n].y)}var Em=exports.ExtrudeGeometry=function(e){x(n,vo);var t=S(n);function n(e=new Vf([new Hr(.5,.5),new Hr(-.5,.5),new Hr(-.5,-.5),new Hr(.5,-.5)]),r={}){var i;k(this,n),(i=t.call(this)).type="ExtrudeGeometry",i.parameters={shapes:e,options:r},e=Array.isArray(e)?e:[e];for(var a=T(i),o=[],s=[],l=0,u=e.length;l<u;l++){c(e[l])}function c(e){var t,n,i,l,u,c=[],h=void 0!==r.curveSegments?r.curveSegments:12,p=void 0!==r.steps?r.steps:1,d=void 0!==r.depth?r.depth:1,f=void 0===r.bevelEnabled||r.bevelEnabled,m=void 0!==r.bevelThickness?r.bevelThickness:.2,v=void 0!==r.bevelSize?r.bevelSize:m-.1,g=void 0!==r.bevelOffset?r.bevelOffset:0,y=void 0!==r.bevelSegments?r.bevelSegments:3,_=r.extrudePath,x=void 0!==r.UVGenerator?r.UVGenerator:wm,M=!1;_&&(t=_.getSpacedPoints(p),M=!0,f=!1,n=_.computeFrenetFrames(p,!1),i=new Mi,l=new Mi,u=new Mi),f||(y=0,m=0,v=0,g=0);var S=e.extractPoints(h),b=S.shape,T=S.holes;if(!Sm.isClockWise(b)){b=b.reverse();for(var E=0,w=T.length;E<w;E++){var A=T[E];Sm.isClockWise(A)&&(T[E]=A.reverse())}}for(var R=Sm.triangulateShape(b,T),C=b,k=0,L=T.length;k<L;k++){var P=T[k];b=b.concat(P)}function I(e,t,n){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().addScaledVector(t,n)}var U=b.length,D=R.length;function N(e,t,n){var r,i,a,o=e.x-t.x,s=e.y-t.y,l=n.x-e.x,u=n.y-e.y,c=o*o+s*s,h=o*u-s*l;if(Math.abs(h)>Number.EPSILON){var p=Math.sqrt(c),d=Math.sqrt(l*l+u*u),f=t.x-s/p,m=t.y+o/p,v=((n.x-u/d-f)*u-(n.y+l/d-m)*l)/(o*u-s*l),g=(r=f+o*v-e.x)*r+(i=m+s*v-e.y)*i;if(g<=2)return new Hr(r,i);a=Math.sqrt(g/2)}else{var y=!1;o>Number.EPSILON?l>Number.EPSILON&&(y=!0):o<-Number.EPSILON?l<-Number.EPSILON&&(y=!0):Math.sign(s)===Math.sign(u)&&(y=!0),y?(r=-s,i=o,a=Math.sqrt(c)):(r=o,i=s,a=Math.sqrt(c/2))}return new Hr(r/a,i/a)}for(var O=[],F=0,B=C.length,z=B-1,G=F+1;F<B;F++,z++,G++)z===B&&(z=0),G===B&&(G=0),O[F]=N(C[F],C[z],C[G]);for(var H,V=[],W=O.concat(),X=0,j=T.length;X<j;X++){var q=T[X];H=[];for(var Y=0,Z=q.length,J=Z-1,K=Y+1;Y<Z;Y++,J++,K++)J===Z&&(J=0),K===Z&&(K=0),H[Y]=N(q[Y],q[J],q[K]);V.push(H),W=W.concat(H)}for(var Q=0;Q<y;Q++){for(var $=Q/y,ee=m*Math.cos($*Math.PI/2),te=v*Math.sin($*Math.PI/2)+g,ne=0,re=C.length;ne<re;ne++){var ie=I(C[ne],O[ne],te);Le(ie.x,ie.y,-ee)}for(var ae=0,oe=T.length;ae<oe;ae++){var se=T[ae];H=V[ae];for(var le=0,ue=se.length;le<ue;le++){var ce=I(se[le],H[le],te);Le(ce.x,ce.y,-ee)}}}for(var he=v+g,pe=0;pe<U;pe++){var de=f?I(b[pe],W[pe],he):b[pe];M?(l.copy(n.normals[0]).multiplyScalar(de.x),i.copy(n.binormals[0]).multiplyScalar(de.y),u.copy(t[0]).add(l).add(i),Le(u.x,u.y,u.z)):Le(de.x,de.y,0)}for(var fe=1;fe<=p;fe++)for(var me=0;me<U;me++){var ve=f?I(b[me],W[me],he):b[me];M?(l.copy(n.normals[fe]).multiplyScalar(ve.x),i.copy(n.binormals[fe]).multiplyScalar(ve.y),u.copy(t[fe]).add(l).add(i),Le(u.x,u.y,u.z)):Le(ve.x,ve.y,d/p*fe)}for(var ge=y-1;ge>=0;ge--){for(var ye=ge/y,_e=m*Math.cos(ye*Math.PI/2),xe=v*Math.sin(ye*Math.PI/2)+g,Me=0,Se=C.length;Me<Se;Me++){var be=I(C[Me],O[Me],xe);Le(be.x,be.y,d+_e)}for(var Te=0,Ee=T.length;Te<Ee;Te++){var we=T[Te];H=V[Te];for(var Ae=0,Re=we.length;Ae<Re;Ae++){var Ce=I(we[Ae],H[Ae],xe);M?Le(Ce.x,Ce.y+t[p-1].y,t[p-1].x+_e):Le(Ce.x,Ce.y,d+_e)}}}function ke(e,t){for(var n=e.length;--n>=0;){var r=n,i=n-1;i<0&&(i=e.length-1);for(var a=0,o=p+2*y;a<o;a++){var s=U*a,l=U*(a+1);Ie(t+r+s,t+i+s,t+i+l,t+r+l)}}}function Le(e,t,n){c.push(e),c.push(t),c.push(n)}function Pe(e,t,n){Ue(e),Ue(t),Ue(n);var r=o.length/3,i=x.generateTopUV(a,o,r-3,r-2,r-1);De(i[0]),De(i[1]),De(i[2])}function Ie(e,t,n,r){Ue(e),Ue(t),Ue(r),Ue(t),Ue(n),Ue(r);var i=o.length/3,s=x.generateSideWallUV(a,o,i-6,i-3,i-2,i-1);De(s[0]),De(s[1]),De(s[3]),De(s[1]),De(s[2]),De(s[3])}function Ue(e){o.push(c[3*e+0]),o.push(c[3*e+1]),o.push(c[3*e+2])}function De(e){s.push(e.x),s.push(e.y)}!function(){var e=o.length/3;if(f){for(var t=0,n=U*t,r=0;r<D;r++){var i=R[r];Pe(i[2]+n,i[1]+n,i[0]+n)}n=U*(t=p+2*y);for(var s=0;s<D;s++){var l=R[s];Pe(l[0]+n,l[1]+n,l[2]+n)}}else{for(var u=0;u<D;u++){var c=R[u];Pe(c[2],c[1],c[0])}for(var h=0;h<D;h++){var d=R[h];Pe(d[0]+U*p,d[1]+U*p,d[2]+U*p)}}a.addGroup(e,o.length/3-e,0)}(),function(){var e=o.length/3,t=0;ke(C,t),t+=C.length;for(var n=0,r=T.length;n<r;n++){var i=T[n];ke(i,t),t+=i.length}a.addGroup(e,o.length/3-e,1)}()}return i.setAttribute("position",new oo(o,3)),i.setAttribute("uv",new oo(s,2)),i.computeVertexNormals(),i}return P(n,[{key:"copy",value:function(e){return p(w(n.prototype),"copy",this).call(this,e),this.parameters=Object.assign({},e.parameters),this}},{key:"toJSON",value:function(){var e=p(w(n.prototype),"toJSON",this).call(this);return Am(this.parameters.shapes,this.parameters.options,e)}}],[{key:"fromJSON",value:function(e,t){for(var r=[],i=0,a=e.shapes.length;i<a;i++){var o=t[e.shapes[i]];r.push(o)}var s=e.options.extrudePath;return void 0!==s&&(e.options.extrudePath=(new Rf[s.type]).fromJSON(s)),new n(r,e.options)}}]),n}(),wm={generateTopUV:function(e,t,n,r,i){var a=t[3*n],o=t[3*n+1],s=t[3*r],l=t[3*r+1],u=t[3*i],c=t[3*i+1];return[new Hr(a,o),new Hr(s,l),new Hr(u,c)]},generateSideWallUV:function(e,t,n,r,i,a){var o=t[3*n],s=t[3*n+1],l=t[3*n+2],u=t[3*r],c=t[3*r+1],h=t[3*r+2],p=t[3*i],d=t[3*i+1],f=t[3*i+2],m=t[3*a],v=t[3*a+1],g=t[3*a+2];return Math.abs(s-c)<Math.abs(o-u)?[new Hr(o,1-l),new Hr(u,1-h),new Hr(p,1-f),new Hr(m,1-g)]:[new Hr(s,1-l),new Hr(c,1-h),new Hr(d,1-f),new Hr(v,1-g)]}};function Am(e,t,n){if(n.shapes=[],Array.isArray(e))for(var r=0,i=e.length;r<i;r++){var a=e[r];n.shapes.push(a.uuid)}else n.shapes.push(e.uuid);return n.options=Object.assign({},t),void 0!==t.extrudePath&&(n.options.extrudePath=t.extrudePath.toJSON()),n}var Rm=exports.IcosahedronGeometry=function(e){x(n,Nf);var t=S(n);function n(e=1,r=0){var i;k(this,n);var a=(1+Math.sqrt(5))/2,o=[-1,a,0,1,a,0,-1,-a,0,1,-a,0,0,-1,a,0,1,a,0,-1,-a,0,1,-a,a,0,-1,a,0,1,-a,0,-1,-a,0,1];return(i=t.call(this,o,[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,r)).type="IcosahedronGeometry",i.parameters={radius:e,detail:r},i}return P(n,null,[{key:"fromJSON",value:function(e){return new n(e.radius,e.detail)}}]),n}(),Cm=exports.OctahedronGeometry=function(e){x(n,Nf);var t=S(n);function n(e=1,r=0){var i;k(this,n);return(i=t.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,r)).type="OctahedronGeometry",i.parameters={radius:e,detail:r},i}return P(n,null,[{key:"fromJSON",value:function(e){return new n(e.radius,e.detail)}}]),n}(),km=exports.RingGeometry=function(e){x(n,vo);var t=S(n);function n(e=.5,r=1,i=32,a=1,o=0,s=2*Math.PI){var l;k(this,n),(l=t.call(this)).type="RingGeometry",l.parameters={innerRadius:e,outerRadius:r,thetaSegments:i,phiSegments:a,thetaStart:o,thetaLength:s},i=Math.max(3,i);for(var u=[],c=[],h=[],p=[],d=e,f=(r-e)/(a=Math.max(1,a)),m=new Mi,v=new Hr,g=0;g<=a;g++){for(var y=0;y<=i;y++){var _=o+y/i*s;m.x=d*Math.cos(_),m.y=d*Math.sin(_),c.push(m.x,m.y,m.z),h.push(0,0,1),v.x=(m.x/r+1)/2,v.y=(m.y/r+1)/2,p.push(v.x,v.y)}d+=f}for(var x=0;x<a;x++)for(var M=x*(i+1),S=0;S<i;S++){var b=S+M,T=b,E=b+i+1,w=b+i+2,A=b+1;u.push(T,E,A),u.push(E,w,A)}return l.setIndex(u),l.setAttribute("position",new oo(c,3)),l.setAttribute("normal",new oo(h,3)),l.setAttribute("uv",new oo(p,2)),l}return P(n,[{key:"copy",value:function(e){return p(w(n.prototype),"copy",this).call(this,e),this.parameters=Object.assign({},e.parameters),this}}],[{key:"fromJSON",value:function(e){return new n(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}]),n}(),Lm=exports.ShapeGeometry=function(e){x(n,vo);var t=S(n);function n(e=new Vf([new Hr(0,.5),new Hr(-.5,-.5),new Hr(.5,-.5)]),r=12){var i;k(this,n),(i=t.call(this)).type="ShapeGeometry",i.parameters={shapes:e,curveSegments:r};var a=[],o=[],s=[],l=[],u=0,c=0;if(!1===Array.isArray(e))p(e);else for(var h=0;h<e.length;h++)p(e[h]),i.addGroup(u,c,h),u+=c,c=0;function p(e){var t=o.length/3,n=e.extractPoints(r),i=n.shape,u=n.holes;!1===Sm.isClockWise(i)&&(i=i.reverse());for(var h=0,p=u.length;h<p;h++){var d=u[h];!0===Sm.isClockWise(d)&&(u[h]=d.reverse())}for(var f=Sm.triangulateShape(i,u),m=0,v=u.length;m<v;m++){var g=u[m];i=i.concat(g)}for(var y=0,_=i.length;y<_;y++){var x=i[y];o.push(x.x,x.y,0),s.push(0,0,1),l.push(x.x,x.y)}for(var M=0,S=f.length;M<S;M++){var b=f[M],T=b[0]+t,E=b[1]+t,w=b[2]+t;a.push(T,E,w),c+=3}}return i.setIndex(a),i.setAttribute("position",new oo(o,3)),i.setAttribute("normal",new oo(s,3)),i.setAttribute("uv",new oo(l,2)),i}return P(n,[{key:"copy",value:function(e){return p(w(n.prototype),"copy",this).call(this,e),this.parameters=Object.assign({},e.parameters),this}},{key:"toJSON",value:function(){var e=p(w(n.prototype),"toJSON",this).call(this);return Pm(this.parameters.shapes,e)}}],[{key:"fromJSON",value:function(e,t){for(var r=[],i=0,a=e.shapes.length;i<a;i++){var o=t[e.shapes[i]];r.push(o)}return new n(r,e.curveSegments)}}]),n}();function Pm(e,t){if(t.shapes=[],Array.isArray(e))for(var n=0,r=e.length;n<r;n++){var i=e[n];t.shapes.push(i.uuid)}else t.shapes.push(e.uuid);return t}var Im=exports.SphereGeometry=function(e){x(n,vo);var t=S(n);function n(e=1,r=32,i=16,a=0,o=2*Math.PI,s=0,l=Math.PI){var u;k(this,n),(u=t.call(this)).type="SphereGeometry",u.parameters={radius:e,widthSegments:r,heightSegments:i,phiStart:a,phiLength:o,thetaStart:s,thetaLength:l},r=Math.max(3,Math.floor(r)),i=Math.max(2,Math.floor(i));for(var c=Math.min(s+l,Math.PI),h=0,p=[],d=new Mi,f=new Mi,m=[],v=[],g=[],y=[],_=0;_<=i;_++){var x=[],M=_/i,S=0;0===_&&0===s?S=.5/r:_===i&&c===Math.PI&&(S=-.5/r);for(var b=0;b<=r;b++){var T=b/r;d.x=-e*Math.cos(a+T*o)*Math.sin(s+M*l),d.y=e*Math.cos(s+M*l),d.z=e*Math.sin(a+T*o)*Math.sin(s+M*l),v.push(d.x,d.y,d.z),f.copy(d).normalize(),g.push(f.x,f.y,f.z),y.push(T+S,1-M),x.push(h++)}p.push(x)}for(var E=0;E<i;E++)for(var w=0;w<r;w++){var A=p[E][w+1],R=p[E][w],C=p[E+1][w],L=p[E+1][w+1];(0!==E||s>0)&&m.push(A,R,L),(E!==i-1||c<Math.PI)&&m.push(R,C,L)}return u.setIndex(m),u.setAttribute("position",new oo(v,3)),u.setAttribute("normal",new oo(g,3)),u.setAttribute("uv",new oo(y,2)),u}return P(n,[{key:"copy",value:function(e){return p(w(n.prototype),"copy",this).call(this,e),this.parameters=Object.assign({},e.parameters),this}}],[{key:"fromJSON",value:function(e){return new n(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}]),n}(),Um=exports.TetrahedronGeometry=function(e){x(n,Nf);var t=S(n);function n(e=1,r=0){var i;k(this,n);return(i=t.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,r)).type="TetrahedronGeometry",i.parameters={radius:e,detail:r},i}return P(n,null,[{key:"fromJSON",value:function(e){return new n(e.radius,e.detail)}}]),n}(),Dm=exports.TorusGeometry=function(e){x(n,vo);var t=S(n);function n(e=1,r=.4,i=12,a=48,o=2*Math.PI){var s;k(this,n),(s=t.call(this)).type="TorusGeometry",s.parameters={radius:e,tube:r,radialSegments:i,tubularSegments:a,arc:o},i=Math.floor(i),a=Math.floor(a);for(var l=[],u=[],c=[],h=[],p=new Mi,d=new Mi,f=new Mi,m=0;m<=i;m++)for(var v=0;v<=a;v++){var g=v/a*o,y=m/i*Math.PI*2;d.x=(e+r*Math.cos(y))*Math.cos(g),d.y=(e+r*Math.cos(y))*Math.sin(g),d.z=r*Math.sin(y),u.push(d.x,d.y,d.z),p.x=e*Math.cos(g),p.y=e*Math.sin(g),f.subVectors(d,p).normalize(),c.push(f.x,f.y,f.z),h.push(v/a),h.push(m/i)}for(var _=1;_<=i;_++)for(var x=1;x<=a;x++){var M=(a+1)*_+x-1,S=(a+1)*(_-1)+x-1,b=(a+1)*(_-1)+x,T=(a+1)*_+x;l.push(M,S,T),l.push(S,b,T)}return s.setIndex(l),s.setAttribute("position",new oo(u,3)),s.setAttribute("normal",new oo(c,3)),s.setAttribute("uv",new oo(h,2)),s}return P(n,[{key:"copy",value:function(e){return p(w(n.prototype),"copy",this).call(this,e),this.parameters=Object.assign({},e.parameters),this}}],[{key:"fromJSON",value:function(e){return new n(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}]),n}(),Nm=exports.TorusKnotGeometry=function(e){x(n,vo);var t=S(n);function n(e=1,r=.4,i=64,a=8,o=2,s=3){var l;k(this,n),(l=t.call(this)).type="TorusKnotGeometry",l.parameters={radius:e,tube:r,tubularSegments:i,radialSegments:a,p:o,q:s},i=Math.floor(i),a=Math.floor(a);for(var u=[],c=[],h=[],p=[],d=new Mi,f=new Mi,m=new Mi,v=new Mi,g=new Mi,y=new Mi,_=new Mi,x=0;x<=i;++x){var M=x/i*o*Math.PI*2;I(M,o,s,e,m),I(M+.01,o,s,e,v),y.subVectors(v,m),_.addVectors(v,m),g.crossVectors(y,_),_.crossVectors(g,y),g.normalize(),_.normalize();for(var S=0;S<=a;++S){var b=S/a*Math.PI*2,T=-r*Math.cos(b),E=r*Math.sin(b);d.x=m.x+(T*_.x+E*g.x),d.y=m.y+(T*_.y+E*g.y),d.z=m.z+(T*_.z+E*g.z),c.push(d.x,d.y,d.z),f.subVectors(d,m).normalize(),h.push(f.x,f.y,f.z),p.push(x/i),p.push(S/a)}}for(var w=1;w<=i;w++)for(var A=1;A<=a;A++){var R=(a+1)*(w-1)+(A-1),C=(a+1)*w+(A-1),L=(a+1)*w+A,P=(a+1)*(w-1)+A;u.push(R,C,P),u.push(C,L,P)}function I(e,t,n,r,i){var a=Math.cos(e),o=Math.sin(e),s=n/t*e,l=Math.cos(s);i.x=r*(2+l)*.5*a,i.y=r*(2+l)*o*.5,i.z=r*Math.sin(s)*.5}return l.setIndex(u),l.setAttribute("position",new oo(c,3)),l.setAttribute("normal",new oo(h,3)),l.setAttribute("uv",new oo(p,2)),l}return P(n,[{key:"copy",value:function(e){return p(w(n.prototype),"copy",this).call(this,e),this.parameters=Object.assign({},e.parameters),this}}],[{key:"fromJSON",value:function(e){return new n(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}]),n}(),Om=exports.TubeGeometry=function(e){x(n,vo);var t=S(n);function n(e=new wf(new Mi(-1,-1,0),new Mi(-1,1,0),new Mi(1,1,0)),r=64,i=1,a=8,o=!1){var s;k(this,n),(s=t.call(this)).type="TubeGeometry",s.parameters={path:e,tubularSegments:r,radius:i,radialSegments:a,closed:o};var l=e.computeFrenetFrames(r,o);s.tangents=l.tangents,s.normals=l.normals,s.binormals=l.binormals;var u=new Mi,c=new Mi,h=new Hr,p=new Mi,d=[],f=[],m=[],v=[];function g(t){p=e.getPointAt(t/r,p);for(var n=l.normals[t],o=l.binormals[t],s=0;s<=a;s++){var h=s/a*Math.PI*2,m=Math.sin(h),v=-Math.cos(h);c.x=v*n.x+m*o.x,c.y=v*n.y+m*o.y,c.z=v*n.z+m*o.z,c.normalize(),f.push(c.x,c.y,c.z),u.x=p.x+i*c.x,u.y=p.y+i*c.y,u.z=p.z+i*c.z,d.push(u.x,u.y,u.z)}}return function(){for(var e=0;e<r;e++)g(e);g(!1===o?r:0),function(){for(var e=0;e<=r;e++)for(var t=0;t<=a;t++)h.x=e/r,h.y=t/a,m.push(h.x,h.y)}(),function(){for(var e=1;e<=r;e++)for(var t=1;t<=a;t++){var n=(a+1)*(e-1)+(t-1),i=(a+1)*e+(t-1),o=(a+1)*e+t,s=(a+1)*(e-1)+t;v.push(n,i,s),v.push(i,o,s)}}()}(),s.setIndex(v),s.setAttribute("position",new oo(d,3)),s.setAttribute("normal",new oo(f,3)),s.setAttribute("uv",new oo(m,2)),s}return P(n,[{key:"copy",value:function(e){return p(w(n.prototype),"copy",this).call(this,e),this.parameters=Object.assign({},e.parameters),this}},{key:"toJSON",value:function(){var e=p(w(n.prototype),"toJSON",this).call(this);return e.path=this.parameters.path.toJSON(),e}}],[{key:"fromJSON",value:function(e){return new n((new Rf[e.path.type]).fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}]),n}(),Fm=exports.WireframeGeometry=function(e){x(n,vo);var t=S(n);function n(e=null){var r;if(k(this,n),(r=t.call(this)).type="WireframeGeometry",r.parameters={geometry:e},null!==e){var i=[],a=new Set,o=new Mi,s=new Mi;if(null!==e.index){var l=e.attributes.position,u=e.index,c=e.groups;0===c.length&&(c=[{start:0,count:u.count,materialIndex:0}]);for(var h=0,p=c.length;h<p;++h)for(var d=c[h],f=d.start,m=f,v=f+d.count;m<v;m+=3)for(var g=0;g<3;g++){var y=u.getX(m+g),_=u.getX(m+(g+1)%3);o.fromBufferAttribute(l,y),s.fromBufferAttribute(l,_),!0===Bm(o,s,a)&&(i.push(o.x,o.y,o.z),i.push(s.x,s.y,s.z))}}else for(var x=e.attributes.position,M=0,S=x.count/3;M<S;M++)for(var b=0;b<3;b++){var T=3*M+b,E=3*M+(b+1)%3;o.fromBufferAttribute(x,T),s.fromBufferAttribute(x,E),!0===Bm(o,s,a)&&(i.push(o.x,o.y,o.z),i.push(s.x,s.y,s.z))}r.setAttribute("position",new oo(i,3))}return r}return P(n,[{key:"copy",value:function(e){return p(w(n.prototype),"copy",this).call(this,e),this.parameters=Object.assign({},e.parameters),this}}]),n}();function Bm(e,t,n){var r="".concat(e.x,",").concat(e.y,",").concat(e.z,"-").concat(t.x,",").concat(t.y,",").concat(t.z),i="".concat(t.x,",").concat(t.y,",").concat(t.z,"-").concat(e.x,",").concat(e.y,",").concat(e.z);return!0!==n.has(r)&&!0!==n.has(i)&&(n.add(r),n.add(i),!0)}var zm=Object.freeze({__proto__:null,BoxGeometry:Oo,CapsuleGeometry:Pf,CircleGeometry:If,ConeGeometry:Df,CylinderGeometry:Uf,DodecahedronGeometry:Of,EdgesGeometry:Hf,ExtrudeGeometry:Em,IcosahedronGeometry:Rm,LatheGeometry:Lf,OctahedronGeometry:Cm,PlaneGeometry:ls,PolyhedronGeometry:Nf,RingGeometry:km,ShapeGeometry:Lm,SphereGeometry:Im,TetrahedronGeometry:Um,TorusGeometry:Dm,TorusKnotGeometry:Nm,TubeGeometry:Om,WireframeGeometry:Fm}),Gm=exports.ShadowMaterial=function(e){x(n,Na);var t=S(n);function n(e){var r;return k(this,n),(r=t.call(this)).isShadowMaterial=!0,r.type="ShadowMaterial",r.color=new Ga(0),r.transparent=!0,r.fog=!0,r.setValues(e),r}return P(n,[{key:"copy",value:function(e){return p(w(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.fog=e.fog,this}}]),n}(),Hm=exports.RawShaderMaterial=function(e){x(n,Xo);var t=S(n);function n(e){var r;return k(this,n),(r=t.call(this,e)).isRawShaderMaterial=!0,r.type="RawShaderMaterial",r}return P(n)}(),Vm=exports.MeshStandardMaterial=function(e){x(n,Na);var t=S(n);function n(e){var r;return k(this,n),(r=t.call(this)).isMeshStandardMaterial=!0,r.defines={STANDARD:""},r.type="MeshStandardMaterial",r.color=new Ga(16777215),r.roughness=1,r.metalness=0,r.map=null,r.lightMap=null,r.lightMapIntensity=1,r.aoMap=null,r.aoMapIntensity=1,r.emissive=new Ga(0),r.emissiveIntensity=1,r.emissiveMap=null,r.bumpMap=null,r.bumpScale=1,r.normalMap=null,r.normalMapType=_n,r.normalScale=new Hr(1,1),r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.roughnessMap=null,r.metalnessMap=null,r.alphaMap=null,r.envMap=null,r.envMapIntensity=1,r.wireframe=!1,r.wireframeLinewidth=1,r.wireframeLinecap="round",r.wireframeLinejoin="round",r.flatShading=!1,r.fog=!0,r.setValues(e),r}return P(n,[{key:"copy",value:function(e){return p(w(n.prototype),"copy",this).call(this,e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}]),n}(),Wm=exports.MeshPhysicalMaterial=function(e){x(n,Vm);var t=S(n);function n(e){var r;return k(this,n),(r=t.call(this)).isMeshPhysicalMaterial=!0,r.defines={STANDARD:"",PHYSICAL:""},r.type="MeshPhysicalMaterial",r.anisotropyRotation=0,r.anisotropyMap=null,r.clearcoatMap=null,r.clearcoatRoughness=0,r.clearcoatRoughnessMap=null,r.clearcoatNormalScale=new Hr(1,1),r.clearcoatNormalMap=null,r.ior=1.5,Object.defineProperty(T(r),"reflectivity",{get:function(){return xr(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(e){this.ior=(1+.4*e)/(1-.4*e)}}),r.iridescenceMap=null,r.iridescenceIOR=1.3,r.iridescenceThicknessRange=[100,400],r.iridescenceThicknessMap=null,r.sheenColor=new Ga(0),r.sheenColorMap=null,r.sheenRoughness=1,r.sheenRoughnessMap=null,r.transmissionMap=null,r.thickness=0,r.thicknessMap=null,r.attenuationDistance=1/0,r.attenuationColor=new Ga(1,1,1),r.specularIntensity=1,r.specularIntensityMap=null,r.specularColor=new Ga(1,1,1),r.specularColorMap=null,r._anisotropy=0,r._clearcoat=0,r._iridescence=0,r._sheen=0,r._transmission=0,r.setValues(e),r}return P(n,[{key:"anisotropy",get:function(){return this._anisotropy},set:function(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}},{key:"clearcoat",get:function(){return this._clearcoat},set:function(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}},{key:"iridescence",get:function(){return this._iridescence},set:function(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}},{key:"sheen",get:function(){return this._sheen},set:function(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}},{key:"transmission",get:function(){return this._transmission},set:function(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}},{key:"copy",value:function(e){return p(w(n.prototype),"copy",this).call(this,e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=f(e.iridescenceThicknessRange),this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}]),n}(),Xm=exports.MeshPhongMaterial=function(e){x(n,Na);var t=S(n);function n(e){var r;return k(this,n),(r=t.call(this)).isMeshPhongMaterial=!0,r.type="MeshPhongMaterial",r.color=new Ga(16777215),r.specular=new Ga(1118481),r.shininess=30,r.map=null,r.lightMap=null,r.lightMapIntensity=1,r.aoMap=null,r.aoMapIntensity=1,r.emissive=new Ga(0),r.emissiveIntensity=1,r.emissiveMap=null,r.bumpMap=null,r.bumpScale=1,r.normalMap=null,r.normalMapType=_n,r.normalScale=new Hr(1,1),r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.specularMap=null,r.alphaMap=null,r.envMap=null,r.combine=we,r.reflectivity=1,r.refractionRatio=.98,r.wireframe=!1,r.wireframeLinewidth=1,r.wireframeLinecap="round",r.wireframeLinejoin="round",r.flatShading=!1,r.fog=!0,r.setValues(e),r}return P(n,[{key:"copy",value:function(e){return p(w(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}]),n}(),jm=exports.MeshToonMaterial=function(e){x(n,Na);var t=S(n);function n(e){var r;return k(this,n),(r=t.call(this)).isMeshToonMaterial=!0,r.defines={TOON:""},r.type="MeshToonMaterial",r.color=new Ga(16777215),r.map=null,r.gradientMap=null,r.lightMap=null,r.lightMapIntensity=1,r.aoMap=null,r.aoMapIntensity=1,r.emissive=new Ga(0),r.emissiveIntensity=1,r.emissiveMap=null,r.bumpMap=null,r.bumpScale=1,r.normalMap=null,r.normalMapType=_n,r.normalScale=new Hr(1,1),r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.alphaMap=null,r.wireframe=!1,r.wireframeLinewidth=1,r.wireframeLinecap="round",r.wireframeLinejoin="round",r.fog=!0,r.setValues(e),r}return P(n,[{key:"copy",value:function(e){return p(w(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}]),n}(),qm=exports.MeshNormalMaterial=function(e){x(n,Na);var t=S(n);function n(e){var r;return k(this,n),(r=t.call(this)).isMeshNormalMaterial=!0,r.type="MeshNormalMaterial",r.bumpMap=null,r.bumpScale=1,r.normalMap=null,r.normalMapType=_n,r.normalScale=new Hr(1,1),r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.wireframe=!1,r.wireframeLinewidth=1,r.flatShading=!1,r.setValues(e),r}return P(n,[{key:"copy",value:function(e){return p(w(n.prototype),"copy",this).call(this,e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}]),n}(),Ym=exports.MeshLambertMaterial=function(e){x(n,Na);var t=S(n);function n(e){var r;return k(this,n),(r=t.call(this)).isMeshLambertMaterial=!0,r.type="MeshLambertMaterial",r.color=new Ga(16777215),r.map=null,r.lightMap=null,r.lightMapIntensity=1,r.aoMap=null,r.aoMapIntensity=1,r.emissive=new Ga(0),r.emissiveIntensity=1,r.emissiveMap=null,r.bumpMap=null,r.bumpScale=1,r.normalMap=null,r.normalMapType=_n,r.normalScale=new Hr(1,1),r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.specularMap=null,r.alphaMap=null,r.envMap=null,r.combine=we,r.reflectivity=1,r.refractionRatio=.98,r.wireframe=!1,r.wireframeLinewidth=1,r.wireframeLinecap="round",r.wireframeLinejoin="round",r.flatShading=!1,r.fog=!0,r.setValues(e),r}return P(n,[{key:"copy",value:function(e){return p(w(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}]),n}(),Zm=exports.MeshMatcapMaterial=function(e){x(n,Na);var t=S(n);function n(e){var r;return k(this,n),(r=t.call(this)).isMeshMatcapMaterial=!0,r.defines={MATCAP:""},r.type="MeshMatcapMaterial",r.color=new Ga(16777215),r.matcap=null,r.map=null,r.bumpMap=null,r.bumpScale=1,r.normalMap=null,r.normalMapType=_n,r.normalScale=new Hr(1,1),r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.alphaMap=null,r.flatShading=!1,r.fog=!0,r.setValues(e),r}return P(n,[{key:"copy",value:function(e){return p(w(n.prototype),"copy",this).call(this,e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}]),n}(),Jm=exports.LineDashedMaterial=function(e){x(n,Ld);var t=S(n);function n(e){var r;return k(this,n),(r=t.call(this)).isLineDashedMaterial=!0,r.type="LineDashedMaterial",r.scale=1,r.dashSize=3,r.gapSize=1,r.setValues(e),r}return P(n,[{key:"copy",value:function(e){return p(w(n.prototype),"copy",this).call(this,e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}]),n}();function Km(e,t,n){return!e||!n&&e.constructor===t?e:"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)}function Qm(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function $m(e){for(var t=e.length,n=new Array(t),r=0;r!==t;++r)n[r]=r;return n.sort(function(t,n){return e[t]-e[n]}),n}function ev(e,t,n){for(var r=e.length,i=new e.constructor(r),a=0,o=0;o!==r;++a)for(var s=n[a]*t,l=0;l!==t;++l)i[o++]=e[s+l];return i}function tv(e,t,n,r){for(var i=1,a=e[0];void 0!==a&&void 0===a[r];)a=e[i++];if(void 0!==a){var o=a[r];if(void 0!==o)if(Array.isArray(o))do{void 0!==(o=a[r])&&(t.push(a.time),n.push.apply(n,o)),a=e[i++]}while(void 0!==a);else if(void 0!==o.toArray)do{void 0!==(o=a[r])&&(t.push(a.time),o.toArray(n,n.length)),a=e[i++]}while(void 0!==a);else do{void 0!==(o=a[r])&&(t.push(a.time),n.push(o)),a=e[i++]}while(void 0!==a)}}function nv(e,t,n,r,i=30){var a=e.clone();a.name=t;for(var o=[],s=0;s<a.tracks.length;++s){for(var l=a.tracks[s],u=l.getValueSize(),c=[],h=[],p=0;p<l.times.length;++p){var d=l.times[p]*i;if(!(d<n||d>=r)){c.push(l.times[p]);for(var f=0;f<u;++f)h.push(l.values[p*u+f])}}0!==c.length&&(l.times=Km(c,l.times.constructor),l.values=Km(h,l.values.constructor),o.push(l))}a.tracks=o;for(var m=1/0,v=0;v<a.tracks.length;++v)m>a.tracks[v].times[0]&&(m=a.tracks[v].times[0]);for(var g=0;g<a.tracks.length;++g)a.tracks[g].shift(-1*m);return a.resetDuration(),a}function rv(e,t=0,n=e,r=30){r<=0&&(r=30);for(var i=n.tracks.length,a=t/r,o=function(){var t=n.tracks[s],r=t.ValueTypeName;if("bool"===r||"string"===r)return 0;var i=e.tracks.find(function(e){return e.name===t.name&&e.ValueTypeName===r});if(void 0===i)return 0;var o=0,l=t.getValueSize();t.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(o=l/3);var u=0,c=i.getValueSize();i.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(u=c/3);var h,p=t.times.length-1;if(a<=t.times[0]){var d=o,f=l-o;h=t.values.slice(d,f)}else if(a>=t.times[p]){var m=p*l+o,v=m+l-o;h=t.values.slice(m,v)}else{var g=t.createInterpolant(),y=o,_=l-o;g.evaluate(a),h=g.resultBuffer.slice(y,_)}"quaternion"===r&&(new xi).fromArray(h).normalize().conjugate().toArray(h);for(var x=i.times.length,M=0;M<x;++M){var S=M*c+u;if("quaternion"===r)xi.multiplyQuaternionsFlat(i.values,S,h,0,i.values,S);else for(var b=c-2*u,T=0;T<b;++T)i.values[S+T]-=h[T]}},s=0;s<i;++s)o();return e.blendMode=hn,e}var iv=exports.AnimationUtils={convertArray:Km,isTypedArray:Qm,getKeyframeOrder:$m,sortedArray:ev,flattenJSON:tv,subclip:nv,makeClipAdditive:rv},av=exports.Interpolant=function(){function e(t,n,r,i){k(this,e),this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==i?i:new n.constructor(r),this.sampleValues=n,this.valueSize=r,this.settings=null,this.DefaultSettings_={}}return P(e,[{key:"evaluate",value:function(e){var t=this.parameterPositions,n=this._cachedIndex,r=t[n],i=t[n-1];e:{t:{var a;n:{r:if(!(e<r)){for(var o=n+2;;){if(void 0===r){if(e<i)break r;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===o)break;if(i=r,e<(r=t[++n]))break t}a=t.length;break n}if(e>=i)break e;var s=t[1];e<s&&(n=2,i=s);for(var l=n-2;;){if(void 0===i)return this._cachedIndex=0,this.copySampleValue_(0);if(n===l)break;if(r=i,e>=(i=t[--n-1]))break t}a=n,n=0}for(;n<a;){var u=n+a>>>1;e<t[u]?a=u:n=u+1}if(r=t[n],void 0===(i=t[n-1]))return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===r)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,e,r)}},{key:"getSettings_",value:function(){return this.settings||this.DefaultSettings_}},{key:"copySampleValue_",value:function(e){for(var t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=e*r,a=0;a!==r;++a)t[a]=n[i+a];return t}},{key:"interpolate_",value:function(){throw new Error("call to abstract method")}},{key:"intervalChanged_",value:function(){}}]),e}(),ov=exports.CubicInterpolant=function(e){x(n,av);var t=S(n);function n(e,r,i,a){var o;return k(this,n),(o=t.call(this,e,r,i,a))._weightPrev=-0,o._offsetPrev=-0,o._weightNext=-0,o._offsetNext=-0,o.DefaultSettings_={endingStart:sn,endingEnd:sn},o}return P(n,[{key:"intervalChanged_",value:function(e,t,n){var r=this.parameterPositions,i=e-2,a=e+1,o=r[i],s=r[a];if(void 0===o)switch(this.getSettings_().endingStart){case ln:i=e,o=2*t-n;break;case un:o=t+r[i=r.length-2]-r[i+1];break;default:i=e,o=n}if(void 0===s)switch(this.getSettings_().endingEnd){case ln:a=e,s=2*n-t;break;case un:a=1,s=n+r[1]-r[0];break;default:a=e-1,s=t}var l=.5*(n-t),u=this.valueSize;this._weightPrev=l/(t-o),this._weightNext=l/(s-n),this._offsetPrev=i*u,this._offsetNext=a*u}},{key:"interpolate_",value:function(e,t,n,r){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,l=s-o,u=this._offsetPrev,c=this._offsetNext,h=this._weightPrev,p=this._weightNext,d=(n-t)/(r-t),f=d*d,m=f*d,v=-h*m+2*h*f-h*d,g=(1+h)*m+(-1.5-2*h)*f+(-.5+h)*d+1,y=(-1-p)*m+(1.5+p)*f+.5*d,_=p*m-p*f,x=0;x!==o;++x)i[x]=v*a[u+x]+g*a[l+x]+y*a[s+x]+_*a[c+x];return i}}]),n}(),sv=exports.LinearInterpolant=function(e){x(n,av);var t=S(n);function n(e,r,i,a){return k(this,n),t.call(this,e,r,i,a)}return P(n,[{key:"interpolate_",value:function(e,t,n,r){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,l=s-o,u=(n-t)/(r-t),c=1-u,h=0;h!==o;++h)i[h]=a[l+h]*c+a[s+h]*u;return i}}]),n}(),lv=exports.DiscreteInterpolant=function(e){x(n,av);var t=S(n);function n(e,r,i,a){return k(this,n),t.call(this,e,r,i,a)}return P(n,[{key:"interpolate_",value:function(e){return this.copySampleValue_(e-1)}}]),n}(),uv=exports.KeyframeTrack=function(){function e(t,n,r,i){if(k(this,e),void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===n||0===n.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=Km(n,this.TimeBufferType),this.values=Km(r,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}return P(e,[{key:"InterpolantFactoryMethodDiscrete",value:function(e){return new lv(this.times,this.values,this.getValueSize(),e)}},{key:"InterpolantFactoryMethodLinear",value:function(e){return new sv(this.times,this.values,this.getValueSize(),e)}},{key:"InterpolantFactoryMethodSmooth",value:function(e){return new ov(this.times,this.values,this.getValueSize(),e)}},{key:"setInterpolation",value:function(e){var t;switch(e){case rn:t=this.InterpolantFactoryMethodDiscrete;break;case an:t=this.InterpolantFactoryMethodLinear;break;case on:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){var n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this}},{key:"getInterpolation",value:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return rn;case this.InterpolantFactoryMethodLinear:return an;case this.InterpolantFactoryMethodSmooth:return on}}},{key:"getValueSize",value:function(){return this.values.length/this.times.length}},{key:"shift",value:function(e){if(0!==e)for(var t=this.times,n=0,r=t.length;n!==r;++n)t[n]+=e;return this}},{key:"scale",value:function(e){if(1!==e)for(var t=this.times,n=0,r=t.length;n!==r;++n)t[n]*=e;return this}},{key:"trim",value:function(e,t){for(var n=this.times,r=n.length,i=0,a=r-1;i!==r&&n[i]<e;)++i;for(;-1!==a&&n[a]>t;)--a;if(++a,0!==i||a!==r){i>=a&&(i=(a=Math.max(a,1))-1);var o=this.getValueSize();this.times=n.slice(i,a),this.values=this.values.slice(i*o,a*o)}return this}},{key:"validate",value:function(){var e=!0,t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);var n=this.times,r=this.values,i=n.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);for(var a=null,o=0;o!==i;o++){var s=n[o];if("number"==typeof s&&isNaN(s)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,s),e=!1;break}if(null!==a&&a>s){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,s,a),e=!1;break}a=s}if(void 0!==r&&Qm(r))for(var l=0,u=r.length;l!==u;++l){var c=r[l];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,l,c),e=!1;break}}return e}},{key:"optimize",value:function(){for(var e=this.times.slice(),t=this.values.slice(),n=this.getValueSize(),r=this.getInterpolation()===on,i=e.length-1,a=1,o=1;o<i;++o){var s=!1,l=e[o];if(l!==e[o+1]&&(1!==o||l!==e[0]))if(r)s=!0;else for(var u=o*n,c=u-n,h=u+n,p=0;p!==n;++p){var d=t[u+p];if(d!==t[c+p]||d!==t[h+p]){s=!0;break}}if(s){if(o!==a){e[a]=e[o];for(var f=o*n,m=a*n,v=0;v!==n;++v)t[m+v]=t[f+v]}++a}}if(i>0){e[a]=e[i];for(var g=i*n,y=a*n,_=0;_!==n;++_)t[y+_]=t[g+_];++a}return a!==e.length?(this.times=e.slice(0,a),this.values=t.slice(0,a*n)):(this.times=e,this.values=t),this}},{key:"clone",value:function(){var e=this.times.slice(),t=this.values.slice(),n=new(0,this.constructor)(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}}],[{key:"toJSON",value:function(e){var t,n=e.constructor;if(n.toJSON!==this.toJSON)t=n.toJSON(e);else{t={name:e.name,times:Km(e.times,Array),values:Km(e.values,Array)};var r=e.getInterpolation();r!==e.DefaultInterpolation&&(t.interpolation=r)}return t.type=e.ValueTypeName,t}}]),e}();uv.prototype.TimeBufferType=Float32Array,uv.prototype.ValueBufferType=Float32Array,uv.prototype.DefaultInterpolation=an;var cv=exports.BooleanKeyframeTrack=function(e){x(n,uv);var t=S(n);function n(){return k(this,n),t.apply(this,arguments)}return P(n)}();cv.prototype.ValueTypeName="bool",cv.prototype.ValueBufferType=Array,cv.prototype.DefaultInterpolation=rn,cv.prototype.InterpolantFactoryMethodLinear=void 0,cv.prototype.InterpolantFactoryMethodSmooth=void 0;var hv=exports.ColorKeyframeTrack=function(e){x(n,uv);var t=S(n);function n(){return k(this,n),t.apply(this,arguments)}return P(n)}();hv.prototype.ValueTypeName="color";var pv=exports.NumberKeyframeTrack=function(e){x(n,uv);var t=S(n);function n(){return k(this,n),t.apply(this,arguments)}return P(n)}();pv.prototype.ValueTypeName="number";var dv=exports.QuaternionLinearInterpolant=function(e){x(n,av);var t=S(n);function n(e,r,i,a){return k(this,n),t.call(this,e,r,i,a)}return P(n,[{key:"interpolate_",value:function(e,t,n,r){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=(n-t)/(r-t),l=e*o,u=l+o;l!==u;l+=4)xi.slerpFlat(i,0,a,l-o,a,l,s);return i}}]),n}(),fv=exports.QuaternionKeyframeTrack=function(e){x(n,uv);var t=S(n);function n(){return k(this,n),t.apply(this,arguments)}return P(n,[{key:"InterpolantFactoryMethodLinear",value:function(e){return new dv(this.times,this.values,this.getValueSize(),e)}}]),n}();fv.prototype.ValueTypeName="quaternion",fv.prototype.DefaultInterpolation=an,fv.prototype.InterpolantFactoryMethodSmooth=void 0;var mv=exports.StringKeyframeTrack=function(e){x(n,uv);var t=S(n);function n(){return k(this,n),t.apply(this,arguments)}return P(n)}();mv.prototype.ValueTypeName="string",mv.prototype.ValueBufferType=Array,mv.prototype.DefaultInterpolation=rn,mv.prototype.InterpolantFactoryMethodLinear=void 0,mv.prototype.InterpolantFactoryMethodSmooth=void 0;var vv=exports.VectorKeyframeTrack=function(e){x(n,uv);var t=S(n);function n(){return k(this,n),t.apply(this,arguments)}return P(n)}();vv.prototype.ValueTypeName="vector";var gv=exports.AnimationClip=function(){function e(t,n=-1,r,i=cn){k(this,e),this.name=t,this.tracks=r,this.duration=n,this.blendMode=i,this.uuid=_r(),this.duration<0&&this.resetDuration()}return P(e,[{key:"resetDuration",value:function(){for(var e=0,t=0,n=this.tracks.length;t!==n;++t){var r=this.tracks[t];e=Math.max(e,r.times[r.times.length-1])}return this.duration=e,this}},{key:"trim",value:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}},{key:"validate",value:function(){for(var e=!0,t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}},{key:"optimize",value:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}},{key:"clone",value:function(){for(var e=[],t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}},{key:"toJSON",value:function(){return this.constructor.toJSON(this)}}],[{key:"parse",value:function(e){for(var t=[],n=e.tracks,r=1/(e.fps||1),i=0,a=n.length;i!==a;++i)t.push(_v(n[i]).scale(r));var o=new this(e.name,e.duration,t,e.blendMode);return o.uuid=e.uuid,o}},{key:"toJSON",value:function(e){for(var t=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode},i=0,a=n.length;i!==a;++i)t.push(uv.toJSON(n[i]));return r}},{key:"CreateFromMorphTargetSequence",value:function(e,t,n,r){for(var i=t.length,a=[],o=0;o<i;o++){var s=[],l=[];s.push((o+i-1)%i,o,(o+1)%i),l.push(0,1,0);var u=$m(s);s=ev(s,1,u),l=ev(l,1,u),r||0!==s[0]||(s.push(i),l.push(l[0])),a.push(new pv(".morphTargetInfluences["+t[o].name+"]",s,l).scale(1/n))}return new this(e,-1,a)}},{key:"findByName",value:function(e,t){var n=e;if(!Array.isArray(e)){var r=e;n=r.geometry&&r.geometry.animations||r.animations}for(var i=0;i<n.length;i++)if(n[i].name===t)return n[i];return null}},{key:"CreateClipsFromMorphTargetSequences",value:function(e,t,n){for(var r={},i=/^([\w-]*?)([\d]+)$/,a=0,o=e.length;a<o;a++){var s=e[a],l=s.name.match(i);if(l&&l.length>1){var u=l[1],c=r[u];c||(r[u]=c=[]),c.push(s)}}var h=[];for(var p in r)h.push(this.CreateFromMorphTargetSequence(p,r[p],t,n));return h}},{key:"parseAnimation",value:function(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var n=function(e,t,n,r,i){if(0!==n.length){var a=[],o=[];tv(n,a,o,r),0!==a.length&&i.push(new e(t,a,o))}},r=[],i=e.name||"default",a=e.fps||30,o=e.blendMode,s=e.length||-1,l=e.hierarchy||[],u=0;u<l.length;u++){var c=l[u].keys;if(c&&0!==c.length)if(c[0].morphTargets){var h={},p=void 0;for(p=0;p<c.length;p++)if(c[p].morphTargets)for(var d=0;d<c[p].morphTargets.length;d++)h[c[p].morphTargets[d]]=-1;for(var f in h){for(var m=[],v=[],g=0;g!==c[p].morphTargets.length;++g){var y=c[p];m.push(y.time),v.push(y.morphTarget===f?1:0)}r.push(new pv(".morphTargetInfluence["+f+"]",m,v))}s=h.length*a}else{var _=".bones["+t[u].name+"]";n(vv,_+".position",c,"pos",r),n(fv,_+".quaternion",c,"rot",r),n(vv,_+".scale",c,"scl",r)}}return 0===r.length?null:new this(i,s,r,o)}}]),e}();function yv(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return pv;case"vector":case"vector2":case"vector3":case"vector4":return vv;case"color":return hv;case"quaternion":return fv;case"bool":case"boolean":return cv;case"string":return mv}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}function _v(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var t=yv(e.type);if(void 0===e.times){var n=[],r=[];tv(e.keys,n,r,"value"),e.times=n,e.values=r}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}var xv=exports.Cache={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}},Mv=exports.LoadingManager=P(function e(t,n,r){k(this,e);var i=this,a=!1,o=0,s=0,l=void 0,u=[];this.onStart=void 0,this.onLoad=t,this.onProgress=n,this.onError=r,this.itemStart=function(e){s++,!1===a&&void 0!==i.onStart&&i.onStart(e,o,s),a=!0},this.itemEnd=function(e){o++,void 0!==i.onProgress&&i.onProgress(e,o,s),o===s&&(a=!1,void 0!==i.onLoad&&i.onLoad())},this.itemError=function(e){void 0!==i.onError&&i.onError(e)},this.resolveURL=function(e){return l?l(e):e},this.setURLModifier=function(e){return l=e,this},this.addHandler=function(e,t){return u.push(e,t),this},this.removeHandler=function(e){var t=u.indexOf(e);return-1!==t&&u.splice(t,2),this},this.getHandler=function(e){for(var t=0,n=u.length;t<n;t+=2){var r=u[t],i=u[t+1];if(r.global&&(r.lastIndex=0),r.test(e))return i}return null}}),Sv=exports.DefaultLoadingManager=new Mv,bv=exports.Loader=function(){function e(t){k(this,e),this.manager=void 0!==t?t:Sv,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}return P(e,[{key:"load",value:function(){}},{key:"loadAsync",value:function(e,t){var n=this;return new Promise(function(r,i){n.load(e,r,t,i)})}},{key:"parse",value:function(){}},{key:"setCrossOrigin",value:function(e){return this.crossOrigin=e,this}},{key:"setWithCredentials",value:function(e){return this.withCredentials=e,this}},{key:"setPath",value:function(e){return this.path=e,this}},{key:"setResourcePath",value:function(e){return this.resourcePath=e,this}},{key:"setRequestHeader",value:function(e){return this.requestHeader=e,this}}]),e}();bv.DEFAULT_MATERIAL_NAME="__DEFAULT";var Tv,Ev={},wv=function(e){x(r,n(Error));var t=S(r);function r(e,n){var i;return k(this,r),(i=t.call(this,e)).response=n,i}return P(r)}(),Av=exports.FileLoader=function(e){x(n,bv);var t=S(n);function n(e){return k(this,n),t.call(this,e)}return P(n,[{key:"load",value:function(e,t,n,r){var i=this;void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var a=xv.get(e);if(void 0!==a)return this.manager.itemStart(e),setTimeout(function(){t&&t(a),i.manager.itemEnd(e)},0),a;if(void 0===Ev[e]){Ev[e]=[],Ev[e].push({onLoad:t,onProgress:n,onError:r});var o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),s=this.mimeType,l=this.responseType;fetch(o).then(function(t){if(200===t.status||0===t.status){if(0===t.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),"undefined"==typeof ReadableStream||void 0===t.body||void 0===t.body.getReader)return t;var n=Ev[e],r=t.body.getReader(),i=t.headers.get("Content-Length")||t.headers.get("X-File-Size"),a=i?parseInt(i):0,o=0!==a,s=0,l=new ReadableStream({start:function(e){!function t(){r.read().then(function({done:r,value:i}){if(r)e.close();else{s+=i.byteLength;for(var l=new ProgressEvent("progress",{lengthComputable:o,loaded:s,total:a}),u=0,c=n.length;u<c;u++){var h=n[u];h.onProgress&&h.onProgress(l)}e.enqueue(i),t()}})}()}});return new Response(l)}throw new wv('fetch for "'.concat(t.url,'" responded with ').concat(t.status,": ").concat(t.statusText),t)}).then(function(e){switch(l){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"document":return e.text().then(function(e){return(new DOMParser).parseFromString(e,s)});case"json":return e.json();default:if(void 0===s)return e.text();var t=/charset="?([^;"\s]*)"?/i.exec(s),n=t&&t[1]?t[1].toLowerCase():void 0,r=new TextDecoder(n);return e.arrayBuffer().then(function(e){return r.decode(e)})}}).then(function(t){xv.add(e,t);var n=Ev[e];delete Ev[e];for(var r=0,i=n.length;r<i;r++){var a=n[r];a.onLoad&&a.onLoad(t)}}).catch(function(t){var n=Ev[e];if(void 0===n)throw i.manager.itemError(e),t;delete Ev[e];for(var r=0,a=n.length;r<a;r++){var o=n[r];o.onError&&o.onError(t)}i.manager.itemError(e)}).finally(function(){i.manager.itemEnd(e)}),this.manager.itemStart(e)}else Ev[e].push({onLoad:t,onProgress:n,onError:r})}},{key:"setResponseType",value:function(e){return this.responseType=e,this}},{key:"setMimeType",value:function(e){return this.mimeType=e,this}}]),n}(),Rv=exports.AnimationLoader=function(e){x(n,bv);var t=S(n);function n(e){return k(this,n),t.call(this,e)}return P(n,[{key:"load",value:function(e,t,n,r){var i=this,a=new Av(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(n){try{t(i.parse(JSON.parse(n)))}catch(a){r?r(a):console.error(a),i.manager.itemError(e)}},n,r)}},{key:"parse",value:function(e){for(var t=[],n=0;n<e.length;n++){var r=gv.parse(e[n]);t.push(r)}return t}}]),n}(),Cv=exports.CompressedTextureLoader=function(e){x(n,bv);var t=S(n);function n(e){return k(this,n),t.call(this,e)}return P(n,[{key:"load",value:function(e,t,n,r){var i=this,a=[],o=new Kd,s=new Av(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(i.withCredentials);var l=0;function u(u){s.load(e[u],function(e){var n=i.parse(e,!0);a[u]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},6===(l+=1)&&(1===n.mipmapCount&&(o.minFilter=Ze),o.image=a,o.format=n.format,o.needsUpdate=!0,t&&t(o))},n,r)}if(Array.isArray(e))for(var c=0,h=e.length;c<h;++c)u(c);else s.load(e,function(e){var n=i.parse(e,!0);if(n.isCubemap){for(var r=n.mipmaps.length/n.mipmapCount,s=0;s<r;s++){a[s]={mipmaps:[]};for(var l=0;l<n.mipmapCount;l++)a[s].mipmaps.push(n.mipmaps[s*n.mipmapCount+l]),a[s].format=n.format,a[s].width=n.width,a[s].height=n.height}o.image=a}else o.image.width=n.width,o.image.height=n.height,o.mipmaps=n.mipmaps;1===n.mipmapCount&&(o.minFilter=Ze),o.format=n.format,o.needsUpdate=!0,t&&t(o)},n,r);return o}}]),n}(),kv=exports.ImageLoader=function(e){x(n,bv);var t=S(n);function n(e){return k(this,n),t.call(this,e)}return P(n,[{key:"load",value:function(e,t,n,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,a=xv.get(e);if(void 0!==a)return i.manager.itemStart(e),setTimeout(function(){t&&t(a),i.manager.itemEnd(e)},0),a;var o=Yr("img");function s(){u(),xv.add(e,this),t&&t(this),i.manager.itemEnd(e)}function l(t){u(),r&&r(t),i.manager.itemError(e),i.manager.itemEnd(e)}function u(){o.removeEventListener("load",s,!1),o.removeEventListener("error",l,!1)}return o.addEventListener("load",s,!1),o.addEventListener("error",l,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),i.manager.itemStart(e),o.src=e,o}}]),n}(),Lv=exports.CubeTextureLoader=function(e){x(n,bv);var t=S(n);function n(e){return k(this,n),t.call(this,e)}return P(n,[{key:"load",value:function(e,t,n,r){var i=new Ko;i.colorSpace=Sn;var a=new kv(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);var o=0;function s(n){a.load(e[n],function(e){i.images[n]=e,6===++o&&(i.needsUpdate=!0,t&&t(i))},void 0,r)}for(var l=0;l<e.length;++l)s(l);return i}}]),n}(),Pv=exports.DataTextureLoader=function(e){x(n,bv);var t=S(n);function n(e){return k(this,n),t.call(this,e)}return P(n,[{key:"load",value:function(e,t,n,r){var i=this,a=new yd,o=new Av(this.manager);return o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setPath(this.path),o.setWithCredentials(i.withCredentials),o.load(e,function(e){var n;try{n=i.parse(e)}catch(o){if(void 0===r)return void console.error(o);r(o)}void 0!==n.image?a.image=n.image:void 0!==n.data&&(a.image.width=n.width,a.image.height=n.height,a.image.data=n.data),a.wrapS=void 0!==n.wrapS?n.wrapS:He,a.wrapT=void 0!==n.wrapT?n.wrapT:He,a.magFilter=void 0!==n.magFilter?n.magFilter:Ze,a.minFilter=void 0!==n.minFilter?n.minFilter:Ze,a.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.colorSpace?a.colorSpace=n.colorSpace:void 0!==n.encoding&&(a.encoding=n.encoding),void 0!==n.flipY&&(a.flipY=n.flipY),void 0!==n.format&&(a.format=n.format),void 0!==n.type&&(a.type=n.type),void 0!==n.mipmaps&&(a.mipmaps=n.mipmaps,a.minFilter=Qe),1===n.mipmapCount&&(a.minFilter=Ze),void 0!==n.generateMipmaps&&(a.generateMipmaps=n.generateMipmaps),a.needsUpdate=!0,t&&t(a,n)},n,r),a}}]),n}(),Iv=exports.TextureLoader=function(e){x(n,bv);var t=S(n);function n(e){return k(this,n),t.call(this,e)}return P(n,[{key:"load",value:function(e,t,n,r){var i=new hi,a=new kv(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,function(e){i.image=e,i.needsUpdate=!0,void 0!==t&&t(i)},n,r),i}}]),n}(),Uv=exports.Light=function(e){x(n,Sa);var t=S(n);function n(e,r=1){var i;return k(this,n),(i=t.call(this)).isLight=!0,i.type="Light",i.color=new Ga(e),i.intensity=r,i}return P(n,[{key:"dispose",value:function(){}},{key:"copy",value:function(e,t){return p(w(n.prototype),"copy",this).call(this,e,t),this.color.copy(e.color),this.intensity=e.intensity,this}},{key:"toJSON",value:function(e){var t=p(w(n.prototype),"toJSON",this).call(this,e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}]),n}(),Dv=exports.HemisphereLight=function(e){x(n,Uv);var t=S(n);function n(e,r,i){var a;return k(this,n),(a=t.call(this,e,i)).isHemisphereLight=!0,a.type="HemisphereLight",a.position.copy(Sa.DEFAULT_UP),a.updateMatrix(),a.groundColor=new Ga(r),a}return P(n,[{key:"copy",value:function(e,t){return p(w(n.prototype),"copy",this).call(this,e,t),this.groundColor.copy(e.groundColor),this}}]),n}(),Nv=new Ki,Ov=new Mi,Fv=new Mi,Bv=function(){function e(t){k(this,e),this.camera=t,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Hr(512,512),this.map=null,this.mapPass=null,this.matrix=new Ki,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new as,this._frameExtents=new Hr(1,1),this._viewportCount=1,this._viewports=[new pi(0,0,1,1)]}return P(e,[{key:"getViewportCount",value:function(){return this._viewportCount}},{key:"getFrustum",value:function(){return this._frustum}},{key:"updateMatrices",value:function(e){var t=this.camera,n=this.matrix;Ov.setFromMatrixPosition(e.matrixWorld),t.position.copy(Ov),Fv.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(Fv),t.updateMatrixWorld(),Nv.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Nv),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(Nv)}},{key:"getViewport",value:function(e){return this._viewports[e]}},{key:"getFrameExtents",value:function(){return this._frameExtents}},{key:"dispose",value:function(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}},{key:"copy",value:function(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"toJSON",value:function(){var e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}]),e}(),zv=function(e){x(n,Bv);var t=S(n);function n(){var e;return k(this,n),(e=t.call(this,new qo(50,1,.5,500))).isSpotLightShadow=!0,e.focus=1,e}return P(n,[{key:"updateMatrices",value:function(e){var t=this.camera,r=2*yr*e.angle*this.focus,i=this.mapSize.width/this.mapSize.height,a=e.distance||t.far;r===t.fov&&i===t.aspect&&a===t.far||(t.fov=r,t.aspect=i,t.far=a,t.updateProjectionMatrix()),p(w(n.prototype),"updateMatrices",this).call(this,e)}},{key:"copy",value:function(e){return p(w(n.prototype),"copy",this).call(this,e),this.focus=e.focus,this}}]),n}(),Gv=exports.SpotLight=function(e){x(n,Uv);var t=S(n);function n(e,r,i=0,a=Math.PI/3,o=0,s=2){var l;return k(this,n),(l=t.call(this,e,r)).isSpotLight=!0,l.type="SpotLight",l.position.copy(Sa.DEFAULT_UP),l.updateMatrix(),l.target=new Sa,l.distance=i,l.angle=a,l.penumbra=o,l.decay=s,l.map=null,l.shadow=new zv,l}return P(n,[{key:"power",get:function(){return this.intensity*Math.PI},set:function(e){this.intensity=e/Math.PI}},{key:"dispose",value:function(){this.shadow.dispose()}},{key:"copy",value:function(e,t){return p(w(n.prototype),"copy",this).call(this,e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}]),n}(),Hv=new Ki,Vv=new Mi,Wv=new Mi,Xv=function(e){x(n,Bv);var t=S(n);function n(){var e;return k(this,n),(e=t.call(this,new qo(90,1,.5,500))).isPointLightShadow=!0,e._frameExtents=new Hr(4,2),e._viewportCount=6,e._viewports=[new pi(2,1,1,1),new pi(0,1,1,1),new pi(3,1,1,1),new pi(1,1,1,1),new pi(3,0,1,1),new pi(1,0,1,1)],e._cubeDirections=[new Mi(1,0,0),new Mi(-1,0,0),new Mi(0,0,1),new Mi(0,0,-1),new Mi(0,1,0),new Mi(0,-1,0)],e._cubeUps=[new Mi(0,1,0),new Mi(0,1,0),new Mi(0,1,0),new Mi(0,1,0),new Mi(0,0,1),new Mi(0,0,-1)],e}return P(n,[{key:"updateMatrices",value:function(e,t=0){var n=this.camera,r=this.matrix,i=e.distance||n.far;i!==n.far&&(n.far=i,n.updateProjectionMatrix()),Vv.setFromMatrixPosition(e.matrixWorld),n.position.copy(Vv),Wv.copy(n.position),Wv.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(Wv),n.updateMatrixWorld(),r.makeTranslation(-Vv.x,-Vv.y,-Vv.z),Hv.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Hv)}}]),n}(),jv=exports.PointLight=function(e){x(n,Uv);var t=S(n);function n(e,r,i=0,a=2){var o;return k(this,n),(o=t.call(this,e,r)).isPointLight=!0,o.type="PointLight",o.distance=i,o.decay=a,o.shadow=new Xv,o}return P(n,[{key:"power",get:function(){return 4*this.intensity*Math.PI},set:function(e){this.intensity=e/(4*Math.PI)}},{key:"dispose",value:function(){this.shadow.dispose()}},{key:"copy",value:function(e,t){return p(w(n.prototype),"copy",this).call(this,e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}]),n}(),qv=function(e){x(n,Bv);var t=S(n);function n(){var e;return k(this,n),(e=t.call(this,new Ju(-5,5,5,-5,.5,500))).isDirectionalLightShadow=!0,e}return P(n)}(),Yv=exports.DirectionalLight=function(e){x(n,Uv);var t=S(n);function n(e,r){var i;return k(this,n),(i=t.call(this,e,r)).isDirectionalLight=!0,i.type="DirectionalLight",i.position.copy(Sa.DEFAULT_UP),i.updateMatrix(),i.target=new Sa,i.shadow=new qv,i}return P(n,[{key:"dispose",value:function(){this.shadow.dispose()}},{key:"copy",value:function(e){return p(w(n.prototype),"copy",this).call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}]),n}(),Zv=exports.AmbientLight=function(e){x(n,Uv);var t=S(n);function n(e,r){var i;return k(this,n),(i=t.call(this,e,r)).isAmbientLight=!0,i.type="AmbientLight",i}return P(n)}(),Jv=exports.RectAreaLight=function(e){x(n,Uv);var t=S(n);function n(e,r,i=10,a=10){var o;return k(this,n),(o=t.call(this,e,r)).isRectAreaLight=!0,o.type="RectAreaLight",o.width=i,o.height=a,o}return P(n,[{key:"power",get:function(){return this.intensity*this.width*this.height*Math.PI},set:function(e){this.intensity=e/(this.width*this.height*Math.PI)}},{key:"copy",value:function(e){return p(w(n.prototype),"copy",this).call(this,e),this.width=e.width,this.height=e.height,this}},{key:"toJSON",value:function(e){var t=p(w(n.prototype),"toJSON",this).call(this,e);return t.object.width=this.width,t.object.height=this.height,t}}]),n}(),Kv=exports.SphericalHarmonics3=function(){function e(){k(this,e),this.isSphericalHarmonics3=!0,this.coefficients=[];for(var t=0;t<9;t++)this.coefficients.push(new Mi)}return P(e,[{key:"set",value:function(e){for(var t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}},{key:"zero",value:function(){for(var e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}},{key:"getAt",value:function(e,t){var n=e.x,r=e.y,i=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.282095),t.addScaledVector(a[1],.488603*r),t.addScaledVector(a[2],.488603*i),t.addScaledVector(a[3],.488603*n),t.addScaledVector(a[4],n*r*1.092548),t.addScaledVector(a[5],r*i*1.092548),t.addScaledVector(a[6],.315392*(3*i*i-1)),t.addScaledVector(a[7],n*i*1.092548),t.addScaledVector(a[8],.546274*(n*n-r*r)),t}},{key:"getIrradianceAt",value:function(e,t){var n=e.x,r=e.y,i=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.886227),t.addScaledVector(a[1],1.023328*r),t.addScaledVector(a[2],1.023328*i),t.addScaledVector(a[3],1.023328*n),t.addScaledVector(a[4],.858086*n*r),t.addScaledVector(a[5],.858086*r*i),t.addScaledVector(a[6],.743125*i*i-.247708),t.addScaledVector(a[7],.858086*n*i),t.addScaledVector(a[8],.429043*(n*n-r*r)),t}},{key:"add",value:function(e){for(var t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}},{key:"addScaledSH",value:function(e,t){for(var n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}},{key:"scale",value:function(e){for(var t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}},{key:"lerp",value:function(e,t){for(var n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}},{key:"equals",value:function(e){for(var t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}},{key:"copy",value:function(e){return this.set(e.coefficients)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"fromArray",value:function(e,t=0){for(var n=this.coefficients,r=0;r<9;r++)n[r].fromArray(e,t+3*r);return this}},{key:"toArray",value:function(e=[],t=0){for(var n=this.coefficients,r=0;r<9;r++)n[r].toArray(e,t+3*r);return e}}],[{key:"getBasisAt",value:function(e,t){var n=e.x,r=e.y,i=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*i,t[3]=.488603*n,t[4]=1.092548*n*r,t[5]=1.092548*r*i,t[6]=.315392*(3*i*i-1),t[7]=1.092548*n*i,t[8]=.546274*(n*n-r*r)}}]),e}(),Qv=exports.LightProbe=function(e){x(n,Uv);var t=S(n);function n(e=new Kv,r=1){var i;return k(this,n),(i=t.call(this,void 0,r)).isLightProbe=!0,i.sh=e,i}return P(n,[{key:"copy",value:function(e){return p(w(n.prototype),"copy",this).call(this,e),this.sh.copy(e.sh),this}},{key:"fromJSON",value:function(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}},{key:"toJSON",value:function(e){var t=p(w(n.prototype),"toJSON",this).call(this,e);return t.object.sh=this.sh.toArray(),t}}]),n}(),$v=exports.MaterialLoader=function(e){x(n,bv);var t=S(n);function n(e){var r;return k(this,n),(r=t.call(this,e)).textures={},r}return P(n,[{key:"load",value:function(e,t,n,r){var i=this,a=new Av(i.manager);a.setPath(i.path),a.setRequestHeader(i.requestHeader),a.setWithCredentials(i.withCredentials),a.load(e,function(n){try{t(i.parse(JSON.parse(n)))}catch(a){r?r(a):console.error(a),i.manager.itemError(e)}},n,r)}},{key:"parse",value:function(e){var t=this.textures;function r(e){return void 0===t[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e),t[e]}var i=n.createMaterialFromType(e.type);if(void 0!==e.uuid&&(i.uuid=e.uuid),void 0!==e.name&&(i.name=e.name),void 0!==e.color&&void 0!==i.color&&i.color.setHex(e.color),void 0!==e.roughness&&(i.roughness=e.roughness),void 0!==e.metalness&&(i.metalness=e.metalness),void 0!==e.sheen&&(i.sheen=e.sheen),void 0!==e.sheenColor&&(i.sheenColor=(new Ga).setHex(e.sheenColor)),void 0!==e.sheenRoughness&&(i.sheenRoughness=e.sheenRoughness),void 0!==e.emissive&&void 0!==i.emissive&&i.emissive.setHex(e.emissive),void 0!==e.specular&&void 0!==i.specular&&i.specular.setHex(e.specular),void 0!==e.specularIntensity&&(i.specularIntensity=e.specularIntensity),void 0!==e.specularColor&&void 0!==i.specularColor&&i.specularColor.setHex(e.specularColor),void 0!==e.shininess&&(i.shininess=e.shininess),void 0!==e.clearcoat&&(i.clearcoat=e.clearcoat),void 0!==e.clearcoatRoughness&&(i.clearcoatRoughness=e.clearcoatRoughness),void 0!==e.iridescence&&(i.iridescence=e.iridescence),void 0!==e.iridescenceIOR&&(i.iridescenceIOR=e.iridescenceIOR),void 0!==e.iridescenceThicknessRange&&(i.iridescenceThicknessRange=e.iridescenceThicknessRange),void 0!==e.transmission&&(i.transmission=e.transmission),void 0!==e.thickness&&(i.thickness=e.thickness),void 0!==e.attenuationDistance&&(i.attenuationDistance=e.attenuationDistance),void 0!==e.attenuationColor&&void 0!==i.attenuationColor&&i.attenuationColor.setHex(e.attenuationColor),void 0!==e.anisotropy&&(i.anisotropy=e.anisotropy),void 0!==e.anisotropyRotation&&(i.anisotropyRotation=e.anisotropyRotation),void 0!==e.fog&&(i.fog=e.fog),void 0!==e.flatShading&&(i.flatShading=e.flatShading),void 0!==e.blending&&(i.blending=e.blending),void 0!==e.combine&&(i.combine=e.combine),void 0!==e.side&&(i.side=e.side),void 0!==e.shadowSide&&(i.shadowSide=e.shadowSide),void 0!==e.opacity&&(i.opacity=e.opacity),void 0!==e.transparent&&(i.transparent=e.transparent),void 0!==e.alphaTest&&(i.alphaTest=e.alphaTest),void 0!==e.alphaHash&&(i.alphaHash=e.alphaHash),void 0!==e.depthTest&&(i.depthTest=e.depthTest),void 0!==e.depthWrite&&(i.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(i.colorWrite=e.colorWrite),void 0!==e.stencilWrite&&(i.stencilWrite=e.stencilWrite),void 0!==e.stencilWriteMask&&(i.stencilWriteMask=e.stencilWriteMask),void 0!==e.stencilFunc&&(i.stencilFunc=e.stencilFunc),void 0!==e.stencilRef&&(i.stencilRef=e.stencilRef),void 0!==e.stencilFuncMask&&(i.stencilFuncMask=e.stencilFuncMask),void 0!==e.stencilFail&&(i.stencilFail=e.stencilFail),void 0!==e.stencilZFail&&(i.stencilZFail=e.stencilZFail),void 0!==e.stencilZPass&&(i.stencilZPass=e.stencilZPass),void 0!==e.wireframe&&(i.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(i.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(i.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(i.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(i.rotation=e.rotation),void 0!==e.linewidth&&(i.linewidth=e.linewidth),void 0!==e.dashSize&&(i.dashSize=e.dashSize),void 0!==e.gapSize&&(i.gapSize=e.gapSize),void 0!==e.scale&&(i.scale=e.scale),void 0!==e.polygonOffset&&(i.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(i.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(i.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.dithering&&(i.dithering=e.dithering),void 0!==e.alphaToCoverage&&(i.alphaToCoverage=e.alphaToCoverage),void 0!==e.premultipliedAlpha&&(i.premultipliedAlpha=e.premultipliedAlpha),void 0!==e.forceSinglePass&&(i.forceSinglePass=e.forceSinglePass),void 0!==e.visible&&(i.visible=e.visible),void 0!==e.toneMapped&&(i.toneMapped=e.toneMapped),void 0!==e.userData&&(i.userData=e.userData),void 0!==e.vertexColors&&("number"==typeof e.vertexColors?i.vertexColors=e.vertexColors>0:i.vertexColors=e.vertexColors),void 0!==e.uniforms)for(var a in e.uniforms){var o=e.uniforms[a];switch(i.uniforms[a]={},o.type){case"t":i.uniforms[a].value=r(o.value);break;case"c":i.uniforms[a].value=(new Ga).setHex(o.value);break;case"v2":i.uniforms[a].value=(new Hr).fromArray(o.value);break;case"v3":i.uniforms[a].value=(new Mi).fromArray(o.value);break;case"v4":i.uniforms[a].value=(new pi).fromArray(o.value);break;case"m3":i.uniforms[a].value=(new Vr).fromArray(o.value);break;case"m4":i.uniforms[a].value=(new Ki).fromArray(o.value);break;default:i.uniforms[a].value=o.value}}if(void 0!==e.defines&&(i.defines=e.defines),void 0!==e.vertexShader&&(i.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(i.fragmentShader=e.fragmentShader),void 0!==e.glslVersion&&(i.glslVersion=e.glslVersion),void 0!==e.extensions)for(var s in e.extensions)i.extensions[s]=e.extensions[s];if(void 0!==e.lights&&(i.lights=e.lights),void 0!==e.clipping&&(i.clipping=e.clipping),void 0!==e.size&&(i.size=e.size),void 0!==e.sizeAttenuation&&(i.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(i.map=r(e.map)),void 0!==e.matcap&&(i.matcap=r(e.matcap)),void 0!==e.alphaMap&&(i.alphaMap=r(e.alphaMap)),void 0!==e.bumpMap&&(i.bumpMap=r(e.bumpMap)),void 0!==e.bumpScale&&(i.bumpScale=e.bumpScale),void 0!==e.normalMap&&(i.normalMap=r(e.normalMap)),void 0!==e.normalMapType&&(i.normalMapType=e.normalMapType),void 0!==e.normalScale){var l=e.normalScale;!1===Array.isArray(l)&&(l=[l,l]),i.normalScale=(new Hr).fromArray(l)}return void 0!==e.displacementMap&&(i.displacementMap=r(e.displacementMap)),void 0!==e.displacementScale&&(i.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(i.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(i.roughnessMap=r(e.roughnessMap)),void 0!==e.metalnessMap&&(i.metalnessMap=r(e.metalnessMap)),void 0!==e.emissiveMap&&(i.emissiveMap=r(e.emissiveMap)),void 0!==e.emissiveIntensity&&(i.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(i.specularMap=r(e.specularMap)),void 0!==e.specularIntensityMap&&(i.specularIntensityMap=r(e.specularIntensityMap)),void 0!==e.specularColorMap&&(i.specularColorMap=r(e.specularColorMap)),void 0!==e.envMap&&(i.envMap=r(e.envMap)),void 0!==e.envMapIntensity&&(i.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(i.reflectivity=e.reflectivity),void 0!==e.refractionRatio&&(i.refractionRatio=e.refractionRatio),void 0!==e.lightMap&&(i.lightMap=r(e.lightMap)),void 0!==e.lightMapIntensity&&(i.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(i.aoMap=r(e.aoMap)),void 0!==e.aoMapIntensity&&(i.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(i.gradientMap=r(e.gradientMap)),void 0!==e.clearcoatMap&&(i.clearcoatMap=r(e.clearcoatMap)),void 0!==e.clearcoatRoughnessMap&&(i.clearcoatRoughnessMap=r(e.clearcoatRoughnessMap)),void 0!==e.clearcoatNormalMap&&(i.clearcoatNormalMap=r(e.clearcoatNormalMap)),void 0!==e.clearcoatNormalScale&&(i.clearcoatNormalScale=(new Hr).fromArray(e.clearcoatNormalScale)),void 0!==e.iridescenceMap&&(i.iridescenceMap=r(e.iridescenceMap)),void 0!==e.iridescenceThicknessMap&&(i.iridescenceThicknessMap=r(e.iridescenceThicknessMap)),void 0!==e.transmissionMap&&(i.transmissionMap=r(e.transmissionMap)),void 0!==e.thicknessMap&&(i.thicknessMap=r(e.thicknessMap)),void 0!==e.anisotropyMap&&(i.anisotropyMap=r(e.anisotropyMap)),void 0!==e.sheenColorMap&&(i.sheenColorMap=r(e.sheenColorMap)),void 0!==e.sheenRoughnessMap&&(i.sheenRoughnessMap=r(e.sheenRoughnessMap)),i}},{key:"setTextures",value:function(e){return this.textures=e,this}}],[{key:"createMaterialFromType",value:function(e){return new{ShadowMaterial:Gm,SpriteMaterial:Vp,RawShaderMaterial:Hm,ShaderMaterial:Xo,PointsMaterial:Hd,MeshPhysicalMaterial:Wm,MeshStandardMaterial:Vm,MeshPhongMaterial:Xm,MeshToonMaterial:jm,MeshNormalMaterial:qm,MeshLambertMaterial:Ym,MeshDepthMaterial:yp,MeshDistanceMaterial:_p,MeshBasicMaterial:Va,MeshMatcapMaterial:Zm,LineDashedMaterial:Jm,LineBasicMaterial:Ld,Material:Na}[e]}}]),n}(),eg=exports.LoaderUtils=function(){function e(){k(this,e)}return P(e,null,[{key:"decodeText",value:function(e){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(e);for(var t="",n=0,r=e.length;n<r;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch(i){return t}}},{key:"extractUrlBase",value:function(e){var t=e.lastIndexOf("/");return-1===t?"./":e.slice(0,t+1)}},{key:"resolveURL",value:function(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)?e:/^data:.*,.*$/i.test(e)?e:/^blob:.*$/i.test(e)?e:t+e)}}]),e}(),tg=exports.InstancedBufferGeometry=function(e){x(n,vo);var t=S(n);function n(){var e;return k(this,n),(e=t.call(this)).isInstancedBufferGeometry=!0,e.type="InstancedBufferGeometry",e.instanceCount=1/0,e}return P(n,[{key:"copy",value:function(e){return p(w(n.prototype),"copy",this).call(this,e),this.instanceCount=e.instanceCount,this}},{key:"toJSON",value:function(){var e=p(w(n.prototype),"toJSON",this).call(this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}]),n}(),ng=exports.BufferGeometryLoader=function(e){x(n,bv);var t=S(n);function n(e){return k(this,n),t.call(this,e)}return P(n,[{key:"load",value:function(e,t,n,r){var i=this,a=new Av(i.manager);a.setPath(i.path),a.setRequestHeader(i.requestHeader),a.setWithCredentials(i.withCredentials),a.load(e,function(n){try{t(i.parse(JSON.parse(n)))}catch(a){r?r(a):console.error(a),i.manager.itemError(e)}},n,r)}},{key:"parse",value:function(e){var t={},n={};function r(e,r){if(void 0!==t[r])return t[r];var i=e.interleavedBuffers[r],a=function(e,t){if(void 0!==n[t])return n[t];var r=e.arrayBuffers[t],i=new Uint32Array(r).buffer;return n[t]=i,i}(e,i.buffer),o=qr(i.type,a),s=new zp(o,i.stride);return s.uuid=i.uuid,t[r]=s,s}var i=e.isInstancedBufferGeometry?new tg:new vo,a=e.data.index;if(void 0!==a){var o=qr(a.type,a.array);i.setIndex(new Ka(o,1))}var s=e.data.attributes;for(var l in s){var u=s[l],c=void 0;if(u.isInterleavedBufferAttribute){var h=r(e.data,u.data);c=new Hp(h,u.itemSize,u.offset,u.normalized)}else{var p=qr(u.type,u.array);c=new(u.isInstancedBufferAttribute?Sd:Ka)(p,u.itemSize,u.normalized)}void 0!==u.name&&(c.name=u.name),void 0!==u.usage&&c.setUsage(u.usage),void 0!==u.updateRange&&(c.updateRange.offset=u.updateRange.offset,c.updateRange.count=u.updateRange.count),i.setAttribute(l,c)}var d=e.data.morphAttributes;if(d)for(var f in d){for(var m=d[f],v=[],g=0,y=m.length;g<y;g++){var _=m[g],x=void 0;if(_.isInterleavedBufferAttribute){var M=r(e.data,_.data);x=new Hp(M,_.itemSize,_.offset,_.normalized)}else{var S=qr(_.type,_.array);x=new Ka(S,_.itemSize,_.normalized)}void 0!==_.name&&(x.name=_.name),v.push(x)}i.morphAttributes[f]=v}e.data.morphTargetsRelative&&(i.morphTargetsRelative=!0);var b=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==b)for(var T=0,E=b.length;T!==E;++T){var w=b[T];i.addGroup(w.start,w.count,w.materialIndex)}var A=e.data.boundingSphere;if(void 0!==A){var R=new Mi;void 0!==A.center&&R.fromArray(A.center),i.boundingSphere=new Hi(R,A.radius)}return e.name&&(i.name=e.name),e.userData&&(i.userData=e.userData),i}}]),n}(),rg=exports.ObjectLoader=function(e){x(n,bv);var t=S(n);function n(e){return k(this,n),t.call(this,e)}return P(n,[{key:"load",value:function(e,t,n,r){var i=this,a=""===this.path?eg.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||a;var o=new Av(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(n){var a=null;try{a=JSON.parse(n)}catch(s){return void 0!==r&&r(s),void console.error("THREE:ObjectLoader: Can't parse "+e+".",s.message)}var o=a.metadata;if(void 0===o||void 0===o.type||"geometry"===o.type.toLowerCase())return void 0!==r&&r(new Error("THREE.ObjectLoader: Can't load "+e)),void console.error("THREE.ObjectLoader: Can't load "+e);i.parse(a,t)},n,r)}},{key:"loadAsync",value:function(){var e=o(R().mark(function e(t,n){var r,i,a,o,s,l;return R().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=this,i=""===this.path?eg.extractUrlBase(t):this.path,this.resourcePath=this.resourcePath||i,(a=new Av(this.manager)).setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),e.next=9,a.loadAsync(t,n);case 9:if(o=e.sent,s=JSON.parse(o),void 0!==(l=s.metadata)&&void 0!==l.type&&"geometry"!==l.type.toLowerCase()){e.next=14;break}throw new Error("THREE.ObjectLoader: Can't load "+t);case 14:return e.next=16,r.parseAsync(s);case 16:return e.abrupt("return",e.sent);case 17:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"parse",value:function(e,t){var n=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),i=this.parseGeometries(e.geometries,r),a=this.parseImages(e.images,function(){void 0!==t&&t(l)}),o=this.parseTextures(e.textures,a),s=this.parseMaterials(e.materials,o),l=this.parseObject(e.object,i,s,o,n),u=this.parseSkeletons(e.skeletons,l);if(this.bindSkeletons(l,u),void 0!==t){var c=!1;for(var h in a)if(a[h].data instanceof HTMLImageElement){c=!0;break}!1===c&&t(l)}return l}},{key:"parseAsync",value:function(){var e=o(R().mark(function e(t){var n,r,i,a,o,s,l,u;return R().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.parseAnimations(t.animations),r=this.parseShapes(t.shapes),i=this.parseGeometries(t.geometries,r),e.next=5,this.parseImagesAsync(t.images);case 5:return a=e.sent,o=this.parseTextures(t.textures,a),s=this.parseMaterials(t.materials,o),l=this.parseObject(t.object,i,s,o,n),u=this.parseSkeletons(t.skeletons,l),this.bindSkeletons(l,u),e.abrupt("return",l);case 12:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"parseShapes",value:function(e){var t={};if(void 0!==e)for(var n=0,r=e.length;n<r;n++){var i=(new Vf).fromJSON(e[n]);t[i.uuid]=i}return t}},{key:"parseSkeletons",value:function(e,t){var n={},r={};if(t.traverse(function(e){e.isBone&&(r[e.uuid]=e)}),void 0!==e)for(var i=0,a=e.length;i<a;i++){var o=(new Md).fromJSON(e[i],r);n[o.uuid]=o}return n}},{key:"parseGeometries",value:function(e,t){var n={};if(void 0!==e)for(var r=new ng,i=0,a=e.length;i<a;i++){var o=void 0,s=e[i];switch(s.type){case"BufferGeometry":case"InstancedBufferGeometry":o=r.parse(s);break;default:s.type in zm?o=zm[s.type].fromJSON(s,t):console.warn('THREE.ObjectLoader: Unsupported geometry type "'.concat(s.type,'"'))}o.uuid=s.uuid,void 0!==s.name&&(o.name=s.name),void 0!==s.userData&&(o.userData=s.userData),n[s.uuid]=o}return n}},{key:"parseMaterials",value:function(e,t){var n={},r={};if(void 0!==e){var i=new $v;i.setTextures(t);for(var a=0,o=e.length;a<o;a++){var s=e[a];void 0===n[s.uuid]&&(n[s.uuid]=i.parse(s)),r[s.uuid]=n[s.uuid]}}return r}},{key:"parseAnimations",value:function(e){var t={};if(void 0!==e)for(var n=0;n<e.length;n++){var r=e[n],i=gv.parse(r);t[i.uuid]=i}return t}},{key:"parseImages",value:function(e,t){var n,r=this,i={};function a(e){if("string"==typeof e){var t=e;return function(e){return r.manager.itemStart(e),n.load(e,function(){r.manager.itemEnd(e)},void 0,function(){r.manager.itemError(e),r.manager.itemEnd(e)})}(/^(\/\/)|([a-z]+:(\/\/)?)/i.test(t)?t:r.resourcePath+t)}return e.data?{data:qr(e.type,e.data),width:e.width,height:e.height}:null}if(void 0!==e&&e.length>0){var o=new Mv(t);(n=new kv(o)).setCrossOrigin(this.crossOrigin);for(var s=0,l=e.length;s<l;s++){var u=e[s],c=u.url;if(Array.isArray(c)){for(var h=[],p=0,d=c.length;p<d;p++){var f=a(c[p]);null!==f&&(f instanceof HTMLImageElement?h.push(f):h.push(new yd(f.data,f.width,f.height)))}i[u.uuid]=new li(h)}else{var m=a(u.url);i[u.uuid]=new li(m)}}}return i}},{key:"parseImagesAsync",value:function(){var e=o(R().mark(function e(t){var n,r,i,a,s,l,u,c,h,p,d,f,m,v,g;return R().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s=function(){return(s=o(R().mark(function e(t){var r,a;return R().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t){e.next=8;break}return a=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(r=t)?r:n.resourcePath+r,e.next=5,i.loadAsync(a);case 5:return e.abrupt("return",e.sent);case 8:if(!t.data){e.next=12;break}return e.abrupt("return",{data:qr(t.type,t.data),width:t.width,height:t.height});case 12:return e.abrupt("return",null);case 13:case"end":return e.stop()}},e)}))).apply(this,arguments)},a=function(e){return s.apply(this,arguments)},n=this,r={},!(void 0!==t&&t.length>0)){e.next=33;break}(i=new kv(this.manager)).setCrossOrigin(this.crossOrigin),l=0,u=t.length;case 8:if(!(l<u)){e.next=33;break}if(c=t[l],h=c.url,!Array.isArray(h)){e.next=26;break}p=[],d=0,f=h.length;case 14:if(!(d<f)){e.next=23;break}return m=h[d],e.next=18,a(m);case 18:null!==(v=e.sent)&&(v instanceof HTMLImageElement?p.push(v):p.push(new yd(v.data,v.width,v.height)));case 20:d++,e.next=14;break;case 23:r[c.uuid]=new li(p),e.next=30;break;case 26:return e.next=28,a(c.url);case 28:g=e.sent,r[c.uuid]=new li(g);case 30:l++,e.next=8;break;case 33:return e.abrupt("return",r);case 34:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"parseTextures",value:function(e,t){function n(e,t){return"number"==typeof e?e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}var r={};if(void 0!==e)for(var i=0,a=e.length;i<a;i++){var o=e[i];void 0===o.image&&console.warn('THREE.ObjectLoader: No "image" specified for',o.uuid),void 0===t[o.image]&&console.warn("THREE.ObjectLoader: Undefined image",o.image);var s=t[o.image],l=s.data,u=void 0;Array.isArray(l)?(u=new Ko,6===l.length&&(u.needsUpdate=!0)):(u=l&&l.data?new yd:new hi,l&&(u.needsUpdate=!0)),u.source=s,u.uuid=o.uuid,void 0!==o.name&&(u.name=o.name),void 0!==o.mapping&&(u.mapping=n(o.mapping,ig)),void 0!==o.channel&&(u.channel=o.channel),void 0!==o.offset&&u.offset.fromArray(o.offset),void 0!==o.repeat&&u.repeat.fromArray(o.repeat),void 0!==o.center&&u.center.fromArray(o.center),void 0!==o.rotation&&(u.rotation=o.rotation),void 0!==o.wrap&&(u.wrapS=n(o.wrap[0],ag),u.wrapT=n(o.wrap[1],ag)),void 0!==o.format&&(u.format=o.format),void 0!==o.internalFormat&&(u.internalFormat=o.internalFormat),void 0!==o.type&&(u.type=o.type),void 0!==o.colorSpace&&(u.colorSpace=o.colorSpace),void 0!==o.encoding&&(u.encoding=o.encoding),void 0!==o.minFilter&&(u.minFilter=n(o.minFilter,og)),void 0!==o.magFilter&&(u.magFilter=n(o.magFilter,og)),void 0!==o.anisotropy&&(u.anisotropy=o.anisotropy),void 0!==o.flipY&&(u.flipY=o.flipY),void 0!==o.generateMipmaps&&(u.generateMipmaps=o.generateMipmaps),void 0!==o.premultiplyAlpha&&(u.premultiplyAlpha=o.premultiplyAlpha),void 0!==o.unpackAlignment&&(u.unpackAlignment=o.unpackAlignment),void 0!==o.compareFunction&&(u.compareFunction=o.compareFunction),void 0!==o.userData&&(u.userData=o.userData),r[o.uuid]=u}return r}},{key:"parseObject",value:function(e,t,n,r,i){var a,o,s;function l(e){return void 0===t[e]&&console.warn("THREE.ObjectLoader: Undefined geometry",e),t[e]}function u(e){if(void 0!==e){if(Array.isArray(e)){for(var t=[],r=0,i=e.length;r<i;r++){var a=e[r];void 0===n[a]&&console.warn("THREE.ObjectLoader: Undefined material",a),t.push(n[a])}return t}return void 0===n[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),n[e]}}function c(e){return void 0===r[e]&&console.warn("THREE.ObjectLoader: Undefined texture",e),r[e]}switch(e.type){case"Scene":a=new Bp,void 0!==e.background&&(Number.isInteger(e.background)?a.background=new Ga(e.background):a.background=c(e.background)),void 0!==e.environment&&(a.environment=c(e.environment)),void 0!==e.fog&&("Fog"===e.fog.type?a.fog=new Fp(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(a.fog=new Op(e.fog.color,e.fog.density)),""!==e.fog.name&&(a.fog.name=e.fog.name)),void 0!==e.backgroundBlurriness&&(a.backgroundBlurriness=e.backgroundBlurriness),void 0!==e.backgroundIntensity&&(a.backgroundIntensity=e.backgroundIntensity);break;case"PerspectiveCamera":a=new qo(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(a.focus=e.focus),void 0!==e.zoom&&(a.zoom=e.zoom),void 0!==e.filmGauge&&(a.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(a.filmOffset=e.filmOffset),void 0!==e.view&&(a.view=Object.assign({},e.view));break;case"OrthographicCamera":a=new Ju(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(a.zoom=e.zoom),void 0!==e.view&&(a.view=Object.assign({},e.view));break;case"AmbientLight":a=new Zv(e.color,e.intensity);break;case"DirectionalLight":a=new Yv(e.color,e.intensity);break;case"PointLight":a=new jv(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":a=new Jv(e.color,e.intensity,e.width,e.height);break;case"SpotLight":a=new Gv(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":a=new Dv(e.color,e.groundColor,e.intensity);break;case"LightProbe":a=(new Qv).fromJSON(e);break;case"SkinnedMesh":o=l(e.geometry),s=u(e.material),a=new vd(o,s),void 0!==e.bindMode&&(a.bindMode=e.bindMode),void 0!==e.bindMatrix&&a.bindMatrix.fromArray(e.bindMatrix),void 0!==e.skeleton&&(a.skeleton=e.skeleton);break;case"Mesh":o=l(e.geometry),s=u(e.material),a=new Uo(o,s);break;case"InstancedMesh":o=l(e.geometry),s=u(e.material);var h=e.count,p=e.instanceMatrix,d=e.instanceColor;(a=new kd(o,s,h)).instanceMatrix=new Sd(new Float32Array(p.array),16),void 0!==d&&(a.instanceColor=new Sd(new Float32Array(d.array),d.itemSize));break;case"LOD":a=new od;break;case"Line":a=new Od(l(e.geometry),u(e.material));break;case"LineLoop":a=new Gd(l(e.geometry),u(e.material));break;case"LineSegments":a=new zd(l(e.geometry),u(e.material));break;case"PointCloud":case"Points":a=new qd(l(e.geometry),u(e.material));break;case"Sprite":a=new nd(u(e.material));break;case"Group":a=new Ap;break;case"Bone":a=new gd;break;default:a=new Sa}if(a.uuid=e.uuid,void 0!==e.name&&(a.name=e.name),void 0!==e.matrix?(a.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(a.matrixAutoUpdate=e.matrixAutoUpdate),a.matrixAutoUpdate&&a.matrix.decompose(a.position,a.quaternion,a.scale)):(void 0!==e.position&&a.position.fromArray(e.position),void 0!==e.rotation&&a.rotation.fromArray(e.rotation),void 0!==e.quaternion&&a.quaternion.fromArray(e.quaternion),void 0!==e.scale&&a.scale.fromArray(e.scale)),void 0!==e.up&&a.up.fromArray(e.up),void 0!==e.castShadow&&(a.castShadow=e.castShadow),void 0!==e.receiveShadow&&(a.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(a.shadow.bias=e.shadow.bias),void 0!==e.shadow.normalBias&&(a.shadow.normalBias=e.shadow.normalBias),void 0!==e.shadow.radius&&(a.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&a.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(a.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(a.visible=e.visible),void 0!==e.frustumCulled&&(a.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(a.renderOrder=e.renderOrder),void 0!==e.userData&&(a.userData=e.userData),void 0!==e.layers&&(a.layers.mask=e.layers),void 0!==e.children)for(var f=e.children,m=0;m<f.length;m++)a.add(this.parseObject(f[m],t,n,r,i));if(void 0!==e.animations)for(var v=e.animations,g=0;g<v.length;g++){var y=v[g];a.animations.push(i[y])}if("LOD"===e.type){void 0!==e.autoUpdate&&(a.autoUpdate=e.autoUpdate);for(var _=e.levels,x=0;x<_.length;x++){var M=_[x],S=a.getObjectByProperty("uuid",M.object);void 0!==S&&a.addLevel(S,M.distance,M.hysteresis)}}return a}},{key:"bindSkeletons",value:function(e,t){0!==Object.keys(t).length&&e.traverse(function(e){if(!0===e.isSkinnedMesh&&void 0!==e.skeleton){var n=t[e.skeleton];void 0===n?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",e.skeleton):e.bind(n,e.bindMatrix)}})}}]),n}(),ig={UVMapping:De,CubeReflectionMapping:Ne,CubeRefractionMapping:Oe,EquirectangularReflectionMapping:Fe,EquirectangularRefractionMapping:Be,CubeUVReflectionMapping:ze},ag={RepeatWrapping:Ge,ClampToEdgeWrapping:He,MirroredRepeatWrapping:Ve},og={NearestFilter:We,NearestMipmapNearestFilter:Xe,NearestMipmapLinearFilter:qe,LinearFilter:Ze,LinearMipmapNearestFilter:Je,LinearMipmapLinearFilter:Qe},sg=exports.ImageBitmapLoader=function(e){x(n,bv);var t=S(n);function n(e){var r;return k(this,n),(r=t.call(this,e)).isImageBitmapLoader=!0,"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),r.options={premultiplyAlpha:"none"},r}return P(n,[{key:"setOptions",value:function(e){return this.options=e,this}},{key:"load",value:function(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,a=xv.get(e);if(void 0!==a)return i.manager.itemStart(e),setTimeout(function(){t&&t(a),i.manager.itemEnd(e)},0),a;var o={};o.credentials="anonymous"===this.crossOrigin?"same-origin":"include",o.headers=this.requestHeader,fetch(e,o).then(function(e){return e.blob()}).then(function(e){return createImageBitmap(e,Object.assign(i.options,{colorSpaceConversion:"none"}))}).then(function(n){xv.add(e,n),t&&t(n),i.manager.itemEnd(e)}).catch(function(t){r&&r(t),i.manager.itemError(e),i.manager.itemEnd(e)}),i.manager.itemStart(e)}}]),n}(),lg=exports.AudioContext=function(){function e(){k(this,e)}return P(e,null,[{key:"getContext",value:function(){return void 0===Tv&&(Tv=new(window.AudioContext||window.webkitAudioContext)),Tv}},{key:"setContext",value:function(e){Tv=e}}]),e}(),ug=exports.AudioLoader=function(e){x(n,bv);var t=S(n);function n(e){return k(this,n),t.call(this,e)}return P(n,[{key:"load",value:function(e,t,n,r){var i=this,a=new Av(this.manager);function o(t){r?r(t):console.error(t),i.manager.itemError(e)}a.setResponseType("arraybuffer"),a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(e){try{var n=e.slice(0);lg.getContext().decodeAudioData(n,function(e){t(e)},o)}catch(r){o(r)}},n,r)}}]),n}(),cg=new Ki,hg=new Ki,pg=new Ki,dg=exports.StereoCamera=function(){function e(){k(this,e),this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new qo,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new qo,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}return P(e,[{key:"update",value:function(e){var t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,pg.copy(e.projectionMatrix);var n,r,i=t.eyeSep/2,a=i*t.near/t.focus,o=t.near*Math.tan(gr*t.fov*.5)/t.zoom;hg.elements[12]=-i,cg.elements[12]=i,n=-o*t.aspect+a,r=o*t.aspect+a,pg.elements[0]=2*t.near/(r-n),pg.elements[8]=(r+n)/(r-n),this.cameraL.projectionMatrix.copy(pg),n=-o*t.aspect-a,r=o*t.aspect-a,pg.elements[0]=2*t.near/(r-n),pg.elements[8]=(r+n)/(r-n),this.cameraR.projectionMatrix.copy(pg)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(hg),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(cg)}}]),e}(),fg=exports.Clock=function(){function e(t=!0){k(this,e),this.autoStart=t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}return P(e,[{key:"start",value:function(){this.startTime=mg(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}},{key:"stop",value:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}},{key:"getElapsedTime",value:function(){return this.getDelta(),this.elapsedTime}},{key:"getDelta",value:function(){var e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var t=mg();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}]),e}();function mg(){return("undefined"==typeof performance?Date:performance).now()}var vg=new Mi,gg=new xi,yg=new Mi,_g=new Mi,xg=exports.AudioListener=function(e){x(n,Sa);var t=S(n);function n(){var e;return k(this,n),(e=t.call(this)).type="AudioListener",e.context=lg.getContext(),e.gain=e.context.createGain(),e.gain.connect(e.context.destination),e.filter=null,e.timeDelta=0,e._clock=new fg,e}return P(n,[{key:"getInput",value:function(){return this.gain}},{key:"removeFilter",value:function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}},{key:"getFilter",value:function(){return this.filter}},{key:"setFilter",value:function(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}},{key:"getMasterVolume",value:function(){return this.gain.gain.value}},{key:"setMasterVolume",value:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}},{key:"updateMatrixWorld",value:function(e){p(w(n.prototype),"updateMatrixWorld",this).call(this,e);var t=this.context.listener,r=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(vg,gg,yg),_g.set(0,0,-1).applyQuaternion(gg),t.positionX){var i=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(vg.x,i),t.positionY.linearRampToValueAtTime(vg.y,i),t.positionZ.linearRampToValueAtTime(vg.z,i),t.forwardX.linearRampToValueAtTime(_g.x,i),t.forwardY.linearRampToValueAtTime(_g.y,i),t.forwardZ.linearRampToValueAtTime(_g.z,i),t.upX.linearRampToValueAtTime(r.x,i),t.upY.linearRampToValueAtTime(r.y,i),t.upZ.linearRampToValueAtTime(r.z,i)}else t.setPosition(vg.x,vg.y,vg.z),t.setOrientation(_g.x,_g.y,_g.z,r.x,r.y,r.z)}}]),n}(),Mg=exports.Audio=function(e){x(n,Sa);var t=S(n);function n(e){var r;return k(this,n),(r=t.call(this)).type="Audio",r.listener=e,r.context=e.context,r.gain=r.context.createGain(),r.gain.connect(e.getInput()),r.autoplay=!1,r.buffer=null,r.detune=0,r.loop=!1,r.loopStart=0,r.loopEnd=0,r.offset=0,r.duration=void 0,r.playbackRate=1,r.isPlaying=!1,r.hasPlaybackControl=!0,r.source=null,r.sourceType="empty",r._startedAt=0,r._progress=0,r._connected=!1,r.filters=[],r}return P(n,[{key:"getOutput",value:function(){return this.gain}},{key:"setNodeSource",value:function(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}},{key:"setMediaElementSource",value:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}},{key:"setMediaStreamSource",value:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}},{key:"setBuffer",value:function(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}},{key:"play",value:function(e=0){if(!0!==this.isPlaying){if(!1!==this.hasPlaybackControl){this._startedAt=this.context.currentTime+e;var t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}else console.warn("THREE.Audio: Audio is already playing.")}},{key:"pause",value:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}},{key:"stop",value:function(){if(!1!==this.hasPlaybackControl)return this._progress=0,null!==this.source&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}},{key:"connect",value:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}},{key:"disconnect",value:function(){if(!1!==this._connected){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}},{key:"getFilters",value:function(){return this.filters}},{key:"setFilters",value:function(e){return e||(e=[]),!0===this._connected?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}},{key:"setDetune",value:function(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}},{key:"getDetune",value:function(){return this.detune}},{key:"getFilter",value:function(){return this.getFilters()[0]}},{key:"setFilter",value:function(e){return this.setFilters(e?[e]:[])}},{key:"setPlaybackRate",value:function(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}},{key:"getPlaybackRate",value:function(){return this.playbackRate}},{key:"onEnded",value:function(){this.isPlaying=!1}},{key:"getLoop",value:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}},{key:"setLoop",value:function(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}},{key:"setLoopStart",value:function(e){return this.loopStart=e,this}},{key:"setLoopEnd",value:function(e){return this.loopEnd=e,this}},{key:"getVolume",value:function(){return this.gain.gain.value}},{key:"setVolume",value:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}]),n}(),Sg=new Mi,bg=new xi,Tg=new Mi,Eg=new Mi,wg=exports.PositionalAudio=function(e){x(n,Mg);var t=S(n);function n(e){var r;return k(this,n),(r=t.call(this,e)).panner=r.context.createPanner(),r.panner.panningModel="HRTF",r.panner.connect(r.gain),r}return P(n,[{key:"connect",value:function(){p(w(n.prototype),"connect",this).call(this),this.panner.connect(this.gain)}},{key:"disconnect",value:function(){p(w(n.prototype),"disconnect",this).call(this),this.panner.disconnect(this.gain)}},{key:"getOutput",value:function(){return this.panner}},{key:"getRefDistance",value:function(){return this.panner.refDistance}},{key:"setRefDistance",value:function(e){return this.panner.refDistance=e,this}},{key:"getRolloffFactor",value:function(){return this.panner.rolloffFactor}},{key:"setRolloffFactor",value:function(e){return this.panner.rolloffFactor=e,this}},{key:"getDistanceModel",value:function(){return this.panner.distanceModel}},{key:"setDistanceModel",value:function(e){return this.panner.distanceModel=e,this}},{key:"getMaxDistance",value:function(){return this.panner.maxDistance}},{key:"setMaxDistance",value:function(e){return this.panner.maxDistance=e,this}},{key:"setDirectionalCone",value:function(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this}},{key:"updateMatrixWorld",value:function(e){if(p(w(n.prototype),"updateMatrixWorld",this).call(this,e),!0!==this.hasPlaybackControl||!1!==this.isPlaying){this.matrixWorld.decompose(Sg,bg,Tg),Eg.set(0,0,1).applyQuaternion(bg);var t=this.panner;if(t.positionX){var r=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(Sg.x,r),t.positionY.linearRampToValueAtTime(Sg.y,r),t.positionZ.linearRampToValueAtTime(Sg.z,r),t.orientationX.linearRampToValueAtTime(Eg.x,r),t.orientationY.linearRampToValueAtTime(Eg.y,r),t.orientationZ.linearRampToValueAtTime(Eg.z,r)}else t.setPosition(Sg.x,Sg.y,Sg.z),t.setOrientation(Eg.x,Eg.y,Eg.z)}}}]),n}(),Ag=exports.AudioAnalyser=function(){function e(t,n=2048){k(this,e),this.analyser=t.context.createAnalyser(),this.analyser.fftSize=n,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}return P(e,[{key:"getFrequencyData",value:function(){return this.analyser.getByteFrequencyData(this.data),this.data}},{key:"getAverageFrequency",value:function(){for(var e=0,t=this.getFrequencyData(),n=0;n<t.length;n++)e+=t[n];return e/t.length}}]),e}(),Rg=exports.PropertyMixer=function(){function e(t,n,r){var i,a,o;switch(k(this,e),this.binding=t,this.valueSize=r,n){case"quaternion":i=this._slerp,a=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*r),this._workIndex=5;break;case"string":case"bool":i=this._select,a=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(5*r);break;default:i=this._lerp,a=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*r)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=a,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}return P(e,[{key:"accumulate",value:function(e,t){var n=this.buffer,r=this.valueSize,i=e*r+r,a=this.cumulativeWeight;if(0===a){for(var o=0;o!==r;++o)n[i+o]=n[o];a=t}else{var s=t/(a+=t);this._mixBufferRegion(n,i,0,s,r)}this.cumulativeWeight=a}},{key:"accumulateAdditive",value:function(e){var t=this.buffer,n=this.valueSize,r=n*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,n),this.cumulativeWeightAdditive+=e}},{key:"apply",value:function(e){var t=this.valueSize,n=this.buffer,r=e*t+t,i=this.cumulativeWeight,a=this.cumulativeWeightAdditive,o=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,i<1){var s=t*this._origIndex;this._mixBufferRegion(n,r,s,1-i,t)}a>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*t,1,t);for(var l=t,u=t+t;l!==u;++l)if(n[l]!==n[l+t]){o.setValue(n,r);break}}},{key:"saveOriginalState",value:function(){var e=this.binding,t=this.buffer,n=this.valueSize,r=n*this._origIndex;e.getValue(t,r);for(var i=n,a=r;i!==a;++i)t[i]=t[r+i%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}},{key:"restoreOriginalState",value:function(){var e=3*this.valueSize;this.binding.setValue(this.buffer,e)}},{key:"_setAdditiveIdentityNumeric",value:function(){for(var e=this._addIndex*this.valueSize,t=e+this.valueSize,n=e;n<t;n++)this.buffer[n]=0}},{key:"_setAdditiveIdentityQuaternion",value:function(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}},{key:"_setAdditiveIdentityOther",value:function(){for(var e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize,n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}},{key:"_select",value:function(e,t,n,r,i){if(r>=.5)for(var a=0;a!==i;++a)e[t+a]=e[n+a]}},{key:"_slerp",value:function(e,t,n,r){xi.slerpFlat(e,t,e,t,e,n,r)}},{key:"_slerpAdditive",value:function(e,t,n,r,i){var a=this._workIndex*i;xi.multiplyQuaternionsFlat(e,a,e,t,e,n),xi.slerpFlat(e,t,e,t,e,a,r)}},{key:"_lerp",value:function(e,t,n,r,i){for(var a=1-r,o=0;o!==i;++o){var s=t+o;e[s]=e[s]*a+e[n+o]*r}}},{key:"_lerpAdditive",value:function(e,t,n,r,i){for(var a=0;a!==i;++a){var o=t+a;e[o]=e[o]+e[n+a]*r}}}]),e}(),Cg="\\[\\]\\.:\\/",kg=new RegExp("["+Cg+"]","g"),Lg="[^"+Cg+"]",Pg="[^"+Cg.replace("\\.","")+"]",Ig=/((?:WC+[\/:])*)/.source.replace("WC",Lg),Ug=/(WCOD+)?/.source.replace("WCOD",Pg),Dg=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Lg),Ng=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Lg),Og=new RegExp("^"+Ig+Ug+Dg+Ng+"$"),Fg=["material","materials","bones","map"],Bg=function(){function e(t,n,r){k(this,e);var i=r||zg.parseTrackName(n);this._targetGroup=t,this._bindings=t.subscribe_(n,i)}return P(e,[{key:"getValue",value:function(e,t){this.bind();var n=this._targetGroup.nCachedObjects_,r=this._bindings[n];void 0!==r&&r.getValue(e,t)}},{key:"setValue",value:function(e,t){for(var n=this._bindings,r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(e,t)}},{key:"bind",value:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}},{key:"unbind",value:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}]),e}(),zg=exports.PropertyBinding=function(){function e(t,n,r){k(this,e),this.path=n,this.parsedPath=r||e.parseTrackName(n),this.node=e.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}return P(e,[{key:"_getValue_unavailable",value:function(){}},{key:"_setValue_unavailable",value:function(){}},{key:"_getValue_direct",value:function(e,t){e[t]=this.targetObject[this.propertyName]}},{key:"_getValue_array",value:function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)e[t++]=n[r]}},{key:"_getValue_arrayElement",value:function(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}},{key:"_getValue_toArray",value:function(e,t){this.resolvedProperty.toArray(e,t)}},{key:"_setValue_direct",value:function(e,t){this.targetObject[this.propertyName]=e[t]}},{key:"_setValue_direct_setNeedsUpdate",value:function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}},{key:"_setValue_direct_setMatrixWorldNeedsUpdate",value:function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}},{key:"_setValue_array",value:function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++]}},{key:"_setValue_array_setNeedsUpdate",value:function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.needsUpdate=!0}},{key:"_setValue_array_setMatrixWorldNeedsUpdate",value:function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}},{key:"_setValue_arrayElement",value:function(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}},{key:"_setValue_arrayElement_setNeedsUpdate",value:function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}},{key:"_setValue_arrayElement_setMatrixWorldNeedsUpdate",value:function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}},{key:"_setValue_fromArray",value:function(e,t){this.resolvedProperty.fromArray(e,t)}},{key:"_setValue_fromArray_setNeedsUpdate",value:function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}},{key:"_setValue_fromArray_setMatrixWorldNeedsUpdate",value:function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}},{key:"_getValue_unbound",value:function(e,t){this.bind(),this.getValue(e,t)}},{key:"_setValue_unbound",value:function(e,t){this.bind(),this.setValue(e,t)}},{key:"bind",value:function(){var t=this.node,n=this.parsedPath,r=n.objectName,i=n.propertyName,a=n.propertyIndex;if(t||(t=e.findNode(this.rootNode,n.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,t){if(r){var o=n.objectIndex;switch(r){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(var s=0;s<t.length;s++)if(t[s].name===o){o=s;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);t=t.material.map;break;default:if(void 0===t[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[r]}if(void 0!==o){if(void 0===t[o])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[o]}}var l=t[i];if(void 0!==l){var u=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?u=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(u=this.Versioning.MatrixWorldNeedsUpdate);var c=this.BindingType.Direct;if(void 0!==a){if("morphTargetInfluences"===i){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[a]&&(a=t.morphTargetDictionary[a])}c=this.BindingType.ArrayElement,this.resolvedProperty=l,this.propertyIndex=a}else void 0!==l.fromArray&&void 0!==l.toArray?(c=this.BindingType.HasFromToArray,this.resolvedProperty=l):Array.isArray(l)?(c=this.BindingType.EntireArray,this.resolvedProperty=l):this.propertyName=i;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][u]}else{var h=n.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+h+"."+i+" but it wasn't found.",t)}}else console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".")}},{key:"unbind",value:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}],[{key:"create",value:function(t,n,r){return t&&t.isAnimationObjectGroup?new e.Composite(t,n,r):new e(t,n,r)}},{key:"sanitizeNodeName",value:function(e){return e.replace(/\s/g,"_").replace(kg,"")}},{key:"parseTrackName",value:function(e){var t=Og.exec(e);if(null===t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);var n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){var i=n.nodeName.substring(r+1);-1!==Fg.indexOf(i)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=i)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}},{key:"findNode",value:function(e,t){if(void 0===t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){var n=e.skeleton.getBoneByName(t);if(void 0!==n)return n}if(e.children){var r=function e(n){for(var r=0;r<n.length;r++){var i=n[r];if(i.name===t||i.uuid===t)return i;var a=e(i.children);if(a)return a}return null}(e.children);if(r)return r}return null}}]),e}();zg.Composite=Bg,zg.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},zg.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},zg.prototype.GetterByBindingType=[zg.prototype._getValue_direct,zg.prototype._getValue_array,zg.prototype._getValue_arrayElement,zg.prototype._getValue_toArray],zg.prototype.SetterByBindingTypeAndVersioning=[[zg.prototype._setValue_direct,zg.prototype._setValue_direct_setNeedsUpdate,zg.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[zg.prototype._setValue_array,zg.prototype._setValue_array_setNeedsUpdate,zg.prototype._setValue_array_setMatrixWorldNeedsUpdate],[zg.prototype._setValue_arrayElement,zg.prototype._setValue_arrayElement_setNeedsUpdate,zg.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[zg.prototype._setValue_fromArray,zg.prototype._setValue_fromArray_setNeedsUpdate,zg.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];var Gg=exports.AnimationObjectGroup=function(){function e(){k(this,e),this.isAnimationObjectGroup=!0,this.uuid=_r(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var t={};this._indicesByUUID=t;for(var n=0,r=arguments.length;n!==r;++n)t[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var i=this;this.stats={objects:{get total(){return i._objects.length},get inUse(){return this.total-i.nCachedObjects_}},get bindingsPerObject(){return i._bindings.length}}}return P(e,[{key:"add",value:function(){for(var e=this._objects,t=this._indicesByUUID,n=this._paths,r=this._parsedPaths,i=this._bindings,a=i.length,o=void 0,s=e.length,l=this.nCachedObjects_,u=0,c=arguments.length;u!==c;++u){var h=arguments[u],p=h.uuid,d=t[p];if(void 0===d){d=s++,t[p]=d,e.push(h);for(var f=0,m=a;f!==m;++f)i[f].push(new zg(h,n[f],r[f]))}else if(d<l){o=e[d];var v=--l,g=e[v];t[g.uuid]=d,e[d]=g,t[p]=v,e[v]=h;for(var y=0,_=a;y!==_;++y){var x=i[y],M=x[v],S=x[d];x[d]=M,void 0===S&&(S=new zg(h,n[y],r[y])),x[v]=S}}else e[d]!==o&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=l}},{key:"remove",value:function(){for(var e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length,i=this.nCachedObjects_,a=0,o=arguments.length;a!==o;++a){var s=arguments[a],l=s.uuid,u=t[l];if(void 0!==u&&u>=i){var c=i++,h=e[c];t[h.uuid]=u,e[u]=h,t[l]=c,e[c]=s;for(var p=0,d=r;p!==d;++p){var f=n[p],m=f[c],v=f[u];f[u]=m,f[c]=v}}}this.nCachedObjects_=i}},{key:"uncache",value:function(){for(var e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length,i=this.nCachedObjects_,a=e.length,o=0,s=arguments.length;o!==s;++o){var l=arguments[o].uuid,u=t[l];if(void 0!==u)if(delete t[l],u<i){var c=--i,h=e[c],p=--a,d=e[p];t[h.uuid]=u,e[u]=h,t[d.uuid]=c,e[c]=d,e.pop();for(var f=0,m=r;f!==m;++f){var v=n[f],g=v[c],y=v[p];v[u]=g,v[c]=y,v.pop()}}else{var _=--a,x=e[_];_>0&&(t[x.uuid]=u),e[u]=x,e.pop();for(var M=0,S=r;M!==S;++M){var b=n[M];b[u]=b[_],b.pop()}}}this.nCachedObjects_=i}},{key:"subscribe_",value:function(e,t){var n=this._bindingsIndicesByPath,r=n[e],i=this._bindings;if(void 0!==r)return i[r];var a=this._paths,o=this._parsedPaths,s=this._objects,l=s.length,u=this.nCachedObjects_,c=new Array(l);r=i.length,n[e]=r,a.push(e),o.push(t),i.push(c);for(var h=u,p=s.length;h!==p;++h){var d=s[h];c[h]=new zg(d,e,t)}return c}},{key:"unsubscribe_",value:function(e){var t=this._bindingsIndicesByPath,n=t[e];if(void 0!==n){var r=this._paths,i=this._parsedPaths,a=this._bindings,o=a.length-1,s=a[o];t[e[o]]=n,a[n]=s,a.pop(),i[n]=i[o],i.pop(),r[n]=r[o],r.pop()}}}]),e}(),Hg=exports.AnimationAction=function(){function e(t,n,r=null,i=n.blendMode){k(this,e),this._mixer=t,this._clip=n,this._localRoot=r,this.blendMode=i;for(var a=n.tracks,o=a.length,s=new Array(o),l={endingStart:sn,endingEnd:sn},u=0;u!==o;++u){var c=a[u].createInterpolant(null);s[u]=c,c.settings=l}this._interpolantSettings=l,this._interpolants=s,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=tn,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}return P(e,[{key:"play",value:function(){return this._mixer._activateAction(this),this}},{key:"stop",value:function(){return this._mixer._deactivateAction(this),this.reset()}},{key:"reset",value:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}},{key:"isRunning",value:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}},{key:"isScheduled",value:function(){return this._mixer._isActiveAction(this)}},{key:"startAt",value:function(e){return this._startTime=e,this}},{key:"setLoop",value:function(e,t){return this.loop=e,this.repetitions=t,this}},{key:"setEffectiveWeight",value:function(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}},{key:"getEffectiveWeight",value:function(){return this._effectiveWeight}},{key:"fadeIn",value:function(e){return this._scheduleFading(e,0,1)}},{key:"fadeOut",value:function(e){return this._scheduleFading(e,1,0)}},{key:"crossFadeFrom",value:function(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){var r=this._clip.duration,i=e._clip.duration,a=i/r,o=r/i;e.warp(1,a,t),this.warp(o,1,t)}return this}},{key:"crossFadeTo",value:function(e,t,n){return e.crossFadeFrom(this,t,n)}},{key:"stopFading",value:function(){var e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}},{key:"setEffectiveTimeScale",value:function(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}},{key:"getEffectiveTimeScale",value:function(){return this._effectiveTimeScale}},{key:"setDuration",value:function(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}},{key:"syncWith",value:function(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}},{key:"halt",value:function(e){return this.warp(this._effectiveTimeScale,0,e)}},{key:"warp",value:function(e,t,n){var r=this._mixer,i=r.time,a=this.timeScale,o=this._timeScaleInterpolant;null===o&&(o=r._lendControlInterpolant(),this._timeScaleInterpolant=o);var s=o.parameterPositions,l=o.sampleValues;return s[0]=i,s[1]=i+n,l[0]=e/a,l[1]=t/a,this}},{key:"stopWarping",value:function(){var e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}},{key:"getMixer",value:function(){return this._mixer}},{key:"getClip",value:function(){return this._clip}},{key:"getRoot",value:function(){return this._localRoot||this._mixer._root}},{key:"_update",value:function(e,t,n,r){if(this.enabled){var i=this._startTime;if(null!==i){var a=(e-i)*n;a<0||0===n?t=0:(this._startTime=null,t=n*a)}t*=this._updateTimeScale(e);var o=this._updateTime(t),s=this._updateWeight(e);if(s>0){var l=this._interpolants,u=this._propertyBindings;switch(this.blendMode){case hn:for(var c=0,h=l.length;c!==h;++c)l[c].evaluate(o),u[c].accumulateAdditive(s);break;case cn:default:for(var p=0,d=l.length;p!==d;++p)l[p].evaluate(o),u[p].accumulate(r,s)}}}else this._updateWeight(e)}},{key:"_updateWeight",value:function(e){var t=0;if(this.enabled){t=this.weight;var n=this._weightInterpolant;if(null!==n){var r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=t,t}},{key:"_updateTimeScale",value:function(e){var t=0;if(!this.paused){t=this.timeScale;var n=this._timeScaleInterpolant;if(null!==n)t*=n.evaluate(e)[0],e>n.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t)}return this._effectiveTimeScale=t,t}},{key:"_updateTime",value:function(e){var t=this._clip.duration,n=this.loop,r=this.time+e,i=this._loopCount,a=n===nn;if(0===e)return-1===i?r:a&&1==(1&i)?t-r:r;if(n===en){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else{if(!(r<0)){this.time=r;break e}r=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===i&&(e>=0?(i=0,this._setEndings(!0,0===this.repetitions,a)):this._setEndings(0===this.repetitions,!0,a)),r>=t||r<0){var o=Math.floor(r/t);r-=t*o,i+=Math.abs(o);var s=this.repetitions-i;if(s<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===s){var l=e<0;this._setEndings(l,!l,a)}else this._setEndings(!1,!1,a);this._loopCount=i,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}else this.time=r;if(a&&1==(1&i))return t-r}return r}},{key:"_setEndings",value:function(e,t,n){var r=this._interpolantSettings;n?(r.endingStart=ln,r.endingEnd=ln):(r.endingStart=e?this.zeroSlopeAtStart?ln:sn:un,r.endingEnd=t?this.zeroSlopeAtEnd?ln:sn:un)}},{key:"_scheduleFading",value:function(e,t,n){var r=this._mixer,i=r.time,a=this._weightInterpolant;null===a&&(a=r._lendControlInterpolant(),this._weightInterpolant=a);var o=a.parameterPositions,s=a.sampleValues;return o[0]=i,s[0]=t,o[1]=i+e,s[1]=n,this}}]),e}(),Vg=new Float32Array(1),Wg=exports.AnimationMixer=function(e){x(n,fr);var t=S(n);function n(e){var r;return k(this,n),(r=t.call(this))._root=e,r._initMemoryManager(),r._accuIndex=0,r.time=0,r.timeScale=1,r}return P(n,[{key:"_bindAction",value:function(e,t){var n=e._localRoot||this._root,r=e._clip.tracks,i=r.length,a=e._propertyBindings,o=e._interpolants,s=n.uuid,l=this._bindingsByRootAndName,u=l[s];void 0===u&&(u={},l[s]=u);for(var c=0;c!==i;++c){var h=r[c],p=h.name,d=u[p];if(void 0!==d)++d.referenceCount,a[c]=d;else{if(void 0!==(d=a[c])){null===d._cacheIndex&&(++d.referenceCount,this._addInactiveBinding(d,s,p));continue}var f=t&&t._propertyBindings[c].binding.parsedPath;++(d=new Rg(zg.create(n,p,f),h.ValueTypeName,h.getValueSize())).referenceCount,this._addInactiveBinding(d,s,p),a[c]=d}o[c].resultBuffer=d.buffer}}},{key:"_activateAction",value:function(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){var t=(e._localRoot||this._root).uuid,n=e._clip.uuid,r=this._actionsByClip[n];this._bindAction(e,r&&r.knownActions[0]),this._addInactiveAction(e,n,t)}for(var i=e._propertyBindings,a=0,o=i.length;a!==o;++a){var s=i[a];0==s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}},{key:"_deactivateAction",value:function(e){if(this._isActiveAction(e)){for(var t=e._propertyBindings,n=0,r=t.length;n!==r;++n){var i=t[n];0==--i.useCount&&(i.restoreOriginalState(),this._takeBackBinding(i))}this._takeBackAction(e)}}},{key:"_initMemoryManager",value:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}},{key:"_isActiveAction",value:function(e){var t=e._cacheIndex;return null!==t&&t<this._nActiveActions}},{key:"_addInactiveAction",value:function(e,t,n){var r=this._actions,i=this._actionsByClip,a=i[t];if(void 0===a)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,i[t]=a;else{var o=a.knownActions;e._byClipCacheIndex=o.length,o.push(e)}e._cacheIndex=r.length,r.push(e),a.actionByRoot[n]=e}},{key:"_removeInactiveAction",value:function(e){var t=this._actions,n=t[t.length-1],r=e._cacheIndex;n._cacheIndex=r,t[r]=n,t.pop(),e._cacheIndex=null;var i=e._clip.uuid,a=this._actionsByClip,o=a[i],s=o.knownActions,l=s[s.length-1],u=e._byClipCacheIndex;l._byClipCacheIndex=u,s[u]=l,s.pop(),e._byClipCacheIndex=null,delete o.actionByRoot[(e._localRoot||this._root).uuid],0===s.length&&delete a[i],this._removeInactiveBindingsForAction(e)}},{key:"_removeInactiveBindingsForAction",value:function(e){for(var t=e._propertyBindings,n=0,r=t.length;n!==r;++n){var i=t[n];0==--i.referenceCount&&this._removeInactiveBinding(i)}}},{key:"_lendAction",value:function(e){var t=this._actions,n=e._cacheIndex,r=this._nActiveActions++,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}},{key:"_takeBackAction",value:function(e){var t=this._actions,n=e._cacheIndex,r=--this._nActiveActions,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}},{key:"_addInactiveBinding",value:function(e,t,n){var r=this._bindingsByRootAndName,i=this._bindings,a=r[t];void 0===a&&(a={},r[t]=a),a[n]=e,e._cacheIndex=i.length,i.push(e)}},{key:"_removeInactiveBinding",value:function(e){var t=this._bindings,n=e.binding,r=n.rootNode.uuid,i=n.path,a=this._bindingsByRootAndName,o=a[r],s=t[t.length-1],l=e._cacheIndex;s._cacheIndex=l,t[l]=s,t.pop(),delete o[i],0===Object.keys(o).length&&delete a[r]}},{key:"_lendBinding",value:function(e){var t=this._bindings,n=e._cacheIndex,r=this._nActiveBindings++,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}},{key:"_takeBackBinding",value:function(e){var t=this._bindings,n=e._cacheIndex,r=--this._nActiveBindings,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}},{key:"_lendControlInterpolant",value:function(){var e=this._controlInterpolants,t=this._nActiveControlInterpolants++,n=e[t];return void 0===n&&((n=new sv(new Float32Array(2),new Float32Array(2),1,Vg)).__cacheIndex=t,e[t]=n),n}},{key:"_takeBackControlInterpolant",value:function(e){var t=this._controlInterpolants,n=e.__cacheIndex,r=--this._nActiveControlInterpolants,i=t[r];e.__cacheIndex=r,t[r]=e,i.__cacheIndex=n,t[n]=i}},{key:"clipAction",value:function(e,t,n){var r=t||this._root,i=r.uuid,a="string"==typeof e?gv.findByName(r,e):e,o=null!==a?a.uuid:e,s=this._actionsByClip[o],l=null;if(void 0===n&&(n=null!==a?a.blendMode:cn),void 0!==s){var u=s.actionByRoot[i];if(void 0!==u&&u.blendMode===n)return u;l=s.knownActions[0],null===a&&(a=l._clip)}if(null===a)return null;var c=new Hg(this,a,t,n);return this._bindAction(c,l),this._addInactiveAction(c,o,i),c}},{key:"existingAction",value:function(e,t){var n=t||this._root,r=n.uuid,i="string"==typeof e?gv.findByName(n,e):e,a=i?i.uuid:e,o=this._actionsByClip[a];return void 0!==o&&o.actionByRoot[r]||null}},{key:"stopAllAction",value:function(){for(var e=this._actions,t=this._nActiveActions-1;t>=0;--t)e[t].stop();return this}},{key:"update",value:function(e){e*=this.timeScale;for(var t=this._actions,n=this._nActiveActions,r=this.time+=e,i=Math.sign(e),a=this._accuIndex^=1,o=0;o!==n;++o){t[o]._update(r,e,i,a)}for(var s=this._bindings,l=this._nActiveBindings,u=0;u!==l;++u)s[u].apply(a);return this}},{key:"setTime",value:function(e){this.time=0;for(var t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}},{key:"getRoot",value:function(){return this._root}},{key:"uncacheClip",value:function(e){var t=this._actions,n=e.uuid,r=this._actionsByClip,i=r[n];if(void 0!==i){for(var a=i.knownActions,o=0,s=a.length;o!==s;++o){var l=a[o];this._deactivateAction(l);var u=l._cacheIndex,c=t[t.length-1];l._cacheIndex=null,l._byClipCacheIndex=null,c._cacheIndex=u,t[u]=c,t.pop(),this._removeInactiveBindingsForAction(l)}delete r[n]}}},{key:"uncacheRoot",value:function(e){var t=e.uuid,n=this._actionsByClip;for(var r in n){var i=n[r].actionByRoot[t];void 0!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}var a=this._bindingsByRootAndName[t];if(void 0!==a)for(var o in a){var s=a[o];s.restoreOriginalState(),this._removeInactiveBinding(s)}}},{key:"uncacheAction",value:function(e,t){var n=this.existingAction(e,t);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}]),n}(),Xg=exports.Uniform=function(){function e(t){k(this,e),this.value=t}return P(e,[{key:"clone",value:function(){return new e(void 0===this.value.clone?this.value:this.value.clone())}}]),e}(),jg=0,qg=exports.UniformsGroup=function(e){x(n,fr);var t=S(n);function n(){var e;return k(this,n),(e=t.call(this)).isUniformsGroup=!0,Object.defineProperty(T(e),"id",{value:jg++}),e.name="",e.usage=er,e.uniforms=[],e}return P(n,[{key:"add",value:function(e){return this.uniforms.push(e),this}},{key:"remove",value:function(e){var t=this.uniforms.indexOf(e);return-1!==t&&this.uniforms.splice(t,1),this}},{key:"setName",value:function(e){return this.name=e,this}},{key:"setUsage",value:function(e){return this.usage=e,this}},{key:"dispose",value:function(){return this.dispatchEvent({type:"dispose"}),this}},{key:"copy",value:function(e){this.name=e.name,this.usage=e.usage;var t=e.uniforms;this.uniforms.length=0;for(var n=0,r=t.length;n<r;n++)this.uniforms.push(t[n].clone());return this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),n}(),Yg=exports.InstancedInterleavedBuffer=function(e){x(n,zp);var t=S(n);function n(e,r,i=1){var a;return k(this,n),(a=t.call(this,e,r)).isInstancedInterleavedBuffer=!0,a.meshPerAttribute=i,a}return P(n,[{key:"copy",value:function(e){return p(w(n.prototype),"copy",this).call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}},{key:"clone",value:function(e){var t=p(w(n.prototype),"clone",this).call(this,e);return t.meshPerAttribute=this.meshPerAttribute,t}},{key:"toJSON",value:function(e){var t=p(w(n.prototype),"toJSON",this).call(this,e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}]),n}(),Zg=exports.GLBufferAttribute=function(){function e(t,n,r,i,a){k(this,e),this.isGLBufferAttribute=!0,this.name="",this.buffer=t,this.type=n,this.itemSize=r,this.elementSize=i,this.count=a,this.version=0}return P(e,[{key:"needsUpdate",set:function(e){!0===e&&this.version++}},{key:"setBuffer",value:function(e){return this.buffer=e,this}},{key:"setType",value:function(e,t){return this.type=e,this.elementSize=t,this}},{key:"setItemSize",value:function(e){return this.itemSize=e,this}},{key:"setCount",value:function(e){return this.count=e,this}}]),e}(),Jg=exports.Raycaster=function(){function e(t,n,r=0,i=1/0){k(this,e),this.ray=new Ji(t,n),this.near=r,this.far=i,this.camera=null,this.layers=new la,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}return P(e,[{key:"set",value:function(e,t){this.ray.set(e,t)}},{key:"setFromCamera",value:function(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}},{key:"intersectObject",value:function(e,t=!0,n=[]){return Qg(e,this,n,t),n.sort(Kg),n}},{key:"intersectObjects",value:function(e,t=!0,n=[]){for(var r=0,i=e.length;r<i;r++)Qg(e[r],this,n,t);return n.sort(Kg),n}}]),e}();function Kg(e,t){return e.distance-t.distance}function Qg(e,t,n,r){if(e.layers.test(t.layers)&&e.raycast(t,n),!0===r)for(var i=e.children,a=0,o=i.length;a<o;a++)Qg(i[a],t,n,!0)}var $g=exports.Spherical=function(){function e(t=1,n=0,r=0){return k(this,e),this.radius=t,this.phi=n,this.theta=r,this}return P(e,[{key:"set",value:function(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}},{key:"copy",value:function(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}},{key:"makeSafe",value:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}},{key:"setFromVector3",value:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}},{key:"setFromCartesianCoords",value:function(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(xr(t/this.radius,-1,1))),this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}(),ey=exports.Cylindrical=function(){function e(t=1,n=0,r=0){return k(this,e),this.radius=t,this.theta=n,this.y=r,this}return P(e,[{key:"set",value:function(e,t,n){return this.radius=e,this.theta=t,this.y=n,this}},{key:"copy",value:function(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}},{key:"setFromVector3",value:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}},{key:"setFromCartesianCoords",value:function(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}(),ty=new Hr,ny=exports.Box2=function(){function e(t=new Hr(1/0,1/0),n=new Hr(-1/0,-1/0)){k(this,e),this.isBox2=!0,this.min=t,this.max=n}return P(e,[{key:"set",value:function(e,t){return this.min.copy(e),this.max.copy(t),this}},{key:"setFromPoints",value:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}},{key:"setFromCenterAndSize",value:function(e,t){var n=ty.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.min.copy(e.min),this.max.copy(e.max),this}},{key:"makeEmpty",value:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}},{key:"isEmpty",value:function(){return this.max.x<this.min.x||this.max.y<this.min.y}},{key:"getCenter",value:function(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}},{key:"getSize",value:function(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}},{key:"expandByPoint",value:function(e){return this.min.min(e),this.max.max(e),this}},{key:"expandByVector",value:function(e){return this.min.sub(e),this.max.add(e),this}},{key:"expandByScalar",value:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this}},{key:"containsPoint",value:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}},{key:"containsBox",value:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}},{key:"getParameter",value:function(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}},{key:"intersectsBox",value:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}},{key:"clampPoint",value:function(e,t){return t.copy(e).clamp(this.min,this.max)}},{key:"distanceToPoint",value:function(e){return this.clampPoint(e,ty).distanceTo(e)}},{key:"intersect",value:function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}},{key:"union",value:function(e){return this.min.min(e.min),this.max.max(e.max),this}},{key:"translate",value:function(e){return this.min.add(e),this.max.add(e),this}},{key:"equals",value:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}]),e}(),ry=new Mi,iy=new Mi,ay=exports.Line3=function(){function e(t=new Mi,n=new Mi){k(this,e),this.start=t,this.end=n}return P(e,[{key:"set",value:function(e,t){return this.start.copy(e),this.end.copy(t),this}},{key:"copy",value:function(e){return this.start.copy(e.start),this.end.copy(e.end),this}},{key:"getCenter",value:function(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}},{key:"delta",value:function(e){return e.subVectors(this.end,this.start)}},{key:"distanceSq",value:function(){return this.start.distanceToSquared(this.end)}},{key:"distance",value:function(){return this.start.distanceTo(this.end)}},{key:"at",value:function(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}},{key:"closestPointToPointParameter",value:function(e,t){ry.subVectors(e,this.start),iy.subVectors(this.end,this.start);var n=iy.dot(iy),r=iy.dot(ry)/n;return t&&(r=xr(r,0,1)),r}},{key:"closestPointToPoint",value:function(e,t,n){var r=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(r).add(this.start)}},{key:"applyMatrix4",value:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}},{key:"equals",value:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}(),oy=new Mi,sy=exports.SpotLightHelper=function(e){x(n,Sa);var t=S(n);function n(e,r){var i;k(this,n),(i=t.call(this)).light=e,i.matrix=e.matrixWorld,i.matrixAutoUpdate=!1,i.color=r,i.type="SpotLightHelper";for(var a=new vo,o=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],s=0,l=1;s<32;s++,l++){var u=s/32*Math.PI*2,c=l/32*Math.PI*2;o.push(Math.cos(u),Math.sin(u),1,Math.cos(c),Math.sin(c),1)}a.setAttribute("position",new oo(o,3));var h=new Ld({fog:!1,toneMapped:!1});return i.cone=new zd(a,h),i.add(i.cone),i.update(),i}return P(n,[{key:"dispose",value:function(){this.cone.geometry.dispose(),this.cone.material.dispose()}},{key:"update",value:function(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);var e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),oy.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(oy),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}]),n}(),ly=new Mi,uy=new Ki,cy=new Ki,hy=exports.SkeletonHelper=function(e){x(n,zd);var t=S(n);function n(e){var r;k(this,n);for(var i=py(e),a=new vo,o=[],s=[],l=new Ga(0,0,1),u=new Ga(0,1,0),c=0;c<i.length;c++){var h=i[c];h.parent&&h.parent.isBone&&(o.push(0,0,0),o.push(0,0,0),s.push(l.r,l.g,l.b),s.push(u.r,u.g,u.b))}a.setAttribute("position",new oo(o,3)),a.setAttribute("color",new oo(s,3));var p=new Ld({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});return(r=t.call(this,a,p)).isSkeletonHelper=!0,r.type="SkeletonHelper",r.root=e,r.bones=i,r.matrix=e.matrixWorld,r.matrixAutoUpdate=!1,r}return P(n,[{key:"updateMatrixWorld",value:function(e){var t=this.bones,r=this.geometry,i=r.getAttribute("position");cy.copy(this.root.matrixWorld).invert();for(var a=0,o=0;a<t.length;a++){var s=t[a];s.parent&&s.parent.isBone&&(uy.multiplyMatrices(cy,s.matrixWorld),ly.setFromMatrixPosition(uy),i.setXYZ(o,ly.x,ly.y,ly.z),uy.multiplyMatrices(cy,s.parent.matrixWorld),ly.setFromMatrixPosition(uy),i.setXYZ(o+1,ly.x,ly.y,ly.z),o+=2)}r.getAttribute("position").needsUpdate=!0,p(w(n.prototype),"updateMatrixWorld",this).call(this,e)}},{key:"dispose",value:function(){this.geometry.dispose(),this.material.dispose()}}]),n}();function py(e){var t=[];!0===e.isBone&&t.push(e);for(var n=0;n<e.children.length;n++)t.push.apply(t,py(e.children[n]));return t}var dy=exports.PointLightHelper=function(e){x(n,Uo);var t=S(n);function n(e,r,i){var a;k(this,n);var o=new Im(r,4,2),s=new Va({wireframe:!0,fog:!1,toneMapped:!1});return(a=t.call(this,o,s)).light=e,a.color=i,a.type="PointLightHelper",a.matrix=a.light.matrixWorld,a.matrixAutoUpdate=!1,a.update(),a}return P(n,[{key:"dispose",value:function(){this.geometry.dispose(),this.material.dispose()}},{key:"update",value:function(){this.light.updateWorldMatrix(!0,!1),void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}]),n}(),fy=new Mi,my=new Ga,vy=new Ga,gy=exports.HemisphereLightHelper=function(e){x(n,Sa);var t=S(n);function n(e,r,i){var a;k(this,n),(a=t.call(this)).light=e,a.matrix=e.matrixWorld,a.matrixAutoUpdate=!1,a.color=i,a.type="HemisphereLightHelper";var o=new Cm(r);o.rotateY(.5*Math.PI),a.material=new Va({wireframe:!0,fog:!1,toneMapped:!1}),void 0===a.color&&(a.material.vertexColors=!0);var s=o.getAttribute("position"),l=new Float32Array(3*s.count);return o.setAttribute("color",new Ka(l,3)),a.add(new Uo(o,a.material)),a.update(),a}return P(n,[{key:"dispose",value:function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}},{key:"update",value:function(){var e=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var t=e.geometry.getAttribute("color");my.copy(this.light.color),vy.copy(this.light.groundColor);for(var n=0,r=t.count;n<r;n++){var i=n<r/2?my:vy;t.setXYZ(n,i.r,i.g,i.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(fy.setFromMatrixPosition(this.light.matrixWorld).negate())}}]),n}(),yy=exports.GridHelper=function(e){x(n,zd);var t=S(n);function n(e=10,r=10,i=4473924,a=8947848){var o;k(this,n),i=new Ga(i),a=new Ga(a);for(var s=r/2,l=e/r,u=e/2,c=[],h=[],p=0,d=0,f=-u;p<=r;p++,f+=l){c.push(-u,0,f,u,0,f),c.push(f,0,-u,f,0,u);var m=p===s?i:a;m.toArray(h,d),d+=3,m.toArray(h,d),d+=3,m.toArray(h,d),d+=3,m.toArray(h,d),d+=3}var v=new vo;v.setAttribute("position",new oo(c,3)),v.setAttribute("color",new oo(h,3));var g=new Ld({vertexColors:!0,toneMapped:!1});return(o=t.call(this,v,g)).type="GridHelper",o}return P(n,[{key:"dispose",value:function(){this.geometry.dispose(),this.material.dispose()}}]),n}(),_y=exports.PolarGridHelper=function(e){x(n,zd);var t=S(n);function n(e=10,r=16,i=8,a=64,o=4473924,s=8947848){var l;k(this,n),o=new Ga(o),s=new Ga(s);var u=[],c=[];if(r>1)for(var h=0;h<r;h++){var p=h/r*(2*Math.PI),d=Math.sin(p)*e,f=Math.cos(p)*e;u.push(0,0,0),u.push(d,0,f);var m=1&h?o:s;c.push(m.r,m.g,m.b),c.push(m.r,m.g,m.b)}for(var v=0;v<i;v++)for(var g=1&v?o:s,y=e-e/i*v,_=0;_<a;_++){var x=_/a*(2*Math.PI),M=Math.sin(x)*y,S=Math.cos(x)*y;u.push(M,0,S),c.push(g.r,g.g,g.b),x=(_+1)/a*(2*Math.PI),M=Math.sin(x)*y,S=Math.cos(x)*y,u.push(M,0,S),c.push(g.r,g.g,g.b)}var b=new vo;b.setAttribute("position",new oo(u,3)),b.setAttribute("color",new oo(c,3));var T=new Ld({vertexColors:!0,toneMapped:!1});return(l=t.call(this,b,T)).type="PolarGridHelper",l}return P(n,[{key:"dispose",value:function(){this.geometry.dispose(),this.material.dispose()}}]),n}(),xy=new Mi,My=new Mi,Sy=new Mi,by=exports.DirectionalLightHelper=function(e){x(n,Sa);var t=S(n);function n(e,r,i){var a;k(this,n),(a=t.call(this)).light=e,a.matrix=e.matrixWorld,a.matrixAutoUpdate=!1,a.color=i,a.type="DirectionalLightHelper",void 0===r&&(r=1);var o=new vo;o.setAttribute("position",new oo([-r,r,0,r,r,0,r,-r,0,-r,-r,0,-r,r,0],3));var s=new Ld({fog:!1,toneMapped:!1});return a.lightPlane=new Od(o,s),a.add(a.lightPlane),(o=new vo).setAttribute("position",new oo([0,0,0,0,0,1],3)),a.targetLine=new Od(o,s),a.add(a.targetLine),a.update(),a}return P(n,[{key:"dispose",value:function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}},{key:"update",value:function(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),xy.setFromMatrixPosition(this.light.matrixWorld),My.setFromMatrixPosition(this.light.target.matrixWorld),Sy.subVectors(My,xy),this.lightPlane.lookAt(My),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(My),this.targetLine.scale.z=Sy.length()}}]),n}(),Ty=new Mi,Ey=new jo,wy=exports.CameraHelper=function(e){x(n,zd);var t=S(n);function n(e){var r;k(this,n);var i=new vo,a=new Ld({color:16777215,vertexColors:!0,toneMapped:!1}),o=[],s=[],l={};function u(e,t){c(e),c(t)}function c(e){o.push(0,0,0),s.push(0,0,0),void 0===l[e]&&(l[e]=[]),l[e].push(o.length/3-1)}u("n1","n2"),u("n2","n4"),u("n4","n3"),u("n3","n1"),u("f1","f2"),u("f2","f4"),u("f4","f3"),u("f3","f1"),u("n1","f1"),u("n2","f2"),u("n3","f3"),u("n4","f4"),u("p","n1"),u("p","n2"),u("p","n3"),u("p","n4"),u("u1","u2"),u("u2","u3"),u("u3","u1"),u("c","t"),u("p","c"),u("cn1","cn2"),u("cn3","cn4"),u("cf1","cf2"),u("cf3","cf4"),i.setAttribute("position",new oo(o,3)),i.setAttribute("color",new oo(s,3)),(r=t.call(this,i,a)).type="CameraHelper",r.camera=e,r.camera.updateProjectionMatrix&&r.camera.updateProjectionMatrix(),r.matrix=e.matrixWorld,r.matrixAutoUpdate=!1,r.pointMap=l,r.update();var h=new Ga(16755200),p=new Ga(16711680),d=new Ga(43775),f=new Ga(16777215),m=new Ga(3355443);return r.setColors(h,p,d,f,m),r}return P(n,[{key:"setColors",value:function(e,t,n,r,i){var a=this.geometry.getAttribute("color");a.setXYZ(0,e.r,e.g,e.b),a.setXYZ(1,e.r,e.g,e.b),a.setXYZ(2,e.r,e.g,e.b),a.setXYZ(3,e.r,e.g,e.b),a.setXYZ(4,e.r,e.g,e.b),a.setXYZ(5,e.r,e.g,e.b),a.setXYZ(6,e.r,e.g,e.b),a.setXYZ(7,e.r,e.g,e.b),a.setXYZ(8,e.r,e.g,e.b),a.setXYZ(9,e.r,e.g,e.b),a.setXYZ(10,e.r,e.g,e.b),a.setXYZ(11,e.r,e.g,e.b),a.setXYZ(12,e.r,e.g,e.b),a.setXYZ(13,e.r,e.g,e.b),a.setXYZ(14,e.r,e.g,e.b),a.setXYZ(15,e.r,e.g,e.b),a.setXYZ(16,e.r,e.g,e.b),a.setXYZ(17,e.r,e.g,e.b),a.setXYZ(18,e.r,e.g,e.b),a.setXYZ(19,e.r,e.g,e.b),a.setXYZ(20,e.r,e.g,e.b),a.setXYZ(21,e.r,e.g,e.b),a.setXYZ(22,e.r,e.g,e.b),a.setXYZ(23,e.r,e.g,e.b),a.setXYZ(24,t.r,t.g,t.b),a.setXYZ(25,t.r,t.g,t.b),a.setXYZ(26,t.r,t.g,t.b),a.setXYZ(27,t.r,t.g,t.b),a.setXYZ(28,t.r,t.g,t.b),a.setXYZ(29,t.r,t.g,t.b),a.setXYZ(30,t.r,t.g,t.b),a.setXYZ(31,t.r,t.g,t.b),a.setXYZ(32,n.r,n.g,n.b),a.setXYZ(33,n.r,n.g,n.b),a.setXYZ(34,n.r,n.g,n.b),a.setXYZ(35,n.r,n.g,n.b),a.setXYZ(36,n.r,n.g,n.b),a.setXYZ(37,n.r,n.g,n.b),a.setXYZ(38,r.r,r.g,r.b),a.setXYZ(39,r.r,r.g,r.b),a.setXYZ(40,i.r,i.g,i.b),a.setXYZ(41,i.r,i.g,i.b),a.setXYZ(42,i.r,i.g,i.b),a.setXYZ(43,i.r,i.g,i.b),a.setXYZ(44,i.r,i.g,i.b),a.setXYZ(45,i.r,i.g,i.b),a.setXYZ(46,i.r,i.g,i.b),a.setXYZ(47,i.r,i.g,i.b),a.setXYZ(48,i.r,i.g,i.b),a.setXYZ(49,i.r,i.g,i.b),a.needsUpdate=!0}},{key:"update",value:function(){var e=this.geometry,t=this.pointMap;Ey.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Ay("c",t,e,Ey,0,0,-1),Ay("t",t,e,Ey,0,0,1),Ay("n1",t,e,Ey,-1,-1,-1),Ay("n2",t,e,Ey,1,-1,-1),Ay("n3",t,e,Ey,-1,1,-1),Ay("n4",t,e,Ey,1,1,-1),Ay("f1",t,e,Ey,-1,-1,1),Ay("f2",t,e,Ey,1,-1,1),Ay("f3",t,e,Ey,-1,1,1),Ay("f4",t,e,Ey,1,1,1),Ay("u1",t,e,Ey,.7,1.1,-1),Ay("u2",t,e,Ey,-.7,1.1,-1),Ay("u3",t,e,Ey,0,2,-1),Ay("cf1",t,e,Ey,-1,0,1),Ay("cf2",t,e,Ey,1,0,1),Ay("cf3",t,e,Ey,0,-1,1),Ay("cf4",t,e,Ey,0,1,1),Ay("cn1",t,e,Ey,-1,0,-1),Ay("cn2",t,e,Ey,1,0,-1),Ay("cn3",t,e,Ey,0,-1,-1),Ay("cn4",t,e,Ey,0,1,-1),e.getAttribute("position").needsUpdate=!0}},{key:"dispose",value:function(){this.geometry.dispose(),this.material.dispose()}}]),n}();function Ay(e,t,n,r,i,a,o){Ty.set(i,a,o).unproject(r);var s=t[e];if(void 0!==s)for(var l=n.getAttribute("position"),u=0,c=s.length;u<c;u++)l.setXYZ(s[u],Ty.x,Ty.y,Ty.z)}var Ry,Cy,ky=new Ti,Ly=exports.BoxHelper=function(e){x(n,zd);var t=S(n);function n(e,r=16776960){var i;k(this,n);var a=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),o=new Float32Array(24),s=new vo;return s.setIndex(new Ka(a,1)),s.setAttribute("position",new Ka(o,3)),(i=t.call(this,s,new Ld({color:r,toneMapped:!1}))).object=e,i.type="BoxHelper",i.matrixAutoUpdate=!1,i.update(),i}return P(n,[{key:"update",value:function(e){if(void 0!==e&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&ky.setFromObject(this.object),!ky.isEmpty()){var t=ky.min,n=ky.max,r=this.geometry.attributes.position,i=r.array;i[0]=n.x,i[1]=n.y,i[2]=n.z,i[3]=t.x,i[4]=n.y,i[5]=n.z,i[6]=t.x,i[7]=t.y,i[8]=n.z,i[9]=n.x,i[10]=t.y,i[11]=n.z,i[12]=n.x,i[13]=n.y,i[14]=t.z,i[15]=t.x,i[16]=n.y,i[17]=t.z,i[18]=t.x,i[19]=t.y,i[20]=t.z,i[21]=n.x,i[22]=t.y,i[23]=t.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}}},{key:"setFromObject",value:function(e){return this.object=e,this.update(),this}},{key:"copy",value:function(e,t){return p(w(n.prototype),"copy",this).call(this,e,t),this.object=e.object,this}},{key:"dispose",value:function(){this.geometry.dispose(),this.material.dispose()}}]),n}(),Py=exports.Box3Helper=function(e){x(n,zd);var t=S(n);function n(e,r=16776960){var i;k(this,n);var a=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),o=new vo;return o.setIndex(new Ka(a,1)),o.setAttribute("position",new oo([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),(i=t.call(this,o,new Ld({color:r,toneMapped:!1}))).box=e,i.type="Box3Helper",i.geometry.computeBoundingSphere(),i}return P(n,[{key:"updateMatrixWorld",value:function(e){var t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),p(w(n.prototype),"updateMatrixWorld",this).call(this,e))}},{key:"dispose",value:function(){this.geometry.dispose(),this.material.dispose()}}]),n}(),Iy=exports.PlaneHelper=function(e){x(n,Od);var t=S(n);function n(e,r=1,i=16776960){var a;k(this,n);var o=i,s=new vo;s.setAttribute("position",new oo([1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],3)),s.computeBoundingSphere(),(a=t.call(this,s,new Ld({color:o,toneMapped:!1}))).type="PlaneHelper",a.plane=e,a.size=r;var l=new vo;return l.setAttribute("position",new oo([1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],3)),l.computeBoundingSphere(),a.add(new Uo(l,new Va({color:o,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1}))),a}return P(n,[{key:"updateMatrixWorld",value:function(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),p(w(n.prototype),"updateMatrixWorld",this).call(this,e)}},{key:"dispose",value:function(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}]),n}(),Uy=new Mi,Dy=exports.ArrowHelper=function(e){x(n,Sa);var t=S(n);function n(e=new Mi(0,0,1),r=new Mi(0,0,0),i=1,a=16776960,o=.2*i,s=.2*o){var l;return k(this,n),(l=t.call(this)).type="ArrowHelper",void 0===Ry&&((Ry=new vo).setAttribute("position",new oo([0,0,0,0,1,0],3)),(Cy=new Uf(0,.5,1,5,1)).translate(0,-.5,0)),l.position.copy(r),l.line=new Od(Ry,new Ld({color:a,toneMapped:!1})),l.line.matrixAutoUpdate=!1,l.add(l.line),l.cone=new Uo(Cy,new Va({color:a,toneMapped:!1})),l.cone.matrixAutoUpdate=!1,l.add(l.cone),l.setDirection(e),l.setLength(i,o,s),l}return P(n,[{key:"setDirection",value:function(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{Uy.set(e.z,0,-e.x).normalize();var t=Math.acos(e.y);this.quaternion.setFromAxisAngle(Uy,t)}}},{key:"setLength",value:function(e,t=.2*e,n=.2*t){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()}},{key:"setColor",value:function(e){this.line.material.color.set(e),this.cone.material.color.set(e)}},{key:"copy",value:function(e){return p(w(n.prototype),"copy",this).call(this,e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}},{key:"dispose",value:function(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}]),n}(),Ny=exports.AxesHelper=function(e){x(n,zd);var t=S(n);function n(e=1){var r;k(this,n);var i=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],a=new vo;a.setAttribute("position",new oo(i,3)),a.setAttribute("color",new oo([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));var o=new Ld({vertexColors:!0,toneMapped:!1});return(r=t.call(this,a,o)).type="AxesHelper",r}return P(n,[{key:"setColors",value:function(e,t,n){var r=new Ga,i=this.geometry.attributes.color.array;return r.set(e),r.toArray(i,0),r.toArray(i,3),r.set(t),r.toArray(i,6),r.toArray(i,9),r.set(n),r.toArray(i,12),r.toArray(i,15),this.geometry.attributes.color.needsUpdate=!0,this}},{key:"dispose",value:function(){this.geometry.dispose(),this.material.dispose()}}]),n}(),Oy=exports.ShapePath=function(){function e(){k(this,e),this.type="ShapePath",this.color=new Ga,this.subPaths=[],this.currentPath=null}return P(e,[{key:"moveTo",value:function(e,t){return this.currentPath=new kf,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}},{key:"lineTo",value:function(e,t){return this.currentPath.lineTo(e,t),this}},{key:"quadraticCurveTo",value:function(e,t,n,r){return this.currentPath.quadraticCurveTo(e,t,n,r),this}},{key:"bezierCurveTo",value:function(e,t,n,r,i,a){return this.currentPath.bezierCurveTo(e,t,n,r,i,a),this}},{key:"splineThru",value:function(e){return this.currentPath.splineThru(e),this}},{key:"toShapes",value:function(e){function t(e,t){for(var n=t.length,r=!1,i=n-1,a=0;a<n;i=a++){var o=t[i],s=t[a],l=s.x-o.x,u=s.y-o.y;if(Math.abs(u)>Number.EPSILON){if(u<0&&(o=t[a],l=-l,s=t[i],u=-u),e.y<o.y||e.y>s.y)continue;if(e.y===o.y){if(e.x===o.x)return!0}else{var c=u*(e.x-o.x)-l*(e.y-o.y);if(0===c)return!0;if(c<0)continue;r=!r}}else{if(e.y!==o.y)continue;if(s.x<=e.x&&e.x<=o.x||o.x<=e.x&&e.x<=s.x)return!0}}return r}var n,r,i,a=Sm.isClockWise,o=this.subPaths;if(0===o.length)return[];var s=[];if(1===o.length)return r=o[0],(i=new Vf).curves=r.curves,s.push(i),s;var l=!a(o[0].getPoints());l=e?!l:l;var u,c,h=[],p=[],d=[],f=0;p[f]=void 0,d[f]=[];for(var m=0,v=o.length;m<v;m++)n=a(u=(r=o[m]).getPoints()),(n=e?!n:n)?(!l&&p[f]&&f++,p[f]={s:new Vf,p:u},p[f].s.curves=r.curves,l&&f++,d[f]=[]):d[f].push({h:r,p:u[0]});if(!p[0])return function(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n],a=new Vf;a.curves=i.curves,t.push(a)}return t}(o);if(p.length>1){for(var g=!1,y=0,_=0,x=p.length;_<x;_++)h[_]=[];for(var M=0,S=p.length;M<S;M++)for(var b=d[M],T=0;T<b.length;T++){for(var E=b[T],w=!0,A=0;A<p.length;A++)t(E.p,p[A].p)&&(M!==A&&y++,w?(w=!1,h[A].push(E)):g=!0);w&&h[M].push(E)}y>0&&!1===g&&(d=h)}for(var R=0,C=p.length;R<C;R++){i=p[R].s,s.push(i);for(var k=0,L=(c=d[R]).length;k<L;k++)i.holes.push(c[k].h)}return s}}]),e}();"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:D}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=D);
},{}],"x87H":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.OrbitControls=void 0;var e=require("three");function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,a(o.key),o)}}function o(e,t,o){return t&&n(e.prototype,t),o&&n(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e}function a(e){var n=r(e,"string");return"symbol"===t(n)?n:String(n)}function r(e,n){if("object"!==t(e)||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var a=o.call(e,n||"default");if("object"!==t(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}function l(e,t){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=m();return function(){var n,o=d(e);if(t){var a=d(this).constructor;n=Reflect.construct(o,arguments,a)}else n=o.apply(this,arguments);return u(this,n)}}function u(e,n){if(n&&("object"===t(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return p(e)}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var b={type:"change"},f={type:"start"},h={type:"end"},y=new e.Ray,g=new e.Plane,E=Math.cos(70*e.MathUtils.DEG2RAD),v=exports.OrbitControls=function(t){c(a,e.EventDispatcher);var n=s(a);function a(t,o){var r,c,l,s,u,m,d,v;i(this,a),(r=n.call(this)).object=t,r.domElement=o,r.domElement.style.touchAction="none",r.enabled=!0,r.target=new e.Vector3,r.minDistance=0,r.maxDistance=1/0,r.minZoom=0,r.maxZoom=1/0,r.minPolarAngle=0,r.maxPolarAngle=Math.PI,r.minAzimuthAngle=-1/0,r.maxAzimuthAngle=1/0,r.enableDamping=!1,r.dampingFactor=.05,r.enableZoom=!0,r.zoomSpeed=1,r.enableRotate=!0,r.rotateSpeed=1,r.enablePan=!0,r.panSpeed=1,r.screenSpacePanning=!0,r.keyPanSpeed=7,r.zoomToCursor=!1,r.autoRotate=!1,r.autoRotateSpeed=2,r.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},r.mouseButtons={LEFT:e.MOUSE.ROTATE,MIDDLE:e.MOUSE.DOLLY,RIGHT:e.MOUSE.PAN},r.touches={ONE:e.TOUCH.ROTATE,TWO:e.TOUCH.DOLLY_PAN},r.target0=r.target.clone(),r.position0=r.object.position.clone(),r.zoom0=r.object.zoom,r._domElementKeyEvents=null,r.getPolarAngle=function(){return w.phi},r.getAzimuthalAngle=function(){return w.theta},r.getDistance=function(){return this.object.position.distanceTo(this.target)},r.listenToKeyEvents=function(e){e.addEventListener("keydown",me),this._domElementKeyEvents=e},r.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",me),this._domElementKeyEvents=null},r.saveState=function(){O.target0.copy(O.target),O.position0.copy(O.object.position),O.zoom0=O.object.zoom},r.reset=function(){O.target.copy(O.target0),O.object.position.copy(O.position0),O.object.zoom=O.zoom0,O.object.updateProjectionMatrix(),O.dispatchEvent(b),O.update(),j=P.NONE},r.update=(c=new e.Vector3,l=(new e.Quaternion).setFromUnitVectors(t.up,new e.Vector3(0,1,0)),s=l.clone().invert(),u=new e.Vector3,m=new e.Quaternion,d=new e.Vector3,v=2*Math.PI,function(n=null){var o=O.object.position;c.copy(o).sub(O.target),c.applyQuaternion(l),w.setFromVector3(c),O.autoRotate&&j===P.NONE&&X(function(e){return null!==e?2*Math.PI/60*O.autoRotateSpeed*e:2*Math.PI/60/60*O.autoRotateSpeed}(n)),O.enableDamping?(w.theta+=A.theta*O.dampingFactor,w.phi+=A.phi*O.dampingFactor):(w.theta+=A.theta,w.phi+=A.phi);var a=O.minAzimuthAngle,r=O.maxAzimuthAngle;isFinite(a)&&isFinite(r)&&(a<-Math.PI?a+=v:a>Math.PI&&(a-=v),r<-Math.PI?r+=v:r>Math.PI&&(r-=v),w.theta=a<=r?Math.max(a,Math.min(r,w.theta)):w.theta>(a+r)/2?Math.max(a,w.theta):Math.min(r,w.theta)),w.phi=Math.max(O.minPolarAngle,Math.min(O.maxPolarAngle,w.phi)),w.makeSafe(),!0===O.enableDamping?O.target.addScaledVector(S,O.dampingFactor):O.target.add(S),O.zoomToCursor&&V||O.object.isOrthographicCamera?w.radius=$(w.radius):w.radius=$(w.radius*M),c.setFromSpherical(w),c.applyQuaternion(s),o.copy(O.target).add(c),O.object.lookAt(O.target),!0===O.enableDamping?(A.theta*=1-O.dampingFactor,A.phi*=1-O.dampingFactor,S.multiplyScalar(1-O.dampingFactor)):(A.set(0,0,0),S.set(0,0,0));var i=!1;if(O.zoomToCursor&&V){var p=null;if(O.object.isPerspectiveCamera){var f=c.length(),h=f-(p=$(f*M));O.object.position.addScaledVector(Y,h),O.object.updateMatrixWorld()}else if(O.object.isOrthographicCamera){var L=new e.Vector3(H.x,H.y,0);L.unproject(O.object),O.object.zoom=Math.max(O.minZoom,Math.min(O.maxZoom,O.object.zoom/M)),O.object.updateProjectionMatrix(),i=!0;var N=new e.Vector3(H.x,H.y,0);N.unproject(O.object),O.object.position.sub(N).add(L),O.object.updateMatrixWorld(),p=c.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),O.zoomToCursor=!1;null!==p&&(this.screenSpacePanning?O.target.set(0,0,-1).transformDirection(O.object.matrix).multiplyScalar(p).add(O.object.position):(y.origin.copy(O.object.position),y.direction.set(0,0,-1).transformDirection(O.object.matrix),Math.abs(O.object.up.dot(y.direction))<E?t.lookAt(O.target):(g.setFromNormalAndCoplanarPoint(O.object.up,O.target),y.intersectPlane(g,O.target))))}else O.object.isOrthographicCamera&&(O.object.zoom=Math.max(O.minZoom,Math.min(O.maxZoom,O.object.zoom/M)),O.object.updateProjectionMatrix(),i=!0);return M=1,V=!1,!!(i||u.distanceToSquared(O.object.position)>T||8*(1-m.dot(O.object.quaternion))>T||d.distanceToSquared(O.target)>0)&&(O.dispatchEvent(b),u.copy(O.object.position),m.copy(O.object.quaternion),d.copy(O.target),i=!1,!0)}),r.dispose=function(){O.domElement.removeEventListener("contextmenu",de),O.domElement.removeEventListener("pointerdown",le),O.domElement.removeEventListener("pointercancel",ue),O.domElement.removeEventListener("wheel",pe),O.domElement.removeEventListener("pointermove",se),O.domElement.removeEventListener("pointerup",ue),null!==O._domElementKeyEvents&&(O._domElementKeyEvents.removeEventListener("keydown",me),O._domElementKeyEvents=null)};var O=p(r),P={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},j=P.NONE,T=1e-6,w=new e.Spherical,A=new e.Spherical,M=1,S=new e.Vector3,L=new e.Vector2,N=new e.Vector2,R=new e.Vector2,x=new e.Vector2,C=new e.Vector2,k=new e.Vector2,_=new e.Vector2,D=new e.Vector2,I=new e.Vector2,Y=new e.Vector3,H=new e.Vector2,V=!1,z=[],U={};function K(){return Math.pow(.95,O.zoomSpeed)}function X(e){A.theta-=e}function F(e){A.phi-=e}var Z,B=(Z=new e.Vector3,function(e,t){Z.setFromMatrixColumn(t,0),Z.multiplyScalar(-e),S.add(Z)}),G=function(){var t=new e.Vector3;return function(e,n){!0===O.screenSpacePanning?t.setFromMatrixColumn(n,1):(t.setFromMatrixColumn(n,0),t.crossVectors(O.object.up,t)),t.multiplyScalar(e),S.add(t)}}(),W=function(){var t=new e.Vector3;return function(e,n){var o=O.domElement;if(O.object.isPerspectiveCamera){var a=O.object.position;t.copy(a).sub(O.target);var r=t.length();r*=Math.tan(O.object.fov/2*Math.PI/180),B(2*e*r/o.clientHeight,O.object.matrix),G(2*n*r/o.clientHeight,O.object.matrix)}else O.object.isOrthographicCamera?(B(e*(O.object.right-O.object.left)/O.object.zoom/o.clientWidth,O.object.matrix),G(n*(O.object.top-O.object.bottom)/O.object.zoom/o.clientHeight,O.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),O.enablePan=!1)}}();function q(e){O.object.isPerspectiveCamera||O.object.isOrthographicCamera?M/=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),O.enableZoom=!1)}function Q(e){O.object.isPerspectiveCamera||O.object.isOrthographicCamera?M*=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),O.enableZoom=!1)}function J(e){if(O.zoomToCursor){V=!0;var t=O.domElement.getBoundingClientRect(),n=e.clientX-t.left,o=e.clientY-t.top,a=t.width,r=t.height;H.x=n/a*2-1,H.y=-o/r*2+1,Y.set(H.x,H.y,1).unproject(O.object).sub(O.object.position).normalize()}}function $(e){return Math.max(O.minDistance,Math.min(O.maxDistance,e))}function ee(e){L.set(e.clientX,e.clientY)}function te(e){x.set(e.clientX,e.clientY)}function ne(){if(1===z.length)L.set(z[0].pageX,z[0].pageY);else{var e=.5*(z[0].pageX+z[1].pageX),t=.5*(z[0].pageY+z[1].pageY);L.set(e,t)}}function oe(){if(1===z.length)x.set(z[0].pageX,z[0].pageY);else{var e=.5*(z[0].pageX+z[1].pageX),t=.5*(z[0].pageY+z[1].pageY);x.set(e,t)}}function ae(){var e=z[0].pageX-z[1].pageX,t=z[0].pageY-z[1].pageY,n=Math.sqrt(e*e+t*t);_.set(0,n)}function re(e){if(1==z.length)N.set(e.pageX,e.pageY);else{var t=fe(e),n=.5*(e.pageX+t.x),o=.5*(e.pageY+t.y);N.set(n,o)}R.subVectors(N,L).multiplyScalar(O.rotateSpeed);var a=O.domElement;X(2*Math.PI*R.x/a.clientHeight),F(2*Math.PI*R.y/a.clientHeight),L.copy(N)}function ie(e){if(1===z.length)C.set(e.pageX,e.pageY);else{var t=fe(e),n=.5*(e.pageX+t.x),o=.5*(e.pageY+t.y);C.set(n,o)}k.subVectors(C,x).multiplyScalar(O.panSpeed),W(k.x,k.y),x.copy(C)}function ce(e){var t=fe(e),n=e.pageX-t.x,o=e.pageY-t.y,a=Math.sqrt(n*n+o*o);D.set(0,a),I.set(0,Math.pow(D.y/_.y,O.zoomSpeed)),q(I.y),_.copy(D)}function le(t){!1!==O.enabled&&(0===z.length&&(O.domElement.setPointerCapture(t.pointerId),O.domElement.addEventListener("pointermove",se),O.domElement.addEventListener("pointerup",ue)),function(e){z.push(e)}(t),"touch"===t.pointerType?function(t){switch(be(t),z.length){case 1:switch(O.touches.ONE){case e.TOUCH.ROTATE:if(!1===O.enableRotate)return;ne(),j=P.TOUCH_ROTATE;break;case e.TOUCH.PAN:if(!1===O.enablePan)return;oe(),j=P.TOUCH_PAN;break;default:j=P.NONE}break;case 2:switch(O.touches.TWO){case e.TOUCH.DOLLY_PAN:if(!1===O.enableZoom&&!1===O.enablePan)return;O.enableZoom&&ae(),O.enablePan&&oe(),j=P.TOUCH_DOLLY_PAN;break;case e.TOUCH.DOLLY_ROTATE:if(!1===O.enableZoom&&!1===O.enableRotate)return;O.enableZoom&&ae(),O.enableRotate&&ne(),j=P.TOUCH_DOLLY_ROTATE;break;default:j=P.NONE}break;default:j=P.NONE}j!==P.NONE&&O.dispatchEvent(f)}(t):function(t){var n;switch(t.button){case 0:n=O.mouseButtons.LEFT;break;case 1:n=O.mouseButtons.MIDDLE;break;case 2:n=O.mouseButtons.RIGHT;break;default:n=-1}switch(n){case e.MOUSE.DOLLY:if(!1===O.enableZoom)return;!function(e){J(e),_.set(e.clientX,e.clientY)}(t),j=P.DOLLY;break;case e.MOUSE.ROTATE:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!1===O.enablePan)return;te(t),j=P.PAN}else{if(!1===O.enableRotate)return;ee(t),j=P.ROTATE}break;case e.MOUSE.PAN:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!1===O.enableRotate)return;ee(t),j=P.ROTATE}else{if(!1===O.enablePan)return;te(t),j=P.PAN}break;default:j=P.NONE}j!==P.NONE&&O.dispatchEvent(f)}(t))}function se(e){!1!==O.enabled&&("touch"===e.pointerType?function(e){switch(be(e),j){case P.TOUCH_ROTATE:if(!1===O.enableRotate)return;re(e),O.update();break;case P.TOUCH_PAN:if(!1===O.enablePan)return;ie(e),O.update();break;case P.TOUCH_DOLLY_PAN:if(!1===O.enableZoom&&!1===O.enablePan)return;!function(e){O.enableZoom&&ce(e),O.enablePan&&ie(e)}(e),O.update();break;case P.TOUCH_DOLLY_ROTATE:if(!1===O.enableZoom&&!1===O.enableRotate)return;!function(e){O.enableZoom&&ce(e),O.enableRotate&&re(e)}(e),O.update();break;default:j=P.NONE}}(e):function(e){switch(j){case P.ROTATE:if(!1===O.enableRotate)return;!function(e){N.set(e.clientX,e.clientY),R.subVectors(N,L).multiplyScalar(O.rotateSpeed);var t=O.domElement;X(2*Math.PI*R.x/t.clientHeight),F(2*Math.PI*R.y/t.clientHeight),L.copy(N),O.update()}(e);break;case P.DOLLY:if(!1===O.enableZoom)return;!function(e){D.set(e.clientX,e.clientY),I.subVectors(D,_),I.y>0?q(K()):I.y<0&&Q(K()),_.copy(D),O.update()}(e);break;case P.PAN:if(!1===O.enablePan)return;!function(e){C.set(e.clientX,e.clientY),k.subVectors(C,x).multiplyScalar(O.panSpeed),W(k.x,k.y),x.copy(C),O.update()}(e)}}(e))}function ue(e){!function(e){delete U[e.pointerId];for(var t=0;t<z.length;t++)if(z[t].pointerId==e.pointerId)return void z.splice(t,1)}(e),0===z.length&&(O.domElement.releasePointerCapture(e.pointerId),O.domElement.removeEventListener("pointermove",se),O.domElement.removeEventListener("pointerup",ue)),O.dispatchEvent(h),j=P.NONE}function pe(e){!1!==O.enabled&&!1!==O.enableZoom&&j===P.NONE&&(e.preventDefault(),O.dispatchEvent(f),function(e){J(e),e.deltaY<0?Q(K()):e.deltaY>0&&q(K()),O.update()}(e),O.dispatchEvent(h))}function me(e){!1!==O.enabled&&!1!==O.enablePan&&function(e){var t=!1;switch(e.code){case O.keys.UP:e.ctrlKey||e.metaKey||e.shiftKey?F(2*Math.PI*O.rotateSpeed/O.domElement.clientHeight):W(0,O.keyPanSpeed),t=!0;break;case O.keys.BOTTOM:e.ctrlKey||e.metaKey||e.shiftKey?F(-2*Math.PI*O.rotateSpeed/O.domElement.clientHeight):W(0,-O.keyPanSpeed),t=!0;break;case O.keys.LEFT:e.ctrlKey||e.metaKey||e.shiftKey?X(2*Math.PI*O.rotateSpeed/O.domElement.clientHeight):W(O.keyPanSpeed,0),t=!0;break;case O.keys.RIGHT:e.ctrlKey||e.metaKey||e.shiftKey?X(-2*Math.PI*O.rotateSpeed/O.domElement.clientHeight):W(-O.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),O.update())}(e)}function de(e){!1!==O.enabled&&e.preventDefault()}function be(t){var n=U[t.pointerId];void 0===n&&(n=new e.Vector2,U[t.pointerId]=n),n.set(t.pageX,t.pageY)}function fe(e){var t=e.pointerId===z[0].pointerId?z[1]:z[0];return U[t.pointerId]}return O.domElement.addEventListener("contextmenu",de),O.domElement.addEventListener("pointerdown",le),O.domElement.addEventListener("pointercancel",ue),O.domElement.addEventListener("wheel",pe,{passive:!1}),r.update(),r}return o(a)}();
},{"three":"gBK8"}],"PnwU":[function(require,module,exports) {
"use strict";var e=i(require("three")),t=require("./node_modules/three/examples/jsm/controls/OrbitControls.js");function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,i=new WeakMap;return(a=function(e){return e?i:t})(e)}function i(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var i=a(t);if(i&&i.has(e))return i.get(e);var _={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var m in e)if("default"!==m&&Object.prototype.hasOwnProperty.call(e,m)){var r=s?Object.getOwnPropertyDescriptor(e,m):null;r&&(r.get||r.set)?Object.defineProperty(_,m,r):_[m]=e[m]}return _.default=e,i&&i.set(e,_),_}var _={near_earth_objects:{"2023-10-08":[{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/2274138?api_key=DEMO_KEY"},id:"2274138",neo_reference_id:"2274138",name:"274138 (2008 FU6)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=2274138",absolute_magnitude_h:17.82,estimated_diameter:{kilometers:{estimated_diameter_min:.7253622947,estimated_diameter_max:1.6219593992},meters:{estimated_diameter_min:725.3622946704,estimated_diameter_max:1621.9593991982},miles:{estimated_diameter_min:.4507190944,estimated_diameter_max:1.0078385338},feet:{estimated_diameter_min:2379.7976308464,estimated_diameter_max:5321.3892752654}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-08",close_approach_date_full:"2023-Oct-08 20:15",epoch_date_close_approach:16967961e5,relative_velocity:{kilometers_per_second:"15.852377343",kilometers_per_hour:"57068.5584347507",miles_per_hour:"35460.1828785261"},miss_distance:{astronomical:"0.3364317949",lunar:"130.8719682161",kilometers:"50329479.917316863",miles:"31273288.6589561894"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/2401954?api_key=DEMO_KEY"},id:"2401954",neo_reference_id:"2401954",name:"401954 (2002 RW25)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=2401954",absolute_magnitude_h:18.91,estimated_diameter:{kilometers:{estimated_diameter_min:.439091446,estimated_diameter_max:.9818383215},meters:{estimated_diameter_min:439.0914459693,estimated_diameter_max:981.838321526},miles:{estimated_diameter_min:.2728386909,estimated_diameter_max:.6100858597},feet:{estimated_diameter_min:1440.5887795938,estimated_diameter_max:3221.2544387953}},is_potentially_hazardous_asteroid:!0,close_approach_data:[{close_approach_date:"2023-10-08",close_approach_date_full:"2023-Oct-08 01:29",epoch_date_close_approach:169672854e4,relative_velocity:{kilometers_per_second:"16.3309540272",kilometers_per_hour:"58791.434497925",miles_per_hour:"36530.7110634468"},miss_distance:{astronomical:"0.317059048",lunar:"123.335969672",kilometers:"47431358.24502776",miles:"29472479.356432688"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/3350777?api_key=DEMO_KEY"},id:"3350777",neo_reference_id:"3350777",name:"(2006 UA)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=3350777",absolute_magnitude_h:20.12,estimated_diameter:{kilometers:{estimated_diameter_min:.2515098375,estimated_diameter_max:.5623930936},meters:{estimated_diameter_min:251.509837491,estimated_diameter_max:562.3930936399},miles:{estimated_diameter_min:.1562809192,estimated_diameter_max:.349454759},feet:{estimated_diameter_min:825.1635352341,estimated_diameter_max:1845.1217573374}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-08",close_approach_date_full:"2023-Oct-08 03:54",epoch_date_close_approach:169673724e4,relative_velocity:{kilometers_per_second:"18.2584753095",kilometers_per_hour:"65730.5111140805",miles_per_hour:"40842.3834197463"},miss_distance:{astronomical:"0.1304293832",lunar:"50.7370300648",kilometers:"19511957.912133784",miles:"12124168.4414388592"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/3548887?api_key=DEMO_KEY"},id:"3548887",neo_reference_id:"3548887",name:"(2010 TE55)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=3548887",absolute_magnitude_h:28,estimated_diameter:{kilometers:{estimated_diameter_min:.0066765941,estimated_diameter_max:.0149293183},meters:{estimated_diameter_min:6.676594135,estimated_diameter_max:14.9293183439},miles:{estimated_diameter_min:.004148642,estimated_diameter_max:.0092766455},feet:{estimated_diameter_min:21.9048371017,estimated_diameter_max:48.9807047955}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-08",close_approach_date_full:"2023-Oct-08 06:58",epoch_date_close_approach:169674828e4,relative_velocity:{kilometers_per_second:"12.4921631491",kilometers_per_hour:"44971.7873366948",miles_per_hour:"27943.7197481813"},miss_distance:{astronomical:"0.3090773581",lunar:"120.2310923009",kilometers:"46237314.436987247",miles:"28730534.9385361286"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/3648641?api_key=DEMO_KEY"},id:"3648641",neo_reference_id:"3648641",name:"(2013 SO20)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=3648641",absolute_magnitude_h:21.74,estimated_diameter:{kilometers:{estimated_diameter_min:.1192765246,estimated_diameter_max:.2667104172},meters:{estimated_diameter_min:119.2765246442,estimated_diameter_max:266.7104172244},miles:{estimated_diameter_min:.0741149734,estimated_diameter_max:.1657261187},feet:{estimated_diameter_min:391.3271931138,estimated_diameter_max:875.0342052466}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-08",close_approach_date_full:"2023-Oct-08 06:12",epoch_date_close_approach:169674552e4,relative_velocity:{kilometers_per_second:"18.1886144979",kilometers_per_hour:"65479.012192507",miles_per_hour:"40686.1117703941"},miss_distance:{astronomical:"0.471221865",lunar:"183.305305485",kilometers:"70493787.30142755",miles:"43802808.26589819"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/3694459?api_key=DEMO_KEY"},id:"3694459",neo_reference_id:"3694459",name:"(2014 UZ56)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=3694459",absolute_magnitude_h:25.5,estimated_diameter:{kilometers:{estimated_diameter_min:.0211132445,estimated_diameter_max:.0472106499},meters:{estimated_diameter_min:21.113244479,estimated_diameter_max:47.2106498806},miles:{estimated_diameter_min:.0131191578,estimated_diameter_max:.0293353287},feet:{estimated_diameter_min:69.2691770164,estimated_diameter_max:154.8905885541}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-08",close_approach_date_full:"2023-Oct-08 18:36",epoch_date_close_approach:169679016e4,relative_velocity:{kilometers_per_second:"18.9697698323",kilometers_per_hour:"68291.1713963095",miles_per_hour:"42433.4781378902"},miss_distance:{astronomical:"0.4775852132",lunar:"185.7806479348",kilometers:"71445730.638215884",miles:"44394318.4266878392"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/3710915?api_key=DEMO_KEY"},id:"3710915",neo_reference_id:"3710915",name:"(2015 DE1)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=3710915",absolute_magnitude_h:23.3,estimated_diameter:{kilometers:{estimated_diameter_min:.058150704,estimated_diameter_max:.130028927},meters:{estimated_diameter_min:58.1507039646,estimated_diameter_max:130.0289270043},miles:{estimated_diameter_min:.0361331611,estimated_diameter_max:.0807962044},feet:{estimated_diameter_min:190.7831555951,estimated_diameter_max:426.6041048727}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-08",close_approach_date_full:"2023-Oct-08 07:51",epoch_date_close_approach:169675146e4,relative_velocity:{kilometers_per_second:"22.4103518843",kilometers_per_hour:"80677.2667835419",miles_per_hour:"50129.7161300291"},miss_distance:{astronomical:"0.4738609095",lunar:"184.3318937955",kilometers:"70888582.737462765",miles:"44048122.774465557"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/3774010?api_key=DEMO_KEY"},id:"3774010",neo_reference_id:"3774010",name:"(2017 HB1)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=3774010",absolute_magnitude_h:26.3,estimated_diameter:{kilometers:{estimated_diameter_min:.0146067964,estimated_diameter_max:.0326617897},meters:{estimated_diameter_min:14.6067964271,estimated_diameter_max:32.6617897446},miles:{estimated_diameter_min:.0090762397,estimated_diameter_max:.020295089},feet:{estimated_diameter_min:47.92256199,estimated_diameter_max:107.1581062656}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-08",close_approach_date_full:"2023-Oct-08 13:59",epoch_date_close_approach:169677354e4,relative_velocity:{kilometers_per_second:"7.0275121863",kilometers_per_hour:"25299.0438706511",miles_per_hour:"15719.8420095165"},miss_distance:{astronomical:"0.4505824465",lunar:"175.2765716885",kilometers:"67406174.255788955",miles:"41884254.483859379"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/3781023?api_key=DEMO_KEY"},id:"3781023",neo_reference_id:"3781023",name:"(2017 QW17)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=3781023",absolute_magnitude_h:21.62,estimated_diameter:{kilometers:{estimated_diameter_min:.1260535197,estimated_diameter_max:.2818642388},meters:{estimated_diameter_min:126.0535196822,estimated_diameter_max:281.8642388124},miles:{estimated_diameter_min:.0783260016,estimated_diameter_max:.1751422639},feet:{estimated_diameter_min:413.5614295141,estimated_diameter_max:924.7514692654}},is_potentially_hazardous_asteroid:!0,close_approach_data:[{close_approach_date:"2023-10-08",close_approach_date_full:"2023-Oct-08 21:05",epoch_date_close_approach:16967991e5,relative_velocity:{kilometers_per_second:"15.3910320485",kilometers_per_hour:"55407.7153745784",miles_per_hour:"34428.1995892762"},miss_distance:{astronomical:"0.4660789769",lunar:"181.3047220141",kilometers:"69724422.196019203",miles:"43324746.9573948814"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/3781886?api_key=DEMO_KEY"},id:"3781886",neo_reference_id:"3781886",name:"(2017 SV14)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=3781886",absolute_magnitude_h:23.26,estimated_diameter:{kilometers:{estimated_diameter_min:.0592318063,estimated_diameter_max:.1324463452},meters:{estimated_diameter_min:59.2318062676,estimated_diameter_max:132.4463452445},miles:{estimated_diameter_min:.0368049267,estimated_diameter_max:.082298318},feet:{estimated_diameter_min:194.330079275,estimated_diameter_max:434.5352673318}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-08",close_approach_date_full:"2023-Oct-08 00:16",epoch_date_close_approach:169672416e4,relative_velocity:{kilometers_per_second:"10.074951866",kilometers_per_hour:"36269.8267175863",miles_per_hour:"22536.6598290469"},miss_distance:{astronomical:"0.2611793177",lunar:"101.5987545853",kilometers:"39071869.615973299",miles:"24278133.9873335662"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/3799826?api_key=DEMO_KEY"},id:"3799826",neo_reference_id:"3799826",name:"(2018 ER1)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=3799826",absolute_magnitude_h:25.6,estimated_diameter:{kilometers:{estimated_diameter_min:.0201629919,estimated_diameter_max:.0450858206},meters:{estimated_diameter_min:20.1629919443,estimated_diameter_max:45.0858206172},miles:{estimated_diameter_min:.0125286985,estimated_diameter_max:.0280150214},feet:{estimated_diameter_min:66.1515504905,estimated_diameter_max:147.9193637137}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-08",close_approach_date_full:"2023-Oct-08 14:00",epoch_date_close_approach:16967736e5,relative_velocity:{kilometers_per_second:"5.293391791",kilometers_per_hour:"19056.210447491",miles_per_hour:"11840.7880972202"},miss_distance:{astronomical:"0.0320468132",lunar:"12.4662103348",kilometers:"4794134.995007884",miles:"2978937.3507374392"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/3840794?api_key=DEMO_KEY"},id:"3840794",neo_reference_id:"3840794",name:"(2019 GP1)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=3840794",absolute_magnitude_h:26,estimated_diameter:{kilometers:{estimated_diameter_min:.0167708462,estimated_diameter_max:.0375007522},meters:{estimated_diameter_min:16.7708462163,estimated_diameter_max:37.5007521798},miles:{estimated_diameter_min:.0104209175,estimated_diameter_max:.0233018799},feet:{estimated_diameter_min:55.0224631002,estimated_diameter_max:123.0339677816}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-08",close_approach_date_full:"2023-Oct-08 06:53",epoch_date_close_approach:169674798e4,relative_velocity:{kilometers_per_second:"7.3875289621",kilometers_per_hour:"26595.1042636503",miles_per_hour:"16525.1635353776"},miss_distance:{astronomical:"0.2435923018",lunar:"94.7574054002",kilometers:"36440889.497677166",miles:"22643318.7492142508"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/3884015?api_key=DEMO_KEY"},id:"3884015",neo_reference_id:"3884015",name:"(2019 UY8)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=3884015",absolute_magnitude_h:24.7,estimated_diameter:{kilometers:{estimated_diameter_min:.0305179233,estimated_diameter_max:.0682401509},meters:{estimated_diameter_min:30.5179232594,estimated_diameter_max:68.2401509401},miles:{estimated_diameter_min:.0189629525,estimated_diameter_max:.0424024508},feet:{estimated_diameter_min:100.1244233463,estimated_diameter_max:223.8850168104}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-08",close_approach_date_full:"2023-Oct-08 01:18",epoch_date_close_approach:169672788e4,relative_velocity:{kilometers_per_second:"9.542976329",kilometers_per_hour:"34354.7147844788",miles_per_hour:"21346.6837503891"},miss_distance:{astronomical:"0.2282606651",lunar:"88.7933987239",kilometers:"34147309.303743337",miles:"21218154.1024665706"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/54016334?api_key=DEMO_KEY"},id:"54016334",neo_reference_id:"54016334",name:"(2020 FV3)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=54016334",absolute_magnitude_h:27.7,estimated_diameter:{kilometers:{estimated_diameter_min:.0076657557,estimated_diameter_max:.0171411509},meters:{estimated_diameter_min:7.6657557353,estimated_diameter_max:17.1411509231},miles:{estimated_diameter_min:.0047632783,estimated_diameter_max:.0106510141},feet:{estimated_diameter_min:25.1501180466,estimated_diameter_max:56.2373735944}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-08",close_approach_date_full:"2023-Oct-08 02:18",epoch_date_close_approach:169673148e4,relative_velocity:{kilometers_per_second:"10.8237462675",kilometers_per_hour:"38965.486562923",miles_per_hour:"24211.6380257229"},miss_distance:{astronomical:"0.161109902",lunar:"62.671751878",kilometers:"24101698.17510874",miles:"14976100.794991012"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/54159407?api_key=DEMO_KEY"},id:"54159407",neo_reference_id:"54159407",name:"(2021 LK6)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=54159407",absolute_magnitude_h:28.39,estimated_diameter:{kilometers:{estimated_diameter_min:.0055789822,estimated_diameter_max:.0124749835},meters:{estimated_diameter_min:5.5789822107,estimated_diameter_max:12.4749834683},miles:{estimated_diameter_min:.0034666178,estimated_diameter_max:.007751593},feet:{estimated_diameter_min:18.3037479961,estimated_diameter_max:40.9284247622}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-08",close_approach_date_full:"2023-Oct-08 09:47",epoch_date_close_approach:169675842e4,relative_velocity:{kilometers_per_second:"17.0995166713",kilometers_per_hour:"61558.2600165673",miles_per_hour:"38249.908841961"},miss_distance:{astronomical:"0.2722233964",lunar:"105.8949011996",kilometers:"40724040.265605668",miles:"25304745.2244194984"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/54207058?api_key=DEMO_KEY"},id:"54207058",neo_reference_id:"54207058",name:"(2021 TJ10)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=54207058",absolute_magnitude_h:28.98,estimated_diameter:{kilometers:{estimated_diameter_min:.0042516252,estimated_diameter_max:.0095069231},meters:{estimated_diameter_min:4.2516252401,estimated_diameter_max:9.5069230516},miles:{estimated_diameter_min:.0026418366,estimated_diameter_max:.0059073263},feet:{estimated_diameter_min:13.9489021526,estimated_diameter_max:31.1906934247}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-08",close_approach_date_full:"2023-Oct-08 12:09",epoch_date_close_approach:169676694e4,relative_velocity:{kilometers_per_second:"9.7431807191",kilometers_per_hour:"35075.4505889313",miles_per_hour:"21794.5209506612"},miss_distance:{astronomical:"0.1076453395",lunar:"41.8740370655",kilometers:"16103513.504626865",miles:"10006259.295366137"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/54374157?api_key=DEMO_KEY"},id:"54374157",neo_reference_id:"54374157",name:"(2015 DV315)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=54374157",absolute_magnitude_h:16.81,estimated_diameter:{kilometers:{estimated_diameter_min:1.1549281758,estimated_diameter_max:2.5824979103},meters:{estimated_diameter_min:1154.928175848,estimated_diameter_max:2582.497910326},miles:{estimated_diameter_min:.7176388756,estimated_diameter_max:1.604689309},feet:{estimated_diameter_min:3789.1345564493,estimated_diameter_max:8472.7624441141}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-08",close_approach_date_full:"2023-Oct-08 21:49",epoch_date_close_approach:169680174e4,relative_velocity:{kilometers_per_second:"16.8891597007",kilometers_per_hour:"60800.9749225009",miles_per_hour:"37779.361334484"},miss_distance:{astronomical:"0.3236109753",lunar:"125.8846693917",kilometers:"48411512.613502611",miles:"30081519.0394575918"},orbiting_body:"Earth"}],is_sentry_object:!1}],"2023-10-09":[{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/2397474?api_key=DEMO_KEY"},id:"2397474",neo_reference_id:"2397474",name:"397474 (2007 PP6)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=2397474",absolute_magnitude_h:17.22,estimated_diameter:{kilometers:{estimated_diameter_min:.9562137328,estimated_diameter_max:2.1381589077},meters:{estimated_diameter_min:956.213732844,estimated_diameter_max:2138.1589076579},miles:{estimated_diameter_min:.5941634834,estimated_diameter_max:1.3285899386},feet:{estimated_diameter_min:3137.1842632638,estimated_diameter_max:7014.9572706004}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-09",close_approach_date_full:"2023-Oct-09 16:53",epoch_date_close_approach:169687038e4,relative_velocity:{kilometers_per_second:"21.7849584331",kilometers_per_hour:"78425.8503592849",miles_per_hour:"48730.773519079"},miss_distance:{astronomical:"0.4913674296",lunar:"191.1419301144",kilometers:"73507520.855534952",miles:"45675455.4606162576"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/3381261?api_key=DEMO_KEY"},id:"3381261",neo_reference_id:"3381261",name:"(2007 PR10)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=3381261",absolute_magnitude_h:20.83,estimated_diameter:{kilometers:{estimated_diameter_min:.1813656249,estimated_diameter_max:.4055458661},meters:{estimated_diameter_min:181.3656249029,estimated_diameter_max:405.5458660645},miles:{estimated_diameter_min:.1126953397,estimated_diameter_max:.2519944403},feet:{estimated_diameter_min:595.0315968063,estimated_diameter_max:1330.5310992191}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-09",close_approach_date_full:"2023-Oct-09 14:24",epoch_date_close_approach:169686144e4,relative_velocity:{kilometers_per_second:"33.3514979242",kilometers_per_hour:"120065.3925272219",miles_per_hour:"74603.9657067063"},miss_distance:{astronomical:"0.2496865418",lunar:"97.1280647602",kilometers:"37352574.820945966",miles:"23209813.7403716908"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/3747991?api_key=DEMO_KEY"},id:"3747991",neo_reference_id:"3747991",name:"(2016 FX2)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=3747991",absolute_magnitude_h:23.7,estimated_diameter:{kilometers:{estimated_diameter_min:.0483676488,estimated_diameter_max:.1081533507},meters:{estimated_diameter_min:48.3676488219,estimated_diameter_max:108.1533506775},miles:{estimated_diameter_min:.0300542543,estimated_diameter_max:.0672033557},feet:{estimated_diameter_min:158.6865169607,estimated_diameter_max:354.8338390368}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-09",close_approach_date_full:"2023-Oct-09 20:45",epoch_date_close_approach:16968843e5,relative_velocity:{kilometers_per_second:"6.6026221388",kilometers_per_hour:"23769.4396998099",miles_per_hour:"14769.4054623624"},miss_distance:{astronomical:"0.3582234125",lunar:"139.3489074625",kilometers:"53589459.494131375",miles:"33298946.037007975"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/3773988?api_key=DEMO_KEY"},id:"3773988",neo_reference_id:"3773988",name:"(2017 HF)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=3773988",absolute_magnitude_h:26.7,estimated_diameter:{kilometers:{estimated_diameter_min:.0121494041,estimated_diameter_max:.0271668934},meters:{estimated_diameter_min:12.14940408,estimated_diameter_max:27.1668934089},miles:{estimated_diameter_min:.0075492874,estimated_diameter_max:.0168807197},feet:{estimated_diameter_min:39.8602508817,estimated_diameter_max:89.1302305717}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-09",close_approach_date_full:"2023-Oct-09 08:40",epoch_date_close_approach:16968408e5,relative_velocity:{kilometers_per_second:"7.7207149778",kilometers_per_hour:"27794.573919925",miles_per_hour:"17270.4673337445"},miss_distance:{astronomical:"0.4578876483",lunar:"178.1182951887",kilometers:"68499016.884989121",miles:"42563315.4051710298"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/3799683?api_key=DEMO_KEY"},id:"3799683",neo_reference_id:"3799683",name:"(2018 DC)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=3799683",absolute_magnitude_h:24.7,estimated_diameter:{kilometers:{estimated_diameter_min:.0305179233,estimated_diameter_max:.0682401509},meters:{estimated_diameter_min:30.5179232594,estimated_diameter_max:68.2401509401},miles:{estimated_diameter_min:.0189629525,estimated_diameter_max:.0424024508},feet:{estimated_diameter_min:100.1244233463,estimated_diameter_max:223.8850168104}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-09",close_approach_date_full:"2023-Oct-09 02:51",epoch_date_close_approach:169681986e4,relative_velocity:{kilometers_per_second:"21.0287577365",kilometers_per_hour:"75703.5278512657",miles_per_hour:"47039.2281806934"},miss_distance:{astronomical:"0.4414462734",lunar:"171.7226003526",kilometers:"66039422.220077658",miles:"41034994.1495933604"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/3884023?api_key=DEMO_KEY"},id:"3884023",neo_reference_id:"3884023",name:"(2019 UM9)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=3884023",absolute_magnitude_h:27.3,estimated_diameter:{kilometers:{estimated_diameter_min:.0092162655,estimated_diameter_max:.0206081961},meters:{estimated_diameter_min:9.216265485,estimated_diameter_max:20.6081961232},miles:{estimated_diameter_min:.0057267201,estimated_diameter_max:.0128053354},feet:{estimated_diameter_min:30.2370924539,estimated_diameter_max:67.6121941689}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-09",close_approach_date_full:"2023-Oct-09 20:16",epoch_date_close_approach:169688256e4,relative_velocity:{kilometers_per_second:"20.2884205793",kilometers_per_hour:"73038.3140855711",miles_per_hour:"45383.1679938928"},miss_distance:{astronomical:"0.4979244275",lunar:"193.6926022975",kilometers:"74488433.774969425",miles:"46284966.485351065"},orbiting_body:"Earth"}],is_sentry_object:!1}],"2023-10-02":[{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/2105140?api_key=DEMO_KEY"},id:"2105140",neo_reference_id:"2105140",name:"105140 (2000 NL10)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=2105140",absolute_magnitude_h:15.74,estimated_diameter:{kilometers:{estimated_diameter_min:1.8904055193,estimated_diameter_max:4.2270752462},meters:{estimated_diameter_min:1890.4055192905,estimated_diameter_max:4227.0752461745},miles:{estimated_diameter_min:1.1746431679,estimated_diameter_max:2.6265819728},feet:{estimated_diameter_min:6202.1180439092,estimated_diameter_max:13868.357550659}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-02",close_approach_date_full:"2023-Oct-02 10:26",epoch_date_close_approach:169624236e4,relative_velocity:{kilometers_per_second:"39.146332157",kilometers_per_hour:"140926.795765205",miles_per_hour:"87566.4304019964"},miss_distance:{astronomical:"0.4419145238",lunar:"171.9047497582",kilometers:"66109471.482544306",miles:"41078520.7429351828"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/2237442?api_key=DEMO_KEY"},id:"2237442",neo_reference_id:"2237442",name:"237442 (1999 TA10)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=2237442",absolute_magnitude_h:18.16,estimated_diameter:{kilometers:{estimated_diameter_min:.620233153,estimated_diameter_max:1.3868834919},meters:{estimated_diameter_min:620.2331529543,estimated_diameter_max:1386.8834919048},miles:{estimated_diameter_min:.3853948945,estimated_diameter_max:.8617691822},feet:{estimated_diameter_min:2034.8857375386,estimated_diameter_max:4550.142835581}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-02",close_approach_date_full:"2023-Oct-02 12:12",epoch_date_close_approach:169624872e4,relative_velocity:{kilometers_per_second:"10.6996648302",kilometers_per_hour:"38518.7933885699",miles_per_hour:"23934.0802585811"},miss_distance:{astronomical:"0.3608998449",lunar:"140.3900396661",kilometers:"53989848.080370363",miles:"33547735.9679544894"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/2405762?api_key=DEMO_KEY"},id:"2405762",neo_reference_id:"2405762",name:"405762 (2005 YO180)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=2405762",absolute_magnitude_h:20.28,estimated_diameter:{kilometers:{estimated_diameter_min:.233644185,estimated_diameter_max:.5224442801},meters:{estimated_diameter_min:233.6441849736,estimated_diameter_max:522.4442801486},miles:{estimated_diameter_min:.1451797209,estimated_diameter_max:.3246317248},feet:{estimated_diameter_min:766.5491878289,estimated_diameter_max:1714.0560920828}},is_potentially_hazardous_asteroid:!0,close_approach_data:[{close_approach_date:"2023-10-02",close_approach_date_full:"2023-Oct-02 06:05",epoch_date_close_approach:16962267e5,relative_velocity:{kilometers_per_second:"21.4435412813",kilometers_per_hour:"77196.7486126742",miles_per_hour:"47967.0574921364"},miss_distance:{astronomical:"0.3444485731",lunar:"133.9904949359",kilometers:"51528772.860299297",miles:"32018494.7380604186"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/2488474?api_key=DEMO_KEY"},id:"2488474",neo_reference_id:"2488474",name:"488474 (1999 HD1)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=2488474",absolute_magnitude_h:20.34,estimated_diameter:{kilometers:{estimated_diameter_min:.2272767323,estimated_diameter_max:.5082062231},meters:{estimated_diameter_min:227.2767322847,estimated_diameter_max:508.2062230927},miles:{estimated_diameter_min:.1412231704,estimated_diameter_max:.315784609},feet:{estimated_diameter_min:745.6585943491,estimated_diameter_max:1667.3433049715}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-02",close_approach_date_full:"2023-Oct-02 09:50",epoch_date_close_approach:16962402e5,relative_velocity:{kilometers_per_second:"17.2558653001",kilometers_per_hour:"62121.1150802581",miles_per_hour:"38599.6450897304"},miss_distance:{astronomical:"0.3534106249",lunar:"137.4767330861",kilometers:"52869476.720408963",miles:"32851569.4865431694"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/3423321?api_key=DEMO_KEY"},id:"3423321",neo_reference_id:"3423321",name:"(2008 PW4)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=3423321",absolute_magnitude_h:22.39,estimated_diameter:{kilometers:{estimated_diameter_min:.0884209093,estimated_diameter_max:.1977151638},meters:{estimated_diameter_min:88.4209092655,estimated_diameter_max:197.7151637501},miles:{estimated_diameter_min:.0549421888,estimated_diameter_max:.122854469},feet:{estimated_diameter_min:290.0948559548,estimated_diameter_max:648.6718178379}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-02",close_approach_date_full:"2023-Oct-02 08:04",epoch_date_close_approach:169623384e4,relative_velocity:{kilometers_per_second:"5.4447313514",kilometers_per_hour:"19601.0328650223",miles_per_hour:"12179.3195599357"},miss_distance:{astronomical:"0.1214581802",lunar:"47.2472320978",kilometers:"18169885.051996174",miles:"11290243.0357842412"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/3761035?api_key=DEMO_KEY"},id:"3761035",neo_reference_id:"3761035",name:"(2016 TB57)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=3761035",absolute_magnitude_h:26.1,estimated_diameter:{kilometers:{estimated_diameter_min:.0160160338,estimated_diameter_max:.0358129403},meters:{estimated_diameter_min:16.0160337979,estimated_diameter_max:35.8129403019},miles:{estimated_diameter_min:.0099518989,estimated_diameter_max:.0222531225},feet:{estimated_diameter_min:52.5460443254,estimated_diameter_max:117.4965270602}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-02",close_approach_date_full:"2023-Oct-02 10:21",epoch_date_close_approach:169624206e4,relative_velocity:{kilometers_per_second:"13.2918084498",kilometers_per_hour:"47850.5104193084",miles_per_hour:"29732.4463213753"},miss_distance:{astronomical:"0.3663641683",lunar:"142.5156614687",kilometers:"54807299.222001521",miles:"34055676.5538461498"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/3781908?api_key=DEMO_KEY"},id:"3781908",neo_reference_id:"3781908",name:"(2017 SN17)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=3781908",absolute_magnitude_h:22.73,estimated_diameter:{kilometers:{estimated_diameter_min:.0756057762,estimated_diameter_max:.1690596552},meters:{estimated_diameter_min:75.605776236,estimated_diameter_max:169.0596551553},miles:{estimated_diameter_min:.0469792368,estimated_diameter_max:.105048767},feet:{estimated_diameter_min:248.050454906,estimated_diameter_max:554.6576790196}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-02",close_approach_date_full:"2023-Oct-02 02:50",epoch_date_close_approach:1696215e6,relative_velocity:{kilometers_per_second:"12.5128332491",kilometers_per_hour:"45046.1996967283",miles_per_hour:"27989.9566948921"},miss_distance:{astronomical:"0.1883940488",lunar:"73.2852849832",kilometers:"28183348.421156056",miles:"17512320.6518073328"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/54054714?api_key=DEMO_KEY"},id:"54054714",neo_reference_id:"54054714",name:"(2020 SV6)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=54054714",absolute_magnitude_h:23.8,estimated_diameter:{kilometers:{estimated_diameter_min:.046190746,estimated_diameter_max:.1032856481},meters:{estimated_diameter_min:46.1907460282,estimated_diameter_max:103.2856480504},miles:{estimated_diameter_min:.0287015901,estimated_diameter_max:.0641787064},feet:{estimated_diameter_min:151.544447199,estimated_diameter_max:338.8636855496}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-02",close_approach_date_full:"2023-Oct-02 00:10",epoch_date_close_approach:16962054e5,relative_velocity:{kilometers_per_second:"14.5632706606",kilometers_per_hour:"52427.7743783015",miles_per_hour:"32576.5801407841"},miss_distance:{astronomical:"0.4726671474",lunar:"183.8675203386",kilometers:"70709998.470016038",miles:"43937155.6562878044"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/54055076?api_key=DEMO_KEY"},id:"54055076",neo_reference_id:"54055076",name:"(2020 TE2)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=54055076",absolute_magnitude_h:26.25,estimated_diameter:{kilometers:{estimated_diameter_min:.0149470324,estimated_diameter_max:.0334225806},meters:{estimated_diameter_min:14.9470324236,estimated_diameter_max:33.422580561},miles:{estimated_diameter_min:.0092876525,estimated_diameter_max:.0207678223},feet:{estimated_diameter_min:49.0388218565,estimated_diameter_max:109.6541392077}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-02",close_approach_date_full:"2023-Oct-02 10:36",epoch_date_close_approach:169624296e4,relative_velocity:{kilometers_per_second:"16.9961844041",kilometers_per_hour:"61186.2638547492",miles_per_hour:"38018.7648935246"},miss_distance:{astronomical:"0.3671372379",lunar:"142.8163855431",kilometers:"54922948.787523273",miles:"34127537.8616082474"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/54087416?api_key=DEMO_KEY"},id:"54087416",neo_reference_id:"54087416",name:"(2020 VF)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=54087416",absolute_magnitude_h:24.1,estimated_diameter:{kilometers:{estimated_diameter_min:.040230458,estimated_diameter_max:.0899580388},meters:{estimated_diameter_min:40.2304579834,estimated_diameter_max:89.9580388169},miles:{estimated_diameter_min:.0249980399,estimated_diameter_max:.0558973165},feet:{estimated_diameter_min:131.9896957704,estimated_diameter_max:295.1379320721}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-02",close_approach_date_full:"2023-Oct-02 14:47",epoch_date_close_approach:169625802e4,relative_velocity:{kilometers_per_second:"20.6821097457",kilometers_per_hour:"74455.5950844728",miles_per_hour:"46263.811290127"},miss_distance:{astronomical:"0.4731793521",lunar:"184.0667679669",kilometers:"70786623.202140027",miles:"43984768.0570132926"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/54316566?api_key=DEMO_KEY"},id:"54316566",neo_reference_id:"54316566",name:"(2022 TS2)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=54316566",absolute_magnitude_h:24.56,estimated_diameter:{kilometers:{estimated_diameter_min:.0325502986,estimated_diameter_max:.0727846803},meters:{estimated_diameter_min:32.5502985765,estimated_diameter_max:72.7846803049},miles:{estimated_diameter_min:.0202258116,estimated_diameter_max:.0452262896},feet:{estimated_diameter_min:106.7923215816,estimated_diameter_max:238.7948905315}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-02",close_approach_date_full:"2023-Oct-02 07:03",epoch_date_close_approach:169623018e4,relative_velocity:{kilometers_per_second:"28.6274189852",kilometers_per_hour:"103058.7083468615",miles_per_hour:"64036.6735280818"},miss_distance:{astronomical:"0.4567015369",lunar:"177.6568978541",kilometers:"68321577.145966403",miles:"42453059.4639782414"},orbiting_body:"Earth"}],is_sentry_object:!1}],"2023-10-03":[{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/2221980?api_key=DEMO_KEY"},id:"2221980",neo_reference_id:"2221980",name:"221980 (1996 EO)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=2221980",absolute_magnitude_h:19.11,estimated_diameter:{kilometers:{estimated_diameter_min:.4004561582,estimated_diameter_max:.8954471917},meters:{estimated_diameter_min:400.4561581924,estimated_diameter_max:895.4471917267},miles:{estimated_diameter_min:.2488318435,estimated_diameter_max:.556404917},feet:{estimated_diameter_min:1313.8325820441,estimated_diameter_max:2937.8189645046}},is_potentially_hazardous_asteroid:!0,close_approach_data:[{close_approach_date:"2023-10-03",close_approach_date_full:"2023-Oct-03 05:24",epoch_date_close_approach:169631064e4,relative_velocity:{kilometers_per_second:"12.9334196338",kilometers_per_hour:"46560.3106818496",miles_per_hour:"28930.7663789526"},miss_distance:{astronomical:"0.1877321766",lunar:"73.0278166974",kilometers:"28084333.749823842",miles:"17450795.7879873396"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/2349507?api_key=DEMO_KEY"},id:"2349507",neo_reference_id:"2349507",name:"349507 (2008 QY)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=2349507",absolute_magnitude_h:18.54,estimated_diameter:{kilometers:{estimated_diameter_min:.5206609142,estimated_diameter_max:1.1642331974},meters:{estimated_diameter_min:520.6609142179,estimated_diameter_max:1164.2331974184},miles:{estimated_diameter_min:.3235235929,estimated_diameter_max:.7234207461},feet:{estimated_diameter_min:1708.2051538026,estimated_diameter_max:3819.6628434182}},is_potentially_hazardous_asteroid:!0,close_approach_data:[{close_approach_date:"2023-10-03",close_approach_date_full:"2023-Oct-03 20:39",epoch_date_close_approach:169636554e4,relative_velocity:{kilometers_per_second:"20.9602033183",kilometers_per_hour:"75456.731945876",miles_per_hour:"46885.8788027028"},miss_distance:{astronomical:"0.0422792658",lunar:"16.4466343962",kilometers:"6324888.108843846",miles:"3930103.2295272348"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/2366470?api_key=DEMO_KEY"},id:"2366470",neo_reference_id:"2366470",name:"366470 (2002 FD)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=2366470",absolute_magnitude_h:19.57,estimated_diameter:{kilometers:{estimated_diameter_min:.3240074354,estimated_diameter_max:.7245026508},meters:{estimated_diameter_min:324.0074353942,estimated_diameter_max:724.5026507569},miles:{estimated_diameter_min:.2013288241,estimated_diameter_max:.4501849366},feet:{estimated_diameter_min:1063.0165543388,estimated_diameter_max:2376.9772767092}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-03",close_approach_date_full:"2023-Oct-03 21:15",epoch_date_close_approach:16963677e5,relative_velocity:{kilometers_per_second:"11.6580042299",kilometers_per_hour:"41968.8152276897",miles_per_hour:"26077.7896618942"},miss_distance:{astronomical:"0.3450464024",lunar:"134.2230505336",kilometers:"51618206.850202888",miles:"32074066.4424923344"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/3136724?api_key=DEMO_KEY"},id:"3136724",neo_reference_id:"3136724",name:"(2002 RS129)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=3136724",absolute_magnitude_h:22.86,estimated_diameter:{kilometers:{estimated_diameter_min:.0712122941,estimated_diameter_max:.1592355304},meters:{estimated_diameter_min:71.2122940737,estimated_diameter_max:159.2355303825},miles:{estimated_diameter_min:.0442492544,estimated_diameter_max:.0989443407},feet:{estimated_diameter_min:233.6361428887,estimated_diameter_max:522.4262975}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-03",close_approach_date_full:"2023-Oct-03 11:43",epoch_date_close_approach:169633338e4,relative_velocity:{kilometers_per_second:"8.3838192977",kilometers_per_hour:"30181.7494718728",miles_per_hour:"18753.7653871201"},miss_distance:{astronomical:"0.3326512059",lunar:"129.4013190951",kilometers:"49763911.855571433",miles:"30921860.9613064554"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/3137738?api_key=DEMO_KEY"},id:"3137738",neo_reference_id:"3137738",name:"(2002 TA60)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=3137738",absolute_magnitude_h:20.7,estimated_diameter:{kilometers:{estimated_diameter_min:.1925550782,estimated_diameter_max:.4305662442},meters:{estimated_diameter_min:192.5550781879,estimated_diameter_max:430.566244241},miles:{estimated_diameter_min:.1196481415,estimated_diameter_max:.2675413778},feet:{estimated_diameter_min:631.7424027221,estimated_diameter_max:1412.6189567557}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-03",close_approach_date_full:"2023-Oct-03 12:42",epoch_date_close_approach:169633692e4,relative_velocity:{kilometers_per_second:"28.021418781",kilometers_per_hour:"100877.1076117156",miles_per_hour:"62681.1116712907"},miss_distance:{astronomical:"0.2961538405",lunar:"115.2038439545",kilometers:"44303983.731119735",miles:"27529218.943672943"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/3634614?api_key=DEMO_KEY"},id:"3634614",neo_reference_id:"3634614",name:"(2013 GT66)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=3634614",absolute_magnitude_h:25.2,estimated_diameter:{kilometers:{estimated_diameter_min:.0242412481,estimated_diameter_max:.0542050786},meters:{estimated_diameter_min:24.2412481101,estimated_diameter_max:54.2050786336},miles:{estimated_diameter_min:.0150628086,estimated_diameter_max:.0336814639},feet:{estimated_diameter_min:79.5316564495,estimated_diameter_max:177.8381901842}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-03",close_approach_date_full:"2023-Oct-03 17:30",epoch_date_close_approach:16963542e5,relative_velocity:{kilometers_per_second:"16.7143476864",kilometers_per_hour:"60171.6516711156",miles_per_hour:"37388.3243397551"},miss_distance:{astronomical:"0.4114430124",lunar:"160.0513318236",kilometers:"61550998.281423588",miles:"38246016.8407099944"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/3699892?api_key=DEMO_KEY"},id:"3699892",neo_reference_id:"3699892",name:"(2014 WZ365)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=3699892",absolute_magnitude_h:26,estimated_diameter:{kilometers:{estimated_diameter_min:.0167708462,estimated_diameter_max:.0375007522},meters:{estimated_diameter_min:16.7708462163,estimated_diameter_max:37.5007521798},miles:{estimated_diameter_min:.0104209175,estimated_diameter_max:.0233018799},feet:{estimated_diameter_min:55.0224631002,estimated_diameter_max:123.0339677816}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-03",close_approach_date_full:"2023-Oct-03 19:06",epoch_date_close_approach:169635996e4,relative_velocity:{kilometers_per_second:"15.6723097432",kilometers_per_hour:"56420.3150753688",miles_per_hour:"35057.3896644701"},miss_distance:{astronomical:"0.1470277323",lunar:"57.1937878647",kilometers:"21995035.583010201",miles:"13667081.3602987338"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/3728901?api_key=DEMO_KEY"},id:"3728901",neo_reference_id:"3728901",name:"(2015 TA)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=3728901",absolute_magnitude_h:21.57,estimated_diameter:{kilometers:{estimated_diameter_min:.1289896833,estimated_diameter_max:.2884297004},meters:{estimated_diameter_min:128.9896833431,estimated_diameter_max:288.4297003513},miles:{estimated_diameter_min:.0801504485,estimated_diameter_max:.1792218513},feet:{estimated_diameter_min:423.1945126993,estimated_diameter_max:946.2916981006}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-03",close_approach_date_full:"2023-Oct-03 12:28",epoch_date_close_approach:169633608e4,relative_velocity:{kilometers_per_second:"14.0701375494",kilometers_per_hour:"50652.4951778141",miles_per_hour:"31473.4906842368"},miss_distance:{astronomical:"0.410342843",lunar:"159.623365927",kilometers:"61386415.28254441",miles:"38143749.707396458"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/3759289?api_key=DEMO_KEY"},id:"3759289",neo_reference_id:"3759289",name:"(2016 RL20)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=3759289",absolute_magnitude_h:23.5,estimated_diameter:{kilometers:{estimated_diameter_min:.0530340723,estimated_diameter_max:.1185877909},meters:{estimated_diameter_min:53.0340723319,estimated_diameter_max:118.5877908577},miles:{estimated_diameter_min:.0329538346,estimated_diameter_max:.0736870142},feet:{estimated_diameter_min:173.9963058693,estimated_diameter_max:389.0675677576}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-03",close_approach_date_full:"2023-Oct-03 14:04",epoch_date_close_approach:169634184e4,relative_velocity:{kilometers_per_second:"11.3412772079",kilometers_per_hour:"40828.597948539",miles_per_hour:"25369.302986413"},miss_distance:{astronomical:"0.2068833465",lunar:"80.4776217885",kilometers:"30949307.974871955",miles:"19231008.221884779"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/3789747?api_key=DEMO_KEY"},id:"3789747",neo_reference_id:"3789747",name:"(2017 WD28)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=3789747",absolute_magnitude_h:25.7,estimated_diameter:{kilometers:{estimated_diameter_min:.0192555078,estimated_diameter_max:.0430566244},meters:{estimated_diameter_min:19.2555078188,estimated_diameter_max:43.0566244241},miles:{estimated_diameter_min:.0119648141,estimated_diameter_max:.0267541378},feet:{estimated_diameter_min:63.1742402722,estimated_diameter_max:141.2618956756}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-03",close_approach_date_full:"2023-Oct-03 06:25",epoch_date_close_approach:16963143e5,relative_velocity:{kilometers_per_second:"10.3395803203",kilometers_per_hour:"37222.489153206",miles_per_hour:"23128.6072185574"},miss_distance:{astronomical:"0.3500929243",lunar:"136.1861475527",kilometers:"52373155.777351241",miles:"32543169.9532034858"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/3791345?api_key=DEMO_KEY"},id:"3791345",neo_reference_id:"3791345",name:"(2017 XV60)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=3791345",absolute_magnitude_h:25.8,estimated_diameter:{kilometers:{estimated_diameter_min:.0183888672,estimated_diameter_max:.0411187571},meters:{estimated_diameter_min:18.388867207,estimated_diameter_max:41.1187571041},miles:{estimated_diameter_min:.0114263088,estimated_diameter_max:.0255500032},feet:{estimated_diameter_min:60.3309310875,estimated_diameter_max:134.9040630575}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-03",close_approach_date_full:"2023-Oct-03 22:53",epoch_date_close_approach:169637358e4,relative_velocity:{kilometers_per_second:"11.4959739871",kilometers_per_hour:"41385.506353456",miles_per_hour:"25715.3442116793"},miss_distance:{astronomical:"0.2401337288",lunar:"93.4120205032",kilometers:"35923494.343637656",miles:"22321824.3083894128"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/3956451?api_key=DEMO_KEY"},id:"3956451",neo_reference_id:"3956451",name:"(2019 YS3)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=3956451",absolute_magnitude_h:24.7,estimated_diameter:{kilometers:{estimated_diameter_min:.0305179233,estimated_diameter_max:.0682401509},meters:{estimated_diameter_min:30.5179232594,estimated_diameter_max:68.2401509401},miles:{estimated_diameter_min:.0189629525,estimated_diameter_max:.0424024508},feet:{estimated_diameter_min:100.1244233463,estimated_diameter_max:223.8850168104}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-03",close_approach_date_full:"2023-Oct-03 17:51",epoch_date_close_approach:169635546e4,relative_velocity:{kilometers_per_second:"4.8169757923",kilometers_per_hour:"17341.1128522013",miles_per_hour:"10775.0931497469"},miss_distance:{astronomical:"0.2683310432",lunar:"104.3807758048",kilometers:"40141752.517597984",miles:"24942928.3954768192"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/54016766?api_key=DEMO_KEY"},id:"54016766",neo_reference_id:"54016766",name:"(2020 HT6)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=54016766",absolute_magnitude_h:24.7,estimated_diameter:{kilometers:{estimated_diameter_min:.0305179233,estimated_diameter_max:.0682401509},meters:{estimated_diameter_min:30.5179232594,estimated_diameter_max:68.2401509401},miles:{estimated_diameter_min:.0189629525,estimated_diameter_max:.0424024508},feet:{estimated_diameter_min:100.1244233463,estimated_diameter_max:223.8850168104}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-03",close_approach_date_full:"2023-Oct-03 20:18",epoch_date_close_approach:169636428e4,relative_velocity:{kilometers_per_second:"6.8285020423",kilometers_per_hour:"24582.6073522747",miles_per_hour:"15274.6762184176"},miss_distance:{astronomical:"0.4598433807",lunar:"178.8790750923",kilometers:"68791590.286319109",miles:"42745112.0867333442"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/54054505?api_key=DEMO_KEY"},id:"54054505",neo_reference_id:"54054505",name:"(2020 SP1)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=54054505",absolute_magnitude_h:23.1,estimated_diameter:{kilometers:{estimated_diameter_min:.063760979,estimated_diameter_max:.1425738833},meters:{estimated_diameter_min:63.7609789875,estimated_diameter_max:142.5738833281},miles:{estimated_diameter_min:.0396192233,estimated_diameter_max:.0885912765},feet:{estimated_diameter_min:209.1895703015,estimated_diameter_max:467.7620993781}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-03",close_approach_date_full:"2023-Oct-03 06:12",epoch_date_close_approach:169631352e4,relative_velocity:{kilometers_per_second:"27.5534488509",kilometers_per_hour:"99192.4158630694",miles_per_hour:"61634.3097344722"},miss_distance:{astronomical:"0.468209982",lunar:"182.133682998",kilometers:"70043216.01993834",miles:"43522836.254055492"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/54131386?api_key=DEMO_KEY"},id:"54131386",neo_reference_id:"54131386",name:"(2021 EX3)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=54131386",absolute_magnitude_h:24.83,estimated_diameter:{kilometers:{estimated_diameter_min:.0287445144,estimated_diameter_max:.0642746882},meters:{estimated_diameter_min:28.7445144255,estimated_diameter_max:64.2746882356},miles:{estimated_diameter_min:.0178610077,estimated_diameter_max:.0399384273},feet:{estimated_diameter_min:94.3061527078,estimated_diameter_max:210.874968151}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-03",close_approach_date_full:"2023-Oct-03 19:12",epoch_date_close_approach:169636032e4,relative_velocity:{kilometers_per_second:"9.429916214",kilometers_per_hour:"33947.6983705489",miles_per_hour:"21093.7795791891"},miss_distance:{astronomical:"0.479086031",lunar:"186.364466059",kilometers:"71670249.78435397",miles:"44533828.154945986"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/54184284?api_key=DEMO_KEY"},id:"54184284",neo_reference_id:"54184284",name:"(2021 PF7)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=54184284",absolute_magnitude_h:27.81,estimated_diameter:{kilometers:{estimated_diameter_min:.0072871041,estimated_diameter_max:.0162944602},meters:{estimated_diameter_min:7.287104149,estimated_diameter_max:16.2944602362},miles:{estimated_diameter_min:.0045279952,estimated_diameter_max:.0101249051},feet:{estimated_diameter_min:23.9078227762,estimated_diameter_max:53.4595169215}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-03",close_approach_date_full:"2023-Oct-03 12:16",epoch_date_close_approach:169633536e4,relative_velocity:{kilometers_per_second:"5.6082164293",kilometers_per_hour:"20189.5791455947",miles_per_hour:"12545.0193307724"},miss_distance:{astronomical:"0.1962359719",lunar:"76.3357930691",kilometers:"29356483.413619853",miles:"18241272.9341578514"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/54291608?api_key=DEMO_KEY"},id:"54291608",neo_reference_id:"54291608",name:"(2022 OZ1)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=54291608",absolute_magnitude_h:23.57,estimated_diameter:{kilometers:{estimated_diameter_min:.0513517179,estimated_diameter_max:.1148259319},meters:{estimated_diameter_min:51.3517178663,estimated_diameter_max:114.8259319105},miles:{estimated_diameter_min:.0319084683,estimated_diameter_max:.0713495041},feet:{estimated_diameter_min:168.4767700445,estimated_diameter_max:376.7255104491}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-03",close_approach_date_full:"2023-Oct-03 09:18",epoch_date_close_approach:169632468e4,relative_velocity:{kilometers_per_second:"25.3443472275",kilometers_per_hour:"91239.6500188769",miles_per_hour:"56692.7703131182"},miss_distance:{astronomical:"0.481988127",lunar:"187.493381403",kilometers:"72104397.16448949",miles:"44803594.827715362"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/54354418?api_key=DEMO_KEY"},id:"54354418",neo_reference_id:"54354418",name:"(2023 GW2)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=54354418",absolute_magnitude_h:25.96,estimated_diameter:{kilometers:{estimated_diameter_min:.0170826395,estimated_diameter_max:.0381979432},meters:{estimated_diameter_min:17.0826395263,estimated_diameter_max:38.1979432159},miles:{estimated_diameter_min:.0106146568,estimated_diameter_max:.0237350942},feet:{estimated_diameter_min:56.0454070634,estimated_diameter_max:125.3213400205}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-03",close_approach_date_full:"2023-Oct-03 10:38",epoch_date_close_approach:169632948e4,relative_velocity:{kilometers_per_second:"9.1571509702",kilometers_per_hour:"32965.7434928194",miles_per_hour:"20483.6310053022"},miss_distance:{astronomical:"0.2003863555",lunar:"77.9502922895",kilometers:"29977371.959862785",miles:"18627075.186905033"},orbiting_body:"Earth"}],is_sentry_object:!1}],"2023-10-04":[{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/2518635?api_key=DEMO_KEY"},id:"2518635",neo_reference_id:"2518635",name:"518635 (2008 HO3)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=2518635",absolute_magnitude_h:18.19,estimated_diameter:{kilometers:{estimated_diameter_min:.6117232351,estimated_diameter_max:1.367854737},meters:{estimated_diameter_min:611.7232350672,estimated_diameter_max:1367.8547370263},miles:{estimated_diameter_min:.3801070783,estimated_diameter_max:.8499452658},feet:{estimated_diameter_min:2006.9660585378,estimated_diameter_max:4487.7125354254}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-04",close_approach_date_full:"2023-Oct-04 19:06",epoch_date_close_approach:169644636e4,relative_velocity:{kilometers_per_second:"13.9774266669",kilometers_per_hour:"50318.7360007702",miles_per_hour:"31266.1057111452"},miss_distance:{astronomical:"0.1296333519",lunar:"50.4273738891",kilometers:"19392873.325200453",miles:"12050172.7103461314"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/3648629?api_key=DEMO_KEY"},id:"3648629",neo_reference_id:"3648629",name:"(2013 SC20)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=3648629",absolute_magnitude_h:22.44,estimated_diameter:{kilometers:{estimated_diameter_min:.0864082036,estimated_diameter_max:.1932146172},meters:{estimated_diameter_min:86.408203645,estimated_diameter_max:193.214617164},miles:{estimated_diameter_min:.0536915519,estimated_diameter_max:.1200579599},feet:{estimated_diameter_min:283.4914908468,estimated_diameter_max:633.9062445763}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-04",close_approach_date_full:"2023-Oct-04 21:15",epoch_date_close_approach:16964541e5,relative_velocity:{kilometers_per_second:"9.9841750366",kilometers_per_hour:"35943.0301319363",miles_per_hour:"22333.6011394801"},miss_distance:{astronomical:"0.4158371501",lunar:"161.7606513889",kilometers:"62208351.921830287",miles:"38654477.4522884806"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/3730326?api_key=DEMO_KEY"},id:"3730326",neo_reference_id:"3730326",name:"(2015 TT178)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=3730326",absolute_magnitude_h:20.87,estimated_diameter:{kilometers:{estimated_diameter_min:.1780553292,estimated_diameter_max:.3981438198},meters:{estimated_diameter_min:178.0553291829,estimated_diameter_max:398.1438198091},miles:{estimated_diameter_min:.1106384179,estimated_diameter_max:.2473950235},feet:{estimated_diameter_min:584.1710461965,estimated_diameter_max:1306.2461697825}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-04",close_approach_date_full:"2023-Oct-04 16:18",epoch_date_close_approach:169643628e4,relative_velocity:{kilometers_per_second:"24.1584595237",kilometers_per_hour:"86970.4542853366",miles_per_hour:"54040.0581085748"},miss_distance:{astronomical:"0.4753289966",lunar:"184.9029796774",kilometers:"71108205.440597242",miles:"44184589.9941242596"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/3829483?api_key=DEMO_KEY"},id:"3829483",neo_reference_id:"3829483",name:"(2018 RT7)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=3829483",absolute_magnitude_h:23,estimated_diameter:{kilometers:{estimated_diameter_min:.0667659413,estimated_diameter_max:.1492931834},meters:{estimated_diameter_min:66.7659413495,estimated_diameter_max:149.2931834393},miles:{estimated_diameter_min:.0414864197,estimated_diameter_max:.0927664547},feet:{estimated_diameter_min:219.0483710172,estimated_diameter_max:489.807047955}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-04",close_approach_date_full:"2023-Oct-04 21:16",epoch_date_close_approach:169645416e4,relative_velocity:{kilometers_per_second:"9.5006130897",kilometers_per_hour:"34202.2071228738",miles_per_hour:"21251.9214203213"},miss_distance:{astronomical:"0.4119276221",lunar:"160.2398449969",kilometers:"61623494.860324927",miles:"38291064.1259689126"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/3841618?api_key=DEMO_KEY"},id:"3841618",neo_reference_id:"3841618",name:"(2019 HJ3)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=3841618",absolute_magnitude_h:24.3,estimated_diameter:{kilometers:{estimated_diameter_min:.0366906138,estimated_diameter_max:.0820427065},meters:{estimated_diameter_min:36.6906137531,estimated_diameter_max:82.0427064882},miles:{estimated_diameter_min:.0227984834,estimated_diameter_max:.0509789586},feet:{estimated_diameter_min:120.3760332259,estimated_diameter_max:269.1689931548}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-04",close_approach_date_full:"2023-Oct-04 12:02",epoch_date_close_approach:169642092e4,relative_velocity:{kilometers_per_second:"11.4340115767",kilometers_per_hour:"41162.4416759915",miles_per_hour:"25576.7404958404"},miss_distance:{astronomical:"0.3231547643",lunar:"125.7072033127",kilometers:"48343264.419632041",miles:"30039111.5782465258"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/54205444?api_key=DEMO_KEY"},id:"54205444",neo_reference_id:"54205444",name:"(2021 TD7)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=54205444",absolute_magnitude_h:26.66,estimated_diameter:{kilometers:{estimated_diameter_min:.0123752784,estimated_diameter_max:.0276719637},meters:{estimated_diameter_min:12.3752783658,estimated_diameter_max:27.6719636665},miles:{estimated_diameter_min:.0076896391,estimated_diameter_max:.0171945557},feet:{estimated_diameter_min:40.6013082738,estimated_diameter_max:90.7872852756}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-04",close_approach_date_full:"2023-Oct-04 11:57",epoch_date_close_approach:169642062e4,relative_velocity:{kilometers_per_second:"14.5500207327",kilometers_per_hour:"52380.0746375915",miles_per_hour:"32546.9413768968"},miss_distance:{astronomical:"0.0666464037",lunar:"25.9254510393",kilometers:"9970160.036680119",miles:"6195170.1729348822"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/54265773?api_key=DEMO_KEY"},id:"54265773",neo_reference_id:"54265773",name:"(2022 FX1)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=54265773",absolute_magnitude_h:25.78,estimated_diameter:{kilometers:{estimated_diameter_min:.0185590173,estimated_diameter_max:.0414992243},meters:{estimated_diameter_min:18.5590173004,estimated_diameter_max:41.4992242792},miles:{estimated_diameter_min:.0115320351,estimated_diameter_max:.0257864145},feet:{estimated_diameter_min:60.8891663197,estimated_diameter_max:136.1523149843}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-04",close_approach_date_full:"2023-Oct-04 08:25",epoch_date_close_approach:16964079e5,relative_velocity:{kilometers_per_second:"9.9213800173",kilometers_per_hour:"35716.9680621602",miles_per_hour:"22193.1349606239"},miss_distance:{astronomical:"0.0512387614",lunar:"19.9318781846",kilometers:"7665209.566878218",miles:"4762940.3643786884"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/54292217?api_key=DEMO_KEY"},id:"54292217",neo_reference_id:"54292217",name:"(2022 OC3)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=54292217",absolute_magnitude_h:28.37,estimated_diameter:{kilometers:{estimated_diameter_min:.0056306039,estimated_diameter_max:.0125904131},meters:{estimated_diameter_min:5.6306038975,estimated_diameter_max:12.5904130692},miles:{estimated_diameter_min:.003498694,estimated_diameter_max:.0078233176},feet:{estimated_diameter_min:18.473110491,estimated_diameter_max:41.3071308138}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-04",close_approach_date_full:"2023-Oct-04 12:40",epoch_date_close_approach:16964232e5,relative_velocity:{kilometers_per_second:"3.1754061142",kilometers_per_hour:"11431.4620109647",miles_per_hour:"7103.0659367575"},miss_distance:{astronomical:"0.0960587815",lunar:"37.3668660035",kilometers:"14370189.107195405",miles:"8929221.457710389"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/54312818?api_key=DEMO_KEY"},id:"54312818",neo_reference_id:"54312818",name:"(2022 SL49)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=54312818",absolute_magnitude_h:22.87,estimated_diameter:{kilometers:{estimated_diameter_min:.0708851033,estimated_diameter_max:.1585039096},meters:{estimated_diameter_min:70.885103303,estimated_diameter_max:158.5039095776},miles:{estimated_diameter_min:.0440459475,estimated_diameter_max:.0984897328},feet:{estimated_diameter_min:232.5626823206,estimated_diameter_max:520.0259666984}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-04",close_approach_date_full:"2023-Oct-04 04:23",epoch_date_close_approach:169639338e4,relative_velocity:{kilometers_per_second:"10.8579552702",kilometers_per_hour:"39088.6389725962",miles_per_hour:"24288.1601438334"},miss_distance:{astronomical:"0.3461188578",lunar:"134.6402356842",kilometers:"51778643.893712886",miles:"32173757.3985983868"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/54376554?api_key=DEMO_KEY"},id:"54376554",neo_reference_id:"54376554",name:"(2023 OJ6)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=54376554",absolute_magnitude_h:20.492,estimated_diameter:{kilometers:{estimated_diameter_min:.2119117201,estimated_diameter_max:.4738490113},meters:{estimated_diameter_min:211.9117200584,estimated_diameter_max:473.8490112795},miles:{estimated_diameter_min:.1316757974,estimated_diameter_max:.294436034},feet:{estimated_diameter_min:695.2484476365,estimated_diameter_max:1554.6227901664}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-04",close_approach_date_full:"2023-Oct-04 09:45",epoch_date_close_approach:16964127e5,relative_velocity:{kilometers_per_second:"4.9451762298",kilometers_per_hour:"17802.6344274336",miles_per_hour:"11061.8647085351"},miss_distance:{astronomical:"0.393790036",lunar:"153.184324004",kilometers:"58910150.61282332",miles:"36605070.191149016"},orbiting_body:"Earth"}],is_sentry_object:!1}],"2023-10-05":[{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/3607823?api_key=DEMO_KEY"},id:"3607823",neo_reference_id:"3607823",name:"(2012 QL14)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=3607823",absolute_magnitude_h:24.4,estimated_diameter:{kilometers:{estimated_diameter_min:.0350392641,estimated_diameter_max:.0783501764},meters:{estimated_diameter_min:35.0392641108,estimated_diameter_max:78.3501764334},miles:{estimated_diameter_min:.0217723826,estimated_diameter_max:.0486845275},feet:{estimated_diameter_min:114.9582192654,estimated_diameter_max:257.0543928497}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-05",close_approach_date_full:"2023-Oct-05 16:37",epoch_date_close_approach:169652382e4,relative_velocity:{kilometers_per_second:"15.385458218",kilometers_per_hour:"55387.6495847312",miles_per_hour:"34415.7314878015"},miss_distance:{astronomical:"0.1968690941",lunar:"76.5820776049",kilometers:"29451197.146189567",miles:"18300125.3185553446"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/3702706?api_key=DEMO_KEY"},id:"3702706",neo_reference_id:"3702706",name:"(2014 YS)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=3702706",absolute_magnitude_h:24.5,estimated_diameter:{kilometers:{estimated_diameter_min:.0334622374,estimated_diameter_max:.0748238376},meters:{estimated_diameter_min:33.4622374455,estimated_diameter_max:74.8238376074},miles:{estimated_diameter_min:.0207924639,estimated_diameter_max:.0464933628},feet:{estimated_diameter_min:109.7842471007,estimated_diameter_max:245.4850393757}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-05",close_approach_date_full:"2023-Oct-05 06:22",epoch_date_close_approach:169648692e4,relative_velocity:{kilometers_per_second:"7.777258916",kilometers_per_hour:"27998.1320976973",miles_per_hour:"17396.9504692609"},miss_distance:{astronomical:"0.3932170429",lunar:"152.9614296881",kilometers:"58824432.065538623",miles:"36551807.1557060774"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/3774691?api_key=DEMO_KEY"},id:"3774691",neo_reference_id:"3774691",name:"(2017 KZ2)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=3774691",absolute_magnitude_h:25,estimated_diameter:{kilometers:{estimated_diameter_min:.02658,estimated_diameter_max:.0594346868},meters:{estimated_diameter_min:26.58,estimated_diameter_max:59.4346868419},miles:{estimated_diameter_min:.0165160412,estimated_diameter_max:.0369309908},feet:{estimated_diameter_min:87.2047272,estimated_diameter_max:194.9956979785}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-05",close_approach_date_full:"2023-Oct-05 20:32",epoch_date_close_approach:169653792e4,relative_velocity:{kilometers_per_second:"22.5998301561",kilometers_per_hour:"81359.3885619841",miles_per_hour:"50553.5600761951"},miss_distance:{astronomical:"0.3951136054",lunar:"153.6991925006",kilometers:"59108153.775860498",miles:"36728103.6515229524"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/3785769?api_key=DEMO_KEY"},id:"3785769",neo_reference_id:"3785769",name:"(2017 TJ4)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=3785769",absolute_magnitude_h:25.2,estimated_diameter:{kilometers:{estimated_diameter_min:.0242412481,estimated_diameter_max:.0542050786},meters:{estimated_diameter_min:24.2412481101,estimated_diameter_max:54.2050786336},miles:{estimated_diameter_min:.0150628086,estimated_diameter_max:.0336814639},feet:{estimated_diameter_min:79.5316564495,estimated_diameter_max:177.8381901842}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-05",close_approach_date_full:"2023-Oct-05 14:08",epoch_date_close_approach:169651488e4,relative_velocity:{kilometers_per_second:"14.9822832684",kilometers_per_hour:"53936.2197661763",miles_per_hour:"33513.8694430444"},miss_distance:{astronomical:"0.2170908007",lunar:"84.4483214723",kilometers:"32476321.381314509",miles:"20179850.3542538642"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/3795062?api_key=DEMO_KEY"},id:"3795062",neo_reference_id:"3795062",name:"(2017 YX4)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=3795062",absolute_magnitude_h:23.6,estimated_diameter:{kilometers:{estimated_diameter_min:.0506471459,estimated_diameter_max:.1132504611},meters:{estimated_diameter_min:50.6471458835,estimated_diameter_max:113.2504610618},miles:{estimated_diameter_min:.0314706677,estimated_diameter_max:.0703705522},feet:{estimated_diameter_min:166.1651821003,estimated_diameter_max:371.5566426699}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-05",close_approach_date_full:"2023-Oct-05 16:17",epoch_date_close_approach:169652262e4,relative_velocity:{kilometers_per_second:"7.9697029719",kilometers_per_hour:"28690.9306987609",miles_per_hour:"17827.4285777939"},miss_distance:{astronomical:"0.4500125476",lunar:"175.0548810164",kilometers:"67320918.594233612",miles:"41831279.0722713656"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/3840696?api_key=DEMO_KEY"},id:"3840696",neo_reference_id:"3840696",name:"(2019 FV)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=3840696",absolute_magnitude_h:24,estimated_diameter:{kilometers:{estimated_diameter_min:.0421264611,estimated_diameter_max:.0941976306},meters:{estimated_diameter_min:42.1264610556,estimated_diameter_max:94.1976305719},miles:{estimated_diameter_min:.0261761612,estimated_diameter_max:.0585316759},feet:{estimated_diameter_min:138.2101784897,estimated_diameter_max:309.0473542854}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-05",close_approach_date_full:"2023-Oct-05 04:34",epoch_date_close_approach:169648044e4,relative_velocity:{kilometers_per_second:"8.1689039031",kilometers_per_hour:"29408.0540511395",miles_per_hour:"18273.0211408316"},miss_distance:{astronomical:"0.3672671549",lunar:"142.8669232561",kilometers:"54942384.094000063",miles:"34139614.4010563494"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/3989456?api_key=DEMO_KEY"},id:"3989456",neo_reference_id:"3989456",name:"(2020 CW)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=3989456",absolute_magnitude_h:32.56,estimated_diameter:{kilometers:{estimated_diameter_min:.0008176265,estimated_diameter_max:.0018282685},meters:{estimated_diameter_min:.8176265334,estimated_diameter_max:1.8282685088},miles:{estimated_diameter_min:.0005080494,estimated_diameter_max:.001136033},feet:{estimated_diameter_min:2.6825018357,estimated_diameter_max:5.9982564544}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-05",close_approach_date_full:"2023-Oct-05 21:06",epoch_date_close_approach:169653996e4,relative_velocity:{kilometers_per_second:"19.3498094004",kilometers_per_hour:"69659.3138414285",miles_per_hour:"43283.5886477476"},miss_distance:{astronomical:"0.093192451",lunar:"36.251863439",kilometers:"13941392.16967937",miles:"8662779.395820506"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/54087658?api_key=DEMO_KEY"},id:"54087658",neo_reference_id:"54087658",name:"(2020 VW1)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=54087658",absolute_magnitude_h:28.3,estimated_diameter:{kilometers:{estimated_diameter_min:.0058150704,estimated_diameter_max:.0130028927},meters:{estimated_diameter_min:5.8150703965,estimated_diameter_max:13.0028927004},miles:{estimated_diameter_min:.0036133161,estimated_diameter_max:.0080796204},feet:{estimated_diameter_min:19.0783155595,estimated_diameter_max:42.6604104873}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-05",close_approach_date_full:"2023-Oct-05 15:58",epoch_date_close_approach:169652148e4,relative_velocity:{kilometers_per_second:"17.0431696859",kilometers_per_hour:"61355.4108691399",miles_per_hour:"38123.8662703275"},miss_distance:{astronomical:"0.4365946209",lunar:"169.8353075301",kilometers:"65313625.340097483",miles:"40584004.8810239454"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/54088822?api_key=DEMO_KEY"},id:"54088822",neo_reference_id:"54088822",name:"(2020 WY)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=54088822",absolute_magnitude_h:26.2,estimated_diameter:{kilometers:{estimated_diameter_min:.0152951935,estimated_diameter_max:.0342010925},meters:{estimated_diameter_min:15.2951935344,estimated_diameter_max:34.201092472},miles:{estimated_diameter_min:.0095039897,estimated_diameter_max:.021251567},feet:{estimated_diameter_min:50.1810827555,estimated_diameter_max:112.2083122258}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-05",close_approach_date_full:"2023-Oct-05 19:54",epoch_date_close_approach:169653564e4,relative_velocity:{kilometers_per_second:"15.615400434",kilometers_per_hour:"56215.4415623521",miles_per_hour:"34930.0892307848"},miss_distance:{astronomical:"0.4856873429",lunar:"188.9323763881",kilometers:"72657791.983799623",miles:"45147458.4232678774"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/54186663?api_key=DEMO_KEY"},id:"54186663",neo_reference_id:"54186663",name:"(2021 PN26)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=54186663",absolute_magnitude_h:20.31,estimated_diameter:{kilometers:{estimated_diameter_min:.2304384666,estimated_diameter_max:.5152760759},meters:{estimated_diameter_min:230.4384665765,estimated_diameter_max:515.2760758959},miles:{estimated_diameter_min:.1431877804,estimated_diameter_max:.3201776106},feet:{estimated_diameter_min:756.031738683,estimated_diameter_max:1690.5383608424}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-05",close_approach_date_full:"2023-Oct-05 12:48",epoch_date_close_approach:169651008e4,relative_velocity:{kilometers_per_second:"22.9654940738",kilometers_per_hour:"82675.7786656066",miles_per_hour:"51371.5136936376"},miss_distance:{astronomical:"0.416443319",lunar:"161.996451091",kilometers:"62299033.49813053",miles:"38710824.370960114"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/54202334?api_key=DEMO_KEY"},id:"54202334",neo_reference_id:"54202334",name:"(2021 TF1)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=54202334",absolute_magnitude_h:25.91,estimated_diameter:{kilometers:{estimated_diameter_min:.0174805453,estimated_diameter_max:.0390876876},meters:{estimated_diameter_min:17.4805453169,estimated_diameter_max:39.0876876124},miles:{estimated_diameter_min:.0108619039,estimated_diameter_max:.0242879555},feet:{estimated_diameter_min:57.3508722975,estimated_diameter_max:128.2404490262}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-05",close_approach_date_full:"2023-Oct-05 01:42",epoch_date_close_approach:169647012e4,relative_velocity:{kilometers_per_second:"13.155003498",kilometers_per_hour:"47358.0125928979",miles_per_hour:"29426.427324737"},miss_distance:{astronomical:"0.2172383543",lunar:"84.5057198227",kilometers:"32498395.085585341",miles:"20193566.3180700658"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/54231259?api_key=DEMO_KEY"},id:"54231259",neo_reference_id:"54231259",name:"(2021 YB)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=54231259",absolute_magnitude_h:27.52,estimated_diameter:{kilometers:{estimated_diameter_min:.0083282735,estimated_diameter_max:.0186225856},meters:{estimated_diameter_min:8.3282734552,estimated_diameter_max:18.6225855811},miles:{estimated_diameter_min:.0051749476,estimated_diameter_max:.0115715346},feet:{estimated_diameter_min:27.3237326829,estimated_diameter_max:61.0977236779}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-05",close_approach_date_full:"2023-Oct-05 04:53",epoch_date_close_approach:169648158e4,relative_velocity:{kilometers_per_second:"4.6780015313",kilometers_per_hour:"16840.8055127065",miles_per_hour:"10464.2216253814"},miss_distance:{astronomical:"0.2054184251",lunar:"79.9077673639",kilometers:"30730158.853714537",miles:"19094835.2724211306"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/54308040?api_key=DEMO_KEY"},id:"54308040",neo_reference_id:"54308040",name:"(2022 SY10)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=54308040",absolute_magnitude_h:26.87,estimated_diameter:{kilometers:{estimated_diameter_min:.0112345318,estimated_diameter_max:.0251211767},meters:{estimated_diameter_min:11.2345317672,estimated_diameter_max:25.1211767268},miles:{estimated_diameter_min:.0069808122,estimated_diameter_max:.0156095707},feet:{estimated_diameter_min:36.858701203,estimated_diameter_max:82.4185614523}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-05",close_approach_date_full:"2023-Oct-05 04:30",epoch_date_close_approach:16964802e5,relative_velocity:{kilometers_per_second:"18.1123644957",kilometers_per_hour:"65204.5121845042",miles_per_hour:"40515.5481404215"},miss_distance:{astronomical:"0.492218468",lunar:"191.472984052",kilometers:"73634834.38746316",miles:"45754564.421025208"},orbiting_body:"Earth"}],is_sentry_object:!1}],"2023-10-06":[{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/3582137?api_key=DEMO_KEY"},id:"3582137",neo_reference_id:"3582137",name:"(2011 UG20)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=3582137",absolute_magnitude_h:21.4,estimated_diameter:{kilometers:{estimated_diameter_min:.1394938229,estimated_diameter_max:.3119176705},meters:{estimated_diameter_min:139.4938229344,estimated_diameter_max:311.9176705226},miles:{estimated_diameter_min:.0866774163,estimated_diameter_max:.1938165949},feet:{estimated_diameter_min:457.6569140361,estimated_diameter_max:1023.3519701574}},is_potentially_hazardous_asteroid:!0,close_approach_data:[{close_approach_date:"2023-10-06",close_approach_date_full:"2023-Oct-06 09:56",epoch_date_close_approach:169658616e4,relative_velocity:{kilometers_per_second:"32.6638893759",kilometers_per_hour:"117590.0017531424",miles_per_hour:"73065.8541448901"},miss_distance:{astronomical:"0.3008400952",lunar:"117.0267970328",kilometers:"45005037.452517224",miles:"27964833.5264327312"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/3604990?api_key=DEMO_KEY"},id:"3604990",neo_reference_id:"3604990",name:"(2012 KP24)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=3604990",absolute_magnitude_h:26.45,estimated_diameter:{kilometers:{estimated_diameter_min:.0136318556,estimated_diameter_max:.0304817558},meters:{estimated_diameter_min:13.6318555865,estimated_diameter_max:30.4817557509},miles:{estimated_diameter_min:.0084704397,estimated_diameter_max:.0189404791},feet:{estimated_diameter_min:44.7239370824,estimated_diameter_max:100.0057635376}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-06",close_approach_date_full:"2023-Oct-06 02:22",epoch_date_close_approach:169655892e4,relative_velocity:{kilometers_per_second:"8.1043348722",kilometers_per_hour:"29175.6055399241",miles_per_hour:"18128.5866756268"},miss_distance:{astronomical:"0.4544937233",lunar:"176.7980583637",kilometers:"67991292.934049371",miles:"42247830.3712924798"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/3782014?api_key=DEMO_KEY"},id:"3782014",neo_reference_id:"3782014",name:"(2017 SX20)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=3782014",absolute_magnitude_h:24.1,estimated_diameter:{kilometers:{estimated_diameter_min:.040230458,estimated_diameter_max:.0899580388},meters:{estimated_diameter_min:40.2304579834,estimated_diameter_max:89.9580388169},miles:{estimated_diameter_min:.0249980399,estimated_diameter_max:.0558973165},feet:{estimated_diameter_min:131.9896957704,estimated_diameter_max:295.1379320721}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-06",close_approach_date_full:"2023-Oct-06 01:57",epoch_date_close_approach:169655742e4,relative_velocity:{kilometers_per_second:"14.4719614874",kilometers_per_hour:"52099.0613544863",miles_per_hour:"32372.3306510695"},miss_distance:{astronomical:"0.2948341172",lunar:"114.6904715908",kilometers:"44106555.936450364",miles:"27406543.0006244632"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/54016296?api_key=DEMO_KEY"},id:"54016296",neo_reference_id:"54016296",name:"(2020 FS2)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=54016296",absolute_magnitude_h:24.3,estimated_diameter:{kilometers:{estimated_diameter_min:.0366906138,estimated_diameter_max:.0820427065},meters:{estimated_diameter_min:36.6906137531,estimated_diameter_max:82.0427064882},miles:{estimated_diameter_min:.0227984834,estimated_diameter_max:.0509789586},feet:{estimated_diameter_min:120.3760332259,estimated_diameter_max:269.1689931548}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-06",close_approach_date_full:"2023-Oct-06 21:36",epoch_date_close_approach:169662816e4,relative_velocity:{kilometers_per_second:"9.3039207457",kilometers_per_hour:"33494.1146844843",miles_per_hour:"20811.9403160341"},miss_distance:{astronomical:"0.1238622289",lunar:"48.1824070421",kilometers:"18529525.616892443",miles:"11513713.3203559934"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/54292683?api_key=DEMO_KEY"},id:"54292683",neo_reference_id:"54292683",name:"(2022 OB5)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=54292683",absolute_magnitude_h:28.93,estimated_diameter:{kilometers:{estimated_diameter_min:.0043506583,estimated_diameter_max:.0097283677},meters:{estimated_diameter_min:4.350658314,estimated_diameter_max:9.7283677369},miles:{estimated_diameter_min:.0027033729,estimated_diameter_max:.0060449256},feet:{estimated_diameter_min:14.2738138228,estimated_diameter_max:31.9172180059}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-06",close_approach_date_full:"2023-Oct-06 19:02",epoch_date_close_approach:169661892e4,relative_velocity:{kilometers_per_second:"1.3658159469",kilometers_per_hour:"4916.9374089582",miles_per_hour:"3055.193691694"},miss_distance:{astronomical:"0.0526926802",lunar:"20.4974525978",kilometers:"7882712.722511174",miles:"4898090.5582912412"},orbiting_body:"Earth"}],is_sentry_object:!1}],"2023-10-07":[{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/2162120?api_key=DEMO_KEY"},id:"2162120",neo_reference_id:"2162120",name:"162120 (1998 SH36)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=2162120",absolute_magnitude_h:20.72,estimated_diameter:{kilometers:{estimated_diameter_min:.1907897226,estimated_diameter_max:.4266187892},meters:{estimated_diameter_min:190.7897226199,estimated_diameter_max:426.6187891865},miles:{estimated_diameter_min:.1185512007,estimated_diameter_max:.2650885437},feet:{estimated_diameter_min:625.9505535604,estimated_diameter_max:1399.6679883146}},is_potentially_hazardous_asteroid:!0,close_approach_data:[{close_approach_date:"2023-10-07",close_approach_date_full:"2023-Oct-07 08:31",epoch_date_close_approach:169666746e4,relative_velocity:{kilometers_per_second:"21.9123044542",kilometers_per_hour:"78884.2960351582",miles_per_hour:"49015.6338336237"},miss_distance:{astronomical:"0.1416560712",lunar:"55.1042116968",kilometers:"21191446.524088344",miles:"13167754.2731893872"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/2162162?api_key=DEMO_KEY"},id:"2162162",neo_reference_id:"2162162",name:"162162 (1999 DB7)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=2162162",absolute_magnitude_h:20.04,estimated_diameter:{kilometers:{estimated_diameter_min:.2609486033,estimated_diameter_max:.5834988155},meters:{estimated_diameter_min:260.9486032547,estimated_diameter_max:583.4988155112},miles:{estimated_diameter_min:.1621458946,estimated_diameter_max:.3625692425},feet:{estimated_diameter_min:856.1306155022,estimated_diameter_max:1914.3662538816}},is_potentially_hazardous_asteroid:!0,close_approach_data:[{close_approach_date:"2023-10-07",close_approach_date_full:"2023-Oct-07 14:13",epoch_date_close_approach:169668798e4,relative_velocity:{kilometers_per_second:"8.457018916",kilometers_per_hour:"30445.2680974651",miles_per_hour:"18917.5056131166"},miss_distance:{astronomical:"0.4595140309",lunar:"178.7509580201",kilometers:"68742320.257754183",miles:"42714497.1106184054"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/2503871?api_key=DEMO_KEY"},id:"2503871",neo_reference_id:"2503871",name:"503871 (2000 SL)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=2503871",absolute_magnitude_h:18.26,estimated_diameter:{kilometers:{estimated_diameter_min:.5923180627,estimated_diameter_max:1.3244634524},meters:{estimated_diameter_min:592.318062676,estimated_diameter_max:1324.4634524446},miles:{estimated_diameter_min:.3680492669,estimated_diameter_max:.8229831799},feet:{estimated_diameter_min:1943.3007927501,estimated_diameter_max:4345.3526733184}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-07",close_approach_date_full:"2023-Oct-07 05:19",epoch_date_close_approach:169665594e4,relative_velocity:{kilometers_per_second:"19.0871949574",kilometers_per_hour:"68713.9018464658",miles_per_hour:"42696.1464000998"},miss_distance:{astronomical:"0.4594925156",lunar:"178.7425885684",kilometers:"68739101.614701772",miles:"42712497.1385655736"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/3293790?api_key=DEMO_KEY"},id:"3293790",neo_reference_id:"3293790",name:"(2005 TQ45)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=3293790",absolute_magnitude_h:25.6,estimated_diameter:{kilometers:{estimated_diameter_min:.0201629919,estimated_diameter_max:.0450858206},meters:{estimated_diameter_min:20.1629919443,estimated_diameter_max:45.0858206172},miles:{estimated_diameter_min:.0125286985,estimated_diameter_max:.0280150214},feet:{estimated_diameter_min:66.1515504905,estimated_diameter_max:147.9193637137}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-07",close_approach_date_full:"2023-Oct-07 10:07",epoch_date_close_approach:169667322e4,relative_velocity:{kilometers_per_second:"17.8554680215",kilometers_per_hour:"64279.6848773327",miles_per_hour:"39940.8964172515"},miss_distance:{astronomical:"0.3215947164",lunar:"125.1003446796",kilometers:"48109884.576694068",miles:"29894096.0683034184"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/3645193?api_key=DEMO_KEY"},id:"3645193",neo_reference_id:"3645193",name:"(2013 OY3)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=3645193",absolute_magnitude_h:24.8,estimated_diameter:{kilometers:{estimated_diameter_min:.0291443905,estimated_diameter_max:.0651688382},meters:{estimated_diameter_min:29.1443904535,estimated_diameter_max:65.1688382168},miles:{estimated_diameter_min:.018109479,estimated_diameter_max:.0404940262},feet:{estimated_diameter_min:95.6180819754,estimated_diameter_max:213.8085311752}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-07",close_approach_date_full:"2023-Oct-07 03:49",epoch_date_close_approach:169665054e4,relative_velocity:{kilometers_per_second:"12.0666062689",kilometers_per_hour:"43439.7825681304",miles_per_hour:"26991.7915629586"},miss_distance:{astronomical:"0.1254134016",lunar:"48.7858132224",kilometers:"18761577.748814592",miles:"11657903.8289296896"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/3742876?api_key=DEMO_KEY"},id:"3742876",neo_reference_id:"3742876",name:"(2016 CF137)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=3742876",absolute_magnitude_h:25.6,estimated_diameter:{kilometers:{estimated_diameter_min:.0201629919,estimated_diameter_max:.0450858206},meters:{estimated_diameter_min:20.1629919443,estimated_diameter_max:45.0858206172},miles:{estimated_diameter_min:.0125286985,estimated_diameter_max:.0280150214},feet:{estimated_diameter_min:66.1515504905,estimated_diameter_max:147.9193637137}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-07",close_approach_date_full:"2023-Oct-07 01:16",epoch_date_close_approach:169664136e4,relative_velocity:{kilometers_per_second:"7.465551692",kilometers_per_hour:"26875.9860912178",miles_per_hour:"16699.6925798459"},miss_distance:{astronomical:"0.1959819107",lunar:"76.2369632623",kilometers:"29318476.399250209",miles:"18217656.4705385242"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/3844011?api_key=DEMO_KEY"},id:"3844011",neo_reference_id:"3844011",name:"(2019 SS2)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=3844011",absolute_magnitude_h:30.7,estimated_diameter:{kilometers:{estimated_diameter_min:.0019255508,estimated_diameter_max:.0043056624},meters:{estimated_diameter_min:1.9255507819,estimated_diameter_max:4.3056624424},miles:{estimated_diameter_min:.0011964814,estimated_diameter_max:.0026754138},feet:{estimated_diameter_min:6.3174240272,estimated_diameter_max:14.1261895676}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-07",close_approach_date_full:"2023-Oct-07 01:25",epoch_date_close_approach:16966419e5,relative_velocity:{kilometers_per_second:"20.2248856103",kilometers_per_hour:"72809.5881971171",miles_per_hour:"45241.0466217031"},miss_distance:{astronomical:"0.3905467257",lunar:"151.9226762973",kilometers:"58424958.300194259",miles:"36303585.6681044142"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/3869331?api_key=DEMO_KEY"},id:"3869331",neo_reference_id:"3869331",name:"(2019 SB6)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=3869331",absolute_magnitude_h:26.8,estimated_diameter:{kilometers:{estimated_diameter_min:.0116025908,estimated_diameter_max:.0259441818},meters:{estimated_diameter_min:11.6025908209,estimated_diameter_max:25.9441817907},miles:{estimated_diameter_min:.0072095135,estimated_diameter_max:.0161209622},feet:{estimated_diameter_min:38.066244069,estimated_diameter_max:85.1187093863}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-07",close_approach_date_full:"2023-Oct-07 09:21",epoch_date_close_approach:169667046e4,relative_velocity:{kilometers_per_second:"5.7384272437",kilometers_per_hour:"20658.3380773169",miles_per_hour:"12836.2879014306"},miss_distance:{astronomical:"0.1099152748",lunar:"42.7570418972",kilometers:"16443090.990544676",miles:"10217262.9607454888"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/3872637?api_key=DEMO_KEY"},id:"3872637",neo_reference_id:"3872637",name:"(2019 SL8)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=3872637",absolute_magnitude_h:25.9,estimated_diameter:{kilometers:{estimated_diameter_min:.0175612318,estimated_diameter_max:.0392681082},meters:{estimated_diameter_min:17.561231848,estimated_diameter_max:39.2681081809},miles:{estimated_diameter_min:.0109120402,estimated_diameter_max:.0244000636},feet:{estimated_diameter_min:57.6155918963,estimated_diameter_max:128.8323800441}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-07",close_approach_date_full:"2023-Oct-07 00:07",epoch_date_close_approach:169663722e4,relative_velocity:{kilometers_per_second:"11.5529284927",kilometers_per_hour:"41590.5425737272",miles_per_hour:"25842.7457453251"},miss_distance:{astronomical:"0.0730372473",lunar:"28.4114891997",kilometers:"10926216.626743251",miles:"6789236.1907928238"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/54087855?api_key=DEMO_KEY"},id:"54087855",neo_reference_id:"54087855",name:"(2020 VU5)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=54087855",absolute_magnitude_h:27.4,estimated_diameter:{kilometers:{estimated_diameter_min:.0088014652,estimated_diameter_max:.0196806745},meters:{estimated_diameter_min:8.801465209,estimated_diameter_max:19.6806745089},miles:{estimated_diameter_min:.0054689752,estimated_diameter_max:.0122290004},feet:{estimated_diameter_min:28.8761991163,estimated_diameter_max:64.5691441559}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-07",close_approach_date_full:"2023-Oct-07 14:24",epoch_date_close_approach:169668864e4,relative_velocity:{kilometers_per_second:"7.3537612664",kilometers_per_hour:"26473.5405589816",miles_per_hour:"16449.6285767739"},miss_distance:{astronomical:"0.1032656718",lunar:"40.1703463302",kilometers:"15448324.545399066",miles:"9599143.7543004708"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/54169406?api_key=DEMO_KEY"},id:"54169406",neo_reference_id:"54169406",name:"(2021 NQ5)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=54169406",absolute_magnitude_h:21.2,estimated_diameter:{kilometers:{estimated_diameter_min:.1529519353,estimated_diameter_max:.3420109247},meters:{estimated_diameter_min:152.9519353442,estimated_diameter_max:342.0109247198},miles:{estimated_diameter_min:.095039897,estimated_diameter_max:.2125156703},feet:{estimated_diameter_min:501.8108275547,estimated_diameter_max:1122.0831222578}},is_potentially_hazardous_asteroid:!0,close_approach_data:[{close_approach_date:"2023-10-07",close_approach_date_full:"2023-Oct-07 22:58",epoch_date_close_approach:169671948e4,relative_velocity:{kilometers_per_second:"9.2647085264",kilometers_per_hour:"33352.9506951528",miles_per_hour:"20724.2265027742"},miss_distance:{astronomical:"0.1281802593",lunar:"49.8621208677",kilometers:"19175493.767327691",miles:"11915099.3165204958"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/54208043?api_key=DEMO_KEY"},id:"54208043",neo_reference_id:"54208043",name:"(2021 TS10)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=54208043",absolute_magnitude_h:25.58,estimated_diameter:{kilometers:{estimated_diameter_min:.0203495578,estimated_diameter_max:.0455029946},meters:{estimated_diameter_min:20.3495578117,estimated_diameter_max:45.502994579},miles:{estimated_diameter_min:.0126446251,estimated_diameter_max:.0282742412},feet:{estimated_diameter_min:66.7636432509,estimated_diameter_max:149.2880447347}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-07",close_approach_date_full:"2023-Oct-07 20:49",epoch_date_close_approach:169671174e4,relative_velocity:{kilometers_per_second:"13.9558963399",kilometers_per_hour:"50241.226823662",miles_per_hour:"31217.944522736"},miss_distance:{astronomical:"0.3739510789",lunar:"145.4669696921",kilometers:"55942284.887641943",miles:"34760923.9437190934"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/54312823?api_key=DEMO_KEY"},id:"54312823",neo_reference_id:"54312823",name:"(2022 TD)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=54312823",absolute_magnitude_h:27.77,estimated_diameter:{kilometers:{estimated_diameter_min:.0074225815,estimated_diameter_max:.0165973969},meters:{estimated_diameter_min:7.42258153,estimated_diameter_max:16.5973968696},miles:{estimated_diameter_min:.0046121769,estimated_diameter_max:.0103131411},feet:{estimated_diameter_min:24.3523023869,estimated_diameter_max:54.4534035458}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-07",close_approach_date_full:"2023-Oct-07 00:17",epoch_date_close_approach:169663782e4,relative_velocity:{kilometers_per_second:"9.4008831737",kilometers_per_hour:"33843.1794253792",miles_per_hour:"21028.8355712863"},miss_distance:{astronomical:"0.0228353761",lunar:"8.8829613029",kilometers:"3416123.625208907",miles:"2122680.7906886366"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/54335221?api_key=DEMO_KEY"},id:"54335221",neo_reference_id:"54335221",name:"(2022 YL)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=54335221",absolute_magnitude_h:26.54,estimated_diameter:{kilometers:{estimated_diameter_min:.0130784109,estimated_diameter_max:.0292442157},meters:{estimated_diameter_min:13.0784108584,estimated_diameter_max:29.2442157171},miles:{estimated_diameter_min:.0081265452,estimated_diameter_max:.0181715076},feet:{estimated_diameter_min:42.9081734807,estimated_diameter_max:95.9455926932}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-07",close_approach_date_full:"2023-Oct-07 14:14",epoch_date_close_approach:169668804e4,relative_velocity:{kilometers_per_second:"5.9601888903",kilometers_per_hour:"21456.6800051366",miles_per_hour:"13332.3465287472"},miss_distance:{astronomical:"0.2591173451",lunar:"100.7966472439",kilometers:"38763402.907014937",miles:"24086461.6623506506"},orbiting_body:"Earth"}],is_sentry_object:!1},{links:{self:"http://api.nasa.gov/neo/rest/v1/neo/54356387?api_key=DEMO_KEY"},id:"54356387",neo_reference_id:"54356387",name:"(2023 HH4)",nasa_jpl_url:"http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=54356387",absolute_magnitude_h:21.99,estimated_diameter:{kilometers:{estimated_diameter_min:.1063053145,estimated_diameter_max:.2377059096},meters:{estimated_diameter_min:106.3053144865,estimated_diameter_max:237.7059095613},miles:{estimated_diameter_min:.0660550396,estimated_diameter_max:.1477035587},feet:{estimated_diameter_min:348.7707279799,estimated_diameter_max:779.8750563251}},is_potentially_hazardous_asteroid:!1,close_approach_data:[{close_approach_date:"2023-10-07",close_approach_date_full:"2023-Oct-07 12:56",epoch_date_close_approach:169668336e4,relative_velocity:{kilometers_per_second:"12.6201638832",kilometers_per_hour:"45432.5899794336",miles_per_hour:"28230.0445902764"},miss_distance:{astronomical:"0.463435326",lunar:"180.276341814",kilometers:"69328937.65235562",miles:"43079004.257202756"},orbiting_body:"Earth"}],is_sentry_object:!1}]}},s=_;console.log(s.near_earth_objects);var m=[],r=[],d=[new e.Object3D,new e.Object3D,new e.Object3D,new e.Object3D,new e.Object3D,new e.Object3D,new e.Object3D,new e.Object3D];for(var o in s.near_earth_objects){for(var l=[],n=[],p=0;p<s.near_earth_objects[o].length;p++){var c=(new e.TextureLoader).load("./asteroid.jpg"),h=.05*s.near_earth_objects[o][p].estimated_diameter.kilometers.estimated_diameter_max;h>.05?h=.05:h<.01&&(h=.01),h=h.toFixed(2);var u=new e.SphereGeometry(h,32,32),b=new e.MeshBasicMaterial({map:c}),k=new e.Mesh(u,b),g=C(),y=g.x,v=g.y,f=g.z;k.position.set(y,v,f),l.push(k),console.log(),n.push(s.near_earth_objects[o][p])}m.push(l),r.push(n),n=[],l=[]}var x,E,j,O,M,D=0,z=0,Y=null;document.getElementById("right-arrow-btn").addEventListener("click",function(){Y&&(m[D][z].remove(Y),Y=null),m[D].length-1>z?z++:(z=0,D++),A(),N(),Q()}),document.getElementById("left-arrow-btn").addEventListener("click",function(){Y&&(m[D][z].remove(Y),Y=null),z>0?z--:D>0?(z=m[D-1].length-1,D--):(D=m.length-1,z=m[D].length-1),A(),N(),Q()});var K=new e.SphereGeometry(.05,32,32),w=new e.MeshBasicMaterial({color:65280}),B=new e.Object3D,I="rgb(255,0,0)",S=1,L=document.getElementById("canvas-area");function T(){E=new e.Scene,(x=new e.PerspectiveCamera(75,window.innerWidth/window.innerHeight,.1,1e3)).position.z=5,(j=new e.WebGLRenderer).setSize(window.innerWidth,window.innerHeight),document.body.appendChild(j.domElement),L.appendChild(j.domElement);var t=(new e.TextureLoader).load("./texture.jpg"),a=new e.SphereGeometry(1.5,32,32),i=new e.MeshBasicMaterial({map:t});O=new e.Mesh(a,i);var _=new e.Mesh(new e.SphereGeometry(1.5,32,32),new e.MeshBasicMaterial({color:"rgba(0, 152, 190, 0.6)",side:e.BackSide}));_.material.opacity=.1,_.material.transparent=!0,_.scale.set(1.1,1.1,1.1),O.add(_);var s=new e.Mesh(new e.SphereGeometry(1.5,32,32),new e.MeshBasicMaterial({color:"#007c9b",side:e.BackSide}));s.material.opacity=.15,s.material.transparent=!0,s.scale.set(1.05,1.05,1.05),O.add(s);var r=new e.Mesh(new e.SphereGeometry(1.5,32,32),new e.MeshBasicMaterial({color:"#93dbed",side:e.BackSide}));r.material.opacity=.3,r.material.transparent=!0,r.scale.set(1.025,1.025,1.025),O.add(r);var o=new e.Mesh(new e.SphereGeometry(1.5,32,32),new e.MeshBasicMaterial({color:"white",side:e.BackSide}));o.material.opacity=1,o.material.transparent=!0,o.scale.set(1.005,1.005,1.005),O.add(o),E.add(O);var l=(new e.TextureLoader).load("./moon.jpg"),n=new e.SphereGeometry(.18,32,32),p=new e.MeshBasicMaterial({map:l});M=new e.Mesh(n,p),O.add(M),M.position.set(3,0,0),B.add(M),E.add(B);for(var c=0;c<m.length;c++){for(var h=0;h<m[c].length;h++)d[c].add(m[c][h]);E.add(d[c])}}var H=new e.Vector3(0,0,10),F=new e.Vector3(0,0,0),P=.1;function W(){requestAnimationFrame(W),O.rotation.y+=.002*S,B.rotation.y+=5e-4*S,d[0].rotation.y+=.003*S,d[1].rotation.y-=.003*S,d[2].rotation.x+=.004*S,d[3].rotation.x-=.003*S,d[4].rotation.z+=.003*S,d[5].rotation.z-=.003*S,d[6].rotation.z+=.005*S,d[7].rotation.y+=.004*S,j.render(E,x)}function G(){x.aspect=window.innerWidth/window.innerHeight,x.updateProjectionMatrix(),j.setSize(window.innerWidth,window.innerHeight)}window.addEventListener("resize",G),T(),W();var V=new t.OrbitControls(x,j.domElement);function C(){var e=Math.random()*Math.PI*2,t=Math.random()*Math.PI;return{x:3*Math.sin(t)*Math.cos(e),y:3*Math.sin(t)*Math.sin(e),z:3*Math.cos(t)}}function A(){r[D][z];var e=r[D][z].name,t=r[D][z].absolute_magnitude_h,a=r[D][z].close_approach_data[0].relative_velocity.kilometers_per_second,i=r[D][z].estimated_diameter.kilometers.estimated_diameter_min,_=r[D][z].estimated_diameter.kilometers.estimated_diameter_max,s=r[D][z].close_approach_data[0].miss_distance.kilometers;document.getElementById("name").innerHTML=e,document.getElementById("magnitude").innerHTML=t,document.getElementById("speed").innerHTML=parseFloat(a).toFixed(4)+" KMPS",document.getElementById("min-size").innerHTML=parseFloat(i).toFixed(8)+" KM",document.getElementById("max-size").innerHTML=parseFloat(_).toFixed(8)+" KM",document.getElementById("cad").innerHTML=r[D][z].close_approach_data[0].close_approach_date,document.getElementById("distance").innerHTML=parseFloat(s).toFixed(2)+" KM",r[D][z].is_potentially_hazardous_asteroid?(document.getElementById("threat").innerHTML="Potentially hazardous to Earth",document.getElementById("threat").style.color="red"):(document.getElementById("threat").innerHTML="No threat to Earth",document.getElementById("threat").style.color="#8ff67e")}V.enableDamping=!0,V.enablePan=!1,V.dampingFactor=.1,V.enableZoom=!0,window.addEventListener("resize",function(){var e=window.innerWidth,t=window.innerHeight;x.aspect=e/t,x.updateProjectionMatrix(),j.setSize(e,t)}),A();var U=!1;function R(t){var a=(new e.TextureLoader).load(t);O.material.map=a,O.material.needsUpdate=!0}document.getElementById("night-mode-btn").addEventListener("click",function(){U?(R("./texture.jpg"),document.getElementById("night-mode-btn").innerHTML="<img src='./sun.png' />",U=!1):(R("./texture_night.jpg"),document.getElementById("night-mode-btn").innerHTML="<img src='./moon.png' />",U=!0)});for(var q=0;q<r.length;q++)for(var X=0;X<r[q].length;X++)document.getElementById("list").innerHTML+='<li pivotIdx="'.concat(q,'" asteroidIdx="').concat(X,'" class="list-item"><p>').concat(r[q][X].name,'</p><div class="list-dot" style="background: ').concat(r[q][X].is_potentially_hazardous_asteroid?"red":"#21e102",'"></div></li>');function N(){document.querySelectorAll("li").forEach(function(e){e.style.color="rgb(0, 152, 190)"}),document.querySelector('[pivotIdx="'.concat(D,'"][asteroidIdx="').concat(z,'"]')).style.color="white"}function Q(){Y&&(m[D][z].remove(Y),Y=null);var t=new e.MeshBasicMaterial({color:I,side:e.BackSide}),a=new e.Mesh(K,t);a.scale.set(1.2,1.2,1.2),m[D][z].add(a),Y=a}N(),Q();var Z=document.querySelectorAll(".list-item");Z.forEach(function(e){e.addEventListener("click",function(){Y&&(m[D][z].remove(Y),Y=null);var t=e.getAttribute("asteroidIdx"),a=e.getAttribute("pivotIdx");z=t,D=a,A(),N(),Q()})}),document.getElementById("highlight-color-btn").addEventListener("click",function(){switch(console.log(I),I){case"rgb(255,0,0)":I="rgb(143,246,126)",document.getElementById("highlight-color-value").style.background="rgb(143,246,126)",Q();break;case"rgb(143,246,126)":I="rgb(0,152,190)",document.getElementById("highlight-color-value").style.background="rgb(0,152,190)",Q();break;case"rgb(0,152,190)":I="rgb(255,0,0)",document.getElementById("highlight-color-value").style.background="rgb(255,0,0)",Q()}}),document.getElementById("physics-speed-btn").addEventListener("click",function(){switch(S){case 1:S=1.5,document.getElementById("physics-speed-btn").innerHTML="<p>1.5<span>x</span></p>";break;case 1.5:S=2,document.getElementById("physics-speed-btn").innerHTML="<p>2<span>x</span></p>";break;case 2:S=.5,document.getElementById("physics-speed-btn").innerHTML="<p>0.5<span>x</span></p>";break;case.5:S=1,document.getElementById("physics-speed-btn").innerHTML="<p>1<span>x</span></p>"}}),document.getElementById("tl-btn").addEventListener("click",function(){document.getElementById("asteroid-list").style.width="100%",document.getElementById("asteroid-list").style.padding="20px"}),document.getElementById("al-close-btn").addEventListener("click",function(){document.getElementById("asteroid-list").style.width="0%",document.getElementById("asteroid-list").style.padding="0px"});var J=!1;document.getElementById("al-toggle").addEventListener("click",function(){J?(document.getElementById("asteroid-list").style.width="60px",J=!1):(document.getElementById("asteroid-list").style.width="400px",J=!0)});
},{"three":"gBK8","./node_modules/three/examples/jsm/controls/OrbitControls.js":"x87H"}]},{},["PnwU"], null)
//# sourceMappingURL=/main.da0980e1.js.map